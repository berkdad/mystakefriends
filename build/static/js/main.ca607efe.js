/*! For license information please see main.ca607efe.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,r)=>{e.exports=r(202)},150:(e,t,r)=>{r.d(t,{MF:()=>de,j6:()=>ie,xZ:()=>oe,om:()=>se,Sx:()=>fe,Wp:()=>he,KO:()=>me});var n=r(812),a=r(443),s=r(700),i=r(555);let o,l;const c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap;let m={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return v(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(y(this),r),v(c.get(this))}:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return v(e.apply(y(this),r))}:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];const s=e.call(y(this),t,...n);return d.set(s,t.sort?t.sort():[t]),v(s)}}function g(e){return"function"===typeof e?p(e):(e instanceof IDBTransaction&&function(e){if(u.has(e))return;const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",s),e.removeEventListener("abort",s)},a=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",a),e.addEventListener("error",s),e.addEventListener("abort",s)});u.set(e,t)}(e),t=e,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,m):e);var t}function v(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("success",a),e.removeEventListener("error",s)},a=()=>{t(v(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",a),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),f.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=g(e);return t!==e&&(h.set(e,t),f.set(t,e)),t}const y=e=>f.get(e);const b=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],x=new Map;function E(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(x.get(t))return x.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,a=w.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!a&&!b.includes(r))return;const s=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let s=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return n&&(s=s.index(o.shift())),(await Promise.all([s[r](...o),a&&t.done]))[0]};return x.set(t,s),s}m=(e=>(0,i.A)((0,i.A)({},e),{},{get:(t,r,n)=>E(t,r)||e.get(t,r,n),has:(t,r)=>!!E(t,r)||e.has(t,r)}))(m);class T{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const k="@firebase/app",N="0.10.13",S=new a.Vy("@firebase/app"),_="@firebase/app-compat",C="@firebase/analytics-compat",A="@firebase/analytics",I="@firebase/app-check-compat",R="@firebase/app-check",O="@firebase/auth",D="@firebase/auth-compat",j="@firebase/database",P="@firebase/data-connect",M="@firebase/database-compat",L="@firebase/functions",F="@firebase/functions-compat",U="@firebase/installations",B="@firebase/installations-compat",V="@firebase/messaging",z="@firebase/messaging-compat",H="@firebase/performance",W="@firebase/performance-compat",G="@firebase/remote-config",K="@firebase/remote-config-compat",q="@firebase/storage",X="@firebase/storage-compat",$="@firebase/firestore",Y="@firebase/vertexai-preview",Q="@firebase/firestore-compat",J="firebase",Z="[DEFAULT]",ee={[k]:"fire-core",[_]:"fire-core-compat",[A]:"fire-analytics",[C]:"fire-analytics-compat",[R]:"fire-app-check",[I]:"fire-app-check-compat",[O]:"fire-auth",[D]:"fire-auth-compat",[j]:"fire-rtdb",[P]:"fire-data-connect",[M]:"fire-rtdb-compat",[L]:"fire-fn",[F]:"fire-fn-compat",[U]:"fire-iid",[B]:"fire-iid-compat",[V]:"fire-fcm",[z]:"fire-fcm-compat",[H]:"fire-perf",[W]:"fire-perf-compat",[G]:"fire-rc",[K]:"fire-rc-compat",[q]:"fire-gcs",[X]:"fire-gcs-compat",[$]:"fire-fst",[Q]:"fire-fst-compat",[Y]:"fire-vertex","fire-js":"fire-js",[J]:"fire-js-all"},te=new Map,re=new Map,ne=new Map;function ae(e,t){try{e.container.addComponent(t)}catch(r){S.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),r)}}function se(e){const t=e.name;if(ne.has(t))return S.debug("There were multiple attempts to register component ".concat(t,".")),!1;ne.set(t,e);for(const r of te.values())ae(r,e);for(const r of re.values())ae(r,e);return!0}function ie(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function oe(e){return void 0!==e.settings}const le={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new s.FA("app","Firebase",le);class ue{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new n.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const de="10.14.1";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;if("object"!==typeof t){t={name:t}}const a=Object.assign({name:Z,automaticDataCollectionEnabled:!1},t),i=a.name;if("string"!==typeof i||!i)throw ce.create("bad-app-name",{appName:String(i)});if(r||(r=(0,s.T9)()),!r)throw ce.create("no-options");const o=te.get(i);if(o){if((0,s.bD)(r,o.options)&&(0,s.bD)(a,o.config))return o;throw ce.create("duplicate-app",{appName:i})}const l=new n.h1(i);for(const n of ne.values())l.addComponent(n);const c=new ue(r,a,l);return te.set(i,c),c}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z;const t=te.get(e);if(!t&&e===Z&&(0,s.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function me(e,t,r){var a;let s=null!==(a=ee[e])&&void 0!==a?a:e;r&&(s+="-".concat(r));const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),i&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void S.warn(e.join(" "))}se(new n.uA("".concat(s,"-version"),()=>({library:s,version:t}),"VERSION"))}const pe="firebase-heartbeat-store";let ge=null;function ve(){return ge||(ge=function(e,t){let{blocked:r,upgrade:n,blocking:a,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=v(i);return n&&i.addEventListener("upgradeneeded",e=>{n(v(i.result),e.oldVersion,e.newVersion,v(i.transaction),e)}),r&&i.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(pe)}catch(r){console.warn(r)}}}).catch(e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})})),ge}async function ye(e,t){try{const r=(await ve()).transaction(pe,"readwrite"),n=r.objectStore(pe);await n.put(t,be(e)),await r.done}catch(r){if(r instanceof s.g)S.warn(r.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===r||void 0===r?void 0:r.message});S.warn(e.message)}}}function be(e){return"".concat(e.name,"!").concat(e.options.appId)}class we{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ee(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=xe();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(e=>e.date===n))return;return this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(r){S.warn(r)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=xe(),{heartbeatsToSend:r,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const r=[];let n=e.slice();for(const a of e){const e=r.find(e=>e.agent===a.agent);if(e){if(e.dates.push(a.date),Te(r)>t){e.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Te(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),a=(0,s.Uj)(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return S.warn(t),""}}}function xe(){return(new Date).toISOString().substring(0,10)}class Ee{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.zW)()&&(0,s.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ve()).transaction(pe),r=await t.objectStore(pe).get(be(e));return await t.done,r}catch(t){if(t instanceof s.g)S.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});S.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function Te(e){return(0,s.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var ke;ke="",se(new n.uA("platform-logger",e=>new T(e),"PRIVATE")),se(new n.uA("heartbeat",e=>new we(e),"PRIVATE")),me(k,N,ke),me(k,N,"esm2017"),me("fire-js","")},153:(e,t,r)=>{var n=r(43),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,s={},c=null,u=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,n)&&!l.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:a,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,p(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,E=Object.prototype.hasOwnProperty,T={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,n){var a,s={},i=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)E.call(t,a)&&!k.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(1===l)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===s[a]&&(s[a]=l[a]);return{$$typeof:r,type:e,key:i,ref:o,props:s,_owner:T.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var _=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,a,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return i=i(l=e),e=""===s?"."+C(l,0):s,x(i)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),A(i,t,a,"",function(e){return e})):null!=i&&(S(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,a+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(_,"$&/")+"/")+e)),t.push(i)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+C(o=e[c],c);l+=A(o,t,a,u,i)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=A(o=o.value,t,a,u=s+C(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,r){if(null==e)return e;var n=[],a=0;return A(e,n,"","",function(e){return t.call(r,e,a++)}),n}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},j={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:T};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,r){I(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=i,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.act=P,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=p({},e.props),s=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=T.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!k.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:r,type:e.type,key:s,ref:i,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,r){return O.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,r){return O.current.useReducer(e,t,r)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return O.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return O.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<s(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,i=a>>>1;n<i;){var o=2*(n+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,r))c<a&&0>s(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<a&&0>s(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,p=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function x(e){if(g=!1,w(e),!p)if(null!==n(c))p=!0,D(E);else{var t=n(u);null!==t&&j(x,t.startTime-e)}}function E(e,r){p=!1,g&&(g=!1,y(S),S=-1),m=!0;var s=f;try{for(w(r),h=n(c);null!==h&&(!(h.expirationTime>r)||e&&!A());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var o=i(h.expirationTime<=r);r=t.unstable_now(),"function"===typeof o?h.callback=o:h===n(c)&&a(c),w(r)}else a(c);h=n(c)}if(null!==h)var l=!0;else{var d=n(u);null!==d&&j(x,d.startTime-r),l=!1}return l}finally{h=null,f=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,k=!1,N=null,S=-1,_=5,C=-1;function A(){return!(t.unstable_now()-C<_)}function I(){if(null!==N){var e=t.unstable_now();C=e;var r=!0;try{r=N(!0,e)}finally{r?T():(k=!1,N=null)}}else k=!1}if("function"===typeof b)T=function(){b(I)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,O=R.port2;R.port1.onmessage=I,T=function(){O.postMessage(null)}}else T=function(){v(I,0)};function D(e){N=e,k||(k=!0,T())}function j(e,r){S=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,D(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,a,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,r(u,e),null===n(c)&&e===n(u)&&(g?(y(S),S=-1):g=!0,j(x,s-i))):(e.sortIndex=o,r(c,e),p||m||(p=!0,D(E))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},391:(e,t,r)=>{var n=r(950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},443:(e,t,r)=>{r.d(t,{$b:()=>a,Vy:()=>c});const n=[];var a;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(a||(a={}));const s={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},i=a.INFO,o={[a.DEBUG]:"log",[a.VERBOSE]:"log",[a.INFO]:"info",[a.WARN]:"warn",[a.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const r=(new Date).toISOString(),n=o[t];if(!n)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i];console[n]("[".concat(r,"]  ").concat(e.name,":"),...s)};class c{constructor(e){this.name=e,this._logLevel=i,this._logHandler=l,this._userLogHandler=null,n.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in a))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,a.DEBUG,...t),this._logHandler(this,a.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,a.VERBOSE,...t),this._logHandler(this,a.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,a.INFO,...t),this._logHandler(this,a.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,a.WARN,...t),this._logHandler(this,a.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,a.ERROR,...t),this._logHandler(this,a.ERROR,...t)}}},472:(e,t,r)=>{r.d(t,{gS:()=>$o,collection:()=>Fi,kd:()=>Xo,H9:()=>Ui,x7:()=>Wo,getDocs:()=>Ko,aU:()=>Hi,AB:()=>Do,aQ:()=>Yo,My:()=>Ro,query:()=>So,O5:()=>tl,mZ:()=>qo,where:()=>Co,wP:()=>rl});var n,a,s=r(150),i=r(812),o=r(443),l=r(700),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function r(e,t,r){r||(r=0);var n=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)n[a]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(a=0;16>a;++a)n[a]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],a=e.g[2];var s=e.g[3],i=t+(s^r&(a^s))+n[0]+3614090360&4294967295;i=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=(r=(a=(s=(t=r+(i<<7&4294967295|i>>>25))+((i=s+(a^t&(r^a))+n[1]+3905402710&4294967295)<<12&4294967295|i>>>20))+((i=a+(r^s&(t^r))+n[2]+606105819&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^a&(s^t))+n[3]+3250441966&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(a^s))+n[4]+4118548399&4294967295)<<7&4294967295|i>>>25))+((i=s+(a^t&(r^a))+n[5]+1200080426&4294967295)<<12&4294967295|i>>>20))+((i=a+(r^s&(t^r))+n[6]+2821735955&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^a&(s^t))+n[7]+4249261313&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(a^s))+n[8]+1770035416&4294967295)<<7&4294967295|i>>>25))+((i=s+(a^t&(r^a))+n[9]+2336552879&4294967295)<<12&4294967295|i>>>20))+((i=a+(r^s&(t^r))+n[10]+4294925233&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^a&(s^t))+n[11]+2304563134&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(a^s))+n[12]+1804603682&4294967295)<<7&4294967295|i>>>25))+((i=s+(a^t&(r^a))+n[13]+4254626195&4294967295)<<12&4294967295|i>>>20))+((i=a+(r^s&(t^r))+n[14]+2792965006&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^a&(s^t))+n[15]+1236535329&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^s&(r^a))+n[1]+4129170786&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^a&(t^r))+n[6]+3225465664&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^r&(s^t))+n[11]+643717713&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(a^s))+n[0]+3921069994&4294967295)<<20&4294967295|i>>>12))+((i=t+(a^s&(r^a))+n[5]+3593408605&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^a&(t^r))+n[10]+38016083&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^r&(s^t))+n[15]+3634488961&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(a^s))+n[4]+3889429448&4294967295)<<20&4294967295|i>>>12))+((i=t+(a^s&(r^a))+n[9]+568446438&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^a&(t^r))+n[14]+3275163606&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^r&(s^t))+n[3]+4107603335&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(a^s))+n[8]+1163531501&4294967295)<<20&4294967295|i>>>12))+((i=t+(a^s&(r^a))+n[13]+2850285829&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^a&(t^r))+n[2]+4243563512&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^r&(s^t))+n[7]+1735328473&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(a^s))+n[12]+2368359562&4294967295)<<20&4294967295|i>>>12))+((i=t+(r^a^s)+n[5]+4294588738&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^a)+n[8]+2272392833&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^r)+n[11]+1839030562&4294967295)<<16&4294967295|i>>>16))+((i=r+(a^s^t)+n[14]+4259657740&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^a^s)+n[1]+2763975236&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^a)+n[4]+1272893353&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^r)+n[7]+4139469664&4294967295)<<16&4294967295|i>>>16))+((i=r+(a^s^t)+n[10]+3200236656&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^a^s)+n[13]+681279174&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^a)+n[0]+3936430074&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^r)+n[3]+3572445317&4294967295)<<16&4294967295|i>>>16))+((i=r+(a^s^t)+n[6]+76029189&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^a^s)+n[9]+3654602809&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^a)+n[12]+3873151461&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^r)+n[15]+530742520&4294967295)<<16&4294967295|i>>>16))+((i=r+(a^s^t)+n[2]+3299628645&4294967295)<<23&4294967295|i>>>9))+((i=t+(a^(r|~s))+n[0]+4096336452&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~a))+n[7]+1126891415&4294967295)<<10&4294967295|i>>>22))+((i=a+(t^(s|~r))+n[14]+2878612391&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(a|~t))+n[5]+4237533241&4294967295)<<21&4294967295|i>>>11))+((i=t+(a^(r|~s))+n[12]+1700485571&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~a))+n[3]+2399980690&4294967295)<<10&4294967295|i>>>22))+((i=a+(t^(s|~r))+n[10]+4293915773&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(a|~t))+n[1]+2240044497&4294967295)<<21&4294967295|i>>>11))+((i=t+(a^(r|~s))+n[8]+1873313359&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~a))+n[15]+4264355552&4294967295)<<10&4294967295|i>>>22))+((i=a+(t^(s|~r))+n[6]+2734768916&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(a|~t))+n[13]+1309151649&4294967295)<<21&4294967295|i>>>11))+((s=(t=r+((i=t+(a^(r|~s))+n[4]+4149444226&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~a))+n[11]+3174756917&4294967295)<<10&4294967295|i>>>22))^((a=s+((i=a+(t^(s|~r))+n[2]+718787259&4294967295)<<15&4294967295|i>>>17))|~t))+n[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+s&4294967295}function s(e,t){this.h=t;for(var r=[],n=!0,a=e.length-1;0<=a;a--){var s=0|e[a];n&&s==t||(r[a]=s,n=!1)}this.g=r}!function(e,t){function r(){}r.prototype=t.prototype,e.D=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.C=function(e,r,n){for(var a=Array(arguments.length-2),s=2;s<arguments.length;s++)a[s-2]=arguments[s];return t.prototype[r].apply(e,a)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,a=this.B,s=this.h,i=0;i<t;){if(0==s)for(;i<=n;)r(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(a[s++]=e.charCodeAt(i++),s==this.blockSize){r(this,a),s=0;break}}else for(;i<t;)if(a[s++]=e[i++],s==this.blockSize){r(this,a),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};var i={};function o(e){return-128<=e&&128>e?function(e,t){var r=i;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}(e,function(e){return new s([0|e],0>e?-1:0)}):new s([0|e],0>e?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return c;if(0>e)return p(l(-e));for(var t=[],r=1,n=0;e>=r;n++)t[n]=e/r|0,r*=4294967296;return new s(t,0)}var c=o(0),d=o(1),h=o(16777216);function f(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function m(e){return-1==e.h}function p(e){for(var t=e.g.length,r=[],n=0;n<t;n++)r[n]=~e.g[n];return new s(r,~e.h).add(d)}function g(e,t){return e.add(p(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function b(e,t){if(f(t))throw Error("division by zero");if(f(e))return new y(c,c);if(m(e))return t=b(p(e),t),new y(p(t.g),p(t.h));if(m(t))return t=b(e,p(t)),new y(p(t.g),t.h);if(30<e.g.length){if(m(e)||m(t))throw Error("slowDivide_ only works with positive integers.");for(var r=d,n=t;0>=n.l(e);)r=w(r),n=w(n);var a=x(r,1),s=x(n,1);for(n=x(n,2),r=x(r,2);!f(n);){var i=s.add(n);0>=i.l(e)&&(a=a.add(r),s=i),n=x(n,1),r=x(r,1)}return t=g(e,a.j(t)),new y(a,t)}for(a=c;0<=e.l(t);){for(r=Math.max(1,Math.floor(e.m()/t.m())),n=48>=(n=Math.ceil(Math.log(r)/Math.LN2))?1:Math.pow(2,n-48),i=(s=l(r)).j(t);m(i)||0<i.l(e);)i=(s=l(r-=n)).j(t);f(s)&&(s=d),a=a.add(s),e=g(e,i)}return new y(a,e)}function w(e){for(var t=e.g.length+1,r=[],n=0;n<t;n++)r[n]=e.i(n)<<1|e.i(n-1)>>>31;return new s(r,e.h)}function x(e,t){var r=t>>5;t%=32;for(var n=e.g.length-r,a=[],i=0;i<n;i++)a[i]=0<t?e.i(i+r)>>>t|e.i(i+r+1)<<32-t:e.i(i+r);return new s(a,e.h)}(e=s.prototype).m=function(){if(m(this))return-p(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.i(r);e+=(0<=n?n:4294967296+n)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(m(this))return"-"+p(this).toString(e);for(var t=l(Math.pow(e,6)),r=this,n="";;){var a=b(r,t).g,s=((0<(r=g(r,a.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(f(r=a))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return m(e=g(this,e))?-1:f(e)?0:1},e.abs=function(){return m(this)?p(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0,a=0;a<=t;a++){var i=n+(65535&this.i(a))+(65535&e.i(a)),o=(i>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);n=o>>>16,i&=65535,o&=65535,r[a]=o<<16|i}return new s(r,-2147483648&r[r.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return c;if(m(this))return m(e)?p(this).j(p(e)):p(p(this).j(e));if(m(e))return p(this.j(p(e)));if(0>this.l(h)&&0>e.l(h))return l(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var a=0;a<e.g.length;a++){var i=this.i(n)>>>16,o=65535&this.i(n),u=e.i(a)>>>16,d=65535&e.i(a);r[2*n+2*a]+=o*d,v(r,2*n+2*a),r[2*n+2*a+1]+=i*d,v(r,2*n+2*a+1),r[2*n+2*a+1]+=o*u,v(r,2*n+2*a+1),r[2*n+2*a+2]+=i*u,v(r,2*n+2*a+2)}for(n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=t;n<2*t;n++)r[n]=0;return new s(r,0)},e.A=function(e){return b(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)&e.i(n);return new s(r,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)|e.i(n);return new s(r,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)^e.i(n);return new s(r,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,a=u.Md5=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return p(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=l(Math.pow(r,8)),a=c,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+i),r);8>i?(i=l(Math.pow(r,i)),a=a.j(i).add(l(o))):a=(a=a.j(n)).add(l(o))}return a},n=u.Integer=s}).apply("undefined"!==typeof c?c:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var d,h,f,m,p,g,v,y,b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e};var r=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);!function(e,n){if(n)e:{var a=r;e=e.split(".");for(var s=0;s<e.length-1;s++){var i=e[s];if(!(i in a))break e;a=a[i]}(n=n(s=a[e=e[e.length-1]]))!=s&&null!=n&&t(a,e,{configurable:!0,writable:!0,value:n})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var r=0,n=!1,a={next:function(){if(!n&&r<e.length){var a=r++;return{value:t(a,e[a]),done:!1}}return n=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,function(e,t){return t})}});var n=n||{},a=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function i(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,r){return e.call.apply(e.bind,arguments)}function l(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function c(e,t,r){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function E(e,t){function r(){}r.prototype=t.prototype,e.aa=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Qb=function(e,r,n){for(var a=Array(arguments.length-2),s=2;s<arguments.length;s++)a[s-2]=arguments[s];return t.prototype[r].apply(e,a)}}function T(e){const t=e.length;if(0<t){const r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function N(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];if(s(t)){const r=e.length||0,n=t.length||0;e.length=r+n;for(let a=0;a<n;a++)e[r+a]=t[a]}else e.push(t)}}function S(e){return/^[\s\xa0]*$/.test(e)}function _(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function C(e){return C[" "](e),e}C[" "]=function(){};var A=-1!=_().indexOf("Gecko")&&!(-1!=_().toLowerCase().indexOf("webkit")&&-1==_().indexOf("Edge"))&&!(-1!=_().indexOf("Trident")||-1!=_().indexOf("MSIE"))&&-1==_().indexOf("Edge");function I(e,t,r){for(const n in e)t.call(r,e[n],n,e)}function R(e){const t={};for(const r in e)t[r]=e[r];return t}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(e,t){let r,n;for(let a=1;a<arguments.length;a++){for(r in n=arguments[a],n)e[r]=n[r];for(let t=0;t<O.length;t++)r=O[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function j(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function P(e){a.setTimeout(()=>{throw e},0)}function M(){var e=V;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var L=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new F,e=>e.reset());class F{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let U,B=!1,V=new class{constructor(){this.h=this.g=null}add(e,t){const r=L.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},z=()=>{const e=a.Promise.resolve(void 0);U=()=>{e.then(H)}};var H=()=>{for(var e;e=M();){try{e.h.call(e.g)}catch(r){P(r)}var t=L;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}B=!1};function W(){this.s=this.s,this.C=this.C}function G(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},G.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(r){}return e}();function q(e,t){if(G.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(A){e:{try{C(t.nodeName);var a=!0;break e}catch(s){}a=!1}a||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:X[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&q.aa.h.call(this)}}E(q,G);var X={2:"touch",3:"pen",4:"mouse"};q.prototype.h=function(){q.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var $="closure_listenable_"+(1e6*Math.random()|0),Y=0;function Q(e,t,r,n,a){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=a,this.key=++Y,this.da=this.fa=!1}function J(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function Z(e){this.src=e,this.g={},this.h=0}function ee(e,t){var r=t.type;if(r in e.g){var n,a=e.g[r],s=Array.prototype.indexOf.call(a,t,void 0);(n=0<=s)&&Array.prototype.splice.call(a,s,1),n&&(J(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function te(e,t,r,n){for(var a=0;a<e.length;++a){var s=e[a];if(!s.da&&s.listener==t&&s.capture==!!r&&s.ha==n)return a}return-1}Z.prototype.add=function(e,t,r,n,a){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var i=te(e,t,n,a);return-1<i?(t=e[i],r||(t.fa=!1)):((t=new Q(t,this.src,s,!!n,a)).fa=r,e.push(t)),t};var re="closure_lm_"+(1e6*Math.random()|0),ne={};function ae(e,t,r,n,a){if(n&&n.once)return ie(e,t,r,n,a);if(Array.isArray(t)){for(var s=0;s<t.length;s++)ae(e,t[s],r,n,a);return null}return r=fe(r),e&&e[$]?e.K(t,r,i(n)?!!n.capture:!!n,a):se(e,t,r,!1,n,a)}function se(e,t,r,n,a,s){if(!t)throw Error("Invalid event type");var o=i(a)?!!a.capture:!!a,l=de(e);if(l||(e[re]=l=new Z(e)),(r=l.add(t,r,n,o,s)).proxy)return r;if(n=function(){function e(r){return t.call(e.src,e.listener,r)}const t=ue;return e}(),r.proxy=n,n.src=e,n.listener=r,e.addEventListener)K||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),n,a);else if(e.attachEvent)e.attachEvent(ce(t.toString()),n);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(n)}return r}function ie(e,t,r,n,a){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ie(e,t[s],r,n,a);return null}return r=fe(r),e&&e[$]?e.L(t,r,i(n)?!!n.capture:!!n,a):se(e,t,r,!0,n,a)}function oe(e,t,r,n,a){if(Array.isArray(t))for(var s=0;s<t.length;s++)oe(e,t[s],r,n,a);else n=i(n)?!!n.capture:!!n,r=fe(r),e&&e[$]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(r=te(s=e.g[t],r,n,a))&&(J(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=de(e))&&(t=e.g[t.toString()],e=-1,t&&(e=te(t,r,n,a)),(r=-1<e?t[e]:null)&&le(r))}function le(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[$])ee(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(ce(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=de(t))?(ee(r,e),0==r.h&&(r.src=null,t[re]=null)):J(e)}}}function ce(e){return e in ne?ne[e]:ne[e]="on"+e}function ue(e,t){if(e.da)e=!0;else{t=new q(t,this);var r=e.listener,n=e.ha||e.src;e.fa&&le(e),e=r.call(n,t)}return e}function de(e){return(e=e[re])instanceof Z?e:null}var he="__closure_events_fn_"+(1e9*Math.random()>>>0);function fe(e){return"function"===typeof e?e:(e[he]||(e[he]=function(t){return e.handleEvent(t)}),e[he])}function me(){W.call(this),this.i=new Z(this),this.M=this,this.F=null}function pe(e,t){var r,n=e.F;if(n)for(r=[];n;n=n.F)r.push(n);if(e=e.M,n=t.type||t,"string"===typeof t)t=new G(t,e);else if(t instanceof G)t.target=t.target||e;else{var a=t;D(t=new G(n,e),a)}if(a=!0,r)for(var s=r.length-1;0<=s;s--){var i=t.g=r[s];a=ge(i,n,!0,t)&&a}if(a=ge(i=t.g=e,n,!0,t)&&a,a=ge(i,n,!1,t)&&a,r)for(s=0;s<r.length;s++)a=ge(i=t.g=r[s],n,!1,t)&&a}function ge(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,s=0;s<t.length;++s){var i=t[s];if(i&&!i.da&&i.capture==r){var o=i.listener,l=i.ha||i.src;i.fa&&ee(e.i,i),a=!1!==o.call(l,n)&&a}}return a&&!n.defaultPrevented}function ve(e,t,r){if("function"===typeof e)r&&(e=c(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function ye(e){e.g=ve(()=>{e.g=null,e.i&&(e.i=!1,ye(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}E(me,W),me.prototype[$]=!0,me.prototype.removeEventListener=function(e,t,r,n){oe(this,e,t,r,n)},me.prototype.N=function(){if(me.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],n=0;n<r.length;n++)J(r[n]);delete t.g[e],t.h--}}this.F=null},me.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},me.prototype.L=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class be extends W{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function we(e){W.call(this),this.h=e,this.g={}}E(we,W);var xe=[];function Ee(e){I(e.g,function(e,t){this.g.hasOwnProperty(t)&&le(e)},e),e.g={}}we.prototype.N=function(){we.aa.N.call(this),Ee(this)},we.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Te=a.JSON.stringify,ke=a.JSON.parse,Ne=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function Se(){}function _e(e){return e.h||(e.h=e.i())}function Ce(){}Se.prototype.h=null;var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ie(){G.call(this,"d")}function Re(){G.call(this,"c")}E(Ie,G),E(Re,G);var Oe={},De=null;function je(){return De=De||new me}function Pe(e){G.call(this,Oe.La,e)}function Me(e){const t=je();pe(t,new Pe(t))}function Le(e,t){G.call(this,Oe.STAT_EVENT,e),this.stat=t}function Fe(e){const t=je();pe(t,new Le(t,e))}function Ue(e,t){G.call(this,Oe.Ma,e),this.size=t}function Be(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function Ve(){this.g=!0}function ze(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r)for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(2>n.length)){var a=n[1];if(Array.isArray(a)&&!(1>a.length)){var s=a[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var i=1;i<a.length;i++)a[i]=""}}}return Te(r)}catch(o){return t}}(e,r)+(n?" "+n:"")})}Oe.La="serverreachability",E(Pe,G),Oe.STAT_EVENT="statevent",E(Le,G),Oe.Ma="timingevent",E(Ue,G),Ve.prototype.xa=function(){this.g=!1},Ve.prototype.info=function(){};var He,We={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ge={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Ke(){}function qe(e,t,r,n){this.j=e,this.i=t,this.l=r,this.R=n||1,this.U=new we(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xe}function Xe(){this.i=null,this.g="",this.h=!1}E(Ke,Se),Ke.prototype.g=function(){return new XMLHttpRequest},Ke.prototype.i=function(){return{}},He=new Ke;var $e={},Ye={};function Qe(e,t,r){e.L=1,e.v=Tt(yt(t)),e.m=r,e.P=!0,Je(e,null)}function Je(e,t){e.F=Date.now(),tt(e),e.A=yt(e.v);var r=e.A,n=e.R;Array.isArray(n)||(n=[String(n)]),Lt(r.i,"t",n),e.C=0,r=e.j.J,e.h=new Xe,e.g=kr(e.j,r?t:null,!e.m),0<e.O&&(e.M=new be(c(e.Y,e,e.g),e.O)),t=e.U,r=e.g,n=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(xe[0]=a.toString()),a=xe);for(var s=0;s<a.length;s++){var i=ae(r,a[s],n||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}t=e.H?R(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Me(),function(e,t,r,n,a,s){e.info(function(){if(e.g)if(s)for(var i="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");i=2<=d.length&&"type"==d[1]?i+(u+"=")+c+"&":i+(u+"=redacted&")}}else i=null;else i=s;return"XMLHTTP REQ ("+n+") [attempt "+a+"]: "+t+"\n"+r+"\n"+i})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function et(e,t){var r=e.C,n=t.indexOf("\n",r);return-1==n?Ye:(r=Number(t.substring(r,n)),isNaN(r)?$e:(n+=1)+r>t.length?Ye:(t=t.slice(n,n+r),e.C=n+r,t))}function tt(e){e.S=Date.now()+e.I,rt(e,e.I)}function rt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Be(c(e.ba,e),t)}function nt(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function at(e){0==e.j.G||e.J||br(e.j,e)}function st(e){nt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,Ee(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function it(e,t){try{var r=e.j;if(0!=r.G&&(r.g==e||dt(r.h,e)))if(!e.K&&dt(r.h,e)&&3==r.G){try{var n=r.Da.g.parse(t)}catch(u){n=null}if(Array.isArray(n)&&3==n.length){var a=n;if(0==a[0]){e:if(!r.u){if(r.g){if(!(r.g.F+3e3<e.F))break e;yr(r),lr(r)}pr(r),Fe(18)}}else r.za=a[1],0<r.za-r.T&&37500>a[2]&&r.F&&0==r.v&&!r.C&&(r.C=Be(c(r.Za,r),6e3));if(1>=ut(r.h)&&r.ca){try{r.ca()}catch(u){}r.ca=void 0}}else xr(r,11)}else if((e.K||r.g==e)&&yr(r),!S(t))for(a=r.Da.g.parse(t),t=0;t<a.length;t++){let c=a[t];if(r.T=c[0],c=c[1],2==r.G)if("c"==c[0]){r.K=c[1],r.ia=c[2];const t=c[3];null!=t&&(r.la=t,r.j.info("VER="+r.la));const a=c[4];null!=a&&(r.Aa=a,r.j.info("SVER="+r.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(n=1.5*u,r.L=n,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=n.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ht(s,s.h),s.h=null))}if(n.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.ya=e,Et(n.I,n.D,e))}}r.G=3,r.l&&r.l.ua(),r.ba&&(r.R=Date.now()-e.F,r.j.info("Handshake RTT: "+r.R+"ms"));var i=e;if((n=r).qa=Tr(n,n.J?n.ia:null,n.W),i.K){ft(n.h,i);var o=i,l=n.L;l&&(o.I=l),o.B&&(nt(o),tt(o)),n.g=i}else mr(n);0<r.i.length&&ur(r)}else"stop"!=c[0]&&"close"!=c[0]||xr(r,7);else 3==r.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?xr(r,7):or(r):"noop"!=c[0]&&r.l&&r.l.ta(c),r.v=0)}Me()}catch(u){}}qe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==nr(e)?t.j():this.Y(e)},qe.prototype.Y=function(e){try{if(e==this.g)e:{const h=nr(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||ar(this.g)))){this.J||4!=h||7==t||Me(),nt(this);var r=this.g.Z();this.X=r;t:if(Ze(this)){var n=ar(this.g);e="";var s=n.length,i=4==nr(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){st(this),at(this);var o="";break t}this.h.i=new a.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(n[t],{stream:!(i&&t==s-1)});n.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==r,function(e,t,r,n,a,s,i){e.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+a+"]: "+t+"\n"+r+"\n"+s+" "+i})}(this.i,this.u,this.A,this.l,this.R,h,r),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(l)){var u=l;break t}}u=null}if(!(r=u)){this.o=!1,this.s=3,Fe(12),st(this),at(this);break e}ze(this.i,this.l,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,it(this,r)}if(this.P){let e;for(r=!0;!this.J&&this.C<o.length;){if(e=et(this,o),e==Ye){4==h&&(this.s=4,Fe(14),r=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}if(e==$e){this.s=4,Fe(15),ze(this.i,this.l,o,"[Invalid Chunk]"),r=!1;break}ze(this.i,this.l,e,null),it(this,e)}if(Ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Fe(16),r=!1),this.o=this.o&&r,r){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),gr(d),d.M=!0,Fe(11))}}else ze(this.i,this.l,o,"[Invalid Chunked Response]"),st(this),at(this)}else ze(this.i,this.l,o,null),it(this,o);4==h&&st(this),this.o&&!this.J&&(4==h?br(this.j,this):(this.o=!1,tt(this)))}else(function(e){const t={};e=(e.g&&2<=nr(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(S(e[n]))continue;var r=j(e[n]);const a=r[0];if("string"!==typeof(r=r[1]))continue;r=r.trim();const s=t[a]||[];t[a]=s,s.push(r)}!function(e,t){for(const r in e)t.call(void 0,e[r],r,e)}(t,function(e){return e.join(", ")})})(this.g),400==r&&0<o.indexOf("Unknown SID")?(this.s=3,Fe(12)):(this.s=0,Fe(13)),st(this),at(this)}}}catch(x){}},qe.prototype.cancel=function(){this.J=!0,st(this)},qe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Me(),Fe(17)),st(this),this.s=2,at(this)):rt(this,this.S-e)};var ot=class{constructor(e,t){this.g=e,this.map=t}};function lt(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ct(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ut(e){return e.h?1:e.g?e.g.size:0}function dt(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ht(e,t){e.g?e.g.add(t):e.h=t}function ft(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function mt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const r of e.g.values())t=t.concat(r.D);return t}return T(e.i)}function pt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const n in e)t[r++]=n;return t}}}(e),n=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}for(n in t=[],r=0,e)t[r++]=e[n];return t}(e),a=n.length,i=0;i<a;i++)t.call(void 0,n[i],r&&r[i],e)}lt.prototype.cancel=function(){if(this.i=mt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var gt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof vt){this.h=e.h,bt(this,e.j),this.o=e.o,this.g=e.g,wt(this,e.s),this.l=e.l;var t=e.i,r=new Dt;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),xt(this,r),this.m=e.m}else e&&(t=String(e).match(gt))?(this.h=!1,bt(this,t[1]||"",!0),this.o=kt(t[2]||""),this.g=kt(t[3]||"",!0),wt(this,t[4]),this.l=kt(t[5]||"",!0),xt(this,t[6]||"",!0),this.m=kt(t[7]||"")):(this.h=!1,this.i=new Dt(null,this.h))}function yt(e){return new vt(e)}function bt(e,t,r){e.j=r?kt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function wt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function xt(e,t,r){t instanceof Dt?(e.i=t,function(e,t){t&&!e.j&&(jt(e),e.i=null,e.g.forEach(function(e,t){var r=t.toLowerCase();t!=r&&(Pt(this,t),Lt(this,r,e))},e)),e.j=t}(e.i,e.h)):(r||(t=Nt(t,Rt)),e.i=new Dt(t,e.h))}function Et(e,t,r){e.i.set(t,r)}function Tt(e){return Et(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function kt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Nt(e,t,r){return"string"===typeof e?(e=encodeURI(e).replace(t,St),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function St(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}vt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Nt(t,Ct,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(Nt(t,Ct,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.s)&&e.push(":",String(r))),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(Nt(r,"/"==r.charAt(0)?It:At,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",Nt(r,Ot)),e.join("")};var _t,Ct=/[#\/\?@]/g,At=/[#\?:]/g,It=/[#\?]/g,Rt=/[#\?@]/g,Ot=/#/g;function Dt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function jt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].indexOf("="),a=null;if(0<=n){var s=e[r].substring(0,n);a=e[r].substring(n+1)}else s=e[r];t(s,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function Pt(e,t){jt(e),t=Ft(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Mt(e,t){return jt(e),t=Ft(e,t),e.g.has(t)}function Lt(e,t,r){Pt(e,t),0<r.length&&(e.i=null,e.g.set(Ft(e,t),T(r)),e.h+=r.length)}function Ft(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ut(e,t,r,n,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),n(r)}catch(s){}}function Bt(){this.g=new Ne}function Vt(e,t,r){const n=r||"";try{pt(e,function(e,r){let a=e;i(e)&&(a=Te(e)),t.push(n+r+"="+encodeURIComponent(a))})}catch(a){throw t.push(n+"type="+encodeURIComponent("_badmap")),a}}function zt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ht(e,t){me.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Wt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Gt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Kt(e)}function Kt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function qt(e){let t="";return I(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function Xt(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=qt(r),"string"===typeof e?null!=r&&encodeURIComponent(String(r)):Et(e,t,r))}function $t(e){me.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Dt.prototype).add=function(e,t){jt(this),this.i=null,e=Ft(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},e.forEach=function(e,t){jt(this),this.g.forEach(function(r,n){r.forEach(function(r){e.call(t,r,n,this)},this)},this)},e.na=function(){jt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let n=0;n<t.length;n++){const a=e[n];for(let e=0;e<a.length;e++)r.push(t[n])}return r},e.V=function(e){jt(this);let t=[];if("string"===typeof e)Mt(this,e)&&(t=t.concat(this.g.get(Ft(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t},e.set=function(e,t){return jt(this),this.i=null,Mt(this,e=Ft(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var n=t[r];const s=encodeURIComponent(String(n)),i=this.V(n);for(n=0;n<i.length;n++){var a=s;""!==i[n]&&(a+="="+encodeURIComponent(String(i[n]))),e.push(a)}}return this.i=e.join("&")},E(zt,Se),zt.prototype.g=function(){return new Ht(this.l,this.j)},zt.prototype.i=(_t={},function(){return _t}),E(Ht,me),(e=Ht.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Kt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Gt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Kt(this)),this.g&&(this.readyState=3,Kt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Gt(this):Kt(this),3==this.readyState&&Wt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Gt(this))},e.Qa=function(e){this.g&&(this.response=e,Gt(this))},e.ga=function(){this.g&&Gt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(Ht.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),E($t,me);var Yt=/^https?$/i,Qt=["POST","PUT"];function Jt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Zt(e),tr(e)}function Zt(e){e.A||(e.A=!0,pe(e,"complete"),pe(e,"error"))}function er(e){if(e.h&&"undefined"!=typeof n&&(!e.v[1]||4!=nr(e)||2!=e.Z()))if(e.u&&4==nr(e))ve(e.Ea,0,e);else if(pe(e,"readystatechange"),4==nr(e)){e.h=!1;try{const n=e.Z();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var s;if(s=0===n){var i=String(e.D).match(gt)[1]||null;!i&&a.self&&a.self.location&&(i=a.self.location.protocol.slice(0,-1)),s=!Yt.test(i?i.toLowerCase():"")}r=s}if(r)pe(e,"complete"),pe(e,"success");else{e.m=6;try{var o=2<nr(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Zt(e)}}finally{tr(e)}}}function tr(e,t){if(e.g){rr(e);const n=e.g,a=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||pe(e,"ready");try{n.onreadystatechange=a}catch(r){}}}function rr(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function nr(e){return e.g?e.g.readyState:0}function ar(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(k){return null}}function sr(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function ir(e){this.Aa=0,this.i=[],this.j=new Ve,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=sr("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=sr("baseRetryDelayMs",5e3,e),this.cb=sr("retryDelaySeedMs",1e4,e),this.Wa=sr("forwardChannelMaxRetries",2,e),this.wa=sr("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new lt(e&&e.concurrentRequestLimit),this.Da=new Bt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function or(e){if(cr(e),3==e.G){var t=e.U++,r=yt(e.I);if(Et(r,"SID",e.K),Et(r,"RID",t),Et(r,"TYPE","terminate"),hr(e,r),(t=new qe(e,e.j,t)).L=2,t.v=Tt(yt(r)),r=!1,a.navigator&&a.navigator.sendBeacon)try{r=a.navigator.sendBeacon(t.v.toString(),"")}catch(n){}!r&&a.Image&&((new Image).src=t.v,r=!0),r||(t.g=kr(t.j,null),t.g.ea(t.v)),t.F=Date.now(),tt(t)}Er(e)}function lr(e){e.g&&(gr(e),e.g.cancel(),e.g=null)}function cr(e){lr(e),e.u&&(a.clearTimeout(e.u),e.u=null),yr(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function ur(e){if(!ct(e.h)&&!e.s){e.s=!0;var t=e.Ga;U||z(),B||(U(),B=!0),V.add(t,e),e.B=0}}function dr(e,t){var r;r=t?t.l:e.U++;const n=yt(e.I);Et(n,"SID",e.K),Et(n,"RID",r),Et(n,"AID",e.T),hr(e,n),e.m&&e.o&&Xt(n,e.m,e.o),r=new qe(e,e.j,r,e.B+1),null===e.m&&(r.H=e.o),t&&(e.i=t.D.concat(e.i)),t=fr(e,r,1e3),r.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ht(e.h,r),Qe(r,n,t)}function hr(e,t){e.H&&I(e.H,function(e,r){Et(t,r,e)}),e.l&&pt({},function(e,r){Et(t,r,e)})}function fr(e,t,r){r=Math.min(e.i.length,r);var n=e.l?c(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+r];-1==t?0<r?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let i=0;i<r;i++){let r=a[i].g;const o=a[i].map;if(r-=t,0>r)t=Math.max(0,a[i].g-100),s=!1;else try{Vt(o,e,"req"+r+"_")}catch(x){n&&n(o)}}if(s){n=e.join("&");break e}}}return e=e.i.splice(0,r),t.D=e,n}function mr(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;U||z(),B||(U(),B=!0),V.add(t,e),e.v=0}}function pr(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Be(c(e.Fa,e),wr(e,e.v)),e.v++,!0)}function gr(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function vr(e){e.g=new qe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=yt(e.qa);Et(t,"RID","rpc"),Et(t,"SID",e.K),Et(t,"AID",e.T),Et(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&Et(t,"TO",e.ja),Et(t,"TYPE","xmlhttp"),hr(e,t),e.m&&e.o&&Xt(t,e.m,e.o),e.L&&(e.g.I=e.L);var r=e.g;e=e.ia,r.L=1,r.v=Tt(yt(t)),r.m=null,r.P=!0,Je(r,e)}function yr(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function br(e,t){var r=null;if(e.g==t){yr(e),gr(e),e.g=null;var n=2}else{if(!dt(e.h,t))return;r=t.D,ft(e.h,t),n=1}if(0!=e.G)if(t.o)if(1==n){r=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;pe(n=je(),new Ue(n,r)),ur(e)}else mr(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==n&&function(e,t){return!(ut(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Be(c(e.Ga,e,t),wr(e,e.B)),e.B++,!0))}(e,t)||2==n&&pr(e)))switch(r&&0<r.length&&(t=e.h,t.i=t.i.concat(r)),a){case 1:xr(e,5);break;case 4:xr(e,10);break;case 3:xr(e,6);break;default:xr(e,2)}}function wr(e,t){let r=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(r*=2),r*t}function xr(e,t){if(e.j.info("Error code "+t),2==t){var r=c(e.fb,e),n=e.Xa;const t=!n;n=new vt(n||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||bt(n,"https"),Tt(n),t?function(e,t){const r=new Ve;if(a.Image){const n=new Image;n.onload=u(Ut,r,"TestLoadImage: loaded",!0,t,n),n.onerror=u(Ut,r,"TestLoadImage: error",!1,t,n),n.onabort=u(Ut,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=u(Ut,r,"TestLoadImage: timeout",!1,t,n),a.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}(n.toString(),r):function(e,t){new Ve;const r=new AbortController,n=setTimeout(()=>{r.abort(),Ut(0,0,!1,t)},1e4);fetch(e,{signal:r.signal}).then(e=>{clearTimeout(n),e.ok?Ut(0,0,!0,t):Ut(0,0,!1,t)}).catch(()=>{clearTimeout(n),Ut(0,0,!1,t)})}(n.toString(),r)}else Fe(2);e.G=0,e.l&&e.l.sa(t),Er(e),cr(e)}function Er(e){if(e.G=0,e.ka=[],e.l){const t=mt(e.h);0==t.length&&0==e.i.length||(N(e.ka,t),N(e.ka,e.i),e.h.i.length=0,T(e.i),e.i.length=0),e.l.ra()}}function Tr(e,t,r){var n=r instanceof vt?yt(r):new vt(r);if(""!=n.g)t&&(n.g=t+"."+n.g),wt(n,n.s);else{var s=a.location;n=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new vt(null);n&&bt(i,n),t&&(i.g=t),s&&wt(i,s),r&&(i.l=r),n=i}return r=e.D,t=e.ya,r&&t&&Et(n,r,t),Et(n,"VER",e.la),hr(e,n),n}function kr(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new $t(new zt({eb:r})):new $t(e.pa)).Ha(e.J),t}function Nr(){}function Sr(){}function _r(e,t){me.call(this),this.g=new ir(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!S(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!S(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Ir(this)}function Cr(e){Ie.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Ar(){Re.call(this),this.status=1}function Ir(e){this.g=e}(e=$t.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():He.g(),this.v=this.o?_e(this.o):_e(He),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(i){return void Jt(this,i)}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var s in n)r.set(s,n[s]);else{if("function"!==typeof n.keys||"function"!==typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const e of n.keys())r.set(e,n.get(e))}n=Array.from(r.keys()).find(e=>"content-type"==e.toLowerCase()),s=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Qt,t,void 0))||n||s||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of r)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{rr(this),this.u=!0,this.g.send(e),this.u=!1}catch(i){Jt(this,i)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,pe(this,"complete"),pe(this,"abort"),tr(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tr(this,!0)),$t.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?er(this):this.bb())},e.bb=function(){er(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<nr(this)?this.g.status:-1}catch(_t){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(_t){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ke(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=ir.prototype).la=8,e.G=1,e.connect=function(e,t,r,n){Fe(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.I=Tr(this,null,this.W),ur(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new qe(this,this.j,e);let s=this.o;if(this.S&&(s?(s=R(s),D(s,this.S)):s=this.S),null!==this.m||this.O||(a.H=s,s=null),this.P)e:{for(var t=0,r=0;r<this.i.length;r++){var n=this.i[r];if(void 0===(n="__data__"in n.map&&"string"===typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(t+=n)){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=fr(this,a,t),Et(r=yt(this.I),"RID",e),Et(r,"CVER",22),this.D&&Et(r,"X-HTTP-Session-Id",this.D),hr(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(qt(s)))+"&"+t:this.m&&Xt(r,this.m,s)),ht(this.h,a),this.Ua&&Et(r,"TYPE","init"),this.P?(Et(r,"$req",t),Et(r,"SID","null"),a.T=!0,Qe(a,r,null)):Qe(a,r,t),this.G=2}}else 3==this.G&&(e?dr(this,e):0==this.i.length||ct(this.h)||dr(this))},e.Fa=function(){if(this.u=null,vr(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Be(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Fe(10),lr(this),vr(this))},e.Za=function(){null!=this.C&&(this.C=null,lr(this),pr(this),Fe(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Nr.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Sr.prototype.g=function(e,t){return new _r(e,t)},E(_r,me),_r.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_r.prototype.close=function(){or(this.g)},_r.prototype.o=function(e){var t=this.g;if("string"===typeof e){var r={};r.__data__=e,e=r}else this.u&&((r={}).__data__=Te(e),e=r);t.i.push(new ot(t.Ya++,e)),3==t.G&&ur(t)},_r.prototype.N=function(){this.g.l=null,delete this.j,or(this.g),delete this.g,_r.aa.N.call(this)},E(Cr,Ie),E(Ar,Re),E(Ir,Nr),Ir.prototype.ua=function(){pe(this.g,"a")},Ir.prototype.ta=function(e){pe(this.g,new Cr(e))},Ir.prototype.sa=function(e){pe(this.g,new Ar)},Ir.prototype.ra=function(){pe(this.g,"b")},Sr.prototype.createWebChannel=Sr.prototype.g,_r.prototype.send=_r.prototype.o,_r.prototype.open=_r.prototype.m,_r.prototype.close=_r.prototype.close,y=w.createWebChannelTransport=function(){return new Sr},v=w.getStatEventTarget=function(){return je()},g=w.Event=Oe,p=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},We.NO_ERROR=0,We.TIMEOUT=8,We.HTTP_ERROR=6,m=w.ErrorCode=We,Ge.COMPLETE="complete",f=w.EventType=Ge,Ce.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",me.prototype.listen=me.prototype.K,h=w.WebChannel=Ce,w.FetchXmlHttpFactory=zt,$t.prototype.listenOnce=$t.prototype.L,$t.prototype.getLastError=$t.prototype.Ka,$t.prototype.getLastErrorCode=$t.prototype.Ba,$t.prototype.getStatus=$t.prototype.Z,$t.prototype.getResponseJson=$t.prototype.Oa,$t.prototype.getResponseText=$t.prototype.oa,$t.prototype.send=$t.prototype.ea,$t.prototype.setWithCredentials=$t.prototype.Ha,d=w.XhrIo=$t}).apply("undefined"!==typeof b?b:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const x="@firebase/firestore";class E{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}E.UNAUTHENTICATED=new E(null),E.GOOGLE_CREDENTIALS=new E("google-credentials-uid"),E.FIRST_PARTY=new E("first-party-uid"),E.MOCK_USER=new E("mock-user");let T="10.14.0";const k=new o.Vy("@firebase/firestore");function N(){return k.logLevel}function S(e){if(k.logLevel<=o.$b.DEBUG){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const a=r.map(A);k.debug("Firestore (".concat(T,"): ").concat(e),...a)}}function _(e){if(k.logLevel<=o.$b.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const a=r.map(A);k.error("Firestore (".concat(T,"): ").concat(e),...a)}}function C(e){if(k.logLevel<=o.$b.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const a=r.map(A);k.warn("Firestore (".concat(T,"): ").concat(e),...a)}}function A(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function I(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(T,") INTERNAL ASSERTION FAILED: ")+e;throw _(t),new Error(t)}function R(e,t){e||I()}function O(e,t){return e}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends l.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class P{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class M{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class L{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(E.UNAUTHENTICATED))}shutdown(){}}class F{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class U{constructor(e){this.t=e,this.currentUser=E.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){R(void 0===this.o);let r=this.i;const n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let a=new P;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new P,e.enqueueRetryable(()=>n(this.currentUser))};const s=()=>{const t=a;e.enqueueRetryable(async()=>{await t.promise,await n(this.currentUser)})},i=e=>{S("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>i(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(S("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new P)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(S("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(R("string"==typeof t.accessToken),new M(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return R(null===e||"string"==typeof e),new E(e)}}class B{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=E.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class V{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new B(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(E.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class z{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class H{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){R(void 0===this.o);const r=e=>{null!=e.error&&S("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const r=e.token!==this.R;return this.R=e.token,S("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};const n=e=>{S("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?n(e):S("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(R("string"==typeof e.token),this.R=e.token,new z(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function W(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}class G{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let r="";for(;r.length<20;){const n=W(40);for(let a=0;a<n.length;++a)r.length<20&&n[a]<t&&(r+=e.charAt(n[a]%62))}return r}}function K(e,t){return e<t?-1:e>t?1:0}function q(e,t,r){return e.length===t.length&&e.every((e,n)=>r(e,t[n]))}class X{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new j(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new j(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new j(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return X.fromMillis(Date.now())}static fromDate(e){return X.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new X(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ${constructor(e){this.timestamp=e}static fromTimestamp(e){return new $(e)}static min(){return new $(new X(0,0))}static max(){return new $(new X(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Y{constructor(e,t,r){void 0===t?t=0:t>e.length&&I(),void 0===r?r=e.length-t:r>e.length-t&&I(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Y.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Y?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const r=e.get(n),a=t.get(n);if(r<a)return-1;if(r>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Q extends Y{construct(e,t,r){return new Q(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const a of r){if(a.indexOf("//")>=0)throw new j(D.INVALID_ARGUMENT,"Invalid segment (".concat(a,"). Paths must not contain // in them."));e.push(...a.split("/").filter(e=>e.length>0))}return new Q(e)}static emptyPath(){return new Q([])}}const J=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Z extends Y{construct(e,t,r){return new Z(e,t,r)}static isValidIdentifier(e){return J.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Z.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Z(["__name__"])}static fromServerFormat(e){const t=[];let r="",n=0;const a=()=>{if(0===r.length)throw new j(D.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""};let s=!1;for(;n<e.length;){const t=e[n];if("\\"===t){if(n+1===e.length)throw new j(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new j(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?(s=!s,n++):"."!==t||s?(r+=t,n++):(a(),n++)}if(a(),s)throw new j(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Z(t)}static emptyPath(){return new Z([])}}class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Q.fromString(e))}static fromName(e){return new ee(Q.fromString(e).popFirst(5))}static empty(){return new ee(Q.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Q.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Q.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Q(e.slice()))}}class te{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}te.UNKNOWN_ID=-1;function re(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,a=$.fromTimestamp(1e9===n?new X(r+1,0):new X(r,n));return new ae(a,ee.empty(),t)}function ne(e){return new ae(e.readTime,e.key,-1)}class ae{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ae($.min(),ee.empty(),-1)}static max(){return new ae($.max(),ee.empty(),-1)}}function se(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r?r:(r=ee.comparator(e.documentKey,t.documentKey),0!==r?r:K(e.largestBatchId,t.largestBatchId))}const ie="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function le(e){if(e.code!==D.FAILED_PRECONDITION||e.message!==ie)throw e;S("LocalStore","Unexpectedly lost primary lease")}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&I(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(e){return ce.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,r)=>{t(e)})}static reject(e){return new ce((t,r)=>{r(e)})}static waitFor(e){return new ce((t,r)=>{let n=0,a=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++a,s&&a===n&&t()},e=>r(e))}),s=!0,a===n&&t()})}static or(e){let t=ce.resolve(!1);for(const r of e)t=t.next(e=>e?ce.resolve(e):r());return t}static forEach(e,t){const r=[];return e.forEach((e,n)=>{r.push(t.call(this,e,n))}),this.waitFor(r)}static mapArray(e,t){return new ce((r,n)=>{const a=e.length,s=new Array(a);let i=0;for(let o=0;o<a;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++i,i===a&&r(s)},e=>n(e))}})}static doWhile(e,t){return new ce((r,n)=>{const a=()=>{!0===e()?t().next(()=>{a()},n):r()};a()})}}function ue(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function de(e){return"IndexedDbTransactionError"===e.name}class he{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function fe(e){return null==e}function me(e){return 0===e&&1/e==-1/0}function pe(e){return"number"==typeof e&&Number.isInteger(e)&&!me(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}he.oe=-1;const ge=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ve=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ye=ve,be=[...ye,"indexConfiguration","indexState","indexEntries"];function we(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function xe(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function Ee(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Te{constructor(e,t){this.comparator=e,this.root=t||Ne.EMPTY}insert(e,t){return new Te(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ne.BLACK,null,null))}remove(e){return new Te(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ne.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push("".concat(t,":").concat(r)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ke(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ke(this.root,e,this.comparator,!1)}getReverseIterator(){return new ke(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ke(this.root,e,this.comparator,!0)}}class ke{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&n&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ne{constructor(e,t,r,n,a){this.key=e,this.value=t,this.color=null!=r?r:Ne.RED,this.left=null!=n?n:Ne.EMPTY,this.right=null!=a?a:Ne.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,a){return new Ne(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this;const a=r(e,n.key);return n=a<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===a?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r)),n.fixUp()}removeMin(){if(this.left.isEmpty())return Ne.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,n=this;if(t(e,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return Ne.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ne.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ne.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw I();if(this.right.isRed())throw I();const e=this.left.check();if(e!==this.right.check())throw I();return e+(this.isRed()?0:1)}}Ne.EMPTY=null,Ne.RED=!0,Ne.BLACK=!1,Ne.EMPTY=new class{constructor(){this.size=0}get key(){throw I()}get value(){throw I()}get color(){throw I()}get left(){throw I()}get right(){throw I()}copy(e,t,r,n,a){return this}insert(e,t,r){return new Ne(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Se{constructor(e){this.comparator=e,this.data=new Te(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _e(this.data.getIterator())}getIteratorFrom(e){return new _e(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Se))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Se(this.comparator);return t.data=e,t}}class _e{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ce{constructor(e){this.fields=e,e.sort(Z.comparator)}static empty(){return new Ce([])}unionWith(e){let t=new Se(Z.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ce(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return q(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Ae extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ie{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ae("Invalid base64 string: "+e):e}}(e);return new Ie(t)}static fromUint8Array(e){const t=function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e);return new Ie(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ie.EMPTY_BYTE_STRING=new Ie("");const Re=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oe(e){if(R(!!e),"string"==typeof e){let t=0;const r=Re.exec(e);if(R(!!r),r[1]){let e=r[1];e=(e+"000000000").substr(0,9),t=Number(e)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:De(e.seconds),nanos:De(e.nanos)}}function De(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function je(e){return"string"==typeof e?Ie.fromBase64String(e):Ie.fromUint8Array(e)}function Pe(e){var t,r;return"server_timestamp"===(null===(r=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===r?void 0:r.stringValue)}function Me(e){const t=e.mapValue.fields.__previous_value__;return Pe(t)?Me(t):t}function Le(e){const t=Oe(e.mapValue.fields.__local_write_time__.timestampValue);return new X(t.seconds,t.nanos)}class Fe{constructor(e,t,r,n,a,s,i,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=i,this.longPollingOptions=o,this.useFetchStreams=l}}class Ue{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ue("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ue&&e.projectId===this.projectId&&e.database===this.database}}const Be={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ve(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Pe(e)?4:nt(e)?9007199254740991:tt(e)?10:11:I()}function ze(e,t){if(e===t)return!0;const r=Ve(e);if(r!==Ve(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Le(e).isEqual(Le(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const r=Oe(e.timestampValue),n=Oe(t.timestampValue);return r.seconds===n.seconds&&r.nanos===n.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return je(e.bytesValue).isEqual(je(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return De(e.geoPointValue.latitude)===De(t.geoPointValue.latitude)&&De(e.geoPointValue.longitude)===De(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return De(e.integerValue)===De(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const r=De(e.doubleValue),n=De(t.doubleValue);return r===n?me(r)===me(n):isNaN(r)&&isNaN(n)}return!1}(e,t);case 9:return q(e.arrayValue.values||[],t.arrayValue.values||[],ze);case 10:case 11:return function(e,t){const r=e.mapValue.fields||{},n=t.mapValue.fields||{};if(we(r)!==we(n))return!1;for(const a in r)if(r.hasOwnProperty(a)&&(void 0===n[a]||!ze(r[a],n[a])))return!1;return!0}(e,t);default:return I()}}function He(e,t){return void 0!==(e.values||[]).find(e=>ze(e,t))}function We(e,t){if(e===t)return 0;const r=Ve(e),n=Ve(t);if(r!==n)return K(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return K(e.booleanValue,t.booleanValue);case 2:return function(e,t){const r=De(e.integerValue||e.doubleValue),n=De(t.integerValue||t.doubleValue);return r<n?-1:r>n?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1}(e,t);case 3:return Ge(e.timestampValue,t.timestampValue);case 4:return Ge(Le(e),Le(t));case 5:return K(e.stringValue,t.stringValue);case 6:return function(e,t){const r=je(e),n=je(t);return r.compareTo(n)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const r=e.split("/"),n=t.split("/");for(let a=0;a<r.length&&a<n.length;a++){const e=K(r[a],n[a]);if(0!==e)return e}return K(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const r=K(De(e.latitude),De(t.latitude));return 0!==r?r:K(De(e.longitude),De(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ke(e.arrayValue,t.arrayValue);case 10:return function(e,t){var r,n,a,s;const i=e.fields||{},o=t.fields||{},l=null===(r=i.value)||void 0===r?void 0:r.arrayValue,c=null===(n=o.value)||void 0===n?void 0:n.arrayValue,u=K((null===(a=null==l?void 0:l.values)||void 0===a?void 0:a.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Ke(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Be.mapValue&&t===Be.mapValue)return 0;if(e===Be.mapValue)return 1;if(t===Be.mapValue)return-1;const r=e.fields||{},n=Object.keys(r),a=t.fields||{},s=Object.keys(a);n.sort(),s.sort();for(let i=0;i<n.length&&i<s.length;++i){const e=K(n[i],s[i]);if(0!==e)return e;const t=We(r[n[i]],a[s[i]]);if(0!==t)return t}return K(n.length,s.length)}(e.mapValue,t.mapValue);default:throw I()}}function Ge(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return K(e,t);const r=Oe(e),n=Oe(t),a=K(r.seconds,n.seconds);return 0!==a?a:K(r.nanos,n.nanos)}function Ke(e,t){const r=e.values||[],n=t.values||[];for(let a=0;a<r.length&&a<n.length;++a){const e=We(r[a],n[a]);if(e)return e}return K(r.length,n.length)}function qe(e){return Xe(e)}function Xe(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Oe(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return je(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ee.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",r=!0;for(const n of e.values||[])r?r=!1:t+=",",t+=Xe(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let r="{",n=!0;for(const a of t)n?n=!1:r+=",",r+="".concat(a,":").concat(Xe(e.fields[a]));return r+"}"}(e.mapValue):I()}function $e(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Ye(e){return!!e&&"integerValue"in e}function Qe(e){return!!e&&"arrayValue"in e}function Je(e){return!!e&&"nullValue"in e}function Ze(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function et(e){return!!e&&"mapValue"in e}function tt(e){var t,r;return"__vector__"===(null===(r=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===r?void 0:r.stringValue)}function rt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return xe(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=rt(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=rt(e.arrayValue.values[r]);return t}return Object.assign({},e)}function nt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class at{constructor(e){this.value=e}static empty(){return new at({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!et(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rt(t)}setAll(e){let t=Z.emptyPath(),r={},n=[];e.forEach((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=a.popLast()}e?r[a.lastSegment()]=rt(e):n.push(a.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,n)}delete(e){const t=this.field(e.popLast());et(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ze(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];et(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){xe(t,(t,r)=>e[t]=r);for(const n of r)delete e[n]}clone(){return new at(rt(this.value))}}function st(e){const t=[];return xe(e.fields,(e,r)=>{const n=new Z([e]);if(et(r)){const e=st(r.mapValue).fields;if(0===e.length)t.push(n);else for(const r of e)t.push(n.child(r))}else t.push(n)}),new Ce(t)}class it{constructor(e,t,r,n,a,s,i){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=a,this.data=s,this.documentState=i}static newInvalidDocument(e){return new it(e,0,$.min(),$.min(),$.min(),at.empty(),0)}static newFoundDocument(e,t,r,n){return new it(e,1,t,$.min(),r,n,0)}static newNoDocument(e,t){return new it(e,2,t,$.min(),$.min(),at.empty(),0)}static newUnknownDocument(e,t){return new it(e,3,t,$.min(),$.min(),at.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=at.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=at.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof it&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new it(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ot{constructor(e,t){this.position=e,this.inclusive=t}}function lt(e,t,r){let n=0;for(let a=0;a<e.position.length;a++){const s=t[a],i=e.position[a];if(n=s.field.isKeyField()?ee.comparator(ee.fromName(i.referenceValue),r.key):We(i,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function ct(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!ze(e.position[r],t.position[r]))return!1;return!0}class ut{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function dt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ht{}class ft extends ht{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new xt(e,t,r):"array-contains"===t?new Nt(e,r):"in"===t?new St(e,r):"not-in"===t?new _t(e,r):"array-contains-any"===t?new Ct(e,r):new ft(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Et(e,r):new Tt(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(We(t,this.value)):null!==t&&Ve(this.value)===Ve(t)&&this.matchesComparison(We(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return I()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mt extends ht{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new mt(e,t)}matches(e){return pt(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function pt(e){return"and"===e.op}function gt(e){return vt(e)&&pt(e)}function vt(e){for(const t of e.filters)if(t instanceof mt)return!1;return!0}function yt(e){if(e instanceof ft)return e.field.canonicalString()+e.op.toString()+qe(e.value);if(gt(e))return e.filters.map(e=>yt(e)).join(",");{const t=e.filters.map(e=>yt(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function bt(e,t){return e instanceof ft?function(e,t){return t instanceof ft&&e.op===t.op&&e.field.isEqual(t.field)&&ze(e.value,t.value)}(e,t):e instanceof mt?function(e,t){return t instanceof mt&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,r,n)=>e&&bt(r,t.filters[n]),!0)}(e,t):void I()}function wt(e){return e instanceof ft?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(qe(e.value))}(e):e instanceof mt?function(e){return e.op.toString()+" {"+e.getFilters().map(wt).join(" ,")+"}"}(e):"Filter"}class xt extends ft{constructor(e,t,r){super(e,t,r),this.key=ee.fromName(r.referenceValue)}matches(e){const t=ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class Et extends ft{constructor(e,t){super(e,"in",t),this.keys=kt("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Tt extends ft{constructor(e,t){super(e,"not-in",t),this.keys=kt("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function kt(e,t){var r;return((null===(r=t.arrayValue)||void 0===r?void 0:r.values)||[]).map(e=>ee.fromName(e.referenceValue))}class Nt extends ft{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qe(t)&&He(t.arrayValue,this.value)}}class St extends ft{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&He(this.value.arrayValue,t)}}class _t extends ft{constructor(e,t){super(e,"not-in",t)}matches(e){if(He(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!He(this.value.arrayValue,t)}}class Ct extends ft{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qe(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>He(this.value.arrayValue,e))}}class At{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=a,this.startAt=s,this.endAt=i,this.ue=null}}function It(e){return new At(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Rt(e){const t=O(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>yt(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),fe(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>qe(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>qe(e)).join(",")),t.ue=e}return t.ue}function Ot(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!dt(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!bt(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ct(e.startAt,t.startAt)&&ct(e.endAt,t.endAt)}function Dt(e){return ee.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class jt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=a,this.limitType=s,this.startAt=i,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Pt(e,t,r,n,a,s,i,o){return new jt(e,t,r,n,a,s,i,o)}function Mt(e){return new jt(e)}function Lt(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ft(e){return null!==e.collectionGroup}function Ut(e){const t=O(e);if(null===t.ce){t.ce=[];const e=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),e.add(a.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",n=function(e){let t=new Se(Z.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);n.forEach(n=>{e.has(n.canonicalString())||n.isKeyField()||t.ce.push(new ut(n,r))}),e.has(Z.keyField().canonicalString())||t.ce.push(new ut(Z.keyField(),r))}return t.ce}function Bt(e){const t=O(e);return t.le||(t.le=Vt(t,Ut(e))),t.le}function Vt(e,t){if("F"===e.limitType)return It(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new ut(e.field,t)});const r=e.endAt?new ot(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new ot(e.startAt.position,e.startAt.inclusive):null;return It(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function zt(e,t){const r=e.filters.concat([t]);return new jt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function Ht(e,t,r){return new jt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Wt(e,t){return Ot(Bt(e),Bt(t))&&e.limitType===t.limitType}function Gt(e){return"".concat(Rt(Bt(e)),"|lt:").concat(e.limitType)}function Kt(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>wt(e)).join(", "),"]")),fe(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>qe(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>qe(e)).join(",")),"Target(".concat(t,")")}(Bt(e)),"; limitType=").concat(e.limitType,")")}function qt(e,t){return t.isFoundDocument()&&function(e,t){const r=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):ee.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}(e,t)&&function(e,t){for(const r of Ut(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(const r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,r){const n=lt(e,t,r);return e.inclusive?n<=0:n<0}(e.startAt,Ut(e),t))&&!(e.endAt&&!function(e,t,r){const n=lt(e,t,r);return e.inclusive?n>=0:n>0}(e.endAt,Ut(e),t))}(e,t)}function Xt(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function $t(e){return(t,r)=>{let n=!1;for(const a of Ut(e)){const e=Yt(a,t,r);if(0!==e)return e;n=n||a.field.isKeyField()}return 0}}function Yt(e,t,r){const n=e.field.isKeyField()?ee.comparator(t.key,r.key):function(e,t,r){const n=t.data.field(e),a=r.data.field(e);return null!==n&&null!==a?We(n,a):I()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return I()}}class Qt{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[n,a]of r)if(this.equalsFn(n,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return void(n[a]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){xe(this.inner,(t,r)=>{for(const[n,a]of r)e(n,a)})}isEmpty(){return Ee(this.inner)}size(){return this.innerSize}}const Jt=new Te(ee.comparator);function Zt(){return Jt}const er=new Te(ee.comparator);function tr(){let e=er;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const a of r)e=e.insert(a.key,a);return e}function rr(e){let t=er;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function nr(){return sr()}function ar(){return sr()}function sr(){return new Qt(e=>e.toString(),(e,t)=>e.isEqual(t))}const ir=new Te(ee.comparator),or=new Se(ee.comparator);function lr(){let e=or;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const a of r)e=e.add(a);return e}const cr=new Se(K);function ur(){return cr}function dr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:me(t)?"-0":t}}function hr(e){return{integerValue:""+e}}function fr(e,t){return pe(t)?hr(t):dr(e,t)}class mr{constructor(){this._=void 0}}function pr(e,t,r){return e instanceof yr?function(e,t){const r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Pe(t)&&(t=Me(t)),t&&(r.fields.__previous_value__=t),{mapValue:r}}(r,t):e instanceof br?wr(e,t):e instanceof xr?Er(e,t):function(e,t){const r=vr(e,t),n=kr(r)+kr(e.Pe);return Ye(r)&&Ye(e.Pe)?hr(n):dr(e.serializer,n)}(e,t)}function gr(e,t,r){return e instanceof br?wr(e,t):e instanceof xr?Er(e,t):r}function vr(e,t){return e instanceof Tr?function(e){return Ye(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class yr extends mr{}class br extends mr{constructor(e){super(),this.elements=e}}function wr(e,t){const r=Nr(t);for(const n of e.elements)r.some(e=>ze(e,n))||r.push(n);return{arrayValue:{values:r}}}class xr extends mr{constructor(e){super(),this.elements=e}}function Er(e,t){let r=Nr(t);for(const n of e.elements)r=r.filter(e=>!ze(e,n));return{arrayValue:{values:r}}}class Tr extends mr{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function kr(e){return De(e.integerValue||e.doubleValue)}function Nr(e){return Qe(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Sr{constructor(e,t){this.field=e,this.transform=t}}class _r{constructor(e,t){this.version=e,this.transformResults=t}}class Cr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cr}static exists(e){return new Cr(void 0,e)}static updateTime(e){return new Cr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ar(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ir{}function Rr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Vr(e.key,Cr.none()):new Mr(e.key,e.data,Cr.none());{const r=e.data,n=at.empty();let a=new Se(Z.comparator);for(let e of t.fields)if(!a.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),a=a.add(e)}return new Lr(e.key,n,new Ce(a.toArray()),Cr.none())}}function Or(e,t,r){e instanceof Mr?function(e,t,r){const n=e.value.clone(),a=Ur(e.fieldTransforms,t,r.transformResults);n.setAll(a),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}(e,t,r):e instanceof Lr?function(e,t,r){if(!Ar(e.precondition,t))return void t.convertToUnknownDocument(r.version);const n=Ur(e.fieldTransforms,t,r.transformResults),a=t.data;a.setAll(Fr(e)),a.setAll(n),t.convertToFoundDocument(r.version,a).setHasCommittedMutations()}(e,t,r):function(e,t,r){t.convertToNoDocument(r.version).setHasCommittedMutations()}(0,t,r)}function Dr(e,t,r,n){return e instanceof Mr?function(e,t,r,n){if(!Ar(e.precondition,t))return r;const a=e.value.clone(),s=Br(e.fieldTransforms,n,t);return a.setAll(s),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,r,n):e instanceof Lr?function(e,t,r,n){if(!Ar(e.precondition,t))return r;const a=Br(e.fieldTransforms,n,t),s=t.data;return s.setAll(Fr(e)),s.setAll(a),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,n):function(e,t,r){return Ar(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}(e,t,r)}function jr(e,t){let r=null;for(const n of e.fieldTransforms){const e=t.data.field(n.field),a=vr(n.transform,e||null);null!=a&&(null===r&&(r=at.empty()),r.set(n.field,a))}return r||null}function Pr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&q(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof br&&t instanceof br||e instanceof xr&&t instanceof xr?q(e.elements,t.elements,ze):e instanceof Tr&&t instanceof Tr?ze(e.Pe,t.Pe):e instanceof yr&&t instanceof yr}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Mr extends Ir{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class Lr extends Ir{constructor(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Fr(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function Ur(e,t,r){const n=new Map;R(e.length===r.length);for(let a=0;a<r.length;a++){const s=e[a],i=s.transform,o=t.data.field(s.field);n.set(s.field,gr(i,o,r[a]))}return n}function Br(e,t,r){const n=new Map;for(const a of e){const e=a.transform,s=r.data.field(a.field);n.set(a.field,pr(e,s,t))}return n}class Vr extends Ir{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zr extends Ir{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Hr{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let n=0;n<this.mutations.length;n++){const t=this.mutations[n];t.key.isEqual(e.key)&&Or(t,e,r[n])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Dr(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Dr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=ar();return this.mutations.forEach(n=>{const a=e.get(n.key),s=a.overlayedDocument;let i=this.applyToLocalView(s,a.mutatedFields);i=t.has(n.key)?null:i;const o=Rr(s,i);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument($.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),lr())}isEqual(e){return this.batchId===e.batchId&&q(this.mutations,e.mutations,(e,t)=>Pr(e,t))&&q(this.baseMutations,e.baseMutations,(e,t)=>Pr(e,t))}}class Wr{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){R(e.mutations.length===r.length);let n=ir;const a=e.mutations;for(let s=0;s<a.length;s++)n=n.insert(a[s].key,r[s].version);return new Wr(e,t,r,n)}}class Gr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Kr{constructor(e,t){this.count=e,this.unchangedNames=t}}var qr,Xr;function $r(e){switch(e){default:return I();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function Yr(e){if(void 0===e)return _("GRPC error has no .code"),D.UNKNOWN;switch(e){case qr.OK:return D.OK;case qr.CANCELLED:return D.CANCELLED;case qr.UNKNOWN:return D.UNKNOWN;case qr.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case qr.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case qr.INTERNAL:return D.INTERNAL;case qr.UNAVAILABLE:return D.UNAVAILABLE;case qr.UNAUTHENTICATED:return D.UNAUTHENTICATED;case qr.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case qr.NOT_FOUND:return D.NOT_FOUND;case qr.ALREADY_EXISTS:return D.ALREADY_EXISTS;case qr.PERMISSION_DENIED:return D.PERMISSION_DENIED;case qr.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case qr.ABORTED:return D.ABORTED;case qr.OUT_OF_RANGE:return D.OUT_OF_RANGE;case qr.UNIMPLEMENTED:return D.UNIMPLEMENTED;case qr.DATA_LOSS:return D.DATA_LOSS;default:return I()}}(Xr=qr||(qr={}))[Xr.OK=0]="OK",Xr[Xr.CANCELLED=1]="CANCELLED",Xr[Xr.UNKNOWN=2]="UNKNOWN",Xr[Xr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xr[Xr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xr[Xr.NOT_FOUND=5]="NOT_FOUND",Xr[Xr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xr[Xr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xr[Xr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xr[Xr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xr[Xr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xr[Xr.ABORTED=10]="ABORTED",Xr[Xr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xr[Xr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xr[Xr.INTERNAL=13]="INTERNAL",Xr[Xr.UNAVAILABLE=14]="UNAVAILABLE",Xr[Xr.DATA_LOSS=15]="DATA_LOSS";let Qr=null;function Jr(){return new TextEncoder}const Zr=new n([4294967295,4294967295],0);function en(e){const t=Jr().encode(e),r=new a;return r.update(t),new Uint8Array(r.digest())}function tn(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),a=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new n([r,a],0),new n([s,i],0)]}class rn{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new nn("Invalid padding: ".concat(t));if(r<0)throw new nn("Invalid hash count: ".concat(r));if(e.length>0&&0===this.hashCount)throw new nn("Invalid hash count: ".concat(r));if(0===e.length&&0!==t)throw new nn("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=n.fromNumber(this.Ie)}Ee(e,t,r){let a=e.add(t.multiply(n.fromNumber(r)));return 1===a.compare(Zr)&&(a=new n([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=en(e),[r,n]=tn(t);for(let a=0;a<this.hashCount;a++){const e=this.Ee(r,n,a);if(!this.de(e))return!1}return!0}static create(e,t,r){const n=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new rn(a,n,t);return r.forEach(e=>s.insert(e)),s}insert(e){if(0===this.Ie)return;const t=en(e),[r,n]=tn(t);for(let a=0;a<this.hashCount;a++){const e=this.Ee(r,n,a);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class nn extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class an{constructor(e,t,r,n,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const n=new Map;return n.set(e,sn.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new an($.min(),n,new Te(K),Zt(),lr())}}class sn{constructor(e,t,r,n,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new sn(r,t,lr(),lr(),lr())}}class on{constructor(e,t,r,n){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=n}}class ln{constructor(e,t){this.targetId=e,this.me=t}}class cn{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ie.EMPTY_BYTE_STRING,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class un{constructor(){this.fe=0,this.ge=fn(),this.pe=Ie.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=lr(),t=lr(),r=lr();return this.ge.forEach((n,a)=>{switch(a){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:I()}}),new sn(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=fn()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,R(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class dn{constructor(e){this.Le=e,this.Be=new Map,this.ke=Zt(),this.qe=hn(),this.Qe=new Te(K)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:I()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,r)=>{this.ze(r)&&t(r)})}He(e){const t=e.targetId,r=e.me.count,n=this.Je(t);if(n){const a=n.target;if(Dt(a))if(0===r){const e=new ee(a.path);this.Ue(t,e,it.newNoDocument(e,$.min()))}else R(1===r);else{const n=this.Ye(t);if(n!==r){const r=this.Ze(e),a=r?this.Xe(r,e,n):1;if(0!==a){this.je(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Qr||Qr.et(function(e,t,r,n,a){var s,i,o,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:r.database,projectId:r.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===a,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(o=null===(i=null==h?void 0:h.bits)||void 0===i?void 0:i.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==n?void 0:n.mightContain(e))&&void 0!==t&&t}}),d}(n,e.me,this.Le.tt(),r,a))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:n=0},hashCount:a=0}=t;let s,i;try{s=je(r).toUint8Array()}catch(e){if(e instanceof Ae)return C("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new rn(s,n,a)}catch(e){return C(e instanceof nn?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.Ie?null:i}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let n=0;return r.forEach(r=>{const a=this.Le.tt(),s="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(r.path.canonicalString());e.mightContain(s)||(this.Ue(t,r,null),n++)}),n}rt(e){const t=new Map;this.Be.forEach((r,n)=>{const a=this.Je(n);if(a){if(r.current&&Dt(a.target)){const t=new ee(a.target.path);null!==this.ke.get(t)||this.it(n,t)||this.Ue(n,t,it.newNoDocument(t,e))}r.be&&(t.set(n,r.ve()),r.Ce())}});let r=lr();this.qe.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)}),n&&(r=r.add(e))}),this.ke.forEach((t,r)=>r.setReadTime(e));const n=new an(e,t,this.Qe,this.ke,r);return this.ke=Zt(),this.qe=hn(),this.Qe=new Te(K),n}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const n=this.Ge(e);this.it(e,t)?n.Fe(t,1):n.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new un,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Se(K),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||S("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new un),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function hn(){return new Te(ee.comparator)}function fn(){return new Te(ee.comparator)}const mn={asc:"ASCENDING",desc:"DESCENDING"},pn={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gn={and:"AND",or:"OR"};class vn{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yn(e,t){return e.useProto3Json||fe(t)?t:{value:t}}function bn(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function wn(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function xn(e,t){return bn(e,t.toTimestamp())}function En(e){return R(!!e),$.fromTimestamp(function(e){const t=Oe(e);return new X(t.seconds,t.nanos)}(e))}function Tn(e,t){return kn(e,t).canonicalString()}function kn(e,t){const r=function(e){return new Q(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?r:r.child(t)}function Nn(e){const t=Q.fromString(e);return R(Gn(t)),t}function Sn(e,t){return Tn(e.databaseId,t.path)}function _n(e,t){const r=Nn(t);if(r.get(1)!==e.databaseId.projectId)throw new j(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new j(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new ee(Rn(r))}function Cn(e,t){return Tn(e.databaseId,t)}function An(e){const t=Nn(e);return 4===t.length?Q.emptyPath():Rn(t)}function In(e){return new Q(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Rn(e){return R(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function On(e,t,r){return{name:Sn(e,t),fields:r.value.mapValue.fields}}function Dn(e,t){let r;if(t instanceof Mr)r={update:On(e,t.key,t.value)};else if(t instanceof Vr)r={delete:Sn(e,t.key)};else if(t instanceof Lr)r={update:On(e,t.key,t.data),updateMask:Wn(t.fieldMask)};else{if(!(t instanceof zr))return I();r={verify:Sn(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const r=t.transform;if(r instanceof yr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof br)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof xr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof Tr)return{fieldPath:t.field.canonicalString(),increment:r.Pe};throw I()}(0,e))),t.precondition.isNone||(r.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:xn(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:I()}(e,t.precondition)),r}function jn(e,t){return{documents:[Cn(e,t.path)]}}function Pn(e,t){const r={structuredQuery:{}},n=t.path;let a;null!==t.collectionGroup?(a=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Cn(e,a);const s=function(e){if(0!==e.length)return Hn(mt.create(e,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const i=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Vn(e.field),direction:Fn(e.dir)}}(e))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=yn(e,t.limit);return null!==o&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:r,parent:a}}function Mn(e){let t=An(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){R(1===n);const e=r.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let s=[];r.where&&(s=function(e){const t=Ln(e);return t instanceof mt&&gt(t)?t.getFilters():[t]}(r.where));let i=[];r.orderBy&&(i=function(e){return e.map(e=>function(e){return new ut(zn(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(r.orderBy));let o=null;r.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,fe(t)?null:t}(r.limit));let l=null;r.startAt&&(l=function(e){const t=!!e.before,r=e.values||[];return new ot(r,t)}(r.startAt));let c=null;return r.endAt&&(c=function(e){const t=!e.before,r=e.values||[];return new ot(r,t)}(r.endAt)),Pt(t,a,i,s,o,"F",l,c)}function Ln(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=zn(e.unaryFilter.field);return ft.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=zn(e.unaryFilter.field);return ft.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const n=zn(e.unaryFilter.field);return ft.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=zn(e.unaryFilter.field);return ft.create(a,"!=",{nullValue:"NULL_VALUE"});default:return I()}}(e):void 0!==e.fieldFilter?function(e){return ft.create(zn(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return I()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return mt.create(e.compositeFilter.filters.map(e=>Ln(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return I()}}(e.compositeFilter.op))}(e):I()}function Fn(e){return mn[e]}function Un(e){return pn[e]}function Bn(e){return gn[e]}function Vn(e){return{fieldPath:e.canonicalString()}}function zn(e){return Z.fromServerFormat(e.fieldPath)}function Hn(e){return e instanceof ft?function(e){if("=="===e.op){if(Ze(e.value))return{unaryFilter:{field:Vn(e.field),op:"IS_NAN"}};if(Je(e.value))return{unaryFilter:{field:Vn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ze(e.value))return{unaryFilter:{field:Vn(e.field),op:"IS_NOT_NAN"}};if(Je(e.value))return{unaryFilter:{field:Vn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vn(e.field),op:Un(e.op),value:e.value}}}(e):e instanceof mt?function(e){const t=e.getFilters().map(e=>Hn(e));return 1===t.length?t[0]:{compositeFilter:{op:Bn(e.op),filters:t}}}(e):I()}function Wn(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Gn(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Kn{constructor(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:$.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:$.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ie.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=i,this.expectedCount=o}withSequenceNumber(e){return new Kn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Kn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class qn{constructor(e){this.ct=e}}function Xn(e){const t=Mn({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ht(t,t.limit,"L"):t}class $n{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(De(e.integerValue));else if("doubleValue"in e){const r=De(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),me(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),"string"==typeof r&&(r=Oe(r)),t.Rt("".concat(r.seconds||"")),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(je(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?nt(e)?this.dt(t,Number.MAX_SAFE_INTEGER):tt(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):I()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const n of Object.keys(r))this.Vt(n,t),this.Tt(r[n],t)}wt(e,t){var r,n;const a=e.fields||{};this.dt(t,53);const s="value",i=(null===(n=null===(r=a[s].arrayValue)||void 0===r?void 0:r.values)||void 0===n?void 0:n.length)||0;this.dt(t,15),t.At(De(i)),this.Vt(s,t),this.Tt(a[s],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const n of r)this.Tt(n,t)}yt(e,t){this.dt(t,37),ee.fromName(e).path.forEach(e=>{this.dt(t,60),this.Dt(e,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}$n.vt=new $n;class Yn{constructor(){this.un=new Qn}addToCollectionParentIndex(e,t){return this.un.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(ae.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(ae.min())}updateCollectionGroup(e,t,r){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class Qn{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new Se(Q.comparator),a=!n.has(r);return this.index[t]=n.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new Se(Q.comparator)).toArray()}}new Uint8Array(0);class Jn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(41943040,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class Zn{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Zn(0)}static kn(){return new Zn(-1)}}class ea{constructor(){this.changes=new Qt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,it.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?ce.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ta{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ra{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(r=n,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&Dr(r.mutation,e,Ce.empty(),X.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,lr()).next(()=>t))}getLocalViewOfDocuments(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lr();const n=nr();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let t=tr();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const r=nr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,lr()))}populateOverlays(e,t,r){const n=[];return r.forEach(e=>{t.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,n){let a=Zt();const s=sr(),i=sr();return t.forEach((e,t)=>{const i=r.get(t.key);n.has(t.key)&&(void 0===i||i.mutation instanceof Lr)?a=a.insert(t.key,t):void 0!==i?(s.set(t.key,i.mutation.getFieldMask()),Dr(i.mutation,t,i.mutation.getFieldMask(),X.now())):s.set(t.key,Ce.empty())}),this.recalculateAndSaveOverlays(e,a).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var r;return i.set(e,new ta(t,null!==(r=s.get(e))&&void 0!==r?r:null))}),i))}recalculateAndSaveOverlays(e,t){const r=sr();let n=new Te((e,t)=>e-t),a=lr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const a of e)a.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let i=r.get(e)||Ce.empty();i=a.applyToLocalView(s,i),r.set(e,i);const o=(n.get(a.batchId)||lr()).add(e);n=n.insert(a.batchId,o)})}).next(()=>{const s=[],i=n.getReverseIterator();for(;i.hasNext();){const n=i.getNext(),o=n.key,l=n.value,c=ar();l.forEach(e=>{if(!a.has(e)){const n=Rr(t.get(e),r.get(e));null!==n&&c.set(e,n),a=a.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return ce.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,n){return function(e){return ee.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ft(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next(a=>{const s=n-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-a.size):ce.resolve(nr());let i=-1,o=a;return s.next(t=>ce.forEach(t,(t,r)=>(i<r.largestBatchId&&(i=r.largestBatchId),a.get(t)?ce.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,a)).next(()=>this.computeViews(e,o,t,lr())).next(e=>({batchId:i,changes:rr(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ee(t)).next(e=>{let t=tr();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){const a=t.collectionGroup;let s=tr();return this.indexManager.getCollectionParents(e,a).next(i=>ce.forEach(i,i=>{const o=function(e,t){return new jt(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,i.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,n){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,n))).next(e=>{a.forEach((t,r)=>{const n=r.getKey();null===e.get(n)&&(e=e.insert(n,it.newInvalidDocument(n)))});let r=tr();return e.forEach((e,n)=>{const s=a.get(e);void 0!==s&&Dr(s.mutation,n,Ce.empty(),X.now()),qt(t,n)&&(r=r.insert(e,n))}),r})}}class na{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ce.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:En(e.createTime)}}(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Xn(e.bundledQuery),readTime:En(e.readTime)}}(t)),ce.resolve()}}class aa{constructor(){this.overlays=new Te(ee.comparator),this.Ir=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const r=nr();return ce.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,n)=>{this.ht(e,t,n)}),ce.resolve()}removeOverlaysForBatchId(e,t,r){const n=this.Ir.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(r)),ce.resolve()}getOverlaysForCollection(e,t,r){const n=nr(),a=t.length+1,s=new ee(t.child("")),i=this.overlays.getIteratorFrom(s);for(;i.hasNext();){const e=i.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===a&&e.largestBatchId>r&&n.set(e.getKey(),e)}return ce.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let a=new Te((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=a.get(e.largestBatchId);null===t&&(t=nr(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=nr(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>i.set(e,t)),!(i.size()>=n)););return ce.resolve(i)}ht(e,t,r){const n=this.overlays.get(r.key);if(null!==n){const e=this.Ir.get(n.largestBatchId).delete(r.key);this.Ir.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new Gr(t,r));let a=this.Ir.get(t);void 0===a&&(a=lr(),this.Ir.set(t,a)),this.Ir.set(t,a.add(r.key))}}class sa{constructor(){this.sessionToken=Ie.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}class ia{constructor(){this.Tr=new Se(oa.Er),this.dr=new Se(oa.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new oa(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new oa(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new ee(new Q([])),r=new oa(t,e),n=new oa(t,e+1),a=[];return this.dr.forEachInRange([r,n],e=>{this.Vr(e),a.push(e.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ee(new Q([])),r=new oa(t,e),n=new oa(t,e+1);let a=lr();return this.dr.forEachInRange([r,n],e=>{a=a.add(e.key)}),a}containsKey(e){const t=new oa(e,0),r=this.Tr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class oa{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ee.comparator(e.key,t.key)||K(e.wr,t.wr)}static Ar(e,t){return K(e.wr,t.wr)||ee.comparator(e.key,t.key)}}class la{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Se(oa.Er)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Hr(a,t,r,n);this.mutationQueue.push(s);for(const i of n)this.br=this.br.add(new oa(i.key,a)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return ce.resolve(s)}lookupMutationBatch(e,t){return ce.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,n=this.vr(r),a=n<0?0:n;return ce.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new oa(t,0),n=new oa(t,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([r,n],e=>{const t=this.Dr(e.wr);a.push(t)}),ce.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Se(K);return t.forEach(e=>{const t=new oa(e,0),n=new oa(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,n],e=>{r=r.add(e.wr)})}),ce.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,n=r.length+1;let a=r;ee.isDocumentKey(a)||(a=a.child(""));const s=new oa(new ee(a),0);let i=new Se(K);return this.br.forEachWhile(e=>{const t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(i=i.add(e.wr)),!0)},s),ce.resolve(this.Cr(i))}Cr(e){const t=[];return e.forEach(e=>{const r=this.Dr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){R(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.br;return ce.forEach(t.mutations,n=>{const a=new oa(n.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new oa(t,0),n=this.br.firstAfterOrEqual(r);return ce.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ca{constructor(e){this.Mr=e,this.docs=new Te(ee.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,n=this.docs.get(r),a=n?n.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ce.resolve(r?r.document.mutableCopy():it.newInvalidDocument(t))}getEntries(e,t){let r=Zt();return t.forEach(e=>{const t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():it.newInvalidDocument(e))}),ce.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let a=Zt();const s=t.path,i=new ee(s.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:e,value:{document:i}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||se(ne(i),r)<=0||(n.has(i.key)||qt(t,i))&&(a=a.insert(i.key,i.mutableCopy()))}return ce.resolve(a)}getAllFromCollectionGroup(e,t,r,n){I()}Or(e,t){return ce.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new ua(this)}getSize(e){return ce.resolve(this.size)}}class ua extends ea{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,n)=>{n.isValidDocument()?t.push(this.cr.addEntry(e,n)):this.cr.removeEntry(r)}),ce.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class da{constructor(e){this.persistence=e,this.Nr=new Qt(e=>Rt(e),Ot),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ia,this.targetCount=0,this.kr=Zn.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,r)=>t(r)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),ce.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Zn(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Kn(t),ce.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,r){let n=0;const a=[];return this.Nr.forEach((s,i)=>{i.sequenceNumber<=t&&null===r.get(i.targetId)&&(this.Nr.delete(s),a.push(this.removeMatchingKeysForTargetId(e,i.targetId)),n++)}),ce.waitFor(a).next(()=>n)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return ce.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),ce.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const n=this.persistence.referenceDelegate,a=[];return n&&t.forEach(t=>{a.push(n.markPotentiallyOrphaned(e,t))}),ce.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return ce.resolve(r)}containsKey(e,t){return ce.resolve(this.Br.containsKey(t))}}class ha{constructor(e,t){this.qr={},this.overlays={},this.Qr=new he(0),this.Kr=!1,this.Kr=!0,this.$r=new sa,this.referenceDelegate=e(this),this.Ur=new da(this),this.indexManager=new Yn,this.remoteDocumentCache=function(e){return new ca(e)}(e=>this.referenceDelegate.Wr(e)),this.serializer=new qn(t),this.Gr=new na(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new la(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){S("MemoryPersistence","Starting transaction:",e);const n=new fa(this.Qr.next());return this.referenceDelegate.zr(),r(n).next(e=>this.referenceDelegate.jr(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}Hr(e,t){return ce.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class fa extends oe{constructor(e){super(),this.currentSequenceNumber=e}}class ma{constructor(e){this.persistence=e,this.Jr=new ia,this.Yr=null}static Zr(e){return new ma(e)}get Xr(){if(this.Yr)return this.Yr;throw I()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),ce.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Xr,r=>{const n=ee.fromPath(r);return this.ei(e,n).next(e=>{e||t.removeEntry(n,$.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return ce.or([()=>ce.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class pa{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=n}static Wi(e,t){let r=lr(),n=lr();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:n=n.add(a.doc.key)}return new pa(e,t.fromCache,r,n)}}class ga{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class va{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(0,l.nr)()?8:ue((0,l.ZQ)())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,n){const a={result:null};return this.Yi(e,t).next(e=>{a.result=e}).next(()=>{if(!a.result)return this.Zi(e,t,n,r).next(e=>{a.result=e})}).next(()=>{if(a.result)return;const r=new ga;return this.Xi(e,t,r).next(n=>{if(a.result=n,this.zi)return this.es(e,t,r,n.size)})}).next(()=>a.result)}es(e,t,r,n){return r.documentReadCount<this.ji?(N()<=o.$b.DEBUG&&S("QueryEngine","SDK will not create cache indexes for query:",Kt(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ce.resolve()):(N()<=o.$b.DEBUG&&S("QueryEngine","Query:",Kt(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.Hi*n?(N()<=o.$b.DEBUG&&S("QueryEngine","The SDK decides to create cache indexes for query:",Kt(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bt(t))):ce.resolve())}Yi(e,t){if(Lt(t))return ce.resolve(null);let r=Bt(t);return this.indexManager.getIndexType(e,r).next(n=>0===n?null:(null!==t.limit&&1===n&&(t=Ht(t,null,"F"),r=Bt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(n=>{const a=lr(...n);return this.Ji.getDocuments(e,a).next(n=>this.indexManager.getMinOffset(e,r).next(r=>{const s=this.ts(t,n);return this.ns(t,s,a,r.readTime)?this.Yi(e,Ht(t,null,"F")):this.rs(e,s,t,r)}))})))}Zi(e,t,r,n){return Lt(t)||n.isEqual($.min())?ce.resolve(null):this.Ji.getDocuments(e,r).next(a=>{const s=this.ts(t,a);return this.ns(t,s,r,n)?ce.resolve(null):(N()<=o.$b.DEBUG&&S("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Kt(t)),this.rs(e,s,t,re(n,-1)).next(e=>e))})}ts(e,t){let r=new Se($t(e));return t.forEach((t,n)=>{qt(e,n)&&(r=r.add(n))}),r}ns(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(n)>0)}Xi(e,t,r){return N()<=o.$b.DEBUG&&S("QueryEngine","Using full collection scan to execute query:",Kt(t)),this.Ji.getDocumentsMatchingQuery(e,t,ae.min(),r)}rs(e,t,r,n){return this.Ji.getDocumentsMatchingQuery(e,r,n).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class ya{constructor(e,t,r,n){this.persistence=e,this.ss=t,this.serializer=n,this.os=new Te(K),this._s=new Qt(e=>Rt(e),Ot),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ra(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function ba(e,t,r,n){return new ya(e,t,r,n)}async function wa(e,t){const r=O(e);return await r.persistence.runTransaction("Handle user change","readonly",e=>{let n;return r.mutationQueue.getAllMutationBatches(e).next(a=>(n=a,r.ls(t),r.mutationQueue.getAllMutationBatches(e))).next(t=>{const a=[],s=[];let i=lr();for(const e of n){a.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return r.localDocuments.getDocuments(e,i).next(e=>({hs:e,removedBatchIds:a,addedBatchIds:s}))})})}function xa(e){const t=O(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function Ea(e,t,r){let n=lr(),a=lr();return r.forEach(e=>n=n.add(e)),t.getEntries(e,n).next(e=>{let n=Zt();return r.forEach((r,s)=>{const i=e.get(r);s.isFoundDocument()!==i.isFoundDocument()&&(a=a.add(r)),s.isNoDocument()&&s.version.isEqual($.min())?(t.removeEntry(r,s.readTime),n=n.insert(r,s)):!i.isValidDocument()||s.version.compareTo(i.version)>0||0===s.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(s),n=n.insert(r,s)):S("LocalStore","Ignoring outdated watch update for ",r,". Current version:",i.version," Watch version:",s.version)}),{Ps:n,Is:a}})}function Ta(e,t){const r=O(e);return r.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function ka(e,t){const r=O(e);return r.persistence.runTransaction("Allocate target","readwrite",e=>{let n;return r.Ur.getTargetData(e,t).next(a=>a?(n=a,ce.resolve(n)):r.Ur.allocateTargetId(e).next(a=>(n=new Kn(t,a,"TargetPurposeListen",e.currentSequenceNumber),r.Ur.addTargetData(e,n).next(()=>n))))}).then(e=>{const n=r.os.get(e.targetId);return(null===n||e.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.os=r.os.insert(e.targetId,e),r._s.set(t,e.targetId)),e})}async function Na(e,t,r){const n=O(e),a=n.os.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,e=>n.persistence.referenceDelegate.removeTarget(e,a))}catch(e){if(!de(e))throw e;S("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}n.os=n.os.remove(t),n._s.delete(a.target)}function Sa(e,t,r){const n=O(e);let a=$.min(),s=lr();return n.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,r){const n=O(e),a=n._s.get(r);return void 0!==a?ce.resolve(n.os.get(a)):n.Ur.getTargetData(t,r)}(n,e,Bt(t)).next(t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>n.ss.getDocumentsMatchingQuery(e,t,r?a:$.min(),r?s:lr())).next(e=>(_a(n,Xt(t),e),{documents:e,Ts:s})))}function _a(e,t,r){let n=e.us.get(t)||$.min();r.forEach((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)}),e.us.set(t,n)}class Ca{constructor(){this.activeTargetIds=ur()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Aa{constructor(){this.so=new Ca,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ca,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ia{_o(e){}shutdown(){}}class Ra{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){S("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){S("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Oa=null;function Da(){return null===Oa?Oa=268435456+Math.round(2147483648*Math.random()):Oa++,"0x"+Oa.toString(16)}const ja={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Pa{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Ma="WebChannelConnection";class La extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(r,"/databases/").concat(n),this.Co="(default)"===this.databaseId.database?"project_id=".concat(r):"project_id=".concat(r,"&database_id=").concat(n)}get Fo(){return!1}Mo(e,t,r,n,a){const s=Da(),i=this.xo(e,t.toUriEncodedString());S("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),i,r);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,n,a),this.No(e,i,o,r).then(t=>(S("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw C("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",i,"request:",r),t})}Lo(e,t,r,n,a,s){return this.Mo(e,t,r,n,a)}Oo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+T,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}xo(e,t){const r=ja[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(r)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,n){const a=Da();return new Promise((s,i)=>{const o=new d;o.setWithCredentials(!0),o.listenOnce(f.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case m.NO_ERROR:const t=o.getResponseJson();S(Ma,"XHR for RPC '".concat(e,"' ").concat(a," received:"),JSON.stringify(t)),s(t);break;case m.TIMEOUT:S(Ma,"RPC '".concat(e,"' ").concat(a," timed out")),i(new j(D.DEADLINE_EXCEEDED,"Request time out"));break;case m.HTTP_ERROR:const r=o.getStatus();if(S(Ma,"RPC '".concat(e,"' ").concat(a," failed with status:"),r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(t)>=0?t:D.UNKNOWN}(t.status);i(new j(e,t.message))}else i(new j(D.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new j(D.UNAVAILABLE,"Connection failed."));break;default:I()}}finally{S(Ma,"RPC '".concat(e,"' ").concat(a," completed."))}});const l=JSON.stringify(n);S(Ma,"RPC '".concat(e,"' ").concat(a," sending request:"),n),o.send(t,"POST",l,r,15)})}Bo(e,t,r){const n=Da(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=y(),i=v(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,r),o.encodeInitMessageHeaders=!0;const c=a.join("");S(Ma,"Creating RPC '".concat(e,"' stream ").concat(n,": ").concat(c),o);const u=s.createWebChannel(c,o);let d=!1,f=!1;const m=new Pa({Io:t=>{f?S(Ma,"Not sending because RPC '".concat(e,"' stream ").concat(n," is closed:"),t):(d||(S(Ma,"Opening RPC '".concat(e,"' stream ").concat(n," transport.")),u.open(),d=!0),S(Ma,"RPC '".concat(e,"' stream ").concat(n," sending:"),t),u.send(t))},To:()=>u.close()}),b=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};return b(u,h.EventType.OPEN,()=>{f||(S(Ma,"RPC '".concat(e,"' stream ").concat(n," transport opened.")),m.yo())}),b(u,h.EventType.CLOSE,()=>{f||(f=!0,S(Ma,"RPC '".concat(e,"' stream ").concat(n," transport closed")),m.So())}),b(u,h.EventType.ERROR,t=>{f||(f=!0,C(Ma,"RPC '".concat(e,"' stream ").concat(n," transport errored:"),t),m.So(new j(D.UNAVAILABLE,"The operation could not be completed")))}),b(u,h.EventType.MESSAGE,t=>{var r;if(!f){const a=t.data[0];R(!!a);const s=a,i=s.error||(null===(r=s[0])||void 0===r?void 0:r.error);if(i){S(Ma,"RPC '".concat(e,"' stream ").concat(n," received error:"),i);const t=i.status;let r=function(e){const t=qr[e];if(void 0!==t)return Yr(t)}(t),a=i.message;void 0===r&&(r=D.INTERNAL,a="Unknown error status: "+t+" with message "+i.message),f=!0,m.So(new j(r,a)),u.close()}else S(Ma,"RPC '".concat(e,"' stream ").concat(n," received:"),a),m.bo(a)}}),b(i,g.STAT_EVENT,t=>{t.stat===p.PROXY?S(Ma,"RPC '".concat(e,"' stream ").concat(n," detected buffering proxy")):t.stat===p.NOPROXY&&S(Ma,"RPC '".concat(e,"' stream ").concat(n," detected no buffering proxy"))}),setTimeout(()=>{m.wo()},0),m}}function Fa(){return"undefined"!=typeof document?document:null}function Ua(e){return new vn(e,!0)}class Ba{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=r,this.qo=n,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),n=Math.max(0,t-r);n>0&&S("ExponentialBackoff","Backing off for ".concat(n," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(r," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,n,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Va{constructor(e,t,r,n,a,s,i,o){this.ui=e,this.Ho=r,this.Jo=n,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=i,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ba(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(_(t.toString()),_("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===D.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[r,n]=e;this.Yo===t&&this.P_(r,n)},t=>{e(()=>{const e=new j(D.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{r(()=>this.I_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return S("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(S("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class za extends Va{constructor(e,t,r,n,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=a}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:I()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(R(void 0===t||"string"==typeof t),Ie.fromBase64String(t||"")):(R(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Ie.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(e){const t=void 0===e.code?D.UNKNOWN:Yr(e.code);return new j(t,e.message||"")}(i);r=new cn(n,a,s,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const a=_n(e,n.document.name),s=En(n.document.updateTime),i=n.document.createTime?En(n.document.createTime):$.min(),o=new at({mapValue:{fields:n.document.fields}}),l=it.newFoundDocument(a,s,i,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new on(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const a=_n(e,n.document),s=n.readTime?En(n.readTime):$.min(),i=it.newNoDocument(a,s),o=n.removedTargetIds||[];r=new on([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const a=_n(e,n.document),s=n.removedTargetIds||[];r=new on([],s,a,null)}else{if(!("filter"in t))return I();{t.filter;const e=t.filter;e.targetId;const{count:n=0,unchangedNames:a}=e,s=new Kr(n,a),i=e.targetId;r=new ln(i,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return $.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?$.min():t.readTime?En(t.readTime):$.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=In(this.serializer),t.addTarget=function(e,t){let r;const n=t.target;if(r=Dt(n)?{documents:jn(e,n)}:{query:Pn(e,n)._t},r.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=wn(e,t.resumeToken);const n=yn(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo($.min())>0){r.readTime=bn(e,t.snapshotVersion.toTimestamp());const n=yn(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e);const r=function(e,t){const r=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return I()}}(t.purpose);return null==r?null:{"goog-listen-tags":r}}(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=In(this.serializer),t.removeTarget=e,this.a_(t)}}class Ha extends Va{constructor(e,t,r,n,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return R(!!e.streamToken),this.lastStreamToken=e.streamToken,R(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){R(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(R(void 0!==t),e.map(e=>function(e,t){let r=e.updateTime?En(e.updateTime):En(t);return r.isEqual($.min())&&(r=En(t)),new _r(r,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),r=En(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=In(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Dn(this.serializer,e))};this.a_(t)}}class Wa extends class{}{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.y_=!1}w_(){if(this.y_)throw new j(D.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,n){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[s,i]=a;return this.connection.Mo(e,kn(t,r),n,s,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new j(D.UNKNOWN,e.toString())})}Lo(e,t,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[i,o]=s;return this.connection.Lo(e,kn(t,r),n,i,o,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new j(D.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Ga{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(_(t),this.D_=!1):S("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class Ka{constructor(e,t,r,n,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(e=>{r.enqueueAndForget(async()=>{ts(this)&&(S("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=O(e);t.L_.add(4),await Xa(t),t.q_.set("Unknown"),t.L_.delete(4),await qa(t)}(this))})}),this.q_=new Ga(r,n)}}async function qa(e){if(ts(e))for(const t of e.B_)await t(!0)}async function Xa(e){for(const t of e.B_)await t(!1)}function $a(e,t){const r=O(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),es(r)?Za(r):ws(r).r_()&&Qa(r,t))}function Ya(e,t){const r=O(e),n=ws(r);r.N_.delete(t),n.r_()&&Ja(r,t),0===r.N_.size&&(n.r_()?n.o_():ts(r)&&r.q_.set("Unknown"))}function Qa(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo($.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}ws(e).A_(t)}function Ja(e,t){e.Q_.xe(t),ws(e).R_(t)}function Za(e){e.Q_=new dn({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),ws(e).start(),e.q_.v_()}function es(e){return ts(e)&&!ws(e).n_()&&e.N_.size>0}function ts(e){return 0===O(e).L_.size}function rs(e){e.Q_=void 0}async function ns(e){e.q_.set("Online")}async function as(e){e.N_.forEach((t,r)=>{Qa(e,t)})}async function ss(e,t){rs(e),es(e)?(e.q_.M_(t),Za(e)):e.q_.set("Unknown")}async function is(e,t,r){if(e.q_.set("Online"),t instanceof cn&&2===t.state&&t.cause)try{await async function(e,t){const r=t.cause;for(const n of t.targetIds)e.N_.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.N_.delete(n),e.Q_.removeTarget(n))}(e,t)}catch(r){S("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await os(e,r)}else if(t instanceof on?e.Q_.Ke(t):t instanceof ln?e.Q_.He(t):e.Q_.We(t),!r.isEqual($.min()))try{const t=await xa(e.localStore);r.compareTo(t)>=0&&await function(e,t){const r=e.Q_.rt(t);return r.targetChanges.forEach((r,n)=>{if(r.resumeToken.approximateByteSize()>0){const a=e.N_.get(n);a&&e.N_.set(n,a.withResumeToken(r.resumeToken,t))}}),r.targetMismatches.forEach((t,r)=>{const n=e.N_.get(t);if(!n)return;e.N_.set(t,n.withResumeToken(Ie.EMPTY_BYTE_STRING,n.snapshotVersion)),Ja(e,t);const a=new Kn(n.target,t,r,n.sequenceNumber);Qa(e,a)}),e.remoteSyncer.applyRemoteEvent(r)}(e,r)}catch(t){S("RemoteStore","Failed to raise snapshot:",t),await os(e,t)}}async function os(e,t,r){if(!de(t))throw t;e.L_.add(1),await Xa(e),e.q_.set("Offline"),r||(r=()=>xa(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{S("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await qa(e)})}function ls(e,t){return t().catch(r=>os(e,r,t))}async function cs(e){const t=O(e),r=xs(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;us(t);)try{const e=await Ta(t.localStore,n);if(null===e){0===t.O_.length&&r.o_();break}n=e.batchId,ds(t,e)}catch(e){await os(t,e)}hs(t)&&fs(t)}function us(e){return ts(e)&&e.O_.length<10}function ds(e,t){e.O_.push(t);const r=xs(e);r.r_()&&r.V_&&r.m_(t.mutations)}function hs(e){return ts(e)&&!xs(e).n_()&&e.O_.length>0}function fs(e){xs(e).start()}async function ms(e){xs(e).p_()}async function ps(e){const t=xs(e);for(const r of e.O_)t.m_(r.mutations)}async function gs(e,t,r){const n=e.O_.shift(),a=Wr.from(n,t,r);await ls(e,()=>e.remoteSyncer.applySuccessfulWrite(a)),await cs(e)}async function vs(e,t){t&&xs(e).V_&&await async function(e,t){if(function(e){return $r(e)&&e!==D.ABORTED}(t.code)){const r=e.O_.shift();xs(e).s_(),await ls(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await cs(e)}}(e,t),hs(e)&&fs(e)}async function ys(e,t){const r=O(e);r.asyncQueue.verifyOperationInProgress(),S("RemoteStore","RemoteStore received new credentials");const n=ts(r);r.L_.add(3),await Xa(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await qa(r)}async function bs(e,t){const r=O(e);t?(r.L_.delete(2),await qa(r)):t||(r.L_.add(2),await Xa(r),r.q_.set("Unknown"))}function ws(e){return e.K_||(e.K_=function(e,t,r){const n=O(e);return n.w_(),new za(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(e.datastore,e.asyncQueue,{Eo:ns.bind(null,e),Ro:as.bind(null,e),mo:ss.bind(null,e),d_:is.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),es(e)?Za(e):e.q_.set("Unknown")):(await e.K_.stop(),rs(e))})),e.K_}function xs(e){return e.U_||(e.U_=function(e,t,r){const n=O(e);return n.w_(),new Ha(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:ms.bind(null,e),mo:vs.bind(null,e),f_:ps.bind(null,e),g_:gs.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await cs(e)):(await e.U_.stop(),e.O_.length>0&&(S("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))})),e.U_}class Es{constructor(e,t,r,n,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=a,this.deferred=new P,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,a){const s=Date.now()+r,i=new Es(e,t,s,n,a);return i.start(r),i}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new j(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ts(e,t){if(_("AsyncQueue","".concat(t,": ").concat(e)),de(e))return new j(D.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class ks{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ee.comparator(t.key,r.key):(e,t)=>ee.comparator(e.key,t.key),this.keyedMap=tr(),this.sortedSet=new Te(this.comparator)}static emptySet(e){return new ks(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ks))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new ks;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Ns{constructor(){this.W_=new Te(ee.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?0!==e.type&&3===r.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==r.type?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.W_=this.W_.remove(t):1===e.type&&2===r.type?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):I():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ss{constructor(e,t,r,n,a,s,i,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=i,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,a){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Ss(e,t,ks.emptySet(t),s,r,n,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wt(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(t[n].type!==r[n].type||!t[n].doc.isEqual(r[n].doc))return!1;return!0}}class _s{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Cs{constructor(){this.queries=As(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const r=O(e),n=r.queries;r.queries=As(),n.forEach((e,r)=>{for(const n of r.j_)n.onError(t)})}(this,new j(D.ABORTED,"Firestore shutting down"))}}function As(){return new Qt(e=>Gt(e),Wt)}async function Is(e,t){const r=O(e);let n=3;const a=t.query;let s=r.queries.get(a);s?!s.H_()&&t.J_()&&(n=2):(s=new _s,n=t.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(a,!0);break;case 1:s.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(e){const r=Ts(e,"Initialization of query '".concat(Kt(t.query),"' failed"));return void t.onError(r)}r.queries.set(a,s),s.j_.push(t),t.Z_(r.onlineState),s.z_&&t.X_(s.z_)&&js(r)}async function Rs(e,t){const r=O(e),n=t.query;let a=3;const s=r.queries.get(n);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?a=t.J_()?0:1:!s.H_()&&t.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function Os(e,t){const r=O(e);let n=!1;for(const a of t){const e=a.query,t=r.queries.get(e);if(t){for(const e of t.j_)e.X_(a)&&(n=!0);t.z_=a}}n&&js(r)}function Ds(e,t,r){const n=O(e),a=n.queries.get(t);if(a)for(const s of a.j_)s.onError(r);n.queries.delete(t)}function js(e){e.Y_.forEach(e=>{e.next()})}var Ps,Ms;(Ms=Ps||(Ps={})).ea="default",Ms.Cache="cache";class Ls{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const r of e.docChanges)3!==r.type&&t.push(r);e=new Ss(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const r="Offline"!==t;return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Ss.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ps.Cache}}class Fs{constructor(e){this.key=e}}class Us{constructor(e){this.key=e}}class Bs{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=lr(),this.mutatedKeys=lr(),this.Aa=$t(e),this.Ra=new ks(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new Ns,n=t?t.Ra:this.Ra;let a=t?t.mutatedKeys:this.mutatedKeys,s=n,i=!1;const o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((e,t)=>{const c=n.get(e),u=qt(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(r.track({type:3,doc:u}),f=!0):this.ga(c,u)||(r.track({type:2,doc:u}),f=!0,(o&&this.Aa(u,o)>0||l&&this.Aa(u,l)<0)&&(i=!0)):!c&&u?(r.track({type:0,doc:u}),f=!0):c&&!u&&(r.track({type:1,doc:c}),f=!0,(o||l)&&(i=!0)),f&&(u?(s=s.add(u),a=h?a.add(e):a.delete(e)):(s=s.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),a=a.delete(e.key),r.track({type:1,doc:e})}return{Ra:s,fa:r,ns:i,mutatedKeys:a}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((e,t)=>function(e,t){const r=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return I()}};return r(e)-r(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(r),n=null!=n&&n;const i=t&&!n?this.ya():[],o=0===this.da.size&&this.current&&!n?1:0,l=o!==this.Ea;return this.Ea=o,0!==s.length||l?{snapshot:new Ss(this.query,e.Ra,a,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:i}:{wa:i}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ns,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=lr(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new Us(e))}),this.da.forEach(r=>{e.has(r)||t.push(new Fs(r))}),t}ba(e){this.Ta=e.Ts,this.da=lr();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ss.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Vs{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class zs{constructor(e){this.key=e,this.va=!1}}class Hs{constructor(e,t,r,n,a,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Qt(e=>Gt(e),Wt),this.Ma=new Map,this.xa=new Set,this.Oa=new Te(ee.comparator),this.Na=new Map,this.La=new ia,this.Ba={},this.ka=new Map,this.qa=Zn.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function Ws(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=di(e);let a;const s=n.Fa.get(t);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await Ks(n,t,r,!0),a}async function Gs(e,t){const r=di(e);await Ks(r,t,!0,!1)}async function Ks(e,t,r,n){const a=await ka(e.localStore,Bt(t)),s=a.targetId,i=e.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await qs(e,t,s,"current"===i,a.resumeToken)),e.isPrimaryClient&&r&&$a(e.remoteStore,a),o}async function qs(e,t,r,n,a){e.Ka=(t,r,n)=>async function(e,t,r,n){let a=t.view.ma(r);a.ns&&(a=await Sa(e.localStore,t.query,!1).then(e=>{let{documents:r}=e;return t.view.ma(r,a)}));const s=n&&n.targetChanges.get(t.targetId),i=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,s,i);return si(e,t.targetId,o.wa),o.snapshot}(e,t,r,n);const s=await Sa(e.localStore,t,!0),i=new Bs(t,s.Ts),o=i.ma(s.documents),l=sn.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,a),c=i.applyChanges(o,e.isPrimaryClient,l);si(e,r,c.wa);const u=new Vs(t,r,i);return e.Fa.set(t,u),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),c.snapshot}async function Xs(e,t,r){const n=O(e),a=n.Fa.get(t),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(e=>!Wt(e,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Na(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Ya(n.remoteStore,a.targetId),ni(n,a.targetId)}).catch(le)):(ni(n,a.targetId),await Na(n.localStore,a.targetId,!0))}async function $s(e,t){const r=O(e),n=r.Fa.get(t),a=r.Ma.get(n.targetId);r.isPrimaryClient&&1===a.length&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Ya(r.remoteStore,n.targetId))}async function Ys(e,t){const r=O(e);try{const e=await function(e,t){const r=O(e),n=t.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const i=[];t.targetChanges.forEach((s,o)=>{const l=a.get(o);if(!l)return;i.push(r.Ur.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.Ur.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Ie.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,n)),a=a.insert(o,c),function(e,t,r){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0}(l,c,s)&&i.push(r.Ur.updateTargetData(e,c))});let o=Zt(),l=lr();if(t.documentUpdates.forEach(n=>{t.resolvedLimboDocuments.has(n)&&i.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))}),i.push(Ea(e,s,t.documentUpdates).next(e=>{o=e.Ps,l=e.Is})),!n.isEqual($.min())){const t=r.Ur.getLastRemoteSnapshotVersion(e).next(t=>r.Ur.setTargetsMetadata(e,e.currentSequenceNumber,n));i.push(t)}return ce.waitFor(i).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(r.os=a,e))}(r.localStore,t);t.targetChanges.forEach((e,t)=>{const n=r.Na.get(t);n&&(R(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.va=!0:e.modifiedDocuments.size>0?R(n.va):e.removedDocuments.size>0&&(R(n.va),n.va=!1))}),await li(r,e,t)}catch(e){await le(e)}}function Qs(e,t,r){const n=O(e);if(n.isPrimaryClient&&0===r||!n.isPrimaryClient&&1===r){const e=[];n.Fa.forEach((r,n)=>{const a=n.view.Z_(t);a.snapshot&&e.push(a.snapshot)}),function(e,t){const r=O(e);r.onlineState=t;let n=!1;r.queries.forEach((e,r)=>{for(const a of r.j_)a.Z_(t)&&(n=!0)}),n&&js(r)}(n.eventManager,t),e.length&&n.Ca.d_(e),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function Js(e,t,r){const n=O(e);n.sharedClientState.updateQueryState(t,"rejected",r);const a=n.Na.get(t),s=a&&a.key;if(s){let e=new Te(ee.comparator);e=e.insert(s,it.newNoDocument(s,$.min()));const r=lr().add(s),a=new an($.min(),new Map,new Te(K),e,r);await Ys(n,a),n.Oa=n.Oa.remove(s),n.Na.delete(t),oi(n)}else await Na(n.localStore,t,!1).then(()=>ni(n,t,r)).catch(le)}async function Zs(e,t){const r=O(e),n=t.batch.batchId;try{const e=await function(e,t){const r=O(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const n=t.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,r,n){const a=r.batch,s=a.keys();let i=ce.resolve();return s.forEach(e=>{i=i.next(()=>n.getEntry(t,e)).next(t=>{const s=r.docVersions.get(e);R(null!==s),t.version.compareTo(s)<0&&(a.applyToRemoteDocument(t,r),t.isValidDocument()&&(t.setReadTime(r.commitVersion),n.addEntry(t)))})}),i.next(()=>e.mutationQueue.removeMutationBatch(t,a))}(r,e,t,a).next(()=>a.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=lr();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,n))})}(r.localStore,t);ri(r,n,null),ti(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await li(r,e)}catch(e){await le(e)}}async function ei(e,t,r){const n=O(e);try{const e=await function(e,t){const r=O(e);return r.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let n;return r.mutationQueue.lookupMutationBatch(e,t).next(t=>(R(null!==t),n=t.keys(),r.mutationQueue.removeMutationBatch(e,t))).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,n)).next(()=>r.localDocuments.getDocuments(e,n))})}(n.localStore,t);ri(n,t,r),ti(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await li(n,e)}catch(r){await le(r)}}function ti(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function ri(e,t,r){const n=O(e);let a=n.Ba[n.currentUser.toKey()];if(a){const e=a.get(t);e&&(r?e.reject(r):e.resolve(),a=a.remove(t)),n.Ba[n.currentUser.toKey()]=a}}function ni(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||ai(e,t)})}function ai(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);null!==r&&(Ya(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),oi(e))}function si(e,t,r){for(const n of r)n instanceof Fs?(e.La.addReference(n.key,t),ii(e,n)):n instanceof Us?(S("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||ai(e,n.key)):I()}function ii(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(S("SyncEngine","New document in limbo: "+r),e.xa.add(n),oi(e))}function oi(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new ee(Q.fromString(t)),n=e.qa.next();e.Na.set(n,new zs(r)),e.Oa=e.Oa.insert(r,n),$a(e.remoteStore,new Kn(Bt(Mt(r.path)),n,"TargetPurposeLimboResolution",he.oe))}}async function li(e,t,r){const n=O(e),a=[],s=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((e,o)=>{i.push(n.Ka(o,t,r).then(e=>{var t;if((e||r)&&n.isPrimaryClient){const a=e?!e.fromCache:null===(t=null==r?void 0:r.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;n.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=pa.Wi(o.targetId,e);s.push(t)}}))}),await Promise.all(i),n.Ca.d_(a),await async function(e,t){const r=O(e);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>ce.forEach(t,t=>ce.forEach(t.$i,n=>r.persistence.referenceDelegate.addReference(e,t.targetId,n)).next(()=>ce.forEach(t.Ui,n=>r.persistence.referenceDelegate.removeReference(e,t.targetId,n)))))}catch(e){if(!de(e))throw e;S("LocalStore","Failed to update sequence numbers: "+e)}for(const n of t){const e=n.targetId;if(!n.fromCache){const t=r.os.get(e),n=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(n);r.os=r.os.insert(e,a)}}}(n.localStore,s))}async function ci(e,t){const r=O(e);if(!r.currentUser.isEqual(t)){S("SyncEngine","User change. New user:",t.toKey());const e=await wa(r.localStore,t);r.currentUser=t,function(e,t){e.ka.forEach(e=>{e.forEach(e=>{e.reject(new j(D.CANCELLED,t))})}),e.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await li(r,e.hs)}}function ui(e,t){const r=O(e),n=r.Na.get(t);if(n&&n.va)return lr().add(n.key);{let e=lr();const n=r.Ma.get(t);if(!n)return e;for(const t of n){const n=r.Fa.get(t);e=e.unionWith(n.view.Va)}return e}}function di(e){const t=O(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ys.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ui.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Js.bind(null,t),t.Ca.d_=Os.bind(null,t.eventManager),t.Ca.$a=Ds.bind(null,t.eventManager),t}function hi(e){const t=O(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Zs.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ei.bind(null,t),t}class fi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ua(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return ba(this.persistence,new va,e.initialUser,this.serializer)}Ga(e){return new ha(ma.Zr,this.serializer)}Wa(e){return new Aa}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fi.provider={build:()=>new fi};class mi{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Qs(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=ci.bind(null,this.syncEngine),await bs(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Cs}createDatastore(e){const t=Ua(e.databaseInfo.databaseId),r=function(e){return new La(e)}(e.databaseInfo);return function(e,t,r,n){return new Wa(e,t,r,n)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(e,t,r,n,a){return new Ka(e,t,r,n,a)}(this.localStore,this.datastore,e.asyncQueue,e=>Qs(this.syncEngine,e,0),Ra.D()?new Ra:new Ia)}createSyncEngine(e,t){return function(e,t,r,n,a,s,i){const o=new Hs(e,t,r,n,a,s);return i&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=O(e);S("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Xa(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}mi.provider={build:()=>new mi};class pi{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):_("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class gi{constructor(e,t,r,n,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=n,this.user=E.UNAUTHENTICATED,this.clientId=G.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async e=>{S("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(S("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new P;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ts(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function vi(e,t){e.asyncQueue.verifyOperationInProgress(),S("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await wa(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function yi(e,t){e.asyncQueue.verifyOperationInProgress();const r=await bi(e);S("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>ys(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>ys(t.remoteStore,r)),e._onlineComponents=t}async function bi(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){S("FirestoreClient","Using user provided OfflineComponentProvider");try{await vi(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(e){return"FirebaseError"===e.name?e.code===D.FAILED_PRECONDITION||e.code===D.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r))throw r;C("Error using user provided cache. Falling back to memory cache: "+r),await vi(e,new fi)}}else S("FirestoreClient","Using default OfflineComponentProvider"),await vi(e,new fi);return e._offlineComponents}async function wi(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(S("FirestoreClient","Using user provided OnlineComponentProvider"),await yi(e,e._uninitializedComponentsProvider._online)):(S("FirestoreClient","Using default OnlineComponentProvider"),await yi(e,new mi))),e._onlineComponents}function xi(e){return wi(e).then(e=>e.syncEngine)}async function Ei(e){const t=await wi(e),r=t.eventManager;return r.onListen=Ws.bind(null,t.syncEngine),r.onUnlisten=Xs.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=Gs.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=$s.bind(null,t.syncEngine),r}function Ti(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=new P;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,r,n,a){const s=new pi({next:o=>{s.Za(),t.enqueueAndForget(()=>Rs(e,i));const l=o.docs.has(r);!l&&o.fromCache?a.reject(new j(D.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&n&&"server"===n.source?a.reject(new j(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(o)},error:e=>a.reject(e)}),i=new Ls(Mt(r.path),s,{includeMetadataChanges:!0,_a:!0});return Is(e,i)}(await Ei(e),e.asyncQueue,t,r,n)),n.promise}function ki(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=new P;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,r,n,a){const s=new pi({next:r=>{s.Za(),t.enqueueAndForget(()=>Rs(e,i)),r.fromCache&&"server"===n.source?a.reject(new j(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(r)},error:e=>a.reject(e)}),i=new Ls(r,s,{includeMetadataChanges:!0,_a:!0});return Is(e,i)}(await Ei(e),e.asyncQueue,t,r,n)),n.promise}function Ni(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Si=new Map;function _i(e,t,r){if(!r)throw new j(D.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Ci(e){if(!ee.isDocumentKey(e))throw new j(D.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Ai(e){if(ee.isDocumentKey(e))throw new j(D.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Ii(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":I()}function Ri(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new j(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Ii(e);throw new j(D.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(r))}}return e}function Oi(e,t){if(t<=0)throw new j(D.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class Di{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new j(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new j(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new j(D.INVALID_ARGUMENT,"".concat(e," and ").concat(r," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ni(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new j(D.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new j(D.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new j(D.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ji{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Di({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new j(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new j(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Di(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new L;switch(e.type){case"firstParty":return new V(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new j(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Si.get(e);t&&(S("ComponentProvider","Removing Datastore"),Si.delete(e),t.terminate())}(this),Promise.resolve()}}class Pi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Pi(this.firestore,e,this._query)}}class Mi{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Li(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mi(this.firestore,e,this._key)}}class Li extends Pi{constructor(e,t,r){super(e,t,Mt(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mi(this.firestore,null,new ee(e))}withConverter(e){return new Li(this.firestore,e,this._path)}}function Fi(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(e=(0,l.Ku)(e),_i("collection","path",t),e instanceof ji){const r=Q.fromString(t,...n);return Ai(r),new Li(e,null,r)}{if(!(e instanceof Mi||e instanceof Li))throw new j(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Q.fromString(t,...n));return Ai(r),new Li(e.firestore,null,r)}}function Ui(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(e=(0,l.Ku)(e),1===arguments.length&&(t=G.newId()),_i("doc","path",t),e instanceof ji){const r=Q.fromString(t,...n);return Ci(r),new Mi(e,null,new ee(r))}{if(!(e instanceof Mi||e instanceof Li))throw new j(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Q.fromString(t,...n));return Ci(r),new Mi(e.firestore,e instanceof Li?e.converter:null,new ee(r))}}class Bi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ba(this,"async_queue_retry"),this.Vu=()=>{const e=Fa();e&&S("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Fa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Fa();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new P;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!de(e))throw e;S("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw _("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const n=Es.createAndSchedule(this,e,t,r,e=>this.yu(e));return this.Tu.push(n),n}fu(){this.Eu&&I()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Vi(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const n of t)if(n in r&&"function"==typeof r[n])return!0;return!1}(e,["next","error","complete"])}class zi extends ji{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new Bi,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Bi(e),this._firestoreClient=void 0,await e}}}function Hi(e,t){const r="object"==typeof e?e:(0,s.Sx)(),n="string"==typeof e?e:t||"(default)",a=(0,s.j6)(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const e=(0,l.yU)("firestore");e&&function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a;const s=(e=Ri(e,ji))._getSettings(),i="".concat(t,":").concat(r);if("firestore.googleapis.com"!==s.host&&s.host!==i&&C("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:i,ssl:!1})),n.mockUserToken){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=E.MOCK_USER;else{t=(0,l.Fy)(n.mockUserToken,null===(a=e._app)||void 0===a?void 0:a.options.projectId);const s=n.mockUserToken.sub||n.mockUserToken.user_id;if(!s)throw new j(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new E(s)}e._authCredentials=new F(new M(t,r))}}(a,...e)}return a}function Wi(e){if(e._terminated)throw new j(D.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Gi(e),e._firestoreClient}function Gi(e){var t,r,n;const a=e._freezeSettings(),s=function(e,t,r,n){return new Fe(e,t,r,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,Ni(n.experimentalLongPollingOptions),n.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||(null===(r=a.localCache)||void 0===r?void 0:r._offlineComponentProvider)&&(null===(n=a.localCache)||void 0===n?void 0:n._onlineComponentProvider)&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new gi(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Ki{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ki(Ie.fromBase64String(e))}catch(e){throw new j(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Ki(Ie.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class qi{constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(let n=0;n<t.length;++n)if(0===t[n].length)throw new j(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Z(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xi{constructor(e){this._methodName=e}}class $i{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new j(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new j(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}}class Yi{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}}const Qi=/^__.*__$/;class Ji{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Lr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mr(e,this.data,t,this.fieldTransforms)}}class Zi{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Lr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function eo(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw I()}}class to{constructor(e,t,r,n,a,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===a&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new to(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),n=this.Fu({path:r,xu:!1});return n.Ou(e),n}Nu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),n=this.Fu({path:r,xu:!1});return n.vu(),n}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yo(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(eo(this.Cu)&&Qi.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class ro{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ua(e)}Qu(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new to({Cu:e,methodName:t,qu:r,path:Z.emptyPath(),xu:!1,ku:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function no(e){const t=e._freezeSettings(),r=Ua(e._databaseId);return new ro(e._databaseId,!!t.ignoreUndefinedProperties,r)}function ao(e,t,r,n,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.Qu(s.merge||s.mergeFields?2:0,t,r,a);mo("Data must be an object, but it was:",i,n);const o=ho(n,i);let l,c;if(s.merge)l=new Ce(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const e=[];for(const n of s.mergeFields){const a=po(t,n,r);if(!i.contains(a))throw new j(D.INVALID_ARGUMENT,"Field '".concat(a,"' is specified in your field mask but missing from your input data."));bo(e,a)||e.push(a)}l=new Ce(e),c=i.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=i.fieldTransforms;return new Ji(new at(o),l,c)}class so extends Xi{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Bu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof so}}class io extends Xi{_toFieldTransform(e){return new Sr(e.path,new yr)}isEqual(e){return e instanceof io}}function oo(e,t,r,n){const a=e.Qu(1,t,r);mo("Data must be an object, but it was:",a,n);const s=[],i=at.empty();xe(n,(e,n)=>{const o=vo(t,e,r);n=(0,l.Ku)(n);const c=a.Nu(o);if(n instanceof so)s.push(o);else{const e=uo(n,c);null!=e&&(s.push(o),i.set(o,e))}});const o=new Ce(s);return new Zi(i,o,a.fieldTransforms)}function lo(e,t,r,n,a,s){const i=e.Qu(1,t,r),o=[po(t,n,r)],c=[a];if(s.length%2!=0)throw new j(D.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let l=0;l<s.length;l+=2)o.push(po(t,s[l])),c.push(s[l+1]);const u=[],d=at.empty();for(let f=o.length-1;f>=0;--f)if(!bo(u,o[f])){const e=o[f];let t=c[f];t=(0,l.Ku)(t);const r=i.Nu(e);if(t instanceof so)u.push(e);else{const n=uo(t,r);null!=n&&(u.push(e),d.set(e,n))}}const h=new Ce(u);return new Zi(d,h,i.fieldTransforms)}function co(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return uo(r,e.Qu(n?4:3,t))}function uo(e,t){if(fo(e=(0,l.Ku)(e)))return mo("Unsupported field value:",t,e),ho(e,t);if(e instanceof Xi)return function(e,t){if(!eo(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const r=[];let n=0;for(const a of e){let e=uo(a,t.Lu(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=(0,l.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return fr(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const r=X.fromDate(e);return{timestampValue:bn(t.serializer,r)}}if(e instanceof X){const r=new X(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:bn(t.serializer,r)}}if(e instanceof $i)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ki)return{bytesValue:wn(t.serializer,e._byteString)};if(e instanceof Mi){const r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.Bu("Document reference is for database ".concat(n.projectId,"/").concat(n.database," but should be for database ").concat(r.projectId,"/").concat(r.database));return{referenceValue:Tn(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Yi)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return dr(t.serializer,e)})}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(Ii(e)))}(e,t)}function ho(e,t){const r={};return Ee(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):xe(e,(e,n)=>{const a=uo(n,t.Mu(e));null!=a&&(r[e]=a)}),{mapValue:{fields:r}}}function fo(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof X||e instanceof $i||e instanceof Ki||e instanceof Mi||e instanceof Xi||e instanceof Yi)}function mo(e,t,r){if(!fo(r)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(r)){const n=Ii(r);throw"an object"===n?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function po(e,t,r){if((t=(0,l.Ku)(t))instanceof qi)return t._internalPath;if("string"==typeof t)return vo(e,t);throw yo("Field path arguments must be of type string or ",e,!1,void 0,r)}const go=new RegExp("[~\\*/\\[\\]]");function vo(e,t,r){if(t.search(go)>=0)throw yo("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,r);try{return new qi(...t.split("."))._internalPath}catch(n){throw yo("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,r)}}function yo(e,t,r,n,a){const s=n&&!n.isEmpty(),i=void 0!==a;let o="Function ".concat(t,"() called with invalid data");r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||i)&&(l+=" (found",s&&(l+=" in field ".concat(n)),i&&(l+=" in document ".concat(a)),l+=")"),new j(D.INVALID_ARGUMENT,o+e+l)}function bo(e,t){return e.some(e=>e.isEqual(t))}class wo{constructor(e,t,r,n,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Mi(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new xo(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Eo("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class xo extends wo{data(){return super.data()}}function Eo(e,t){return"string"==typeof t?vo(e,t):t instanceof qi?t._internalPath:t._delegate._internalPath}function To(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new j(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ko{}class No extends ko{}function So(e,t){let r=[];for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];t instanceof ko&&r.push(t),r=r.concat(a),function(e){const t=e.filter(e=>e instanceof Ao).length,r=e.filter(e=>e instanceof _o).length;if(t>1||t>0&&r>0)throw new j(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class _o extends No{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new _o(e,t,r)}_apply(e){const t=this._parse(e);return Mo(e._query,t),new Pi(e.firestore,e.converter,zt(e._query,t))}_parse(e){const t=no(e.firestore),r=function(e,t,r,n,a,s,i){let o;if(a.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new j(D.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){Po(i,s);const t=[];for(const r of i)t.push(jo(n,e,r));o={arrayValue:{values:t}}}else o=jo(n,e,i)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Po(i,s),o=co(r,t,i,"in"===s||"not-in"===s);return ft.create(a,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return r}}function Co(e,t,r){const n=t,a=Eo("where",e);return _o._create(a,n,r)}class Ao extends ko{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ao(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:mt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;const n=t.getFlattenedFilters();for(const a of n)Mo(r,a),r=zt(r,a)}(e._query,t),new Pi(e.firestore,e.converter,zt(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Io extends No{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Io(e,t)}_apply(e){const t=function(e,t,r){if(null!==e.startAt)throw new j(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new j(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ut(t,r)}(e._query,this._field,this._direction);return new Pi(e.firestore,e.converter,function(e,t){const r=e.explicitOrderBy.concat([t]);return new jt(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Ro(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",r=Eo("orderBy",e);return Io._create(r,t)}class Oo extends No{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Oo(e,t,r)}_apply(e){return new Pi(e.firestore,e.converter,Ht(e._query,this._limit,this._limitType))}}function Do(e){return Oi("limit",e),Oo._create("limit",e,"F")}function jo(e,t,r){if("string"==typeof(r=(0,l.Ku)(r))){if(""===r)throw new j(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ft(t)&&-1!==r.indexOf("/"))throw new j(D.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(r,"' contains a '/' character."));const n=t.path.child(Q.fromString(r));if(!ee.isDocumentKey(n))throw new j(D.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(n,"' is not because it has an odd number of segments (").concat(n.length,")."));return $e(e,new ee(n))}if(r instanceof Mi)return $e(e,r._key);throw new j(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Ii(r),"."))}function Po(e,t){if(!Array.isArray(e)||0===e.length)throw new j(D.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Mo(e,t){const r=function(e,t){for(const r of e)for(const e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new j(D.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new j(D.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(r.toString(),"' filters."))}class Lo{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Ve(e)){case 0:return null;case 1:return e.booleanValue;case 2:return De(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(je(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw I()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const r={};return xe(e,(e,n)=>{r[e]=this.convertValue(n,t)}),r}convertVectorValue(e){var t,r,n;const a=null===(n=null===(r=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===r?void 0:r.values)||void 0===n?void 0:n.map(e=>De(e.doubleValue));return new Yi(a)}convertGeoPoint(e){return new $i(De(e.latitude),De(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Me(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Le(e));default:return null}}convertTimestamp(e){const t=Oe(e);return new X(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Q.fromString(e);R(Gn(r));const n=new Ue(r.get(1),r.get(3)),a=new ee(r.popFirst(5));return n.isEqual(t)||_("Document ".concat(a," contains a document reference within a different database (").concat(n.projectId,"/").concat(n.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}function Fo(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}class Uo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bo extends wo{constructor(e,t,r,n,a,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Vo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const r=this._document.data.field(Eo("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Vo extends Bo{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class zo{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new Uo(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Vo(this._firestore,this._userDataWriter,r.key,r,new Uo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new j(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{const n=new Vo(e._firestore,e._userDataWriter,r.doc.key,r.doc,new Uo(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const n=new Vo(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Uo(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,s=-1;return 0!==t.type&&(a=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(r=r.add(t.doc),s=r.indexOf(t.doc.key)),{type:Ho(t.type),doc:n,oldIndex:a,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Ho(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return I()}}function Wo(e){e=Ri(e,Mi);const t=Ri(e.firestore,zi);return Ti(Wi(t),e._key).then(r=>Jo(t,e,r))}class Go extends Lo{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ki(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mi(this.firestore,null,t)}}function Ko(e){e=Ri(e,Pi);const t=Ri(e.firestore,zi),r=Wi(t),n=new Go(t);return To(e._query),ki(r,e._query).then(r=>new zo(t,n,e,r))}function qo(e,t,r){e=Ri(e,Mi);const n=Ri(e.firestore,zi),a=no(n);let s;for(var i=arguments.length,o=new Array(i>3?i-3:0),c=3;c<i;c++)o[c-3]=arguments[c];return s="string"==typeof(t=(0,l.Ku)(t))||t instanceof qi?lo(a,"updateDoc",e._key,t,r,o):oo(a,"updateDoc",e._key,t),Qo(n,[s.toMutation(e._key,Cr.exists(!0))])}function Xo(e){return Qo(Ri(e.firestore,zi),[new Vr(e._key,Cr.none())])}function $o(e,t){const r=Ri(e.firestore,zi),n=Ui(e),a=Fo(e.converter,t);return Qo(r,[ao(no(e.firestore),"addDoc",n._key,a,null!==e.converter,{}).toMutation(n._key,Cr.exists(!1))]).then(()=>n)}function Yo(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a,s,i;e=(0,l.Ku)(e);let o={includeMetadataChanges:!1,source:"default"},c=0;"object"!=typeof r[c]||Vi(r[c])||(o=r[c],c++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Vi(r[c])){const e=r[c];r[c]=null===(a=e.next)||void 0===a?void 0:a.bind(e),r[c+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),r[c+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let d,h,f;if(e instanceof Mi)h=Ri(e.firestore,zi),f=Mt(e._key.path),d={next:t=>{r[c]&&r[c](Jo(h,e,t))},error:r[c+1],complete:r[c+2]};else{const t=Ri(e,Pi);h=Ri(t.firestore,zi),f=t._query;const n=new Go(h);d={next:e=>{r[c]&&r[c](new zo(h,n,t,e))},error:r[c+1],complete:r[c+2]},To(e._query)}return function(e,t,r,n){const a=new pi(n),s=new Ls(t,a,r);return e.asyncQueue.enqueueAndForget(async()=>Is(await Ei(e),s)),()=>{a.Za(),e.asyncQueue.enqueueAndForget(async()=>Rs(await Ei(e),s))}}(Wi(h),f,u,d)}function Qo(e,t){return function(e,t){const r=new P;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,r){const n=hi(e);try{const e=await function(e,t){const r=O(e),n=X.now(),a=t.reduce((e,t)=>e.add(t.key),lr());let s,i;return r.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Zt(),l=lr();return r.cs.getEntries(e,a).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>r.localDocuments.getOverlayedDocuments(e,o)).next(a=>{s=a;const i=[];for(const e of t){const t=jr(e,s.get(e.key).overlayedDocument);null!=t&&i.push(new Lr(e.key,t,st(t.value.mapValue),Cr.exists(!0)))}return r.mutationQueue.addMutationBatch(e,n,i,t)}).next(t=>{i=t;const n=t.applyToLocalDocumentSet(s,l);return r.documentOverlayCache.saveOverlays(e,t.batchId,n)})}).then(()=>({batchId:i.batchId,changes:rr(s)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(e.batchId),function(e,t,r){let n=e.Ba[e.currentUser.toKey()];n||(n=new Te(K)),n=n.insert(t,r),e.Ba[e.currentUser.toKey()]=n}(n,e.batchId,r),await li(n,e.changes),await cs(n.remoteStore)}catch(e){const t=Ts(e,"Failed to persist write");r.reject(t)}}(await xi(e),t,r)),r.promise}(Wi(e),t)}function Jo(e,t,r){const n=r.docs.get(t._key),a=new Go(e);return new Bo(e,a,t._key,n,new Uo(r.hasPendingWrites,r.fromCache),t.converter)}class Zo{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=no(e)}set(e,t,r){this._verifyNotCommitted();const n=el(e,this._firestore),a=Fo(n.converter,t,r),s=ao(this._dataReader,"WriteBatch.set",n._key,a,null!==n.converter,r);return this._mutations.push(s.toMutation(n._key,Cr.none())),this}update(e,t,r){this._verifyNotCommitted();const n=el(e,this._firestore);let a;for(var s=arguments.length,i=new Array(s>3?s-3:0),o=3;o<s;o++)i[o-3]=arguments[o];return a="string"==typeof(t=(0,l.Ku)(t))||t instanceof qi?lo(this._dataReader,"WriteBatch.update",n._key,t,r,i):oo(this._dataReader,"WriteBatch.update",n._key,t),this._mutations.push(a.toMutation(n._key,Cr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=el(e,this._firestore);return this._mutations=this._mutations.concat(new Vr(t._key,Cr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new j(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function el(e,t){if((e=(0,l.Ku)(e)).firestore!==t)throw new j(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function tl(){return new io("serverTimestamp")}function rl(e){return Wi(e=Ri(e,zi)),new Zo(e,t=>Qo(e,t))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){T=e}(s.MF),(0,s.om)(new i.uA("firestore",(e,r)=>{let{instanceIdentifier:n,options:a}=r;const s=e.getProvider("app").getImmediate(),i=new zi(new U(e.getProvider("auth-internal")),new H(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new j(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ue(e.options.projectId,t)}(s,n),s);return a=Object.assign({useFetchStreams:t},a),i._setSettings(a),i},"PUBLIC").setMultipleInstances(!0)),(0,s.KO)(x,"4.7.3",e),(0,s.KO)(x,"4.7.3","esm2017")}()},555:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}r.d(t,{A:()=>o})},579:(e,t,r)=>{e.exports=r(153)},700:(e,t,r)=>{r.d(t,{Am:()=>R,FA:()=>S,Fy:()=>p,I9:()=>O,Im:()=>C,Ku:()=>L,T9:()=>h,Tj:()=>u,Uj:()=>i,XA:()=>f,ZQ:()=>g,bD:()=>A,c1:()=>y,cY:()=>m,eX:()=>k,g:()=>N,hp:()=>D,jZ:()=>v,lT:()=>x,lV:()=>w,nr:()=>E,sr:()=>b,tD:()=>j,u:()=>o,yU:()=>d,zW:()=>T});const n=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let a=e.charCodeAt(n);a<128?t[r++]=a:a<2048?(t[r++]=a>>6|192,t[r++]=63&a|128):55296===(64512&a)&&n+1<e.length&&56320===(64512&e.charCodeAt(n+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++n)),t[r++]=a>>18|240,t[r++]=a>>12&63|128,t[r++]=a>>6&63|128,t[r++]=63&a|128):(t[r++]=a>>12|224,t[r++]=a>>6&63|128,t[r++]=63&a|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<e.length;a+=3){const t=e[a],s=a+1<e.length,i=s?e[a+1]:0,o=a+2<e.length,l=o?e[a+2]:0,c=t>>2,u=(3&t)<<4|i>>4;let d=(15&i)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),n.push(r[c],r[u],r[d],r[h])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(n(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let r=0,n=0;for(;r<e.length;){const a=e[r++];if(a<128)t[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=e[r++];t[n++]=String.fromCharCode((31&a)<<6|63&s)}else if(a>239&&a<365){const s=((7&a)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{const s=e[r++],i=e[r++];t[n++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<e.length;){const t=r[e.charAt(a++)],i=a<e.length?r[e.charAt(a)]:0;++a;const o=a<e.length?r[e.charAt(a)]:64;++a;const l=a<e.length?r[e.charAt(a)]:64;if(++a,null==t||null==i||null==o||null==l)throw new s;const c=t<<2|i>>4;if(n.push(c),64!==o){const e=i<<4&240|o>>2;if(n.push(e),64!==l){const e=o<<6&192|l;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const i=function(e){return function(e){const t=n(e);return a.encodeByteArray(t,!0)}(e).replace(/\./g,"")},o=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const l=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,c=()=>{try{return l()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const t=e&&o(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},u=e=>{var t,r;return null===(r=null===(t=c())||void 0===t?void 0:t.emulatorHosts)||void 0===r?void 0:r[e]},d=e=>{const t=u(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]},h=()=>{var e;return null===(e=c())||void 0===e?void 0:e.config},f=e=>{var t;return null===(t=c())||void 0===t?void 0:t["_".concat(e)]};class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function p(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",n=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(r),aud:r,iat:n,exp:n+3600,auth_time:n,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[i(JSON.stringify({alg:"none",type:"JWT"})),i(JSON.stringify(s)),""].join(".")}function g(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function y(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function b(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function x(){const e=g();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function E(){return!function(){var e;const t=null===(e=c())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(r.g.process)}catch(n){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function T(){try{return"object"===typeof indexedDB}catch(e){return!1}}function k(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(r){t(r)}})}class N extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,N.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,S.prototype.create)}}class S{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},r="".concat(this.service,"/").concat(e),n=this.errors[e],a=n?function(e,t){return e.replace(_,(e,r)=>{const n=t[r];return null!=n?String(n):"<".concat(r,"?>")})}(n,t):"Error",s="".concat(this.serviceName,": ").concat(a," (").concat(r,").");return new N(r,s,t)}}const _=/\{\$([^}]+)}/g;function C(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function A(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const a of r){if(!n.includes(a))return!1;const r=e[a],s=t[a];if(I(r)&&I(s)){if(!A(r,s))return!1}else if(r!==s)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function I(e){return null!==e&&"object"===typeof e}function R(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function O(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[r,n]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(n)}}),t}function D(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}function j(e,t){const r=new P(e,t);return r.subscribe.bind(r)}class P{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");n=function(e,t){if("object"!==typeof e||null===e)return!1;for(const r of t)if(r in e&&"function"===typeof e[r])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r},void 0===n.next&&(n.next=M),void 0===n.error&&(n.error=M),void 0===n.complete&&(n.complete=M);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function M(){}function L(e){return e&&e._delegate?e._delegate:e}},730:(e,t,r)=>{var n=r(43),a=r(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function p(e,t,r,n,a,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,r,n){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,n)&&(r=null),n||null===a?function(e){return!!d.call(m,e)||!d.call(f,e)&&(h.test(e)?m[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),E=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),_=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var j=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}var M,L=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function B(e,t){if(!e||U)return"";U=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),s=n.stack.split("\n"),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(1!==i||1!==o)do{if(i--,0>--o||a[i]!==s[o]){var l="\n"+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case E:return"Portal";case N:return"Profiler";case k:return"StrictMode";case A:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return z(e(t))}catch(r){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=G(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var r=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=W(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var r=W(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&X(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+W(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(s(92));if(te(r)){if(1<r.length)throw Error(s(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:W(r)}}function se(e,t){var r=W(t.value),n=W(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function pe(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=pe(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}Object.keys(fe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Te=null,ke=null;function Ne(e){if(e=ba(e)){if("function"!==typeof Ee)throw Error(s(280));var t=e.stateNode;t&&(t=xa(t),Ee(e.stateNode,e.type,t))}}function Se(e){Te?ke?ke.push(e):ke=[e]:Te=e}function _e(){if(Te){var e=Te,t=ke;if(ke=Te=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Ce(e,t){return e(t)}function Ae(){}var Ie=!1;function Re(e,t,r){if(Ie)return e(t,r);Ie=!0;try{return Ce(e,t,r)}finally{Ie=!1,(null!==Te||null!==ke)&&(Ae(),_e())}}function Oe(e,t){var r=e.stateNode;if(null===r)return null;var n=xa(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(s(231,t,typeof r));return r}var De=!1;if(u)try{var je={};Object.defineProperty(je,"passive",{get:function(){De=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch(ue){De=!1}function Pe(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Me=!1,Le=null,Fe=!1,Ue=null,Be={onError:function(e){Me=!0,Le=e}};function Ve(e,t,r,n,a,s,i,o,l){Me=!1,Le=null,Pe.apply(Be,arguments)}function ze(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(ze(e)!==e)throw Error(s(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(n=a.return)){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return We(a),e;if(i===n)return We(a),t;i=i.sibling}throw Error(s(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(s(189))}}if(r.alternate!==n)throw Error(s(190))}if(3!==r.tag)throw Error(s(188));return r.stateNode.current===r?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var qe=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,$e=a.unstable_shouldYield,Ye=a.unstable_requestPaint,Qe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,st=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=268435455&r;if(0!==i){var o=i&~a;0!==o?n=dt(o):0!==(s&=i)&&(n=dt(s))}else 0!==(i=r&~a)?n=dt(i):0!==s&&(n=dt(s));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(s=t&-t)||16===a&&0!==(4194240&s)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(r=31-it(t)),n|=e[r],t&=~a;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=r}function yt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-it(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,Et,Tt,kt,Nt,St=!1,_t=[],Ct=null,At=null,It=null,Rt=new Map,Ot=new Map,Dt=[],jt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Mt(e,t,r,n,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&Et(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var r=ze(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=He(r)))return e.blockedOn=t,void Nt(e.priority,function(){Tt(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ba(r))&&Et(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);we=n,r.target.dispatchEvent(n),we=null,t.shift()}return!0}function Ut(e,t,r){Ft(e)&&r.delete(t)}function Bt(){St=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==At&&Ft(At)&&(At=null),null!==It&&Ft(It)&&(It=null),Rt.forEach(Ut),Ot.forEach(Ut)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Bt)))}function zt(e){function t(t){return Vt(t,e)}if(0<_t.length){Vt(_t[0],e);for(var r=1;r<_t.length;r++){var n=_t[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ct&&Vt(Ct,e),null!==At&&Vt(At,e),null!==It&&Vt(It,e),Rt.forEach(t),Ot.forEach(t),r=0;r<Dt.length;r++)(n=Dt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Dt.length&&null===(r=Dt[0]).blockedOn;)Lt(r),null===r.blockedOn&&Dt.shift()}var Ht=w.ReactCurrentBatchConfig,Wt=!0;function Gt(e,t,r,n){var a=bt,s=Ht.transition;Ht.transition=null;try{bt=1,qt(e,t,r,n)}finally{bt=a,Ht.transition=s}}function Kt(e,t,r,n){var a=bt,s=Ht.transition;Ht.transition=null;try{bt=4,qt(e,t,r,n)}finally{bt=a,Ht.transition=s}}function qt(e,t,r,n){if(Wt){var a=$t(e,t,r,n);if(null===a)Wn(e,t,n,Xt,r),Pt(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return Ct=Mt(Ct,e,t,r,n,a),!0;case"dragenter":return At=Mt(At,e,t,r,n,a),!0;case"mouseover":return It=Mt(It,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Rt.set(s,Mt(Rt.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Ot.set(s,Mt(Ot.get(s)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Pt(e,n),4&t&&-1<jt.indexOf(e)){for(;null!==a;){var s=ba(a);if(null!==s&&xt(s),null===(s=$t(e,t,r,n))&&Wn(e,t,n,Xt,r),s===a)break;a=s}null!==a&&n.stopPropagation()}else Wn(e,t,n,null,r)}}var Xt=null;function $t(e,t,r,n){if(Xt=null,null!==(e=ya(e=xe(n))))if(null===(t=ze(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Jt,n=r.length,a="value"in Qt?Qt.value:Qt.textContent,s=a.length;for(e=0;e<n&&r[e]===a[e];e++);var i=n-e;for(t=1;t<=i&&r[n-t]===a[s-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ar(e){function t(t,r,n,a,s){for(var i in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var sr,ir,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ar(lr),ur=L({},lr,{view:0,detail:0}),dr=ar(ur),hr=L({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(sr=e.screenX-or.screenX,ir=e.screenY-or.screenY):ir=sr=0,or=e),sr)},movementY:function(e){return"movementY"in e?e.movementY:ir}}),fr=ar(hr),mr=ar(L({},hr,{dataTransfer:0})),pr=ar(L({},ur,{relatedTarget:0})),gr=ar(L({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=L({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=ar(vr),br=ar(L({},lr,{data:0})),wr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Er={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Er[e])&&!!t[e]}function kr(){return Tr}var Nr=L({},ur,{key:function(e){if(e.key){var t=wr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sr=ar(Nr),_r=ar(L({},hr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cr=ar(L({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kr})),Ar=ar(L({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ir=L({},hr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rr=ar(Ir),Or=[9,13,27,32],Dr=u&&"CompositionEvent"in window,jr=null;u&&"documentMode"in document&&(jr=document.documentMode);var Pr=u&&"TextEvent"in window&&!jr,Mr=u&&(!Dr||jr&&8<jr&&11>=jr),Lr=String.fromCharCode(32),Fr=!1;function Ur(e,t){switch(e){case"keyup":return-1!==Or.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Br(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vr=!1;var zr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zr[e.type]:"textarea"===t}function Wr(e,t,r,n){Se(n),0<(t=Kn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gr=null,Kr=null;function qr(e){Fn(e,0)}function Xr(e){if(q(wa(e)))return e}function $r(e,t){if("change"===e)return t}var Yr=!1;if(u){var Qr;if(u){var Jr="oninput"in document;if(!Jr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Jr="function"===typeof Zr.oninput}Qr=Jr}else Qr=!1;Yr=Qr&&(!document.documentMode||9<document.documentMode)}function en(){Gr&&(Gr.detachEvent("onpropertychange",tn),Kr=Gr=null)}function tn(e){if("value"===e.propertyName&&Xr(Kr)){var t=[];Wr(t,Kr,e,xe(e)),Re(qr,t)}}function rn(e,t,r){"focusin"===e?(en(),Kr=r,(Gr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xr(Kr)}function an(e,t){if("click"===e)return Xr(t)}function sn(e,t){if("input"===e||"change"===e)return Xr(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!d.call(t,a)||!on(e[a],t[a]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function dn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hn(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=X((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=hn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&dn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=void 0===n.end?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=un(r,s);var i=un(r,n);a&&i&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,vn=null,yn=null,bn=!1;function wn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==gn||gn!==X(n)||("selectionStart"in(n=gn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&ln(yn,n)||(yn=n,0<(n=Kn(vn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function xn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var En={animationend:xn("Animation","AnimationEnd"),animationiteration:xn("Animation","AnimationIteration"),animationstart:xn("Animation","AnimationStart"),transitionend:xn("Transition","TransitionEnd")},Tn={},kn={};function Nn(e){if(Tn[e])return Tn[e];if(!En[e])return e;var t,r=En[e];for(t in r)if(r.hasOwnProperty(t)&&t in kn)return Tn[e]=r[t];return e}u&&(kn=document.createElement("div").style,"AnimationEvent"in window||(delete En.animationend.animation,delete En.animationiteration.animation,delete En.animationstart.animation),"TransitionEvent"in window||delete En.transitionend.transition);var Sn=Nn("animationend"),_n=Nn("animationiteration"),Cn=Nn("animationstart"),An=Nn("transitionend"),In=new Map,Rn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function On(e,t){In.set(e,t),l(t,[e])}for(var Dn=0;Dn<Rn.length;Dn++){var jn=Rn[Dn];On(jn.toLowerCase(),"on"+(jn[0].toUpperCase()+jn.slice(1)))}On(Sn,"onAnimationEnd"),On(_n,"onAnimationIteration"),On(Cn,"onAnimationStart"),On("dblclick","onDoubleClick"),On("focusin","onFocus"),On("focusout","onBlur"),On(An,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pn));function Ln(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,a,i,o,l,c){if(Ve.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=Le;Me=!1,Le=null,Fe||(Fe=!0,Ue=u)}}(n,t,void 0,e),e.currentTarget=null}function Fn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Ln(a,o,c),s=l}else for(i=0;i<n.length;i++){if(l=(o=n[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Ln(a,o,c),s=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Un(e,t){var r=t[pa];void 0===r&&(r=t[pa]=new Set);var n=e+"__bubble";r.has(n)||(Hn(t,e,2,!1),r.add(n))}function Bn(e,t,r){var n=0;t&&(n|=4),Hn(r,e,n,t)}var Vn="_reactListening"+Math.random().toString(36).slice(2);function zn(e){if(!e[Vn]){e[Vn]=!0,i.forEach(function(t){"selectionchange"!==t&&(Mn.has(t)||Bn(t,!1,e),Bn(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vn]||(t[Vn]=!0,Bn("selectionchange",!1,t))}}function Hn(e,t,r,n){switch(Yt(t)){case 1:var a=Gt;break;case 4:a=Kt;break;default:a=qt}r=a.bind(null,t,r,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Wn(e,t,r,n,a){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var o=n.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===i)for(i=n.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;i=i.return}for(;null!==o;){if(null===(i=ya(o)))return;if(5===(l=i.tag)||6===l){n=s=i;continue e}o=o.parentNode}}n=n.return}Re(function(){var n=s,a=xe(r),i=[];e:{var o=In.get(e);if(void 0!==o){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Sr;break;case"focusin":c="focus",l=pr;break;case"focusout":c="blur",l=pr;break;case"beforeblur":case"afterblur":l=pr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cr;break;case Sn:case _n:case Cn:l=gr;break;case An:l=Ar;break;case"scroll":l=dr;break;case"wheel":l=Rr;break;case"copy":case"cut":case"paste":l=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=_r}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,m=n;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==h&&(null!=(p=Oe(m,h))&&u.push(Gn(m,p,f)))),d)break;m=m.return}0<u.length&&(o=new l(o,c,null,r,a),i.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===we||!(c=r.relatedTarget||r.fromElement)||!ya(c)&&!c[ma])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?ya(c):null)&&(c!==(d=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=fr,p="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=_r,p="onPointerLeave",h="onPointerEnter",m="pointer"),d=null==l?o:wa(l),f=null==c?o:wa(c),(o=new u(p,m+"leave",l,r,a)).target=d,o.relatedTarget=f,p=null,ya(a)===n&&((u=new u(h,m+"enter",c,r,a)).target=f,u.relatedTarget=d,p=u),d=p,l&&c)e:{for(h=c,m=0,f=u=l;f;f=qn(f))m++;for(f=0,p=h;p;p=qn(p))f++;for(;0<m-f;)u=qn(u),m--;for(;0<f-m;)h=qn(h),f--;for(;m--;){if(u===h||null!==h&&u===h.alternate)break e;u=qn(u),h=qn(h)}u=null}else u=null;null!==l&&Xn(i,o,l,u,!1),null!==c&&null!==d&&Xn(i,d,c,u,!0)}if("select"===(l=(o=n?wa(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=$r;else if(Hr(o))if(Yr)g=sn;else{g=nn;var v=rn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?Wr(i,g,r,a):(v&&v(e,o,n),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=n?wa(n):window,e){case"focusin":(Hr(v)||"true"===v.contentEditable)&&(gn=v,vn=n,yn=null);break;case"focusout":yn=vn=gn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,wn(i,r,a);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":wn(i,r,a)}var y;if(Dr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vr?Ur(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Mr&&"ko"!==r.locale&&(Vr||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vr&&(y=er()):(Jt="value"in(Qt=a)?Qt.value:Qt.textContent,Vr=!0)),0<(v=Kn(n,b)).length&&(b=new br(b,e,null,r,a),i.push({event:b,listeners:v}),y?b.data=y:null!==(y=Br(r))&&(b.data=y))),(y=Pr?function(e,t){switch(e){case"compositionend":return Br(t);case"keypress":return 32!==t.which?null:(Fr=!0,Lr);case"textInput":return(e=t.data)===Lr&&Fr?null:e;default:return null}}(e,r):function(e,t){if(Vr)return"compositionend"===e||!Dr&&Ur(e,t)?(e=er(),Zt=Jt=Qt=null,Vr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Kn(n,"onBeforeInput")).length&&(a=new br("onBeforeInput","beforeinput",null,r,a),i.push({event:a,listeners:n}),a.data=y))}Fn(i,t)})}function Gn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Kn(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=Oe(e,r))&&n.unshift(Gn(e,s,a)),null!=(s=Oe(e,t))&&n.push(Gn(e,s,a))),e=e.return}return n}function qn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xn(e,t,r,n,a){for(var s=t._reactName,i=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=Oe(r,s))&&i.unshift(Gn(r,l,o)):a||null!=(l=Oe(r,s))&&i.push(Gn(r,l,o))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var $n=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function Qn(e){return("string"===typeof e?e:""+e).replace($n,"\n").replace(Yn,"")}function Jn(e,t,r){if(t=Qn(t),Qn(e)!==t&&r)throw Error(s(425))}function Zn(){}var ea=null,ta=null;function ra(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,sa="function"===typeof Promise?Promise:void 0,ia="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sa?function(e){return sa.resolve(null).then(e).catch(oa)}:na;function oa(e){setTimeout(function(){throw e})}function la(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===n)return e.removeChild(a),void zt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=a}while(r);zt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,fa="__reactProps$"+da,ma="__reactContainer$"+da,pa="__reactEvents$"+da,ga="__reactListeners$"+da,va="__reactHandles$"+da;function ya(e){var t=e[ha];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ma]||r[ha]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=ua(e);null!==e;){if(r=e[ha])return r;e=ua(e)}return t}r=(e=r).parentNode}return null}function ba(e){return!(e=e[ha]||e[ma])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xa(e){return e[fa]||null}var Ea=[],Ta=-1;function ka(e){return{current:e}}function Na(e){0>Ta||(e.current=Ea[Ta],Ea[Ta]=null,Ta--)}function Sa(e,t){Ta++,Ea[Ta]=e.current,e.current=t}var _a={},Ca=ka(_a),Aa=ka(!1),Ia=_a;function Ra(e,t){var r=e.type.contextTypes;if(!r)return _a;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in r)s[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Oa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Na(Aa),Na(Ca)}function ja(e,t,r){if(Ca.current!==_a)throw Error(s(168));Sa(Ca,t),Sa(Aa,r)}function Pa(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(s(108,H(e)||"Unknown",a));return L({},r,n)}function Ma(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Ia=Ca.current,Sa(Ca,e),Sa(Aa,Aa.current),!0}function La(e,t,r){var n=e.stateNode;if(!n)throw Error(s(169));r?(e=Pa(e,t,Ia),n.__reactInternalMemoizedMergedChildContext=e,Na(Aa),Na(Ca),Sa(Ca,e)):Na(Aa),Sa(Aa,r)}var Fa=null,Ua=!1,Ba=!1;function Va(e){null===Fa?Fa=[e]:Fa.push(e)}function za(){if(!Ba&&null!==Fa){Ba=!0;var e=0,t=bt;try{var r=Fa;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Fa=null,Ua=!1}catch(a){throw null!==Fa&&(Fa=Fa.slice(e+1)),qe(Ze,za),a}finally{bt=t,Ba=!1}}return null}var Ha=[],Wa=0,Ga=null,Ka=0,qa=[],Xa=0,$a=null,Ya=1,Qa="";function Ja(e,t){Ha[Wa++]=Ka,Ha[Wa++]=Ga,Ga=e,Ka=t}function Za(e,t,r){qa[Xa++]=Ya,qa[Xa++]=Qa,qa[Xa++]=$a,$a=e;var n=Ya;e=Qa;var a=32-it(n)-1;n&=~(1<<a),r+=1;var s=32-it(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Ya=1<<32-it(t)+a|r<<a|n,Qa=s+e}else Ya=1<<s|r<<a|n,Qa=e}function es(e){null!==e.return&&(Ja(e,1),Za(e,1,0))}function ts(e){for(;e===Ga;)Ga=Ha[--Wa],Ha[Wa]=null,Ka=Ha[--Wa],Ha[Wa]=null;for(;e===$a;)$a=qa[--Xa],qa[Xa]=null,Qa=qa[--Xa],qa[Xa]=null,Ya=qa[--Xa],qa[Xa]=null}var rs=null,ns=null,as=!1,ss=null;function is(e,t){var r=Rc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function os(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,ns=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==$a?{id:Ya,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Rc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,rs=e,ns=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(as){var t=ns;if(t){var r=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ca(r.nextSibling);var n=rs;t&&os(e,t)?is(n,r):(e.flags=-4097&e.flags|2,as=!1,rs=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,rs=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function ds(e){if(e!==rs)return!1;if(!as)return us(e),as=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ra(e.type,e.memoizedProps)),t&&(t=ns)){if(ls(e))throw hs(),Error(s(418));for(;t;)is(e,t),t=ca(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){ns=ca(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}ns=null}}else ns=rs?ca(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=ns;e;)e=ca(e.nextSibling)}function fs(){ns=rs=null,as=!1}function ms(e){null===ss?ss=[e]:ss.push(e)}var ps=w.ReactCurrentBatchConfig;function gs(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(s(309));var n=r.stateNode}if(!n)throw Error(s(147,e));var a=n,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=a.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!r._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function i(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Lc(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function c(e,t,r,n){var s=r.type;return s===T?d(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===O&&ys(s)===t.type)?((n=a(t,r.props)).ref=gs(e,t,r),n.return=e,n):((n=jc(r.type,r.key,r.props,null,e.mode,n)).ref=gs(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Fc(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function d(e,t,r,n,s){return null===t||7!==t.tag?((t=Pc(r,e.mode,n,s)).return=e,t):((t=a(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(r=jc(t.type,t.key,t.props,null,e.mode,r)).ref=gs(e,null,t),r.return=e,r;case E:return(t=Fc(t,e.mode,r)).return=e,t;case O:return h(e,(0,t._init)(t._payload),r)}if(te(t)||P(t))return(t=Pc(t,e.mode,r,null)).return=e,t;vs(e,t)}return null}function f(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==a?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return r.key===a?c(e,t,r,n):null;case E:return r.key===a?u(e,t,r,n):null;case O:return f(e,t,(a=r._init)(r._payload),n)}if(te(r)||P(r))return null!==a?null:d(e,t,r,n,null);vs(e,r)}return null}function m(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return c(t,e=e.get(null===n.key?r:n.key)||null,n,a);case E:return u(t,e=e.get(null===n.key?r:n.key)||null,n,a);case O:return m(e,t,r,(0,n._init)(n._payload),a)}if(te(n)||P(n))return d(t,e=e.get(r)||null,n,a,null);vs(t,n)}return null}function p(a,s,o,l){for(var c=null,u=null,d=s,p=s=0,g=null;null!==d&&p<o.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var v=f(a,d,o[p],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(a,d),s=i(v,s,p),null===u?c=v:u.sibling=v,u=v,d=g}if(p===o.length)return r(a,d),as&&Ja(a,p),c;if(null===d){for(;p<o.length;p++)null!==(d=h(a,o[p],l))&&(s=i(d,s,p),null===u?c=d:u.sibling=d,u=d);return as&&Ja(a,p),c}for(d=n(a,d);p<o.length;p++)null!==(g=m(d,a,p,o[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),s=i(g,s,p),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(a,e)}),as&&Ja(a,p),c}function g(a,o,l,c){var u=P(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,p=o,g=o=0,v=null,y=l.next();null!==p&&!y.done;g++,y=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var b=f(a,p,y.value,c);if(null===b){null===p&&(p=v);break}e&&p&&null===b.alternate&&t(a,p),o=i(b,o,g),null===d?u=b:d.sibling=b,d=b,p=v}if(y.done)return r(a,p),as&&Ja(a,g),u;if(null===p){for(;!y.done;g++,y=l.next())null!==(y=h(a,y.value,c))&&(o=i(y,o,g),null===d?u=y:d.sibling=y,d=y);return as&&Ja(a,g),u}for(p=n(a,p);!y.done;g++,y=l.next())null!==(y=m(p,a,g,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),o=i(y,o,g),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(a,e)}),as&&Ja(a,g),u}return function e(n,s,i,l){if("object"===typeof i&&null!==i&&i.type===T&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case x:e:{for(var c=i.key,u=s;null!==u;){if(u.key===c){if((c=i.type)===T){if(7===u.tag){r(n,u.sibling),(s=a(u,i.props.children)).return=n,n=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&ys(c)===u.type){r(n,u.sibling),(s=a(u,i.props)).ref=gs(n,u,i),s.return=n,n=s;break e}r(n,u);break}t(n,u),u=u.sibling}i.type===T?((s=Pc(i.props.children,n.mode,l,i.key)).return=n,n=s):((l=jc(i.type,i.key,i.props,null,n.mode,l)).ref=gs(n,s,i),l.return=n,n=l)}return o(n);case E:e:{for(u=i.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation){r(n,s.sibling),(s=a(s,i.children||[])).return=n,n=s;break e}r(n,s);break}t(n,s),s=s.sibling}(s=Fc(i,n.mode,l)).return=n,n=s}return o(n);case O:return e(n,s,(u=i._init)(i._payload),l)}if(te(i))return p(n,s,i,l);if(P(i))return g(n,s,i,l);vs(n,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==s&&6===s.tag?(r(n,s.sibling),(s=a(s,i)).return=n,n=s):(r(n,s),(s=Lc(i,n.mode,l)).return=n,n=s),o(n)):r(n,s)}}var ws=bs(!0),xs=bs(!1),Es=ka(null),Ts=null,ks=null,Ns=null;function Ss(){Ns=ks=Ts=null}function _s(e){var t=Es.current;Na(Es),e._currentValue=t}function Cs(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function As(e,t){Ts=e,Ns=ks=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(Ns!==e)if(e={context:e,memoizedValue:t,next:null},null===ks){if(null===Ts)throw Error(s(308));ks=e,Ts.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var Rs=null;function Os(e){null===Rs?Rs=[e]:Rs.push(e)}function Ds(e,t,r,n){var a=t.interleaved;return null===a?(r.next=r,Os(t)):(r.next=a.next,a.next=r),t.interleaved=r,js(e,n)}function js(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Ps=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Cl)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,js(e,r)}return null===(a=n.interleaved)?(t.next=t,Os(n)):(t.next=a.next,a.next=t),n.interleaved=t,js(e,r)}function Bs(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}function Vs(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===s?a=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?a=s=t:s=s.next=t}else a=s=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function zs(e,t,r,n){var a=e.updateQueue;Ps=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=a.baseState;for(i=0,u=c=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((n&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(h=t,f=r,p.tag){case 1:if("function"===typeof(m=p.payload)){d=m.call(f,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=p.payload)?m.call(f,d,h):m)||void 0===h)break e;d=L({},d,h);break e;case 2:Ps=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,i|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{i|=a.lane,a=a.next}while(a!==t)}else null===s&&(a.shared.lanes=0);Ml|=i,e.lanes=i,e.memoizedState=d}}function Hs(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=r,"function"!==typeof a)throw Error(s(191,a));a.call(n)}}}var Ws={},Gs=ka(Ws),Ks=ka(Ws),qs=ka(Ws);function Xs(e){if(e===Ws)throw Error(s(174));return e}function $s(e,t){switch(Sa(qs,t),Sa(Ks,e),Sa(Gs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Na(Gs),Sa(Gs,t)}function Ys(){Na(Gs),Na(Ks),Na(qs)}function Qs(e){Xs(qs.current);var t=Xs(Gs.current),r=le(t,e.type);t!==r&&(Sa(Ks,e),Sa(Gs,r))}function Js(e){Ks.current===e&&(Na(Gs),Na(Ks))}var Zs=ka(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ri(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ni=w.ReactCurrentDispatcher,ai=w.ReactCurrentBatchConfig,si=0,ii=null,oi=null,li=null,ci=!1,ui=!1,di=0,hi=0;function fi(){throw Error(s(321))}function mi(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!on(e[r],t[r]))return!1;return!0}function pi(e,t,r,n,a,i){if(si=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ni.current=null===e||null===e.memoizedState?Ji:Zi,e=r(n,a),ui){i=0;do{if(ui=!1,di=0,25<=i)throw Error(s(301));i+=1,li=oi=null,t.updateQueue=null,ni.current=eo,e=r(n,a)}while(ui)}if(ni.current=Qi,t=null!==oi&&null!==oi.next,si=0,li=oi=ii=null,ci=!1,t)throw Error(s(300));return e}function gi(){var e=0!==di;return di=0,e}function vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function yi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function bi(e,t){return"function"===typeof t?t(e):t}function wi(e){var t=yi(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var n=oi,a=n.baseQueue,i=r.pending;if(null!==i){if(null!==a){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(null!==a){i=a.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((si&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=n):c=c.next=h,ii.lanes|=d,Ml|=d}u=u.next}while(null!==u&&u!==i);null===c?o=n:c.next=l,on(n,t.memoizedState)||(bo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){a=e;do{i=a.lane,ii.lanes|=i,Ml|=i,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function xi(e){var t=yi(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(null!==a){r.pending=null;var o=a=a.next;do{i=e(i,o.action),o=o.next}while(o!==a);on(i,t.memoizedState)||(bo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Ei(){}function Ti(e,t){var r=ii,n=yi(),a=t(),i=!on(n.memoizedState,a);if(i&&(n.memoizedState=a,bo=!0),n=n.queue,Pi(Si.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(r.flags|=2048,Ii(9,Ni.bind(null,r,n,a,t),void 0,null),null===Al)throw Error(s(349));0!==(30&si)||ki(r,t,a)}return a}function ki(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ni(e,t,r,n){t.value=r,t.getSnapshot=n,_i(t)&&Ci(e)}function Si(e,t,r){return r(function(){_i(t)&&Ci(e)})}function _i(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!on(e,r)}catch(n){return!0}}function Ci(e){var t=js(e,1);null!==t&&rc(t,e,1,-1)}function Ai(e){var t=vi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=qi.bind(null,ii,e),[t.memoizedState,e]}function Ii(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Ri(){return yi().memoizedState}function Oi(e,t,r,n){var a=vi();ii.flags|=e,a.memoizedState=Ii(1|t,r,void 0,void 0===n?null:n)}function Di(e,t,r,n){var a=yi();n=void 0===n?null:n;var s=void 0;if(null!==oi){var i=oi.memoizedState;if(s=i.destroy,null!==n&&mi(n,i.deps))return void(a.memoizedState=Ii(t,r,s,n))}ii.flags|=e,a.memoizedState=Ii(1|t,r,s,n)}function ji(e,t){return Oi(8390656,8,e,t)}function Pi(e,t){return Di(2048,8,e,t)}function Mi(e,t){return Di(4,2,e,t)}function Li(e,t){return Di(4,4,e,t)}function Fi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ui(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Di(4,4,Fi.bind(null,t,e),r)}function Bi(){}function Vi(e,t){var r=yi();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&mi(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function zi(e,t){var r=yi();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&mi(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Hi(e,t,r){return 0===(21&si)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=r):(on(r,t)||(r=pt(),ii.lanes|=r,Ml|=r,e.baseState=!0),t)}function Wi(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=ai.transition;ai.transition={};try{e(!1),t()}finally{bt=r,ai.transition=n}}function Gi(){return yi().memoizedState}function Ki(e,t,r){var n=tc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Xi(e))$i(t,r);else if(null!==(r=Ds(e,t,r,n))){rc(r,e,n,ec()),Yi(r,t,n)}}function qi(e,t,r){var n=tc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Xi(e))$i(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,on(o,i)){var l=t.interleaved;return null===l?(a.next=a,Os(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(r=Ds(e,t,a,n))&&(rc(r,e,n,a=ec()),Yi(r,t,n))}}function Xi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function $i(e,t){ui=ci=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Yi(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}var Qi={readContext:Is,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},Ji={readContext:Is,useCallback:function(e,t){return vi().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:ji,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Oi(4194308,4,Fi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Oi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oi(4,2,e,t)},useMemo:function(e,t){var r=vi();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=vi();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},vi().memoizedState=e},useState:Ai,useDebugValue:Bi,useDeferredValue:function(e){return vi().memoizedState=e},useTransition:function(){var e=Ai(!1),t=e[0];return e=Wi.bind(null,e[1]),vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ii,a=vi();if(as){if(void 0===r)throw Error(s(407));r=r()}else{if(r=t(),null===Al)throw Error(s(349));0!==(30&si)||ki(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,ji(Si.bind(null,n,i,e),[e]),n.flags|=2048,Ii(9,Ni.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=vi(),t=Al.identifierPrefix;if(as){var r=Qa;t=":"+t+"R"+(r=(Ya&~(1<<32-it(Ya)-1)).toString(32)+r),0<(r=di++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:Is,useCallback:Vi,useContext:Is,useEffect:Pi,useImperativeHandle:Ui,useInsertionEffect:Mi,useLayoutEffect:Li,useMemo:zi,useReducer:wi,useRef:Ri,useState:function(){return wi(bi)},useDebugValue:Bi,useDeferredValue:function(e){return Hi(yi(),oi.memoizedState,e)},useTransition:function(){return[wi(bi)[0],yi().memoizedState]},useMutableSource:Ei,useSyncExternalStore:Ti,useId:Gi,unstable_isNewReconciler:!1},eo={readContext:Is,useCallback:Vi,useContext:Is,useEffect:Pi,useImperativeHandle:Ui,useInsertionEffect:Mi,useLayoutEffect:Li,useMemo:zi,useReducer:xi,useRef:Ri,useState:function(){return xi(bi)},useDebugValue:Bi,useDeferredValue:function(e){var t=yi();return null===oi?t.memoizedState=e:Hi(t,oi.memoizedState,e)},useTransition:function(){return[xi(bi)[0],yi().memoizedState]},useMutableSource:Ei,useSyncExternalStore:Ti,useId:Gi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var r in t=L({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ro(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:L({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var no={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ec(),a=tc(e),s=Fs(n,a);s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Us(e,s,a))&&(rc(t,e,a,n),Bs(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ec(),a=tc(e),s=Fs(n,a);s.tag=1,s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Us(e,s,a))&&(rc(t,e,a,n),Bs(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),n=tc(e),a=Fs(r,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Us(e,a,n))&&(rc(t,e,n,r),Bs(t,e,n))}};function ao(e,t,r,n,a,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!ln(r,n)||!ln(a,s))}function so(e,t,r){var n=!1,a=_a,s=t.contextType;return"object"===typeof s&&null!==s?s=Is(s):(a=Oa(t)?Ia:Ca.current,s=(n=null!==(n=t.contextTypes)&&void 0!==n)?Ra(e,a):_a),t=new t(r,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=no,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function io(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&no.enqueueReplaceState(t,t.state,null)}function oo(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?a.context=Is(s):(s=Oa(t)?Ia:Ca.current,a.context=Ra(e,s)),a.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ro(e,t,s,r),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&no.enqueueReplaceState(a,a.state,null),zs(e,r,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var r="",n=t;do{r+=V(n),n=n.return}while(n);var a=r}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:a,digest:null}}function co(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,r){(r=Fs(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Wl||(Wl=!0,Gl=n),uo(0,t)},r}function mo(e,t,r){(r=Fs(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(r.callback=function(){uo(0,t),"function"!==typeof n&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function po(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ho;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Nc.bind(null,e,t,r),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,r,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Fs(-1,1)).tag=2,Us(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yo=w.ReactCurrentOwner,bo=!1;function wo(e,t,r,n){t.child=null===e?xs(t,null,r,n):ws(t,e.child,r,n)}function xo(e,t,r,n,a){r=r.render;var s=t.ref;return As(t,a),n=pi(e,t,r,n,s,a),r=gi(),null===e||bo?(as&&r&&es(t),t.flags|=1,wo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function Eo(e,t,r,n,a){if(null===e){var s=r.type;return"function"!==typeof s||Oc(s)||void 0!==s.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=jc(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,To(e,t,s,n,a))}if(s=e.child,0===(e.lanes&a)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(i,n)&&e.ref===t.ref)return Wo(e,t,a)}return t.flags|=1,(e=Dc(s,n)).ref=t.ref,e.return=t,t.child=e}function To(e,t,r,n,a){if(null!==e){var s=e.memoizedProps;if(ln(s,n)&&e.ref===t.ref){if(bo=!1,t.pendingProps=n=s,0===(e.lanes&a))return t.lanes=e.lanes,Wo(e,t,a);0!==(131072&e.flags)&&(bo=!0)}}return So(e,t,r,n,a)}function ko(e,t,r){var n=t.pendingProps,a=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sa(Dl,Ol),Ol|=r;else{if(0===(1073741824&r))return e=null!==s?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sa(Dl,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==s?s.baseLanes:r,Sa(Dl,Ol),Ol|=n}else null!==s?(n=s.baseLanes|r,t.memoizedState=null):n=r,Sa(Dl,Ol),Ol|=n;return wo(e,t,a,r),t.child}function No(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function So(e,t,r,n,a){var s=Oa(r)?Ia:Ca.current;return s=Ra(t,s),As(t,a),r=pi(e,t,r,n,s,a),n=gi(),null===e||bo?(as&&n&&es(t),t.flags|=1,wo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function _o(e,t,r,n,a){if(Oa(r)){var s=!0;Ma(t)}else s=!1;if(As(t,a),null===t.stateNode)Ho(e,t),so(t,r,n),oo(t,r,n,a),n=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;"object"===typeof c&&null!==c?c=Is(c):c=Ra(t,c=Oa(r)?Ia:Ca.current);var u=r.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==n||l!==c)&&io(t,i,n,c),Ps=!1;var h=t.memoizedState;i.state=h,zs(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Aa.current||Ps?("function"===typeof u&&(ro(t,r,u,n),l=t.memoizedState),(o=Ps||ao(t,r,o,n,h,l,c))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Ls(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,d=t.pendingProps,h=i.context,"object"===typeof(l=r.contextType)&&null!==l?l=Is(l):l=Ra(t,l=Oa(r)?Ia:Ca.current);var f=r.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==d||h!==l)&&io(t,i,n,l),Ps=!1,h=t.memoizedState,i.state=h,zs(t,n,i,a);var m=t.memoizedState;o!==d||h!==m||Aa.current||Ps?("function"===typeof f&&(ro(t,r,f,n),m=t.memoizedState),(c=Ps||ao(t,r,c,n,h,m,l)||!1)?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(n,m,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,m,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=l,n=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Co(e,t,r,n,s,a)}function Co(e,t,r,n,a,s){No(e,t);var i=0!==(128&t.flags);if(!n&&!i)return a&&La(t,r,!1),Wo(e,t,s);n=t.stateNode,yo.current=t;var o=i&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,o,s)):wo(e,t,o,s),t.memoizedState=n.state,a&&La(t,r,!0),t.child}function Ao(e){var t=e.stateNode;t.pendingContext?ja(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ja(0,t.context,!1),$s(e,t.containerInfo)}function Io(e,t,r,n,a){return fs(),ms(a),t.flags|=256,wo(e,t,r,n),t.child}var Ro,Oo,Do,jo,Po={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,r){var n,a=t.pendingProps,i=Zs.current,o=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&i)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Sa(Zs,1&i),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,a,0,null),e=Pc(e,a,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(r),t.memoizedState=Po,e):Fo(t,l));if(null!==(i=e.memoizedState)&&null!==(n=i.dehydrated))return function(e,t,r,n,a,i,o){if(r)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,n=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Mc({mode:"visible",children:n.children},a,0,null),(i=Pc(i,a,o,null)).flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,0!==(1&t.mode)&&ws(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Po,i);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var l=n.dgst;return n=l,Uo(e,t,o,n=co(i=Error(s(419)),n,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(n=Al)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|o))?0:a)&&a!==i.retryLane&&(i.retryLane=a,js(e,a),rc(n,e,a,-1))}return pc(),Uo(e,t,o,n=co(Error(s(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ns=ca(a.nextSibling),rs=t,as=!0,ss=null,null!==e&&(qa[Xa++]=Ya,qa[Xa++]=Qa,qa[Xa++]=$a,Ya=e.id,Qa=e.overflow,$a=t),t=Fo(t,n.children),t.flags|=4096,t)}(e,t,l,a,n,i,r);if(o){o=a.fallback,l=t.mode,n=(i=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==i?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Dc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==n?o=Dc(n,o):(o=Pc(o,l,r,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=Po,a}return e=(o=e.child).sibling,a=Dc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Fo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,r,n){return null!==n&&ms(n),ws(t,e.child,null,r),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Cs(e.return,t,r)}function Vo(e,t,r,n,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function zo(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(wo(e,t,n.children,r),0!==(2&(n=Zs.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,r,t);else if(19===e.tag)Bo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Sa(Zs,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===ei(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Vo(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ei(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Vo(t,!0,r,null,s);break;case"together":Vo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(r=Dc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Dc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Go(e,t){if(!as)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function qo(e,t,r){var n=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Oa(t.type)&&Da(),Ko(t),null;case 3:return n=t.stateNode,Ys(),Na(Aa),Na(Ca),ri(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ic(ss),ss=null))),Oo(e,t),Ko(t),null;case 5:Js(t);var a=Xs(qs.current);if(r=t.type,null!==e&&null!=t.stateNode)Do(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(s(166));return Ko(t),null}if(e=Xs(Gs.current),ds(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ha]=t,n[fa]=i,e=0!==(1&t.mode),r){case"dialog":Un("cancel",n),Un("close",n);break;case"iframe":case"object":case"embed":Un("load",n);break;case"video":case"audio":for(a=0;a<Pn.length;a++)Un(Pn[a],n);break;case"source":Un("error",n);break;case"img":case"image":case"link":Un("error",n),Un("load",n);break;case"details":Un("toggle",n);break;case"input":Y(n,i),Un("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Un("invalid",n);break;case"textarea":ae(n,i),Un("invalid",n)}for(var l in ye(r,i),a=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==i.suppressHydrationWarning&&Jn(n.textContent,c,e),a=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Jn(n.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Un("scroll",n)}switch(r){case"input":K(n),Z(n,i,!0);break;case"textarea":K(n),ie(n);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(n.onclick=Zn)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[ha]=t,e[fa]=n,Ro(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(r,n),r){case"dialog":Un("cancel",e),Un("close",e),a=n;break;case"iframe":case"object":case"embed":Un("load",e),a=n;break;case"video":case"audio":for(a=0;a<Pn.length;a++)Un(Pn[a],e);a=n;break;case"source":Un("error",e),a=n;break;case"img":case"image":case"link":Un("error",e),Un("load",e),a=n;break;case"details":Un("toggle",e),a=n;break;case"input":Y(e,n),a=$(e,n),Un("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=L({},n,{value:void 0}),Un("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),Un("invalid",e)}for(i in ye(r,a),c=a)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?ge(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"===typeof u?("textarea"!==r||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Un("scroll",e):null!=u&&b(e,i,u,l))}switch(r){case"input":K(e),Z(e,n,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(i=n.value)?re(e,!!n.multiple,i,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)jo(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(s(166));if(r=Xs(qs.current),Xs(Gs.current),ds(t)){if(n=t.stateNode,r=t.memoizedProps,n[ha]=t,(i=n.nodeValue!==r)&&null!==(e=rs))switch(e.tag){case 3:Jn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,r,0!==(1&e.mode))}i&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[ha]=t,t.stateNode=n}return Ko(t),null;case 13:if(Na(Zs),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==ns&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,i=!1;else if(i=ds(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[ha]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),i=!1}else null!==ss&&(ic(ss),ss=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===jl&&(jl=3):pc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Ys(),Oo(e,t),null===e&&zn(t.stateNode.containerInfo),Ko(t),null;case 10:return _s(t.type._context),Ko(t),null;case 19:if(Na(Zs),null===(i=t.memoizedState))return Ko(t),null;if(n=0!==(128&t.flags),null===(l=i.rendering))if(n)Go(i,!1);else{if(0!==jl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Go(i,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(i=r).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Sa(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==i.tail&&Qe()>zl&&(t.flags|=128,n=!0,Go(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ei(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Go(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!as)return Ko(t),null}else 2*Qe()-i.renderingStartTime>zl&&1073741824!==r&&(t.flags|=128,n=!0,Go(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=i.last)?r.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qe(),t.sibling=null,r=Zs.current,Sa(Zs,n?1&r|2:1&r),t):(Ko(t),null);case 22:case 23:return dc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Ol)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Xo(e,t){switch(ts(t),t.tag){case 1:return Oa(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Na(Aa),Na(Ca),ri(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Js(t),null;case 13:if(Na(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Na(Zs),null;case 4:return Ys(),null;case 10:return _s(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Ro=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Oo=function(){},Do=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Xs(Gs.current);var s,i=null;switch(r){case"input":a=$(e,a),n=$(e,n),i=[];break;case"select":a=L({},a,{value:void 0}),n=L({},n,{value:void 0}),i=[];break;case"textarea":a=ne(e,a),n=ne(e,n),i=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(u in ye(r,n),r=null,a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=a?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(u,r)),r=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Un("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},jo=function(e,t,r,n){r!==n&&(t.flags|=4)};var $o=!1,Yo=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){kc(e,t,n)}else r.current=null}function el(e,t,r){try{r()}catch(n){kc(e,t,n)}}var tl=!1;function rl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&el(t,r,s)}a=a.next}while(a!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function al(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[fa],delete t[pa],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var ul=null,dl=!1;function hl(e,t,r){for(r=r.child;null!==r;)fl(e,t,r),r=r.sibling}function fl(e,t,r){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(at,r)}catch(o){}switch(r.tag){case 5:Yo||Zo(r,t);case 6:var n=ul,a=dl;ul=null,hl(e,t,r),dl=a,null!==(ul=n)&&(dl?(e=ul,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):ul.removeChild(r.stateNode));break;case 18:null!==ul&&(dl?(e=ul,r=r.stateNode,8===e.nodeType?la(e.parentNode,r):1===e.nodeType&&la(e,r),zt(e)):la(ul,r.stateNode));break;case 4:n=ul,a=dl,ul=r.stateNode.containerInfo,dl=!0,hl(e,t,r),ul=n,dl=a;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,void 0!==i&&(0!==(2&s)||0!==(4&s))&&el(r,t,i),a=a.next}while(a!==n)}hl(e,t,r);break;case 1:if(!Yo&&(Zo(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){kc(r,t,o)}hl(e,t,r);break;case 21:hl(e,t,r);break;case 22:1&r.mode?(Yo=(n=Yo)||null!==r.memoizedState,hl(e,t,r),Yo=n):hl(e,t,r);break;default:hl(e,t,r)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Qo),t.forEach(function(t){var n=Cc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function pl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(i,o,a),ul=null,dl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){kc(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),vl(e),4&n){try{rl(3,e,e.return),nl(3,e)}catch(g){kc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:pl(t,e),vl(e),512&n&&null!==r&&Zo(r,r.return);break;case 5:if(pl(t,e),vl(e),512&n&&null!==r&&Zo(r,r.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){kc(e,e.return,g)}}if(4&n&&null!=(a=e.stateNode)){var i=e.memoizedProps,o=null!==r?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&Q(a,i),be(l,o);var u=be(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):b(a,d,h,u)}switch(l){case"input":J(a,i);break;case"textarea":se(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;null!=m?re(a,!!i.multiple,m,!1):f!==!!i.multiple&&(null!=i.defaultValue?re(a,!!i.multiple,i.defaultValue,!0):re(a,!!i.multiple,i.multiple?[]:"",!1))}a[fa]=i}catch(g){kc(e,e.return,g)}}break;case 6:if(pl(t,e),vl(e),4&n){if(null===e.stateNode)throw Error(s(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){kc(e,e.return,g)}}break;case 3:if(pl(t,e),vl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:pl(t,e),vl(e);break;case 13:pl(t,e),vl(e),8192&(a=e.child).flags&&(i=null!==a.memoizedState,a.stateNode.isHidden=i,!i||null!==a.alternate&&null!==a.alternate.memoizedState||(Vl=Qe())),4&n&&ml(e);break;case 22:if(d=null!==r&&null!==r.memoizedState,1&e.mode?(Yo=(u=Yo)||d,pl(t,e),Yo=u):pl(t,e),vl(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Jo=e,d=e.child;null!==d;){for(h=Jo=d;null!==Jo;){switch(m=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:Zo(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){n=f,r=f.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){kc(n,r,g)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){xl(h);continue}}null!==m?(m.return=f,Jo=m):xl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(g){kc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),vl(e),4&n&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(il(r)){var n=r;break e}r=r.return}throw Error(s(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(he(a,""),n.flags&=-33),cl(e,ol(e),a);break;case 3:case 4:var i=n.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(s(161))}}catch(o){kc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,r){Jo=e,bl(e,t,r)}function bl(e,t,r){for(var n=0!==(1&e.mode);null!==Jo;){var a=Jo,s=a.child;if(22===a.tag&&n){var i=null!==a.memoizedState||$o;if(!i){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=$o;var c=Yo;if($o=i,(Yo=l)&&!c)for(Jo=a;null!==Jo;)l=(i=Jo).child,22===i.tag&&null!==i.memoizedState?El(a):null!==l?(l.return=i,Jo=l):El(a);for(;null!==s;)Jo=s,bl(s,t,r),s=s.sibling;Jo=a,$o=o,Yo=c}wl(e)}else 0!==(8772&a.subtreeFlags)&&null!==s?(s.return=a,Jo=s):wl(e)}}function wl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Yo)if(null===r)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:to(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Hs(t,i,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Hs(t,o,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(s(163))}Yo||512&t.flags&&al(t)}catch(f){kc(t,t.return,f)}}if(t===e){Jo=null;break}if(null!==(r=t.sibling)){r.return=t.return,Jo=r;break}Jo=t.return}}function xl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Jo=r;break}Jo=t.return}}function El(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nl(4,t)}catch(l){kc(t,r,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(l){kc(t,a,l)}}var s=t.return;try{al(t)}catch(l){kc(t,s,l)}break;case 5:var i=t.return;try{al(t)}catch(l){kc(t,i,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var Tl,kl=Math.ceil,Nl=w.ReactCurrentDispatcher,Sl=w.ReactCurrentOwner,_l=w.ReactCurrentBatchConfig,Cl=0,Al=null,Il=null,Rl=0,Ol=0,Dl=ka(0),jl=0,Pl=null,Ml=0,Ll=0,Fl=0,Ul=null,Bl=null,Vl=0,zl=1/0,Hl=null,Wl=!1,Gl=null,Kl=null,ql=!1,Xl=null,$l=0,Yl=0,Ql=null,Jl=-1,Zl=0;function ec(){return 0!==(6&Cl)?Qe():-1!==Jl?Jl:Jl=Qe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Rl?Rl&-Rl:null!==ps.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,r,n){if(50<Yl)throw Yl=0,Ql=null,Error(s(185));vt(e,r,n),0!==(2&Cl)&&e===Al||(e===Al&&(0===(2&Cl)&&(Ll|=r),4===jl&&oc(e,Rl)),nc(e,n),1===r&&0===Cl&&0===(1&t.mode)&&(zl=Qe()+500,Ua&&za()))}function nc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-it(s),o=1<<i,l=a[i];-1===l?0!==(o&r)&&0===(o&n)||(a[i]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var n=ht(e,e===Al?Rl:0);if(0===n)null!==r&&Xe(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Xe(r),1===t)0===e.tag?function(e){Ua=!0,Va(e)}(lc.bind(null,e)):Va(lc.bind(null,e)),ia(function(){0===(6&Cl)&&za()}),r=null;else{switch(wt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Ac(r,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ac(e,t){if(Jl=-1,Zl=0,0!==(6&Cl))throw Error(s(327));var r=e.callbackNode;if(Ec()&&e.callbackNode!==r)return null;var n=ht(e,e===Al?Rl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var a=Cl;Cl|=2;var i=mc();for(Al===e&&Rl===t||(Hl=null,zl=Qe()+500,hc(e,t));;)try{yc();break}catch(l){fc(e,l)}Ss(),Nl.current=i,Cl=a,null!==Il?t=0:(Al=null,Rl=0,t=jl)}if(0!==t){if(2===t&&(0!==(a=mt(e))&&(n=a,t=sc(e,a))),1===t)throw r=Pl,hc(e,0),oc(e,n),nc(e,Qe()),r;if(6===t)oc(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!on(s(),a))return!1}catch(o){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,n))&&(0!==(i=mt(e))&&(n=i,t=sc(e,i))),1===t))throw r=Pl,hc(e,0),oc(e,n),nc(e,Qe()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,Bl,Hl);break;case 3:if(oc(e,n),(130023424&n)===n&&10<(t=Vl+500-Qe())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=na(xc.bind(null,e,Bl,Hl),t);break}xc(e,Bl,Hl);break;case 4:if(oc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-it(n);i=1<<o,(o=t[o])>a&&(a=o),n&=~i}if(n=a,10<(n=(120>(n=Qe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*kl(n/1960))-n)){e.timeoutHandle=na(xc.bind(null,e,Bl,Hl),n);break}xc(e,Bl,Hl);break;default:throw Error(s(329))}}}return nc(e,Qe()),e.callbackNode===r?ac.bind(null,e):null}function sc(e,t){var r=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Bl,Bl=r,null!==t&&ic(t)),e}function ic(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function oc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-it(t),n=1<<r;e[r]=-1,t&=~n}}function lc(e){if(0!==(6&Cl))throw Error(s(327));Ec();var t=ht(e,0);if(0===(1&t))return nc(e,Qe()),null;var r=gc(e,t);if(0!==e.tag&&2===r){var n=mt(e);0!==n&&(t=n,r=sc(e,n))}if(1===r)throw r=Pl,hc(e,0),oc(e,t),nc(e,Qe()),r;if(6===r)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Bl,Hl),nc(e,Qe()),null}function cc(e,t){var r=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=r)&&(zl=Qe()+500,Ua&&za())}}function uc(e){null!==Xl&&0===Xl.tag&&0===(6&Cl)&&Ec();var t=Cl;Cl|=1;var r=_l.transition,n=bt;try{if(_l.transition=null,bt=1,e)return e()}finally{bt=n,_l.transition=r,0===(6&(Cl=t))&&za()}}function dc(){Ol=Dl.current,Na(Dl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,aa(r)),null!==Il)for(r=Il.return;null!==r;){var n=r;switch(ts(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Da();break;case 3:Ys(),Na(Aa),Na(Ca),ri();break;case 5:Js(n);break;case 4:Ys();break;case 13:case 19:Na(Zs);break;case 10:_s(n.type._context);break;case 22:case 23:dc()}r=r.return}if(Al=e,Il=e=Dc(e.current,null),Rl=Ol=t,jl=0,Pl=null,Fl=Ll=Ml=0,Bl=Ul=null,null!==Rs){for(t=0;t<Rs.length;t++)if(null!==(n=(r=Rs[t]).interleaved)){r.interleaved=null;var a=n.next,s=r.pending;if(null!==s){var i=s.next;s.next=a,n.next=i}r.pending=n}Rs=null}return e}function fc(e,t){for(;;){var r=Il;try{if(Ss(),ni.current=Qi,ci){for(var n=ii.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}ci=!1}if(si=0,li=oi=ii=null,ui=!1,di=0,Sl.current=null,null===r||null===r.return){jl=1,Pl=t,Il=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,vo(m,o,l,0,t),1&m.mode&&po(i,u,t),c=u;var p=(t=m).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0===(1&t)){po(i,u,t),pc();break e}c=Error(s(426))}else if(as&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),ms(lo(c,l));break e}}i=c=lo(c,l),4!==jl&&(jl=2),null===Ul?Ul=[i]:Ul.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Vs(i,fo(0,c,t));break e;case 1:l=c;var y=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kl||!Kl.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Vs(i,mo(i,l,t));break e}}i=i.return}while(null!==i)}wc(r)}catch(w){t=w,Il===r&&null!==r&&(Il=r=r.return);continue}break}}function mc(){var e=Nl.current;return Nl.current=Qi,null===e?Qi:e}function pc(){0!==jl&&3!==jl&&2!==jl||(jl=4),null===Al||0===(268435455&Ml)&&0===(268435455&Ll)||oc(Al,Rl)}function gc(e,t){var r=Cl;Cl|=2;var n=mc();for(Al===e&&Rl===t||(Hl=null,hc(e,t));;)try{vc();break}catch(a){fc(e,a)}if(Ss(),Cl=r,Nl.current=n,null!==Il)throw Error(s(261));return Al=null,Rl=0,jl}function vc(){for(;null!==Il;)bc(Il)}function yc(){for(;null!==Il&&!$e();)bc(Il)}function bc(e){var t=Tl(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?wc(e):Il=t,Sl.current=null}function wc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=qo(r,t,Ol)))return void(Il=r)}else{if(null!==(r=Xo(r,t)))return r.flags&=32767,void(Il=r);if(null===e)return jl=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===jl&&(jl=5)}function xc(e,t,r){var n=bt,a=_l.transition;try{_l.transition=null,bt=1,function(e,t,r,n){do{Ec()}while(null!==Xl);if(0!==(6&Cl))throw Error(s(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-it(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}(e,i),e===Al&&(Il=Al=null,Rl=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||ql||(ql=!0,Ac(tt,function(){return Ec(),null})),i=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||i){i=_l.transition,_l.transition=null;var o=bt;bt=1;var l=Cl;Cl|=4,Sl.current=null,function(e,t){if(ea=Wt,fn(e=hn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch(x){r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==r||0!==a&&3!==h.nodeType||(l=o+a),h!==i||0!==n&&3!==h.nodeType||(c=o+n),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++u===a&&(l=o),f===i&&++d===n&&(c=o),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ta={focusedElem:e,selectionRange:r},Wt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,v=p.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(x){kc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}p=tl,tl=!1}(e,r),gl(r,e),mn(ta),Wt=!!ea,ta=ea=null,e.current=r,yl(r,e,a),Ye(),Cl=l,bt=o,_l.transition=i}else e.current=r;if(ql&&(ql=!1,Xl=e,$l=a),i=e.pendingLanes,0===i&&(Kl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nc(e,Qe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&$l)&&0!==e.tag&&Ec(),i=e.pendingLanes,0!==(1&i)?e===Ql?Yl++:(Yl=0,Ql=e):Yl=0,za()}(e,t,r,n)}finally{_l.transition=a,bt=n}return null}function Ec(){if(null!==Xl){var e=wt($l),t=_l.transition,r=bt;try{if(_l.transition=null,bt=16>e?16:e,null===Xl)var n=!1;else{if(e=Xl,Xl=null,$l=0,0!==(6&Cl))throw Error(s(331));var a=Cl;for(Cl|=4,Jo=e.current;null!==Jo;){var i=Jo,o=i.child;if(0!==(16&Jo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Jo=u;null!==Jo;){var d=Jo;switch(d.tag){case 0:case 11:case 15:rl(8,d,i)}var h=d.child;if(null!==h)h.return=d,Jo=h;else for(;null!==Jo;){var f=(d=Jo).sibling,m=d.return;if(sl(d),d===u){Jo=null;break}if(null!==f){f.return=m,Jo=f;break}Jo=m}}}var p=i.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Jo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(i=Jo).flags))switch(i.tag){case 0:case 11:case 15:rl(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Jo=y;break e}Jo=i.return}}var b=e.current;for(Jo=b;null!==Jo;){var w=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Jo=w;else e:for(o=b;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(E){kc(l,l.return,E)}if(l===o){Jo=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Jo=x;break e}Jo=l.return}}if(Cl=a,za(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(at,e)}catch(E){}n=!0}return n}finally{bt=r,_l.transition=t}}return!1}function Tc(e,t,r){e=Us(e,t=fo(0,t=lo(r,t),1),1),t=ec(),null!==e&&(vt(e,1,t),nc(e,t))}function kc(e,t,r){if(3===e.tag)Tc(e,e,r);else for(;null!==t;){if(3===t.tag){Tc(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Kl||!Kl.has(n))){t=Us(t,e=mo(t,e=lo(r,e),1),1),e=ec(),null!==t&&(vt(t,1,e),nc(t,e));break}}t=t.return}}function Nc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Al===e&&(Rl&r)===r&&(4===jl||3===jl&&(130023424&Rl)===Rl&&500>Qe()-Vl?hc(e,0):Fl|=r),nc(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var r=ec();null!==(e=js(e,t))&&(vt(e,t,r),nc(e,r))}function _c(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Sc(e,r)}function Cc(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(s(314))}null!==n&&n.delete(t),Sc(e,r)}function Ac(e,t){return qe(e,t)}function Ic(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,r,n){return new Ic(e,t,r,n)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var r=e.alternate;return null===r?((r=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function jc(e,t,r,n,a,i){var o=2;if(n=e,"function"===typeof e)Oc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case T:return Pc(r.children,a,i,t);case k:o=8,a|=8;break;case N:return(e=Rc(12,r,t,2|a)).elementType=N,e.lanes=i,e;case A:return(e=Rc(13,r,t,a)).elementType=A,e.lanes=i,e;case I:return(e=Rc(19,r,t,a)).elementType=I,e.lanes=i,e;case D:return Mc(r,a,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case _:o=9;break e;case C:o=11;break e;case R:o=14;break e;case O:o=16,n=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Rc(o,r,t,a)).elementType=e,t.type=n,t.lanes=i,t}function Pc(e,t,r,n){return(e=Rc(7,e,n,t)).lanes=r,e}function Mc(e,t,r,n){return(e=Rc(22,e,n,t)).elementType=D,e.lanes=r,e.stateNode={isHidden:!1},e}function Lc(e,t,r){return(e=Rc(6,e,null,t)).lanes=r,e}function Fc(e,t,r){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bc(e,t,r,n,a,s,i,o,l){return e=new Uc(e,t,r,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Vc(e){if(!e)return _a;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var r=e.type;if(Oa(r))return Pa(e,r,t)}return t}function zc(e,t,r,n,a,s,i,o,l){return(e=Bc(r,n,!0,e,0,s,0,o,l)).context=Vc(null),r=e.current,(s=Fs(n=ec(),a=tc(r))).callback=void 0!==t&&null!==t?t:null,Us(r,s,a),e.current.lanes=a,vt(e,a,n),nc(e,n),e}function Hc(e,t,r,n){var a=t.current,s=ec(),i=tc(a);return r=Vc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Fs(s,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Us(a,t,i))&&(rc(e,a,i,s),Bs(e,a,i)),i}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Kc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Tl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Aa.current)bo=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return bo=!1,function(e,t,r){switch(t.tag){case 3:Ao(t),fs();break;case 5:Qs(t);break;case 1:Oa(t.type)&&Ma(t);break;case 4:$s(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Sa(Es,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Sa(Zs,1&Zs.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Lo(e,t,r):(Sa(Zs,1&Zs.current),null!==(e=Wo(e,t,r))?e.sibling:null);Sa(Zs,1&Zs.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return zo(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Sa(Zs,Zs.current),n)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,r)}return Wo(e,t,r)}(e,t,r);bo=0!==(131072&e.flags)}else bo=!1,as&&0!==(1048576&t.flags)&&Za(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ho(e,t),e=t.pendingProps;var a=Ra(t,Ca.current);As(t,r),a=pi(null,t,n,e,a,r);var i=gi();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oa(n)?(i=!0,Ma(t)):i=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ms(t),a.updater=no,t.stateNode=a,a._reactInternals=t,oo(t,n,e,r),t=Co(null,t,n,!0,i,r)):(t.tag=0,as&&i&&es(t),wo(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Oc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===R)return 14}return 2}(n),e=to(n,e),a){case 0:t=So(null,t,n,e,r);break e;case 1:t=_o(null,t,n,e,r);break e;case 11:t=xo(null,t,n,e,r);break e;case 14:t=Eo(null,t,n,to(n.type,e),r);break e}throw Error(s(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,So(e,t,n,a=t.elementType===n?a:to(n,a),r);case 1:return n=t.type,a=t.pendingProps,_o(e,t,n,a=t.elementType===n?a:to(n,a),r);case 3:e:{if(Ao(t),null===e)throw Error(s(387));n=t.pendingProps,a=(i=t.memoizedState).element,Ls(e,t),zs(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated){if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Io(e,t,n,r,a=lo(Error(s(423)),t));break e}if(n!==a){t=Io(e,t,n,r,a=lo(Error(s(424)),t));break e}for(ns=ca(t.stateNode.containerInfo.firstChild),rs=t,as=!0,ss=null,r=xs(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fs(),n===a){t=Wo(e,t,r);break e}wo(e,t,n,r)}t=t.child}return t;case 5:return Qs(t),null===e&&cs(t),n=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,o=a.children,ra(n,a)?o=null:null!==i&&ra(n,i)&&(t.flags|=32),No(e,t),wo(e,t,o,r),t.child;case 6:return null===e&&cs(t),null;case 13:return Lo(e,t,r);case 4:return $s(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=ws(t,null,n,r):wo(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,xo(e,t,n,a=t.elementType===n?a:to(n,a),r);case 7:return wo(e,t,t.pendingProps,r),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Sa(Es,n._currentValue),n._currentValue=o,null!==i)if(on(i.value,o)){if(i.children===a.children&&!Aa.current){t=Wo(e,t,r);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===i.tag){(c=Fs(-1,r&-r)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,null!==(c=i.alternate)&&(c.lanes|=r),Cs(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),Cs(o,r,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}wo(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,As(t,r),n=n(a=Is(a)),t.flags|=1,wo(e,t,n,r),t.child;case 14:return a=to(n=t.type,t.pendingProps),Eo(e,t,n,a=to(n.type,a),r);case 15:return To(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:to(n,a),Ho(e,t),t.tag=1,Oa(n)?(e=!0,Ma(t)):e=!1,As(t,r),so(t,n,a),oo(t,n,a,r),Co(null,t,n,!0,e,r);case 19:return zo(e,t,r);case 22:return ko(e,t,r)}throw Error(s(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function $c(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if("function"===typeof a){var o=a;a=function(){var e=Wc(i);o.call(e)}}Hc(t,i,e,a)}else i=function(e,t,r,n,a){if(a){if("function"===typeof n){var s=n;n=function(){var e=Wc(i);s.call(e)}}var i=zc(t,n,e,0,null,!1,0,"",Jc);return e._reactRootContainer=i,e[ma]=i.current,zn(8===e.nodeType?e.parentNode:e),uc(),i}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var o=n;n=function(){var e=Wc(l);o.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[ma]=l.current,zn(8===e.nodeType?e.parentNode:e),uc(function(){Hc(t,l,r,n)}),l}(r,t,e,a,n);return Wc(i)}$c.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hc(e,t,null,null)},$c.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Hc(null,e,null,null)}),t[ma]=null}},$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Dt.length&&0!==t&&t<Dt[r].priority;r++);Dt.splice(r,0,e),0===r&&Lt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=dt(t.pendingLanes);0!==r&&(yt(t,1|r),nc(t,Qe()),0===(6&Cl)&&(zl=Qe()+500,za()))}break;case 13:uc(function(){var t=js(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}}),Kc(e,1)}},Et=function(e){if(13===e.tag){var t=js(e,134217728);if(null!==t)rc(t,e,134217728,ec());Kc(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tc(e),r=js(e,t);if(null!==r)rc(r,e,t,ec());Kc(e,t)}},kt=function(){return bt},Nt=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},Ee=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=xa(n);if(!a)throw Error(s(90));q(n),J(n,a)}}}break;case"textarea":se(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ce=cc,Ae=uc;var eu={usingClientEntryPoint:!1,Events:[ba,wa,xa,Se,_e,cc]},tu={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{at=nu.inject(ru),st=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var r=!1,n="",a=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Bc(e,1,!1,null,0,r,0,n,a),e[ma]=t.current,zn(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,r){if(!Qc(t))throw Error(s(200));return Zc(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Yc(e))throw Error(s(405));var n=null!=r&&r.hydratedSources||null,a=!1,i="",o=qc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=zc(t,null,e,1,null!=r?r:null,a,0,i,o),e[ma]=t.current,zn(e),n)for(e=0;e<n.length;e++)a=(a=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new $c(t)},t.render=function(e,t,r){if(!Qc(t))throw Error(s(200));return Zc(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[ma]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Qc(r))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},786:(e,t,r)=>{r.d(t,{getAuth:()=>br,hg:()=>rt,x9:()=>tt,CI:()=>nt});var n=r(150),a=r(700),s=r(443);function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var o=r(812);function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const c=l,u=new a.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),d=new s.Vy("@firebase/auth");function h(e){if(d.logLevel<=s.$b.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];d.error("Auth (".concat(n.MF,"): ").concat(e),...r)}}function f(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw v(e,...r)}function m(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return v(e,...r)}function p(e,t,r){const n=Object.assign(Object.assign({},c()),{[t]:r});return new a.FA("auth","Firebase",n).create(t,{appName:e.name})}function g(e){return p(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function v(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if("string"!==typeof e){const t=r[0],n=[...r.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(t,...n)}return u.create(e,...r)}function y(e,t){if(!e){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];throw v(t,...n)}}function b(e){const t="INTERNAL ASSERTION FAILED: "+e;throw h(t),new Error(t)}function w(e,t){e||b(t)}function x(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function E(){return"http:"===T()||"https:"===T()}function T(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class k{constructor(e,t){this.shortDelay=e,this.longDelay=t,w(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,a.jZ)()||(0,a.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(E()||(0,a.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function N(e,t){w(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?"".concat(r).concat(t.startsWith("/")?t.slice(1):t):r}class S{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void b("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void b("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void b("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},C=new k(3e4,6e4);function A(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function I(e,t,r,n){return R(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let s={},i={};n&&("GET"===t?i=n:s={body:JSON.stringify(n)});const o=(0,a.Am)(Object.assign({key:e.config.apiKey},i)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},s);return(0,a.c1)()||(c.referrerPolicy="no-referrer"),S.fetch()(D(e,e.config.apiHost,r,o),c)})}async function R(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},_),t);try{const t=new P(e),a=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw M(e,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const t=a.ok?s.errorMessage:s.error.message,[r,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===r)throw M(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===r)throw M(e,"email-already-in-use",s);if("USER_DISABLED"===r)throw M(e,"user-disabled",s);const o=n[r]||r.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw p(e,o,i);f(e,o)}}catch(s){if(s instanceof a.g)throw s;f(e,"network-request-failed",{message:String(s)})}}async function O(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await I(e,t,r,n,a);return"mfaPendingCredential"in s&&f(e,"multi-factor-auth-required",{_serverResponse:s}),s}function D(e,t,r,n){const a="".concat(t).concat(r,"?").concat(n);return e.config.emulator?N(e.config,a):"".concat(e.config.apiScheme,"://").concat(a)}function j(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class P{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(m(this.auth,"network-request-failed")),C.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function M(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=m(e,t,n);return a.customData._tokenResponse=r,a}function L(e){return void 0!==e&&void 0!==e.enterprise}class F{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return j(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function U(e,t){return I(e,"GET","/v2/recaptchaConfig",A(e,t))}async function B(e,t){return I(e,"POST","/v1/accounts:lookup",t)}function V(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function z(e){return 1e3*Number(e)}function H(e){const[t,r,n]=e.split(".");if(void 0===t||void 0===r||void 0===n)return h("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,a.u)(r);return e?JSON.parse(e):(h("Failed to decode base64 JWT payload"),null)}catch(s){return h("Caught error parsing JWT payload as JSON",null===s||void 0===s?void 0:s.toString()),null}}function W(e){const t=H(e);return y(t,"internal-error"),y("undefined"!==typeof t.exp,"internal-error"),y("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function G(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(r){throw r instanceof a.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}class K{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class q{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=V(this.lastLoginAt),this.creationTime=V(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function X(e){var t;const r=e.auth,n=await e.getIdToken(),a=await G(e,B(r,{idToken:n}));y(null===a||void 0===a?void 0:a.users.length,r,"internal-error");const s=a.users[0];e._notifyReloadListener(s);const i=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?$(s.providerUserInfo):[],o=(l=e.providerData,c=i,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new q(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function $(e){return e.map(e=>{var{providerId:t}=e,r=i(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}class Y{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){y(e.idToken,"internal-error"),y("undefined"!==typeof e.idToken,"internal-error"),y("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):W(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){y(0!==e.length,"internal-error");const t=W(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(y(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:n,expiresIn:s}=await async function(e,t){const r=await R(e,{},async()=>{const r=(0,a.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:s}=e.config,i=D(e,n,"/v1/token","key=".concat(s)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",S.fetch()(i,{method:"POST",headers:o,body:r})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}(e,t);this.updateTokensAndExpiration(r,n,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){const{refreshToken:r,accessToken:n,expirationTime:a}=t,s=new Y;return r&&(y("string"===typeof r,"internal-error",{appName:e}),s.refreshToken=r),n&&(y("string"===typeof n,"internal-error",{appName:e}),s.accessToken=n),a&&(y("number"===typeof a,"internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Y,this.toJSON())}_performRefresh(){return b("not implemented")}}function Q(e,t){y("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class J{constructor(e){var{uid:t,auth:r,stsTokenManager:n}=e,a=i(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new K(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new q(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await G(this,this.stsTokenManager.getToken(this.auth,e));return y(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(0,a.Ku)(e),n=await r.getIdToken(t),s=H(n);y(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i="object"===typeof s.firebase?s.firebase:void 0,o=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:V(z(s.auth_time)),issuedAtTime:V(z(s.iat)),expirationTime:V(z(s.exp)),signInProvider:o||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,a.Ku)(e);await X(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(y(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new J(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){y(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await X(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,n.xZ)(this.auth.app))return Promise.reject(g(this.auth));const e=await this.getIdToken();return await G(this,async function(e,t){return I(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,n,a,s,i,o,l,c;const u=null!==(r=t.displayName)&&void 0!==r?r:void 0,d=null!==(n=t.email)&&void 0!==n?n:void 0,h=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,m=null!==(i=t.tenantId)&&void 0!==i?i:void 0,p=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:b,emailVerified:w,isAnonymous:x,providerData:E,stsTokenManager:T}=t;y(b&&T,e,"internal-error");const k=Y.fromJSON(this.name,T);y("string"===typeof b,e,"internal-error"),Q(u,e.name),Q(d,e.name),y("boolean"===typeof w,e,"internal-error"),y("boolean"===typeof x,e,"internal-error"),Q(h,e.name),Q(f,e.name),Q(m,e.name),Q(p,e.name),Q(g,e.name),Q(v,e.name);const N=new J({uid:b,auth:e,email:d,emailVerified:w,displayName:u,isAnonymous:x,photoURL:f,phoneNumber:h,tenantId:m,stsTokenManager:k,createdAt:g,lastLoginAt:v});return E&&Array.isArray(E)&&(N.providerData=E.map(e=>Object.assign({},e))),p&&(N._redirectEventId=p),N}static async _fromIdTokenResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=new Y;n.updateFromServerResponse(t);const a=new J({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await X(a),a}static async _fromGetAccountInfoResponse(e,t,r){const n=t.users[0];y(void 0!==n.localId,"internal-error");const a=void 0!==n.providerUserInfo?$(n.providerUserInfo):[],s=!(n.email&&n.passwordHash)&&!(null===a||void 0===a?void 0:a.length),i=new Y;i.updateFromIdToken(r);const o=new J({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s}),l={uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:a,metadata:new q(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(null===a||void 0===a?void 0:a.length)};return Object.assign(o,l),o}}const Z=new Map;function ee(e){w(e instanceof Function,"Expected a class definition");let t=Z.get(e);return t?(w(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Z.set(e,t),t)}class te{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}te.type="NONE";const re=te;function ne(e,t,r){return"firebase".concat(":",e,":").concat(t,":").concat(r)}class ae{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:n,name:a}=this.auth;this.fullUserKey=ne(this.userKey,n.apiKey,a),this.fullPersistenceKey=ne("persistence",n.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?J._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ae(ee(re),e,r);const n=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let a=n[0]||ee(re);const s=ne(r,e.config.apiKey,e.name);let i=null;for(const c of t)try{const t=await c._get(s);if(t){const r=J._fromJSON(e,t);c!==a&&(i=r),a=c;break}}catch(l){}const o=n.filter(e=>e._shouldAllowMigration);return a._shouldAllowMigration&&o.length?(a=o[0],i&&await a._set(s,i.toJSON()),await Promise.all(t.map(async e=>{if(e!==a)try{await e._remove(s)}catch(l){}})),new ae(a,e,r)):new ae(a,e,r)}}function se(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ce(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ie(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(de(t))return"Blackberry";if(he(t))return"Webos";if(oe(t))return"Safari";if((t.includes("chrome/")||le(t))&&!t.includes("edge/"))return"Chrome";if(ue(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=e.match(t);if(2===(null===r||void 0===r?void 0:r.length))return r[1]}return"Other"}function ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/firefox\//i.test(e)}function oe(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function le(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/crios\//i.test(e)}function ce(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/iemobile/i.test(e)}function ue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/android/i.test(e)}function de(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/blackberry/i.test(e)}function he(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/webos/i.test(e)}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return fe(e)||ue(e)||he(e)||de(e)||/windows phone/i.test(e)||ce(e)}function pe(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=se((0,a.ZQ)());break;case"Worker":t="".concat(se((0,a.ZQ)()),"-").concat(e);break;default:t=e}const s=r.length?r.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(n.MF,"/").concat(s)}class ge{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=t=>new Promise((r,n)=>{try{r(e(t))}catch(a){n(a)}});r.onAbort=t,this.queue.push(r);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const e of t)try{e()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===r||void 0===r?void 0:r.message})}}}class ve{constructor(e){var t,r,n,a;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,n,a,s,i;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(r=o.meetsMaxPasswordLength)||void 0===r||r),o.isValid&&(o.isValid=null===(n=o.containsLowercaseLetter)||void 0===n||n),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(i=o.containsNonAlphanumericCharacter)||void 0===i||i),o}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class ye{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new we(this),this.idTokenSubscription=new we(this),this.beforeStateQueue=new ge(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ee(t)),this._initializationPromise=this.queue(async()=>{var r,n;if(!this._deleted&&(this.persistenceManager=await ae.create(this,e),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(a){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(n=this.currentUser)||void 0===n?void 0:n.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await B(this,{idToken:e}),r=await J._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,n.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let a=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,n=null===a||void 0===a?void 0:a._redirectEventId,i=await this.tryRedirectSignIn(e);r&&r!==n||!(null===i||void 0===i?void 0:i.user)||(a=i.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(i){a=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return y(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(r){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await X(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,n.xZ)(this.app))return Promise.reject(g(this));const t=e?(0,a.Ku)(e):null;return t&&y(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&y(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,n.xZ)(this.app)?Promise.reject(g(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,n.xZ)(this.app)?Promise.reject(g(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ee(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return I(e,"GET","/v2/passwordPolicy",A(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new ve(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new a.FA("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return I(e,"POST","/v2/accounts:revokeToken",A(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ee(e)||this._popupRedirectResolver;y(t,this,"argument-error"),this.redirectPersistenceManager=await ae.create(this,[ee(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let s=!1;const i=this._isInitialized?Promise.resolve():this._initializationPromise;if(y(i,this,"internal-error"),i.then(()=>{s||a(this.currentUser)}),"function"===typeof t){const a=e.addObserver(t,r,n);return()=>{s=!0,a()}}{const r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return y(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(d.logLevel<=s.$b.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];d.warn("Auth (".concat(n.MF,"): ").concat(e),...r)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function be(e){return(0,a.Ku)(e)}class we{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,a.tD)(e=>this.observer=e)}get next(){return y(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let xe={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ee(e){return xe.loadJS(e)}function Te(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class ke{constructor(e){this.type="recaptcha-enterprise",this.auth=be(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(t,r,n){const a=window.grecaptcha;L(a)?a.enterprise.ready(()=>{a.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r("NO_RECAPTCHA")})}):n(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,n)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{U(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(n=>{if(void 0!==n.recaptchaKey){const r=new F(n);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{r(e)})})})(this.auth).then(a=>{if(!t&&L(window.grecaptcha))r(a,e,n);else{if("undefined"===typeof window)return void n(new Error("RecaptchaVerifier is only supported in browser"));let t=xe.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Ee(t).then(()=>{r(a,e,n)}).catch(e=>{n(e)})}}).catch(e=>{n(e)})})}}async function Ne(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=new ke(e);let s;try{s=await a.verify(r)}catch(o){s=await a.verify(r,!0)}const i=Object.assign({},t);return n?Object.assign(i,{captchaResp:s}):Object.assign(i,{captchaResponse:s}),Object.assign(i,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(i,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),i}async function Se(e,t,r,n){var a;if(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Ne(e,t,r,"getOobCode"===r);return n(e,a)}return n(e,t).catch(async a=>{if(a.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(r," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const a=await Ne(e,t,r,"getOobCode"===r);return n(e,a)}return Promise.reject(a)})}function _e(e,t,r){const n=be(e);y(n._canInitEmulator,n,"emulator-config-failed"),y(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const a=!!(null===r||void 0===r?void 0:r.disableWarnings),s=Ce(t),{host:i,port:o}=function(e){const t=Ce(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const e=a[1];return{host:e,port:Ae(n.substr(e.length+1))}}{const[e,t]=n.split(":");return{host:e,port:Ae(t)}}}(t),l=null===o?"":":".concat(o);n.config.emulator={url:"".concat(s,"//").concat(i).concat(l,"/")},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ce(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ae(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Ie{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return b("not implemented")}_getIdTokenResponse(e){return b("not implemented")}_linkToIdToken(e,t){return b("not implemented")}_getReauthenticationResolver(e){return b("not implemented")}}async function Re(e,t){return I(e,"POST","/v1/accounts:signUp",t)}async function Oe(e,t){return O(e,"POST","/v1/accounts:signInWithPassword",A(e,t))}class De extends Ie{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",r),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new De(e,t,"password")}static _fromEmailAndCode(e,t){return new De(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Se(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Oe);case"emailLink":return async function(e,t){return O(e,"POST","/v1/accounts:signInWithEmailLink",A(e,t))}(e,{email:this._email,oobCode:this._password});default:f(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Se(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Re);case"emailLink":return async function(e,t){return O(e,"POST","/v1/accounts:signInWithEmailLink",A(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:f(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function je(e,t){return O(e,"POST","/v1/accounts:signInWithIdp",A(e,t))}class Pe extends Ie{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Pe(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):f("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:r,signInMethod:n}=t,a=i(t,["providerId","signInMethod"]);if(!r||!n)return null;const s=new Pe(r,n);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){return je(e,this.buildRequest())}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,je(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,je(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,a.Am)(t)}return e}}const Me={USER_NOT_FOUND:"user-not-found"};class Le extends Ie{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Le({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Le({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return O(e,"POST","/v1/accounts:signInWithPhoneNumber",A(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const r=await O(e,"POST","/v1/accounts:signInWithPhoneNumber",A(e,t));if(r.temporaryProof)throw M(e,"account-exists-with-different-credential",r);return r}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return O(e,"POST","/v1/accounts:signInWithPhoneNumber",A(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Me)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:n}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:n}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:a}=e;return r||t||n||a?new Le({verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:a}):null}}class Fe{constructor(e){var t,r,n,s,i,o;const l=(0,a.I9)((0,a.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(r=l.oobCode)&&void 0!==r?r:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(n=l.mode)&&void 0!==n?n:null);y(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(s=l.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(i=l.languageCode)&&void 0!==i?i:null,this.tenantId=null!==(o=l.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=(0,a.I9)((0,a.hp)(e)).link,r=t?(0,a.I9)((0,a.hp)(t)).deep_link_id:null,n=(0,a.I9)((0,a.hp)(e)).deep_link_id;return(n?(0,a.I9)((0,a.hp)(n)).link:null)||n||r||t||e}(e);try{return new Fe(t)}catch(r){return null}}}class Ue{constructor(){this.providerId=Ue.PROVIDER_ID}static credential(e,t){return De._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Fe.parseLink(t);return y(r,"argument-error"),De._fromEmailAndCode(e,r.code,r.tenantId)}}Ue.PROVIDER_ID="password",Ue.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ue.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Be{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ve extends Be{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ze extends Ve{constructor(){super("facebook.com")}static credential(e){return Pe._fromParams({providerId:ze.PROVIDER_ID,signInMethod:ze.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ze.credentialFromTaggedObject(e)}static credentialFromError(e){return ze.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ze.credential(t.oauthAccessToken)}catch(r){return null}}}ze.FACEBOOK_SIGN_IN_METHOD="facebook.com",ze.PROVIDER_ID="facebook.com";class He extends Ve{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Pe._fromParams({providerId:He.PROVIDER_ID,signInMethod:He.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return He.credentialFromTaggedObject(e)}static credentialFromError(e){return He.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return He.credential(r,n)}catch(a){return null}}}He.GOOGLE_SIGN_IN_METHOD="google.com",He.PROVIDER_ID="google.com";class We extends Ve{constructor(){super("github.com")}static credential(e){return Pe._fromParams({providerId:We.PROVIDER_ID,signInMethod:We.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return We.credentialFromTaggedObject(e)}static credentialFromError(e){return We.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return We.credential(t.oauthAccessToken)}catch(r){return null}}}We.GITHUB_SIGN_IN_METHOD="github.com",We.PROVIDER_ID="github.com";class Ge extends Ve{constructor(){super("twitter.com")}static credential(e,t){return Pe._fromParams({providerId:Ge.PROVIDER_ID,signInMethod:Ge.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ge.credentialFromTaggedObject(e)}static credentialFromError(e){return Ge.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Ge.credential(r,n)}catch(a){return null}}}Ge.TWITTER_SIGN_IN_METHOD="twitter.com",Ge.PROVIDER_ID="twitter.com";class Ke{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await J._fromIdTokenResponse(e,r,n),s=qe(r);return new Ke({user:a,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const n=qe(r);return new Ke({user:e,providerId:n,_tokenResponse:r,operationType:t})}}function qe(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Xe extends a.g{constructor(e,t,r,n){var a;super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,Xe.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new Xe(e,t,r,n)}}function $e(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if(r.code==="auth/".concat("multi-factor-auth-required"))throw Xe._fromErrorAndOperation(e,r,t,n);throw r})}async function Ye(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=await G(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return Ke._forOperation(e,"link",n)}async function Qe(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:a}=e;if((0,n.xZ)(a.app))return Promise.reject(g(a));const s="reauthenticate";try{const n=await G(e,$e(a,s,t,e),r);y(n.idToken,a,"internal-error");const i=H(n.idToken);y(i,a,"internal-error");const{sub:o}=i;return y(e.uid===o,a,"user-mismatch"),Ke._forOperation(e,s,n)}catch(i){throw(null===i||void 0===i?void 0:i.code)==="auth/".concat("user-not-found")&&f(a,"user-mismatch"),i}}async function Je(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,n.xZ)(e.app))return Promise.reject(g(e));const a="signIn",s=await $e(e,a,t),i=await Ke._fromIdTokenResponse(e,a,s);return r||await e._updateCurrentUser(i.user),i}async function Ze(e,t){return Je(be(e),t)}async function et(e){const t=be(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function tt(e,t,r){return(0,n.xZ)(e.app)?Promise.reject(g(e)):Ze((0,a.Ku)(e),Ue.credential(t,r)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&et(e),t})}function rt(e,t,r,n){return(0,a.Ku)(e).onAuthStateChanged(t,r,n)}function nt(e){return(0,a.Ku)(e).signOut()}new WeakMap;const at="__sak";class st{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(at,"1"),this.storage.removeItem(at),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class it extends st{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=me(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),n=this.localCache[t];r!==n&&e(t,n,r)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,r)=>{this.notifyListeners(e,r)});const r=e.key;t?this.detachListener():this.stopPolling();const n=()=>{const e=this.storage.getItem(r);(t||this.localCache[r]!==e)&&this.notifyListeners(r,e)},s=this.storage.getItem(r);(0,a.lT)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(n,10):n()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const n of Array.from(r))n(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}it.type="LOCAL";const ot=it;class lt extends st{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}lt.type="SESSION";const ct=lt;class ut{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const r=new ut(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:n,data:a}=t.data,s=this.handlersMap[n];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:n});const i=Array.from(s).map(async e=>e(t.origin,a)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(i);t.ports[0].postMessage({status:"done",eventId:r,eventType:n,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function dt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r="";for(let n=0;n<t;n++)r+=Math.floor(10*Math.random());return e+r}ut.receivers=[];class ht{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const n="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let a,s;return new Promise((i,o)=>{const l=dt("",20);n.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},r);s={messageChannel:n,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),i(t.data.response);break;default:clearTimeout(c),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(s),n.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[n.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function ft(){return window}function mt(){return"undefined"!==typeof ft().WorkerGlobalScope&&"function"===typeof ft().importScripts}const pt="firebaseLocalStorageDb",gt="firebaseLocalStorage",vt="fbase_key";class yt{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function bt(e,t){return e.transaction([gt],t?"readwrite":"readonly").objectStore(gt)}function wt(){const e=indexedDB.open(pt,1);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(gt,{keyPath:vt})}catch(n){r(n)}}),e.addEventListener("success",async()=>{const r=e.result;r.objectStoreNames.contains(gt)?t(r):(r.close(),await function(){const e=indexedDB.deleteDatabase(pt);return new yt(e).toPromise()}(),t(await wt()))})})}async function xt(e,t,r){const n=bt(e,!0).put({[vt]:t,value:r});return new yt(n).toPromise()}function Et(e,t){const r=bt(e,!0).delete(t);return new yt(r).toPromise()}class Tt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await wt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(r){if(t++>3)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ut._getInstance(mt()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new ht(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&(null===(e=r[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=r[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wt();return await xt(e,at,"1"),await Et(e,at),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>xt(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const r=bt(e,!1).get(t),n=await new yt(r).toPromise();return void 0===n?null:n.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Et(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=bt(e,!1).getAll();return new yt(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],r=new Set;if(0!==e.length)for(const{fbase_key:n,value:a}of e)r.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(a)&&(this.notifyListeners(n,a),t.push(n));for(const n of Object.keys(this.localCache))this.localCache[n]&&!r.has(n)&&(this.notifyListeners(n,null),t.push(n));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const n of Array.from(r))n(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Tt.type="LOCAL";const kt=Tt;Te("rcb"),new k(3e4,6e4);const Nt="recaptcha";async function St(e,t,r){var n;const a=await r.verify();try{let s;if(y("string"===typeof a,e,"argument-error"),y(r.type===Nt,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){y("enroll"===t.type,e,"internal-error");const r=await function(e,t){return I(e,"POST","/v2/accounts/mfaEnrollment:start",A(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:a}});return r.phoneSessionInfo.sessionInfo}{y("signin"===t.type,e,"internal-error");const r=(null===(n=s.multiFactorHint)||void 0===n?void 0:n.uid)||s.multiFactorUid;y(r,e,"missing-multi-factor-info");const i=await function(e,t){return I(e,"POST","/v2/accounts/mfaSignIn:start",A(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:r,phoneSignInInfo:{recaptchaToken:a}});return i.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return I(e,"POST","/v1/accounts:sendVerificationCode",A(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:a});return t}}finally{r._reset()}}class _t{constructor(e){this.providerId=_t.PROVIDER_ID,this.auth=be(e)}verifyPhoneNumber(e,t){return St(this.auth,e,(0,a.Ku)(t))}static credential(e,t){return Le._fromVerification(e,t)}static credentialFromResult(e){const t=e;return _t.credentialFromTaggedObject(t)}static credentialFromError(e){return _t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:r,temporaryProof:n}=t;return r&&n?Le._fromTokenResponse(r,n):null}}function Ct(e,t){return t?ee(t):(y(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}_t.PROVIDER_ID="phone",_t.PHONE_SIGN_IN_METHOD="phone";class At extends Ie{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return je(e,this._buildIdpRequest())}_linkToIdToken(e,t){return je(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return je(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function It(e){return Je(e.auth,new At(e),e.bypassAuthState)}function Rt(e){const{auth:t,user:r}=e;return y(r,t,"internal-error"),Qe(r,new At(e),e.bypassAuthState)}async function Ot(e){const{auth:t,user:r}=e;return y(r,t,"internal-error"),Ye(r,new At(e),e.bypassAuthState)}class Dt{constructor(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=r,this.user=n,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:n,tenantId:a,error:s,type:i}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return It;case"linkViaPopup":case"linkViaRedirect":return Ot;case"reauthViaPopup":case"reauthViaRedirect":return Rt;default:f(this.auth,"internal-error")}}resolve(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jt=new k(2e3,1e4);class Pt extends Dt{constructor(e,t,r,n,a){super(e,t,n,a),this.provider=r,this.authWindow=null,this.pollId=null,Pt.currentPopupAction&&Pt.currentPopupAction.cancel(),Pt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return y(e,this.auth,"internal-error"),e}async onExecution(){w(1===this.filter.length,"Popup operations only handle one event");const e=dt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(m(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(m(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pt.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;(null===(r=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===r?void 0:r.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(m(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,jt.get())};e()}}Pt.currentPopupAction=null;const Mt=new Map;class Lt extends Dt{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Mt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const r=Bt(t),n=Ut(e);if(!await n._isAvailable())return!1;const a="true"===await n._get(r);return await n._remove(r),a}(this.resolver,this.auth),r=t?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Mt.set(this.auth._key(),e)}return this.bypassAuthState||Mt.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ft(e,t){Mt.set(e._key(),t)}function Ut(e){return ee(e._redirectPersistence)}function Bt(e){return ne("pendingRedirect",e.config.apiKey,e.name)}async function Vt(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,n.xZ)(e.app))return Promise.reject(g(e));const a=be(e),s=Ct(a,t),i=new Lt(a,s,r),o=await i.execute();return o&&!r&&(delete o.user._redirectEventId,await a._persistUserIfCurrent(o.user),await a._setRedirectUser(null,t)),o}class zt{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wt(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Wt(e)){const n=(null===(r=e.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";t.onError(m(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ht(e))}saveEventToCache(e){this.cachedEventUids.add(Ht(e)),this.lastProcessedEventTime=Date.now()}}function Ht(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Wt(e){let{type:t,error:r}=e;return"unknown"===t&&(null===r||void 0===r?void 0:r.code)==="auth/".concat("no-auth-event")}const Gt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kt=/^https?/;async function qt(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return I(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const n of t)try{if(Xt(n))return}catch(r){}f(e,"unauthorized-domain")}function Xt(e){const t=x(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===n?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===n}if(!Kt.test(r))return!1;if(Gt.test(e))return n===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const $t=new k(3e4,6e4);function Yt(){const e=ft().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}function Qt(e){return new Promise((t,r)=>{var n,a,s;function i(){Yt(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Yt(),r(m(e,"network-request-failed"))},timeout:$t.get()})}if(null===(a=null===(n=ft().gapi)||void 0===n?void 0:n.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=ft().gapi)||void 0===s?void 0:s.load)){const t=Te("iframefcb");return ft()[t]=()=>{gapi.load?i():r(m(e,"network-request-failed"))},Ee("".concat(xe.gapiScript,"?onload=").concat(t)).catch(e=>r(e))}i()}}).catch(e=>{throw Jt=null,e})}let Jt=null;const Zt=new k(5e3,15e3),er={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function rr(e){const t=e.config;y(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?N(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),s={apiKey:t.apiKey,appName:e.name,v:n.MF},i=tr.get(e.config.apiHost);i&&(s.eid=i);const o=e._getFrameworks();return o.length&&(s.fw=o.join(",")),"".concat(r,"?").concat((0,a.Am)(s).slice(1))}async function nr(e){const t=await function(e){return Jt=Jt||Qt(e),Jt}(e),r=ft().gapi;return y(r,e,"internal-error"),t.open({where:document.body,url:rr(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:er,dontclear:!0},t=>new Promise(async(r,n)=>{await t.restyle({setHideOnLeave:!1});const a=m(e,"network-request-failed"),s=ft().setTimeout(()=>{n(a)},Zt.get());function i(){ft().clearTimeout(s),r(t)}t.ping(i).then(i,()=>{n(a)})}))}const ar={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class sr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function ir(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},ar),{width:n.toString(),height:s.toString(),top:i,left:o}),u=(0,a.ZQ)().toLowerCase();r&&(l=le(u)?"_blank":r),ie(u)&&(t=t||"http://localhost",c.scrollbars="yes");const d=Object.entries(c).reduce((e,t)=>{let[r,n]=t;return"".concat(e).concat(r,"=").concat(n,",")},"");if(function(){var e;return fe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==l)return function(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}(t||"",l),new sr(null);const h=window.open(t||"",l,d);y(h,e,"popup-blocked");try{h.focus()}catch(f){}return new sr(h)}const or="__/auth/handler",lr="emulator/auth/handler",cr=encodeURIComponent("fac");async function ur(e,t,r,s,i,o){y(e.config.authDomain,e,"auth-domain-config-required"),y(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:s,v:n.MF,eventId:i};if(t instanceof Be){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,a.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))l[e]=t}if(t instanceof Ve){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const n of Object.keys(c))void 0===c[n]&&delete c[n];const u=await e._getAppCheckToken(),d=u?"#".concat(cr,"=").concat(encodeURIComponent(u)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(or);return N(t,lr)}(e),"?").concat((0,a.Am)(c).slice(1)).concat(d)}const dr="webStorageSupport";const hr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ct,this._completeRedirectFn=Vt,this._overrideRedirectResult=Ft}async _openPopup(e,t,r,n){var a;w(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return ir(e,await ur(e,t,r,x(),n),dt())}async _openRedirect(e,t,r,n){await this._originValidation(e);return function(e){ft().location.href=e}(await ur(e,t,r,x(),n)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:r}=this.eventManagers[t];return e?Promise.resolve(e):(w(r,"If manager is not set, promise should be"),r)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await nr(e),r=new zt(e);return t.register("authEvent",t=>{y(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(dr,{type:dr},r=>{var n;const a=null===(n=null===r||void 0===r?void 0:r[0])||void 0===n?void 0:n[dr];void 0!==a&&t(!!a),f(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=qt(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return me()||oe()||fe()}};var fr="@firebase/auth",mr="1.7.9";class pr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){y(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const gr=(0,a.XA)("authIdTokenMaxAge")||300;let vr=null;const yr=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>gr)return;const a=null===r||void 0===r?void 0:r.token;vr!==a&&(vr=a,await fetch(e,{method:a?"POST":"DELETE",headers:a?{Authorization:"Bearer ".concat(a)}:{}}))};function br(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,n.Sx)();const t=(0,n.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const r=function(e,t){const r=(0,n.j6)(e,"auth");if(r.isInitialized()){const e=r.getImmediate(),n=r.getOptions();if((0,a.bD)(n,null!==t&&void 0!==t?t:{}))return e;f(e,"already-initialized")}return r.initialize({options:t})}(e,{popupRedirectResolver:hr,persistence:[kt,ot,ct]}),s=(0,a.XA)("authTokenSyncURL");if(s&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(s,location.origin);if(location.origin===e.origin){const t=yr(e.toString());!function(e,t,r){(0,a.Ku)(e).beforeAuthStateChanged(t,r)}(r,t,()=>t(r.currentUser)),function(e,t,r,n){(0,a.Ku)(e).onIdTokenChanged(t,r,n)}(r,e=>t(e))}}const i=(0,a.Tj)("auth");return i&&_e(r,"http://".concat(i)),r}var wr;xe={loadJS:e=>new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=e=>{const t=m("internal-error");t.customData=e,r(t)},n.type="text/javascript",n.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(n)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},wr="Browser",(0,n.om)(new o.uA("auth",(e,t)=>{let{options:r}=t;const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;y(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:wr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pe(wr)},c=new ye(n,a,s,l);return function(e,t){const r=(null===t||void 0===t?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ee);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),(0,n.om)(new o.uA("auth-internal",e=>(e=>new pr(e))(be(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,n.KO)(fr,mr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(wr)),(0,n.KO)(fr,mr,"esm2017")},812:(e,t,r)=>{r.d(t,{h1:()=>o,uA:()=>a});var n=r(700);class a{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class i{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new n.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(r){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),n=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(n)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,r]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});r.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,s]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(a)&&s.resolve(n)}return n}onInit(e,t){var r;const n=this.normalizeInstanceIdentifier(t),a=null!==(r=this.onInitCallbacks.get(n))&&void 0!==r?r:new Set;a.add(e),this.onInitCallbacks.set(n,a);const s=this.instances.get(n);return s&&e(s,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch(n){}}getOrInitializeService(e){let{instanceIdentifier:t,options:r={}}=e,n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===s?void 0:a),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}var a;return n||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new i(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},853:(e,t,r)=>{e.exports=r(234)},950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(730)}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n=r(43),a=r(391),s=r(555),i=r(150);(0,i.KO)("firebase","10.14.1","app");var o=r(786),l=r(472),c=r(700),u=r(812);const d="firebasestorage.googleapis.com",h="storageBucket";class f extends c.g{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(g(e),"Firebase Storage: ".concat(t," (").concat(g(e),")")),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,f.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return g(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var m,p;function g(e){return"storage/"+e}function v(){return new f(m.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function y(){return new f(m.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function b(){return new f(m.CANCELED,"User canceled the upload/download.")}function w(){return new f(m.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function x(e){return new f(m.INVALID_ARGUMENT,e)}function E(){return new f(m.APP_DELETED,"The Firebase app was deleted.")}function T(e,t){return new f(m.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function k(e){throw new f(m.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(m||(m={}));class N{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=N.makeFromUrl(e,t)}catch(a){return new N(e,"")}if(""===r.path)return r;throw n=e,new f(m.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.");var n}static makeFromUrl(e,t){let r=null;const n="([A-Za-z0-9.\\-_]+)";const a=new RegExp("^gs://"+n+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const i=t.replace(/[.]/g,"\\."),o=[{regex:a,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(i,"/").concat("v[A-Za-z0-9_]+","/b/").concat(n,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===d?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(n,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<o.length;l++){const t=o[l],n=t.regex.exec(e);if(n){const e=n[t.indices.bucket];let a=n[t.indices.path];a||(a=""),r=new N(e,a),t.postModify(r);break}}if(null==r)throw function(e){return new f(m.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return r}}class S{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function _(e){return"string"===typeof e||e instanceof String}function C(e){return A()&&e instanceof Blob}function A(){return"undefined"!==typeof Blob}function I(e,t,r,n){if(n<t)throw x("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(n>r)throw x("Invalid value for '".concat(e,"'. Expected ").concat(r," or less."))}function R(e,t,r){let n=t;return null==r&&(n="https://".concat(t)),"".concat(r,"://").concat(n,"/v0").concat(e)}function O(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){r=r+(t(n)+"="+t(e[n]))+"&"}return r=r.slice(0,-1),r}function D(e,t){const r=e>=500&&e<600,n=-1!==[408,429].indexOf(e),a=-1!==t.indexOf(e);return r||n||a}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(p||(p={}));class j{constructor(e,t,r,n,a,s,i,o,l,c,u){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=r,this.body_=n,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=i,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new P(!1,null,!0));const r=this.connectionFactory_();this.pendingConnection_=r;const n=e=>{const t=e.loaded,r=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,r)};null!==this.progressCallback_&&r.addUploadProgressListener(n),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&r.removeUploadProgressListener(n),this.pendingConnection_=null;const t=r.getErrorCode()===p.NO_ERROR,a=r.getStatus();if(!t||D(a,this.additionalRetryCodes_)&&this.retry){const t=r.getErrorCode()===p.ABORT;return void e(!1,new P(!1,null,t))}const s=-1!==this.successCodes_.indexOf(a);e(!0,new P(s,r))})},t=(e,t)=>{const r=this.resolve_,n=this.reject_,a=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(a,a.getResponse());void 0!==e?r(e):r()}catch(s){n(s)}else if(null!==a){const e=v();e.serverResponse=a.getErrorText(),this.errorCallback_?n(this.errorCallback_(a,e)):n(e)}else if(t.canceled){n(this.appDelete_?E():b())}else{n(y())}};this.canceled_?t(0,new P(!1,null,!0)):this.backoffId_=function(e,t,r){let n=1,a=null,s=null,i=!1,o=0;function l(){return 2===o}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];t.apply(null,r)}}function d(t){a=setTimeout(()=>{a=null,e(f,l())},t)}function h(){s&&clearTimeout(s)}function f(e){if(c)return void h();for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(e)return h(),void u.call(null,e,...r);if(l()||i)return h(),void u.call(null,e,...r);let s;n<64&&(n*=2),1===o?(o=2,s=0):s=1e3*(n+Math.random()),d(s)}let m=!1;function p(e){m||(m=!0,h(),c||(null!==a?(e||(o=2),clearTimeout(a),d(0)):e||(o=1)))}return d(0),s=setTimeout(()=>{i=!0,p(!0)},r),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class P{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function M(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function L(){const e=M();for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(void 0!==e){const t=new e;for(let e=0;e<r.length;e++)t.append(r[e]);return t.getBlob()}if(A())return new Blob(r);throw new f(m.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function F(e){if("undefined"===typeof atob)throw t="base-64",new f(m.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const U="raw",B="base64",V="base64url",z="data_url";class H{constructor(e,t){this.data=e,this.contentType=t||null}}function W(e,t){switch(e){case U:return new H(G(t));case B:case V:return new H(K(e,t));case z:return new H(function(e){const t=new q(e);return t.base64?K(B,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(r){throw T(z,"Malformed data URL.")}return G(t)}(t.rest)}(t),new q(t).contentType)}throw v()}function G(e){const t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|63&n);else if(55296===(64512&n)){if(r<e.length-1&&56320===(64512&e.charCodeAt(r+1))){n=65536|(1023&n)<<10|1023&e.charCodeAt(++r),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n)}else t.push(239,191,189)}else 56320===(64512&n)?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|63&n)}return new Uint8Array(t)}function K(e,t){switch(e){case B:{const r=-1!==t.indexOf("-"),n=-1!==t.indexOf("_");if(r||n){throw T(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?")}break}case V:{const r=-1!==t.indexOf("+"),n=-1!==t.indexOf("/");if(r||n){throw T(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=F(t)}catch(a){if(a.message.includes("polyfill"))throw a;throw T(e,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class q{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw T(z,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class X{constructor(e,t){let r=0,n="";C(e)?(this.data_=e,r=e.size,n=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=n}size(){return this.size_}type(){return this.type_}slice(e,t){if(C(this.data_)){const r=function(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}(this.data_,e,t);return null===r?null:new X(r)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new X(r,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(A()){const e=t.map(e=>e instanceof X?e.data_:e);return new X(L.apply(null,e))}{const e=t.map(e=>_(e)?W(U,e).data:e.data_);let r=0;e.forEach(e=>{r+=e.byteLength});const n=new Uint8Array(r);let a=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)n[a++]=e[t]}),new X(n,!0)}}uploadData(){return this.data_}}function Y(e){let t;try{t=JSON.parse(e)}catch(n){return null}return"object"!==typeof(r=t)||Array.isArray(r)?null:t;var r}function Q(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function J(e,t){return t}class Z{constructor(e,t,r,n){this.server=e,this.local=t||e,this.writable=!!r,this.xform=n||J}}let ee=null;function te(){if(ee)return ee;const e=[];e.push(new Z("bucket")),e.push(new Z("generation")),e.push(new Z("metageneration")),e.push(new Z("name","fullPath",!0));const t=new Z("name");t.xform=function(e,t){return function(e){return!_(e)||e.length<2?e:Q(e)}(t)},e.push(t);const r=new Z("size");return r.xform=function(e,t){return void 0!==t?Number(t):t},e.push(r),e.push(new Z("timeCreated")),e.push(new Z("updated")),e.push(new Z("md5Hash",null,!0)),e.push(new Z("cacheControl",null,!0)),e.push(new Z("contentDisposition",null,!0)),e.push(new Z("contentEncoding",null,!0)),e.push(new Z("contentLanguage",null,!0)),e.push(new Z("contentType",null,!0)),e.push(new Z("metadata","customMetadata",!0)),ee=e,ee}function re(e,t,r){const n={type:"file"},a=r.length;for(let s=0;s<a;s++){const e=r[s];n[e.local]=e.xform(n,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const r=e.bucket,n=e.fullPath,a=new N(r,n);return t._makeStorageReference(a)}})}(n,e),n}function ne(e,t,r){const n=Y(t);if(null===n)return null;return re(e,n,r)}function ae(e,t){const r={},n=t.length;for(let a=0;a<n;a++){const n=t[a];n.writable&&(r[n.server]=e[n.local])}return JSON.stringify(r)}class se{constructor(e,t,r,n){this.url=e,this.method=t,this.handler=r,this.timeout=n,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function ie(e){if(!e)throw v()}function oe(e,t){return function(r,n){const a=ne(e,n,t);return ie(null!==a),a}}function le(e,t){return function(r,n){const a=ne(e,n,t);return ie(null!==a),function(e,t,r,n){const a=Y(t);if(null===a)return null;if(!_(a.downloadTokens))return null;const s=a.downloadTokens;if(0===s.length)return null;const i=encodeURIComponent;return s.split(",").map(t=>{const a=e.bucket,s=e.fullPath;return R("/b/"+i(a)+"/o/"+i(s),r,n)+O({alt:"media",token:t})})[0]}(a,n,e.host,e._protocol)}}function ce(e){return function(t,r){let n;var a,s;return 401===t.getStatus()?n=t.getErrorText().includes("Firebase App Check token is invalid")?new f(m.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new f(m.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,n=new f(m.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(a=e.path,n=new f(m.UNAUTHORIZED,"User does not have permission to access '"+a+"'.")):n=r,n.status=t.getStatus(),n.serverResponse=r.serverResponse,n}}function ue(e){const t=ce(e);return function(r,n){let a=t(r,n);var s;return 404===r.getStatus()&&(s=e.path,a=new f(m.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),a.serverResponse=n.serverResponse,a}}function de(e,t,r){const n=Object.assign({},r);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),n}function he(e,t,r,n,a){const s=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};const o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();i["Content-Type"]="multipart/related; boundary="+o;const l=de(t,n,a),c="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ae(l,r)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+o+"--",d=X.getBlob(c,n,u);if(null===d)throw w();const h={name:l.fullPath},f=R(s,e.host,e._protocol),m=e.maxUploadRetryTime,p=new se(f,"POST",oe(e,r),m);return p.urlParams=h,p.headers=i,p.body=d.uploadData(),p.errorHandler=ce(t),p}class fe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=p.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=p.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=p.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,n){if(this.sent_)throw k("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==n)for(const a in n)n.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,n[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw k("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw k("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw k("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw k("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class me extends fe{initXhr(){this.xhr_.responseType="text"}}function pe(){return new me}class ge{constructor(e,t){this._service=e,this._location=t instanceof N?t:N.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ge(e,t)}get root(){const e=new N(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Q(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new N(this._location.bucket,e);return new ge(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new f(m.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function ve(e,t,r){e._throwIfRoot("uploadBytes");const n=he(e.storage,e._location,te(),new X(t,!0),r);return e.storage.makeRequestWithTokens(n,pe).then(t=>({metadata:t,ref:e}))}function ye(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,r){const n=R(t.fullServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,s=new se(n,"GET",le(e,r),a);return s.errorHandler=ue(t),s}(e.storage,e._location,te());return e.storage.makeRequestWithTokens(t,pe).then(e=>{if(null===e)throw new f(m.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function be(e,t){const r=function(e,t){const r=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?r:e+"/"+r}(e._location.path,t),n=new N(e._location.bucket,r);return new ge(e.storage,n)}function we(e,t){if(e instanceof Te){const r=e;if(null==r._bucket)throw new f(m.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+h+"' property when initializing the app?");const n=new ge(r,r._bucket);return null!=t?we(n,t):n}return void 0!==t?be(e,t):e}function xe(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Te)return new ge(e,t);throw x("To use ref(service, url), the first argument must be a Storage instance.")}return we(e,t)}function Ee(e,t){const r=null===t||void 0===t?void 0:t[h];return null==r?null:N.makeFromBucketSpec(r,e)}class Te{constructor(e,t,r,n,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=n,this._firebaseVersion=a,this._bucket=null,this._host=d,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=n?N.makeFromBucketSpec(n,this._host):Ee(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=N.makeFromBucketSpec(this._url,e):this._bucket=Ee(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){I("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){I("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ge(this,e)}_makeRequest(e,t,r,n){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new S(E());{const s=function(e,t,r,n,a,s){let i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const o=O(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,r),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,n),new j(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,a,i)}(e,this._appId,r,n,t,this._firebaseVersion,a);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[r,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,n).getPromise()}}const ke="@firebase/storage",Ne="0.13.2",Se="storage";function _e(e,t,r){return ve(e=(0,c.Ku)(e),t,r)}function Ce(e){return ye(e=(0,c.Ku)(e))}function Ae(e,t){return xe(e=(0,c.Ku)(e),t)}function Ie(e,t){let{instanceIdentifier:r}=t;const n=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Te(n,a,s,r,i.MF)}(0,i.om)(new u.uA(Se,Ie,"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(ke,Ne,""),(0,i.KO)(ke,Ne,"esm2017");function Re(e,t){const r={};for(const n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n]));return r}function Oe(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>Oe(e));if("function"===typeof e||"object"===typeof e)return Re(e,e=>Oe(e));throw new Error("Data cannot be encoded in JSON: "+e)}function De(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>De(e)):"function"===typeof e||"object"===typeof e?Re(e,e=>De(e)):e}const je="functions",Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Me extends c.g{constructor(e,t,r){super("".concat(je,"/").concat(e),t||""),this.details=r}}class Le{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(e=>this.auth=e,()=>{}),this.messaging||t.get().then(e=>this.messaging=e,()=>{}),this.appCheck||r.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null===e||void 0===e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const Fe="us-central1";class Ue{constructor(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fe,s=arguments.length>5?arguments[5]:void 0;this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Le(t,r,n),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{const e=new URL(a);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=Fe}catch(i){this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){const r=this.emulatorOrigin;return"".concat(r,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}}function Be(e,t,r){return n=>function(e,t,r,n){const a=e._url(t);return ze(e,a,r,n)}(e,t,n,r||{})}async function Ve(e,t,r,n){let a;r["Content-Type"]="application/json";try{a=await n(e,{method:"POST",body:JSON.stringify(t),headers:r})}catch(i){return{status:0,json:null}}let s=null;try{s=await a.json()}catch(i){}return{status:a.status,json:s}}async function ze(e,t,r,n){const a={data:r=Oe(r)},s={},i=await e.contextProvider.getContext(n.limitedUseAppCheckTokens);i.authToken&&(s.Authorization="Bearer "+i.authToken),i.messagingToken&&(s["Firebase-Instance-ID-Token"]=i.messagingToken),null!==i.appCheckToken&&(s["X-Firebase-AppCheck"]=i.appCheckToken);const o=function(e){let t=null;return{promise:new Promise((r,n)=>{t=setTimeout(()=>{n(new Me("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}(n.timeout||7e4),l=await Promise.race([Ve(t,a,s,e.fetchImpl),o.promise,e.cancelAllRequests]);if(o.cancel(),!l)throw new Me("cancelled","Firebase Functions instance was deleted.");const c=function(e,t){let r,n=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),a=n;try{const e=t&&t.error;if(e){const t=e.status;if("string"===typeof t){if(!Pe[t])return new Me("internal","internal");n=Pe[t],a=t}const s=e.message;"string"===typeof s&&(a=s),r=e.details,void 0!==r&&(r=De(r))}}catch(s){}return"ok"===n?null:new Me(n,a,r)}(l.status,l.json);if(c)throw c;if(!l.json)throw new Me("internal","Response is not valid JSON object.");let u=l.json.data;if("undefined"===typeof u&&(u=l.json.result),"undefined"===typeof u)throw new Me("internal","Response is missing data field.");return{data:De(u)}}const He="@firebase/functions",We="0.11.8";function Ge(e,t,r){return Be((0,c.Ku)(e),t,r)}var Ke,qe;function Xe(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}Ke=fetch.bind(self),(0,i.om)(new u.uA(je,(e,t)=>{let{instanceIdentifier:r}=t;const n=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),s=e.getProvider("messaging-internal"),i=e.getProvider("app-check-internal");return new Ue(n,a,s,i,r,Ke)},"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(He,We,qe),(0,i.KO)(He,We,"esm2017");var $e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ye=["color","size","strokeWidth","absoluteStrokeWidth","children"];var Qe=(e,t)=>{const r=(0,n.forwardRef)((r,a)=>{let{color:i="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:c,children:u}=r,d=Xe(r,Ye);return(0,n.createElement)("svg",(0,s.A)((0,s.A)({ref:a},$e),{},{width:o,height:o,stroke:i,strokeWidth:c?24*Number(l)/Number(o):l,className:"lucide lucide-".concat((h=e,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},d),[...t.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...(Array.isArray(u)?u:[u])||[]]);var h});return r.displayName="".concat(e),r};const Je=Qe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Ze=Qe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),et=Qe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),tt=Qe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),rt=Qe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),nt=Qe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),at=Qe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),st=Qe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),it=Qe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),ot=Qe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),lt=Qe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ct=Qe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),ut=Qe("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),dt=Qe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),ht=Qe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),ft=Qe("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]),mt=Qe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),pt=Qe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),gt=Qe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),vt=Qe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),yt=Qe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var bt=r(579);function wt(e){let{member:t,currentWard:r,wards:a,stakeId:i,db:o,onClose:c,onComplete:u}=e;const[d,h]=(0,n.useState)(""),[f,m]=(0,n.useState)(!1),[p,g]=(0,n.useState)(""),v=a.find(e=>e.id===d);return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Transfer Member"}),(0,bt.jsx)("button",{onClick:c,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:(0,bt.jsx)(gt,{className:"w-5 h-5"})})]}),p&&(0,bt.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[(0,bt.jsx)(vt,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,bt.jsx)("p",{className:"text-sm text-red-700",children:p})]}),(0,bt.jsxs)("div",{className:"mb-6",children:[(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Member"}),(0,bt.jsx)("p",{className:"font-semibold text-gray-800",children:t.fullName}),t.email&&(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:t.email})]}),(0,bt.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,bt.jsxs)("div",{className:"flex-1 bg-blue-50 rounded-lg p-3 border border-blue-200",children:[(0,bt.jsx)("p",{className:"text-xs text-blue-600 mb-1",children:"Current Ward"}),(0,bt.jsx)("p",{className:"font-medium text-blue-800",children:r.name})]}),(0,bt.jsx)(yt,{className:"w-6 h-6 text-gray-400 flex-shrink-0"}),(0,bt.jsxs)("div",{className:"flex-1 bg-green-50 rounded-lg p-3 border border-green-200",children:[(0,bt.jsx)("p",{className:"text-xs text-green-600 mb-1",children:"New Ward"}),(0,bt.jsx)("p",{className:"font-medium text-green-800",children:v?v.name:"Select..."})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transfer to Ward"}),(0,bt.jsxs)("select",{value:d,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:f,children:[(0,bt.jsx)("option",{value:"",children:"Select a ward..."}),a.filter(e=>e.id!==r.id).map(e=>(0,bt.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,bt.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-6",children:(0,bt.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,bt.jsx)("strong",{children:"Note:"})," This will remove the member from any circles in ",r.name,". They will need to be added to a circle in the new ward."]})}),(0,bt.jsxs)("div",{className:"flex gap-3",children:[(0,bt.jsx)("button",{onClick:c,disabled:f,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),(0,bt.jsx)("button",{onClick:async()=>{var e;if(d&&d!==r.id){if(confirm("Transfer ".concat(t.fullName," from ").concat(r.name," to ").concat(null===(e=a.find(e=>e.id===d))||void 0===e?void 0:e.name,"?\n\nThis will:\n- Move their member record\n- Remove them from any circles in the current ward\n- Update their user account (if they have one)"))){m(!0),g("");try{var n;const e=(0,l.wP)(o),c=(0,l.H9)((0,l.collection)(o,"stakes",i,"wards",d,"members"));e.set(c,(0,s.A)((0,s.A)({},t),{},{updatedAt:(new Date).toISOString(),transferredFrom:r.id,transferredAt:(new Date).toISOString()})),await e.commit();const h=(0,l.query)((0,l.collection)(o,"stakes",i,"wards",r.id,"circles")),f=await(0,l.getDocs)(h);for(const n of f.docs){const e=n.data();if((e.memberIds||[]).includes(t.id)){const a=e.memberIds.filter(e=>e!==t.id),s=e.captainId===t.id?null:e.captainId;await(0,l.H9)(o,"stakes",i,"wards",r.id,"circles",n.id).set({memberIds:a,captainId:s},{merge:!0})}}if(t.email){const e=(0,l.query)((0,l.collection)(o,"users"),(0,l.where)("email","==",t.email)),r=await(0,l.getDocs)(e);if(!r.empty){const e=r.docs[0];await(0,l.H9)(o,"users",e.id).set({wardId:d,memberWardId:d,updatedAt:(new Date).toISOString()},{merge:!0})}}await(0,l.kd)((0,l.H9)(o,"stakes",i,"wards",r.id,"members",t.id)),alert("Successfully transferred ".concat(t.fullName," to ").concat(null===(n=a.find(e=>e.id===d))||void 0===n?void 0:n.name)),u()}catch(c){console.error("Error transferring member:",c),g("Failed to transfer member: ".concat(c.message))}finally{m(!1)}}}else g("Please select a different ward")},disabled:!d||f,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Transferring...":"Transfer Member"})]})]})})}var xt,Et={version:"0.20.1"},Tt=1200,kt=1252,Nt=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],St={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_t=function(e){-1!=Nt.indexOf(e)&&(kt=St[0]=e)};var Ct=function(e){Tt=e,_t(e)};function At(){Ct(1200),_t(1252)}function It(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Rt(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Ot(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Dt=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?Rt(e.slice(2)):254==t&&255==r?Ot(e.slice(2)):65279==t?e.slice(1):e},jt=function(e){return String.fromCharCode(e)},Pt=function(e){return String.fromCharCode(e)};var Mt=null,Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ft(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Lt.charAt(s)+Lt.charAt(i)+Lt.charAt(o)+Lt.charAt(l);return t}function Ut(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0;e=e.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=Lt.indexOf(e.charAt(l++))<<2|(s=Lt.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&s)<<4|(i=Lt.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(n)),a=(3&i)<<6|(o=Lt.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var Bt=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Vt=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),zt=function(){if("undefined"===typeof Buffer)return!1;var e=Vt([65,0]);return!!e&&1==e.toString("utf16le").length}();function Ht(e){return Bt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Wt(e){return Bt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Gt=function(e){return Bt?Vt(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Kt(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qt(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qt(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xt=Bt?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:Vt(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):"string"==typeof e[t]?n.set(new Uint8Array(Gt(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var $t=/\u0000/g,Yt=/[\u0001-\u0006]/g;function Qt(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Jt(e,t){var r=""+e;return r.length>=t?r:an("0",t-r.length)+r}function Zt(e,t){var r=""+e;return r.length>=t?r:an(" ",t-r.length)+r}function er(e,t){var r=""+e;return r.length>=t?r:r+an(" ",t-r.length)}var tr=Math.pow(2,32);function rr(e,t){return e>tr||e<-tr?function(e,t){var r=""+Math.round(e);return r.length>=t?r:an("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:an("0",t-r.length)+r}(Math.round(e),t)}function nr(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var ar=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sr=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var ir={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},or={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lr={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function cr(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(a);c<t&&(o=(d=Math.floor(a))*i+s,u=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function ur(e,t,r){if(e>2958465||e<0)return null;var n=0|(e=function(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return(r=r.indexOf(".")>-1?r.slice(0,"0."==r.slice(0,2)?17:16):r.slice(0,15)+an("0",r.length-15))+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,"0."==t.slice(0,2)?17:16):t.slice(0,15)+an("0",t.length-15);return Number(n)}(e)),a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++n,++o.D)),60===n)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}function dr(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hr(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=dr(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=dr(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),dr(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function fr(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):hr(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return jr(14,$r(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function mr(e,t,r,n){var a,s="",i=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return sr[r.m-1][1];case 5:return sr[r.m-1][0];default:return sr[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return ar[r.q][0];default:return ar[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=n>=2?3===n?1e3:100:1===n?10:1,(i=Math.round(o*(r.S+r.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=Jt(i,2+n),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Jt(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+(0==n?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Jt(a,c):""}function pr(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var gr=/%/g;function vr(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+vr(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var yr=/# (\?+)( ?)\/( ?)(\d+)/;var br=/^#*0*\.([0#]+)/,wr=/\).*[0#]/,xr=/\(###\) ###\\?-####/;function Er(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Tr(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function kr(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Nr(e,t,r){if(40===e.charCodeAt(0)&&!t.match(wr)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Nr("n",n,r):"("+Nr("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Cr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(gr,""),a=t.length-n.length;return Cr(e,n,r*Math.pow(10,2*a))+an("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return vr(t,r);if(36===t.charCodeAt(0))return"$"+Nr(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+rr(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=rr(r,0))&&(a=""),a.length>t.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(yr))return function(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(0===s?"":""+s)+" "+(0===i?an(" ",e[1].length+1+e[4].length):Zt(i,e[1].length)+e[2]+"/"+e[3]+Jt(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+rr(l,t.length-t.indexOf("0"));if(s=t.match(br))return a=Tr(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Er(s[1])).replace(/\.$/,"."+Er(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+an("0",Er(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Tr(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+pr(rr(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Nr(e,t,-r):pr(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,s[1].length)))+"."+Jt(kr(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Nr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Qt(Nr(e,t.replace(/[\\-]/g,""),r)),i=0,Qt(Qt(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(xr))return"("+(a=Nr(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=cr(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=Cr("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=er(o[2],i)).length<s[4].length&&(u=Er(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=cr(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Zt(o[1],i)+s[2]+"/"+s[3]+er(o[2],i):an(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=rr(r,0),t.length<=a.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Er(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=kr(r,s[1].length),r<0?"-"+Nr(e,t,-r):pr(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Jt(0,3-e.length):"")+e})+"."+Jt(i,s[1].length);switch(t){case"###,##0.00":return Nr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=pr(rr(l,0));return"0"!==f?c+f:"";case"###,###.00":return Nr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Nr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Sr(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Sr(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _r(e,t,r){if(40===e.charCodeAt(0)&&!t.match(wr)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_r("n",n,r):"("+_r("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Cr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(gr,""),a=t.length-n.length;return Cr(e,n,r*Math.pow(10,2*a))+an("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return Sr(t,r);if(36===t.charCodeAt(0))return"$"+_r(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Jt(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(yr))return function(e,t,r){return r+(0===t?"":""+t)+an(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+Jt(l,t.length-t.indexOf("0"));if(s=t.match(br))return a=(a=(""+r).replace(/^([^\.]+)$/,"$1."+Er(s[1])).replace(/\.$/,"."+Er(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+an("0",Er(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+pr(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_r(e,t,-r):pr(""+r)+"."+an("0",s[1].length);if(s=t.match(/^#,#*,#0/))return _r(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Qt(_r(e,t.replace(/[\\-]/g,""),r)),i=0,Qt(Qt(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(xr))return"("+(a=_r(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=cr(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=Cr("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=er(o[2],i)).length<s[4].length&&(u=Er(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=cr(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Zt(o[1],i)+s[2]+"/"+s[3]+er(o[2],i):an(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Er(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_r(e,t,-r):pr(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Jt(0,3-e.length):"")+e})+"."+Jt(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=pr(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return _r(e,t.slice(0,t.lastIndexOf(".")),r)+Er(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Cr(e,t,r){return(0|r)===r?_r(e,t,r):Nr(e,t,r)}var Ar=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ir(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":nr(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(Ar))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Rr=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Or(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function Dr(e,t){var r=function(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(Rr),o=r[1].match(Rr);return Or(t,i)?[n,r[0]]:Or(t,o)?[n,r[1]]:[n,r[null!=i&&null!=o?2:1]]}return[n,s]}function jr(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:ir)[e])&&(n=r.table&&r.table[or[e]]||ir[or[e]]),null==n&&(n=lr[e]||"General")}if(nr(n,0))return fr(t,r);t instanceof Date&&(t=$r(t,r.date1904));var a=Dr(n,t);if(nr(a[1]))return fr(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var a,s,i,o=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!nr(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";o[o.length]={t:m,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=ur(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=ur(t,r)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),o[o.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var p={t:u,v:u};if(null==a&&(a=ur(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(p.v=a.H>=12?e.charAt(c+2):u),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==a&&"T"===p.t)return"";o[o.length]=p,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Ar)){if(null==a&&null==(a=ur(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ir(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===n?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v,y=0,b=0;for(c=o.length-1,d="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,d="h",y<1&&(y=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1),y=4),y<3&&(y=3);case"d":case"y":case"e":d=o[c].t;break;case"M":d=o[c].t,y<2&&(y=2);break;case"m":"s"===d&&(o[c].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&o[c].v.match(/[Hh]/)&&(y=1),y<2&&o[c].v.match(/[Mm]/)&&(y=2),y<3&&o[c].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:case 2:case 3:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H),a.H>=24&&(a.H=0,++a.D,(v=ur(a.D)).u=a.u,v.S=a.S,v.M=a.M,v.H=a.H,a=v);break;case 4:switch(b){case 1:a.u=Math.round(10*a.u)/10;break;case 2:a.u=Math.round(100*a.u)/100;break;case 3:a.u=Math.round(1e3*a.u)/1e3}a.u>=1&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H),a.H>=24&&(a.H=0,++a.D,(v=ur(a.D)).u=a.u,v.S=a.S,v.M=a.M,v.H=a.H,a=v)}var w,x="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=mr(o[c].t.charCodeAt(0),o[c].v,a,b),o[c].t="t";break;case"n":case"?":for(w=c+1;null!=o[w]&&("?"===(u=o[w].t)||"D"===u||(" "===u||"t"===u)&&null!=o[w+1]&&("?"===o[w+1].t||"t"===o[w+1].t&&"/"===o[w+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[w].v||" "===o[w].v&&null!=o[w+1]&&"?"==o[w+1].t));)o[c].v+=o[w].v,o[w]={v:"",t:";"},++w;x+=o[c].v,c=w-1;break;case"G":o[c].t="t",o[c].v=fr(t,r)}var E,T,k="";if(x.length>0){40==x.charCodeAt(0)?(E=t<0&&45===x.charCodeAt(0)?-t:t,T=Cr("n",x,E)):(T=Cr("n",x,E=t<0&&n>1?-t:t),E<0&&o[0]&&"t"==o[0].t&&(T=T.substr(1),o[0].v="-"+o[0].v)),w=T.length-1;var N=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){N=c;break}var S=o.length;if(N===o.length&&-1===T.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(w>=o[c].v.length-1?(w-=o[c].v.length,o[c].v=T.substr(w+1,o[c].v.length)):w<0?o[c].v="":(o[c].v=T.substr(0,w+1),w=-1),o[c].t="t",S=c);w>=0&&S<o.length&&(o[S].v=T.substr(0,w+1)+o[S].v)}else if(N!==o.length&&-1===T.indexOf("E")){for(w=T.indexOf(".")-1,c=N;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===N?o[c].v.indexOf(".")-1:o[c].v.length-1,k=o[c].v.substr(s+1);s>=0;--s)w>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(k=T.charAt(w--)+k);o[c].v=k,o[c].t="t",S=c}for(w>=0&&S<o.length&&(o[S].v=T.substr(0,w+1)+o[S].v),w=T.indexOf(".")+1,c=N;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===N)){for(s=o[c].v.indexOf(".")>-1&&c===N?o[c].v.indexOf(".")+1:0,k=o[c].v.substr(0,s);s<o[c].v.length;++s)w<T.length&&(k+=T.charAt(w++));o[c].v=k,o[c].t="t",S=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(E=n>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Cr(o[c].t,o[c].v,E),o[c].t="t");var _="";for(c=0;c!==o.length;++c)null!=o[c]&&(_+=o[c].v);return _}(a[1],t,r,a[0])}function Pr(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=ir[r]){if(ir[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return ir[t]=e,t}function Mr(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',ir=e}var Lr={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Fr=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Ur={"d.m":"d\\.m"};function Br(e,t){return Pr(Ur[e]||e,t)}var Vr,zr=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!==typeof Int32Array&&"function"==typeof a.subarray?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return s}(t),n=r[0],a=r[1],s=r[2],i=r[3],o=r[4],l=r[5],c=r[6],u=r[7],d=r[8],h=r[9],f=r[10],m=r[11],p=r[12],g=r[13],v=r[14];return e.table=t,e.bstr=function(e,r){for(var n=-1^r,a=0,s=e.length;a<s;)n=n>>>8^t[255&(n^e.charCodeAt(a++))];return~n},e.buf=function(e,r){for(var y=-1^r,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^p[e[w++]^y>>16&255]^m[e[w++]^y>>>24]^f[e[w++]]^h[e[w++]]^d[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^i[e[w++]]^s[e[w++]]^a[e[w++]]^n[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,r){for(var n=-1^r,a=0,s=e.length,i=0,o=0;a<s;)(i=e.charCodeAt(a++))<128?n=n>>>8^t[255&(n^i)]:i<2048?n=(n=n>>>8^t[255&(n^(192|i>>6&31))])>>>8^t[255&(n^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[255&(n^(240|i>>8&7))])>>>8^t[255&(n^(128|i>>2&63))])>>>8^t[255&(n^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(n^(128|63&o))]):n=(n=(n=n>>>8^t[255&(n^(224|i>>12&15))])>>>8^t[255&(n^(128|i>>6&63))])>>>8^t[255&(n^(128|63&i))];return~n},e}(),Hr=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function s(e){za(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),a=e.read_shift(2),s=e.l+a,i={};switch(n){case 21589:1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),a>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));break;case 1:var o=e.read_shift(4),l=e.read_shift(4);i.usz=l*Math.pow(2,32)+o,o=e.read_shift(4),l=e.read_shift(4),i.csz=l*Math.pow(2,32)+o}e.l=s,t[n]=i}return t}function i(){return e||(e=Vr)}function o(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=E(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(Bt&&Buffer.isBuffer(e)?e.toString("binary"):E(e)).split("\r\n"),a=0,s="";for(a=0;a<n.length;++a)if(s=n[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var i=(n[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,f=0;for(a=0;a<n.length;++a){var m=n[a];m!==o&&m!==o+"--"||(f++&&ce(u,n.slice(d,a),r),d=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,a,s,i,o,f=512,m=[],p=e.slice(0,512);za(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&za(p=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var w=p.read_shift(4,"i");if(3===r&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),n=p.read_shift(4,"i"),o=p.read_shift(4,"i"),a=p.read_shift(4,"i");for(var x=-1,T=0;T<109&&!((x=p.read_shift(4,"i"))<0);++T)m[T]=x;var k=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);c(o,a,k,f,m);var N=function(e,t,r,n){var a=e.length,s=[],i=[],o=[],l=[],c=n-1,u=0,d=0,h=0,f=0;for(u=0;u<a;++u)if(o=[],(h=u+t)>=a&&(h-=a),!i[h]){l=[];var m=[];for(d=h;d>=0;){m[d]=!0,i[d]=!0,o[o.length]=d,l.push(e[d]);var p=r[Math.floor(4*d/n)];if(n<4+(f=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+n);if(!e[p])break;if(m[d=ja(e[p],f)])break}s[h]={nodes:o,data:ca([l])}}return s}(k,s,m,f);s<N.length&&(N[s].name="!Directory"),n>0&&i!==v&&(N[i].name="!MiniFAT"),N[m[0]].name="!FAT",N.fat_addrs=m,N.ssz=f;var S=[],_=[],C=[];!function(e,t,r,n,a,s,i,o){for(var c,h=0,f=n.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var y=m.slice(p,p+128);za(y,64),g=y.read_shift(2),c=da(y,0,g-f),n.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=d(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(h=b.start,a>0&&h!==v&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==v&&b.start!==v&&t[h]&&(b.content=l(b,t[h].data,(t[o]||{}).data))),b.content&&za(b.content,0),s[c]=b,i.push(b)}}(s,N,k,S,n,{},_,i),function(e,t,r){for(var n=0,a=0,s=0,i=0,o=0,l=r.length,c=[],u=[];n<l;++n)c[n]=u[n]=n,t[n]=r[n];for(;o<u.length;++o)a=e[n=u[o]].L,s=e[n].R,i=e[n].C,c[n]===n&&(-1!==a&&c[a]!==a&&(c[n]=c[a]),-1!==s&&c[s]!==s&&(c[n]=c[s])),-1!==i&&(c[i]=n),-1!==a&&n!=c[n]&&(c[a]=c[n],u.lastIndexOf(a)<o&&u.push(a)),-1!==s&&n!=c[n]&&(c[s]=c[n],u.lastIndexOf(s)<o&&u.push(s));for(n=1;n<l;++n)c[n]===n&&(-1!==s&&c[s]!==s?c[n]=c[s]:-1!==a&&c[a]!==a&&(c[n]=c[a]));for(n=1;n<l;++n)if(0!==e[n].type){if((o=n)!=c[o])do{o=c[o],t[n]=t[o]+"/"+t[n]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(_,C,S),S.shift();var A={FileIndex:_,FullPaths:C};return t&&t.raw&&(A.raw={header:b,sectors:k}),A}function l(e,t,r){for(var n=e.start,a=e.size,s=[],i=n;r&&a>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),a-=g,i=ja(r,4*i);return 0===s.length?Wa(0):Xt(s).slice(0,e.size)}function c(e,t,r,n,a){var s=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],o=(n>>>2)-1;if(!i)return;for(var l=0;l<o&&(s=ja(i,4*l))!==v;++l)a.push(s);t>=1&&c(ja(i,n-4),t-1,r,n,a)}}function u(e,t,r,n,a){var s=[],i=[];a||(a=[]);var o=n-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,s[s.length]=l,i.push(e[l]);var u=r[Math.floor(4*l/n)];if(n<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=ja(e[u],c)}return{nodes:s,data:ca([i])}}function d(e,t){return new Date(1e3*(Da(e,t+4)/1e7*Math.pow(2,32)+Da(e,t)/1e7-11644473600))}function h(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(Hr.find(e,"/"+t))return;var r=Wa(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(i=0;i<e.FullPaths.length;++i)u[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&d.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<d.length;++i){var f=r(d[i][0]);for(s=u[f];!s;){for(;r(f)&&!u[r(f)];)f=r(f);d.push([f,{name:n(f).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[f]=!0,s=u[f=r(d[i][0])]}}for(d.sort(function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,s=0,i=Math.min(r.length,n.length);a<i;++a){if(s=r[a].length-n[a].length)return s;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<d.length;++i)e.FullPaths[i]=d[i][0],e.FileIndex[i]=d[i][1];for(i=0;i<d.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=n(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||w,0===i)m.C=d.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<d.length&&r(e.FullPaths[c])!=p;++c);for(m.C=c>=d.length?-1:c,c=i+1;c<d.length&&r(e.FullPaths[c])!=r(p);++c);m.R=c>=d.length?-1:c,m.type=1}else r(e.FullPaths[i+1]||"")==r(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,u=Bt&&Buffer.isBuffer(c)?c.toString("binary"):E(c),d=0,h=Math.min(1024,u.length),f=0,m=0;m<=h;++m)(f=u.charCodeAt(m))>=32&&f<128&&++d;var p=d>=4*h/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),a.push("Content-Type: "+ie(o,i)),a.push(""),a.push(p?le(u):oe(u))}return a.push(n+"--\r\n"),a.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],s=[],i=Wa(1),o=r.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var y=d,b=Wa(m.length);for(u=0;u<m.length;++u)b.write_shift(1,127&m.charCodeAt(u));b=b.slice(0,b.l),g[h]="string"==typeof p.content?zr.bstr(p.content,0):zr.buf(p.content,0);var w="string"==typeof p.content?Gt(p.content):p.content;8==o&&(w=T(w)),(i=Wa(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),p.mt?a(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[h]),i.write_shift(4,8&l?0:w.length),i.write_shift(4,8&l?0:p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),d+=i.length,n.push(i),d+=b.length,n.push(b),d+=w.length,n.push(w),8&l&&((i=Wa(12)).write_shift(-4,g[h]),i.write_shift(4,w.length),i.write_shift(4,p.content.length),d+=i.l,n.push(i)),(i=Wa(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,w.length),i.write_shift(4,p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,y),v+=i.l,s.push(i),v+=b.length,s.push(b),++h}return i=Wa(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,v),i.write_shift(4,d),i.write_shift(2,0),Xt([Xt(n),Xt(s),i])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+r+i+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,o,i,r,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),s=Wa(n[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,b[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:v),s.write_shift(4,n[1]),i=0;i<109;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);if(n[1])for(o=0;o<n[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);s.write_shift(-4,o===n[1]-1?v:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,v))};for(o=i=0,o+=n[1];i<o;++i)s.write_shift(-4,x.DIFSECT);for(o+=n[2];i<o;++i)s.write_shift(-4,x.FATSECT);l(n[3]),l(n[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=o,l(u+511>>9)));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=o,l(u+63>>6)));for(;511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(i=0;i<n[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){d=e.FileIndex[i],0===i&&(d.start=d.size?d.start-1:v);var m=0===i&&r.root||d.name;if(m.length>32&&(console.error("Name "+m+" will be truncated to "+m.slice(0,32)),m=m.slice(0,32)),u=2*(m.length+1),s.write_shift(64,m,"utf16le"),s.write_shift(2,u),s.write_shift(1,d.type),s.write_shift(1,d.color),s.write_shift(-4,d.L),s.write_shift(-4,d.R),s.write_shift(-4,d.C),d.clsid)s.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,d.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,d.start),s.write_shift(4,d.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>=4096)if(s.l=d.start+1<<9,Bt&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>0&&d.size<4096)if(Bt&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(Bt)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.2";var p,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function E(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function T(e){return p?p.deflateRawSync(e):X(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var C="undefined"!==typeof Uint8Array,A=C?new Uint8Array(256):[],I=0;I<256;++I)A[I]=_(I);function R(e,t){var r=A[255&e];return t<=8?r>>>8-t:(r=r<<8|A[e>>8&255],t<=16?r>>>16-t:(r=r<<8|A[e>>16&255])>>>24-t)}function O(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function D(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function j(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function M(e,t,r){var n=7&t,a=t>>>3,s=(1<<r)-1,i=e[a]>>>n;return r<8-n?i&s:(i|=e[a+1]<<8-n,r<16-n?i&s:(i|=e[a+2]<<16-n,r<24-n?i&s:(i|=e[a+3]<<24-n)&s))}function L(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function F(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function U(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function V(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(Bt){var s=Wt(n);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(C){var i=new Uint8Array(n);if(i.set)i.set(e);else for(;a<r;++a)i[a]=e[a];return i}return e.length=n,e}function z(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var n=1,a=0,s=0,i=0,o=0,l=e.length,c=C?new Uint16Array(32):z(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<r;++s)e[s]=0;l=e.length;var u=C?new Uint16Array(l):z(l);for(s=0;s<l;++s)c[a=e[s]]++,n<a&&(n=a),u[s]=0;for(c[0]=0,s=1;s<=n;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(u[s]=c[o+16]++);var d=0;for(s=0;s<l;++s)if(0!=(d=e[s]))for(o=R(u[s],n)>>n-d,i=(1<<n+4-d)-1;i>=0;--i)t[o|i<<d]=15&d|s<<4;return n}var W=C?new Uint16Array(512):z(512),G=C?new Uint16Array(32):z(32);if(!C){for(var K=0;K<512;++K)W[K]=0;for(K=0;K<32;++K)G[K]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,G,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,W,288)}();var q=function(){for(var e=C?new Uint8Array(32768):[],t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=C?new Uint8Array(259):[];for(t=0,r=0;t<N.length-1;++t)for(;r<N[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),a=r+n==e.length;for(t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var a=0,s=0,i=C?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(a=L(r,a,+!(s+o!=t.length)))&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[s++];a=8*r.l}else{a=L(r,a,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],u=-1,d=0;if((u=i[l=32767&(l<<5^c)])&&((u|=-32768&s)>s&&(u-=32768),u<s))for(;t[u+d]==t[s+d]&&d<250;)++d;if(d>2){(c=n[d])<=22?a=U(r,a,A[c+1]>>1)-1:(U(r,a,3),U(r,a+=5,A[c-23]>>5),a+=3);var h=c<8?0:c-4>>2;h>0&&(B(r,a,d-N[c]),a+=h),c=e[s-u],a=U(r,a,A[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(B(r,a,s-u-S[c]),a+=f);for(var m=0;m<d;++m)i[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=d-1}else c<=143?c+=48:a=F(r,a,1),a=U(r,a,A[c]),i[l]=32767&s,++s}a=U(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}(t,r)}}();function X(e){var t=Wa(50+Math.floor(1.1*e.length)),r=q(e,t);return t.slice(0,r)}var $=C?new Uint16Array(32768):z(32768),Y=C?new Uint16Array(32768):z(32768),Q=C?new Uint16Array(128):z(128),J=1,Z=1;function ee(e,t){var r=j(e,t)+257,n=j(e,t+=5)+1,a=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,i=C?new Uint8Array(19):z(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=C?new Uint8Array(8):z(8),u=C?new Uint8Array(8):z(8),d=i.length,h=0;h<a;++h)i[k[h]]=s=D(e,t),l<s&&(l=s),c[s]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)u[h]=f=f+c[h-1]<<1;for(h=0;h<d;++h)0!=(f=i[h])&&(o[h]=u[f]++);var m=0;for(h=0;h<d;++h)if(0!=(m=i[h])){f=A[o[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)Q[f|p<<m]=7&m|h<<3}var g=[];for(l=1;g.length<r+n;)switch(t+=7&(f=Q[P(e,t)]),f>>>=3){case 16:for(s=3+O(e,t),t+=2,f=g[g.length-1];s-- >0;)g.push(f);break;case 17:for(s=3+D(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+P(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var v=g.slice(0,r),y=g.slice(r);for(h=r;h<286;++h)v[h]=0;for(h=n;h<30;++h)y[h]=0;return J=H(v,$,286),Z=H(y,Y,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[Ht(t),2];for(var r=0,n=0,a=Wt(t||1<<18),s=0,i=a.length>>>0,o=0,l=0;0==(1&n);)if(n=D(e,r),r+=3,n>>>1!=0)for(n>>1==1?(o=9,l=5):(r=ee(e,r),o=J,l=Z);;){!t&&i<s+32767&&(i=(a=V(a,s+32767)).length);var c=M(e,r,o),u=n>>>1==1?W[c]:$[c];if(r+=15&u,0===((u>>>=4)>>>8&255))a[s++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=s+N[u];d>0&&(h+=M(e,r,d),r+=d),c=M(e,r,l),r+=15&(u=n>>>1==1?G[c]:Y[c]);var f=(u>>>=4)<4?0:u-2>>1,m=S[u];for(f>0&&(m+=M(e,r,f),r+=f),!t&&i<h&&(i=(a=V(a,h+100)).length);s<h;)a[s]=a[s-m],++s}}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,p>0)for(!t&&i<s+p&&(i=(a=V(a,s+p)).length);p-- >0;)a[s++]=e[r>>>3],r+=8}return t?[a,r+7>>>3]:[a.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;za(r,0);var n={FileIndex:[],FullPaths:[]};h(n,{root:t.root});for(var a=r.length-4;(80!=r[a]||75!=r[a+1]||5!=r[a+2]||6!=r[a+3])&&a>=0;)--a;r.l=a+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var o=r.read_shift(4);for(r.l=o,a=0;a<i;++a){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),u=r.read_shift(2),d=r.read_shift(2),f=r.read_shift(2);r.l+=8;var m=r.read_shift(4),p=s(r.slice(r.l+u,r.l+u+d));r.l+=u+d+f;var g=r.l;r.l=m+4,p&&p[1]&&((p[1]||{}).usz&&(c=p[1].usz),(p[1]||{}).csz&&(l=p[1].csz)),ae(r,l,c,n,p),r.l=g}return n}function ae(e,t,r,n,a){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r,s=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(s-1),n.setDate(a);var i=31&t,o=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(o),n.setSeconds(i<<1),n}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<d;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=s(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),(g[1]||{}).usz&&(u=g[1].usz),(g[1]||{}).csz&&(c=g[1].csz),a&&((a[21589]||{}).mt&&(l=a[21589].mt),(a[1]||{}).usz&&(u=g[1].usz),(a[1]||{}).csz&&(c=g[1].csz))}e.l+=h;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&re(y,"Bad compressed size: "+t+" != "+c),u!=r&&re(y,"Bad uncompressed size: "+r+" != "+u),ue(n,f,v,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&se[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&se[n[1]]?se[n[1]]:"application/octet-stream"}function oe(e){for(var t=Ft(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<n.length;++a){var s=n[a];if(0!=s.length)for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,a="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":n=Gt(Ut(t.slice(o).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Gt(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var u=ue(e,a.slice(r.length),n,{unsafe:!0});i&&(u.ctype=i)}function ue(e,t,r,a){var s=a&&a.unsafe;s||h(e);var i=!s&&Hr.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:n(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||Hr.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),n=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===a?r.indexOf(s):n.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(Yt);for(s=s.replace($t,""),o&&(s=s.replace(Yt,"!")),i=0;i<r.length;++i){if((o?r[i].replace(Yt,"!"):r[i]).replace($t,"")==s)return e.FileIndex[i];if((o?n[i].replace(Yt,"!"):n[i]).replace($t,"")==s)return e.FileIndex[i]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||Bt&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return i(),o(e.readFileSync(t),r)}(t,r);case"base64":return o(Gt(Ut(t)),r);case"binary":return o(Gt(t),r)}return o(t,r)},t.parse=o,t.write=function(t,r){var n=m(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:E(n);case"base64":return Ft("string"==typeof n?n:E(n));case"buffer":if(Bt)return Buffer.isBuffer(n)?n:Vt(n);case"array":return"string"==typeof n?Gt(n):n}return n},t.writeFile=function(t,r,n){i();var a=m(t,n);e.writeFileSync(r,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var r=Hr.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){h(e);var a=Hr.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=n(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Ma,CheckField:Va,prep_blob:za,bconcat:Xt,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(r){console.error("cannot use native zlib: "+(r.message||r))}},_deflateRaw:X,_inflateRaw:te,consts:x},t}();function Wr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Gr(e){for(var t=[],r=Wr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Kr=Date.UTC(1899,11,30,0,0,0),qr=Date.UTC(1899,11,31,0,0,0),Xr=Date.UTC(1904,0,1,0,0,0);function $r(e,t){var r=(e.getTime()-Kr)/864e5;return t?(r-=1462)<-1402?r-1:r:r<60?r-1:r}function Yr(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime(24*(e>60?e:e+1)*60*60*1e3+Kr),t}function Qr(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(a[s],10)}return t}var Jr=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,Zr=/^(\d+)-(\d+)-(\d+)$/,en=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function tn(e,t){if(e instanceof Date)return e;var r=e.match(Jr);return r?new Date((t?Xr:qr)+1e3*(60*(60*parseInt(r[1],10)+parseInt(r[2],10))+(r[3]?parseInt(r[3].slice(1),10):0))+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0)):(r=e.match(Zr))?new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0)):(r=e.match(en))?new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt(r[7].slice(1),10)||0)):new Date(e)}function rn(e,t){if(Bt&&Buffer.isBuffer(e)){if(t&&zt){if(255==e[0]&&254==e[1])return Xn(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Xn(Ot(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Xn(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Xn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return r[e]||e})}catch(s){}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch(s){try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch(s){for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function nn(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=nn(e[r]));return t}function an(e,t){for(var r="";r.length<t;)r+=e;return r}function sn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(n))?t:t/r):t/r}var on=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,ln=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,cn=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,un=-177984e5==new Date("6/9/69 00:00 UTC").valueOf();var dn=["january","february","march","april","may","june","july","august","september","october","november","december"];function hn(e){if(cn.test(e))return-1==e.indexOf("Z")?pn(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(on);if(n)return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),0,0,0))}(n);if(n=r.match(ln))return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}(n);if(n=r.match(en))return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt(n[7].slice(1),10)||0));var a=new Date(un&&-1==e.indexOf("UTC")?e+" UTC":e),s=new Date(NaN),i=a.getYear(),o=(a.getMonth(),a.getDate());if(isNaN(o))return s;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==dn.indexOf(t))return s}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return s;return i<0||i>8099||e.match(/[^-0-9:,\/\\\ ]/)?s:a}var fn=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var a=t.split(r),s=[a[0]],i=1;i<a.length;++i)s.push(n),s.push(a[i]);return s}}();function mn(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function pn(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function gn(e){return e?e.content&&e.type?rn(e.content,!0):e.data?Dt(e.data):e.asNodeBuffer&&Bt?Dt(e.asNodeBuffer().toString("binary")):e.asBinary?Dt(e.asBinary()):e._data&&e._data.getContent?Dt(rn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function vn(e){if(!e)return null;if(e.data)return It(e.data);if(e.asNodeBuffer&&Bt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?It(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function yn(e,t){for(var r=e.FullPaths||Wr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function bn(e,t){var r=yn(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function wn(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?vn(e):gn(e)}(bn(e,t));if(!t)return null;try{return wn(e,t)}catch(n){return null}}function xn(e,t,r){if(!r)return gn(bn(e,t));if(!t)return null;try{return xn(e,t)}catch(n){return null}}function En(e,t,r){if(!r)return vn(bn(e,t));if(!t)return null;try{return En(e,t)}catch(n){return null}}function Tn(e){for(var t=e.FullPaths||Wr(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function kn(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=Bt?Vt(r):function(e){for(var t=[],r=0,n=e.length+250,a=Ht(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(3&i)<<4,a[r++]=128|63&o}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|63&i;r>n&&(t.push(a.slice(0,r)),r=0,a=Ht(65535),n=65530)}return t.push(a.slice(0,r)),Xt(t)}(r),Hr.utils.cfb_add(e,t,n);Hr.utils.cfb_add(e,t,r)}else e.file(t,r)}function Nn(e,t){switch(t.type){case"base64":return Hr.read(e,{type:"base64"});case"binary":return Hr.read(e,{type:"binary"});case"buffer":case"array":return Hr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Sn(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var a=n.shift();".."===a?r.pop():"."!==a&&r.push(a)}return r.join("/")}var _n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Cn=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,An=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,In=_n.match(An)?An:/<[^>]*>/g,Rn=/<\w*:/,On=/<(\/?)\w+:/;function Dn(e,t,r){for(var n={},a=0,s=0;a!==e.length&&(32!==(s=e.charCodeAt(a))&&10!==s&&13!==s);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(Cn),o=0,l="",c=0,u="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&61!==d.charCodeAt(s);++s);for(u=d.slice(0,s).trim();32==d.charCodeAt(s+1);)++s;for(h=34==(a=d.charCodeAt(s+1))||39==a?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(n[f]&&"ext"==u.slice(o-3,o))continue;n[f]=l,r||(n[f.toLowerCase()]=l)}}return n}function jn(e){return e.replace(On,"<$1")}var Pn={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Mn=Gr(Pn),Ln=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(-1==s)return a.replace(e,function(e,t){return Pn[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}return function(e,t){var n=r(e);return t?n.replace(/\r\n/g,"\n"):n}}(),Fn=/[&<>'"]/g;var Un=/[\u0000-\u001f]/g;function Bn(e){return(e+"").replace(Fn,function(e){return Mn[e]}).replace(/\n/g,"<br/>").replace(Un,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var Vn=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function zn(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Hn(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(i=(31&n)<<6,i|=63&a,t+=String.fromCharCode(i)):(s=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&s):(o=((7&n)<<18|(63&a)<<12|(63&s)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Wn(e){var t,r,n,a=Ht(2*e.length),s=1,i=0,o=0;for(r=0;r<e.length;r+=s)s=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),s=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[i++]=255&o,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function Gn(e){return Vt(e,"binary").toString("utf8")}var Kn="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",qn=Bt&&(Gn(Kn)==Hn(Kn)&&Gn||Wn(Kn)==Hn(Kn)&&Wn)||Hn,Xn=Bt?function(e){return Vt(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},$n=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),Yn=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),Qn=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Jn=/<\/?(?:vt:)?variant>/g,Zn=/<(?:vt:)([^>]*)>([\s\S]*)</;function ea(e,t){var r=Dn(e),n=e.match(Qn(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(e){var t=e.replace(Jn,"").match(Zn);t&&a.push({v:qn(t[2]),t:t[1]})}),a}var ta=/(^\s|\s$|\n)/;function ra(e){return Wr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function na(e,t,r){return"<"+e+(null!=r?ra(r):"")+(null!=t?(t.match(ta)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function aa(e){if(Bt&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return qn(Kt(qt(e)));throw new Error("Bad input format: expected Buffer or string")}var sa=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/](?:[^>=]|="[^"]*?")*)?>/gm,ia="http://schemas.openxmlformats.org/package/2006/content-types",oa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var la=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,a=e[0][r].length;n<a;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},ca=Bt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:Vt(e)})):la(e)}:la,ua=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ra(e,a)));return n.join("").replace($t,"")},da=Bt?function(e,t,r){return Buffer.isBuffer(e)&&zt?e.toString("utf16le",t,r).replace($t,""):ua(e,t,r)}:ua,ha=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},fa=Bt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ha(e,t,r)}:ha,ma=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ia(e,a)));return n.join("")},pa=Bt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):ma(e,t,r)}:ma,ga=function(e,t){var r=Da(e,t);return r>0?pa(e,t+4,t+4+r-1):""},va=ga,ya=function(e,t){var r=Da(e,t);return r>0?pa(e,t+4,t+4+r-1):""},ba=ya,wa=function(e,t){var r=2*Da(e,t);return r>0?pa(e,t+4,t+4+r-1):""},xa=wa,Ea=function(e,t){var r=Da(e,t);return r>0?da(e,t+4,t+4+r):""},Ta=Ea,ka=function(e,t){var r=Da(e,t);return r>0?pa(e,t+4,t+4+r):""},Na=ka,Sa=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}(e,t)},_a=Sa,Ca=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Aa(){da=function(e,t,r){return xt.utils.decode(1200,e.slice(t,r)).replace($t,"")},pa=function(e,t,r){return xt.utils.decode(65001,e.slice(t,r))},va=function(e,t){var r=Da(e,t);return r>0?xt.utils.decode(kt,e.slice(t+4,t+4+r-1)):""},ba=function(e,t){var r=Da(e,t);return r>0?xt.utils.decode(Tt,e.slice(t+4,t+4+r-1)):""},xa=function(e,t){var r=2*Da(e,t);return r>0?xt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Ta=function(e,t){var r=Da(e,t);return r>0?xt.utils.decode(1200,e.slice(t+4,t+4+r)):""},Na=function(e,t){var r=Da(e,t);return r>0?xt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}Bt&&(va=function(e,t){if(!Buffer.isBuffer(e))return ga(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},ba=function(e,t){if(!Buffer.isBuffer(e))return ya(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},xa=function(e,t){if(!Buffer.isBuffer(e)||!zt)return wa(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Ta=function(e,t){if(!Buffer.isBuffer(e)||!zt)return Ea(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Na=function(e,t){if(!Buffer.isBuffer(e))return ka(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},_a=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Sa(e,t)},Ca=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof xt&&Aa();var Ia=function(e,t){return e[t]},Ra=function(e,t){return 256*e[t+1]+e[t]},Oa=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Da=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ja=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Pa=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ma(e,t){var r,n,a,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Bt&&Buffer.isBuffer(this)&&zt)l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Ra(this,o)),o+=2;e*=2;break;case"utf8":l=pa(this,this.l,this.l+e);break;case"utf16le":e*=2,l=da(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof xt)return Ma.call(this,e,"dbcs");l=xt.utils.decode(Tt,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=va(this,this.l),e=4+Da(this,this.l);break;case"lpstr-cp":l=ba(this,this.l),e=4+Da(this,this.l);break;case"lpwstr":l=xa(this,this.l),e=4+2*Da(this,this.l);break;case"lpp4":e=4+Da(this,this.l),l=Ta(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Da(this,this.l),l=Na(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Ia(this,this.l+e++));)c.push(jt(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Ra(this,this.l+e));)c.push(jt(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Ia(this,o),this.l=o+1,s=Ma.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(jt(Ra(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof xt){l=xt.utils.decode(Tt,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Ia(this,o),this.l=o+1,s=Ma.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(jt(Ia(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=Ia(this,this.l),this.l++,r;case 2:return r=("i"===t?Oa:Ra)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?ja:Pa)(this,this.l),this.l+=4,r):(n=Da(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?_a(this,this.l):_a([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=fa(this,this.l,e)}}return this.l+=e,l}var La=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Fa=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ua=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Ba(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)Ua(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r||"cpstr"==r)if("undefined"!==typeof xt&&874==kt){for(a=0;a!=t.length;++a){var s=xt.utils.encode(kt,t.charAt(a));this[this.l+a]=s[0]}n=t.length}else if("undefined"!==typeof xt&&"cpstr"==r){if((s=xt.utils.encode(Tt,t)).length==t.length)for(a=0;a<t.length;++a)0==s[a]&&0!=t.charCodeAt(a)&&(s[a]=95);if(s.length==2*t.length)for(a=0;a<t.length;++a)0==s[2*a]&&0==s[2*a+1]&&0!=t.charCodeAt(a)&&(s[2*a]=95);for(a=0;a<s.length;++a)this[this.l+a]=s[a];n=s.length}else{for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,La(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?0==i?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=255&s;e[r+6]=(15&a)<<4|15&s,e[r+7]=a>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,Fa(this,t,this.l)}}return this.l+=n,this}function Va(e,t){var r=fa(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function za(e,t){e.l=t,e.read_shift=Ma,e.chk=Va,e.write_shift=Ba}function Ha(e,t){e.l+=t}function Wa(e){var t=Ht(e);return za(t,0),t}function Ga(e,t,r){if(e){var n,a,s;za(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=ou[o]||ou[65535];for(s=127&(n=e.read_shift(1)),a=1;a<4&&128&n;++a)s+=(127&(n=e.read_shift(1)))<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function Ka(){var e=[],t=Bt?256:2048,r=function(e){var t=Wa(e);return za(t,0),t},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n)),n=null)},s=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))};return{next:s,push:function(e){a(),null==(n=e).l&&(n.l=n.length),s(t)},end:function(){return a(),Xt(e)},_bufs:e}}function qa(e,t,r){var n=nn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Xa(e,t,r){var n=nn(e);return n.s=qa(n.s,t.s,r),n.e=qa(n.e,t.s,r),n}function $a(e,t){if(e.cRel&&e.c<0)for(e=nn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=nn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=rs(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Ya(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?$a(e.s,t.biff)+":"+$a(e.e,t.biff):(e.s.rRel?"":"$")+Ja(e.s.r)+":"+(e.e.rRel?"":"$")+Ja(e.e.r):(e.s.cRel?"":"$")+es(e.s.c)+":"+(e.e.cRel?"":"$")+es(e.e.c)}function Qa(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Ja(e){return""+(e+1)}function Za(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function es(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ts(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function rs(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ns(e){var t=e.indexOf(":");return-1==t?{s:ts(e),e:ts(e)}:{s:ts(e.slice(0,t)),e:ts(e.slice(t+1))}}function as(e,t){return"undefined"===typeof t||"number"===typeof t?as(e.s,e.e):("string"!==typeof e&&(e=rs(e)),"string"!==typeof t&&(t=rs(t)),e==t?e:e+":"+t)}function ss(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function is(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function os(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=jr(e.z,r?$r(t):t)}catch(n){}try{return e.w=jr((e.XF||{}).numFmtId||(r?14:0),r?$r(t):t)}catch(n){return""+t}}function ls(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Ps[e.v]||e.v:os(e,void 0==t?e.v:t))}function cs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function us(e,t,r){var n=r||{},a=e?null!=e["!data"]:n.dense;var s=e||{};a&&!s["!data"]&&(s["!data"]=[]);var i=0,o=0;if(s&&null!=n.origin){if("number"==typeof n.origin)i=n.origin;else{var l="string"==typeof n.origin?ts(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=is(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==i&&(c.e.r=i=u.e.r+1)}for(var d=[],h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");var f=i+h,m=""+(f+1);a&&(s["!data"][f]||(s["!data"][f]=[]),d=s["!data"][f]);for(var p=0;p!=t[h].length;++p)if("undefined"!==typeof t[h][p]){var g={v:t[h][p]},v=o+p;if(c.s.r>f&&(c.s.r=f),c.s.c>v&&(c.s.c=v),c.e.r<f&&(c.e.r=f),c.e.c<v&&(c.e.c=v),!t[h][p]||"object"!==typeof t[h][p]||Array.isArray(t[h][p])||t[h][p]instanceof Date)if(Array.isArray(g.v)&&(g.f=t[h][p][1],g.v=g.v[0]),null===g.v)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else{if(!n.sheetStubs)continue;g.t="z"}else"number"===typeof g.v?g.t="n":"boolean"===typeof g.v?g.t="b":g.v instanceof Date?(g.z=n.dateNF||ir[14],n.UTC||(g.v=pn(g.v)),n.cellDates?(g.t="d",g.w=jr(g.z,$r(g.v,n.date1904))):(g.t="n",g.v=$r(g.v,n.date1904),g.w=jr(g.z,g.v))):g.t="s";else g=t[h][p];if(a)d[v]&&d[v].z&&(g.z=d[v].z),d[v]=g;else{var y=es(v)+m;s[y]&&s[y].z&&(g.z=s[y].z),s[y]=g}}}return c.s.c<1e7&&(s["!ref"]=as(c)),s}function ds(e,t){return us(null,e,t)}function hs(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function fs(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ms(e,t){var r=e.l,n=e.read_shift(1),a=hs(e),s=[],i={t:a,h:a};if(0!==(1&n)){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(fs(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var ps=ms;function gs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var ys=hs;function bs(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var ws=hs,xs=bs;function Es(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?_a([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):ja(t,0)>>2;return r?a/100:a}function Ts(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ks=Ts;function Ns(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ss(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var _s=80,Cs=[_s,81],As={1:{n:"CodePage",t:2},2:{n:"Category",t:_s},3:{n:"PresentationFormat",t:_s},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:_s},15:{n:"Company",t:_s},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:_s},27:{n:"ContentStatus",t:_s},28:{n:"Language",t:_s},29:{n:"Version",t:_s},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Is={1:{n:"CodePage",t:2},2:{n:"Title",t:_s},3:{n:"Subject",t:_s},4:{n:"Author",t:_s},5:{n:"Keywords",t:_s},6:{n:"Comments",t:_s},7:{n:"Template",t:_s},8:{n:"LastAuthor",t:_s},9:{n:"RevNumber",t:_s},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:_s},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Rs={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Os=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ds(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var js=nn(Ds([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Ps={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ms={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ls=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],Fs={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var Us={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bs(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Vs(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(In)||[]).forEach(function(e){var a=Dn(e);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=Ln(a.Target),s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var i="External"===a.TargetMode?a.Target:Sn(a.Target,t);r[i]=s,n[a.Id]=s}}),r["!id"]=n,r}var zs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Hs=function(){for(var e=new Array(zs.length),t=0;t<zs.length;++t){var r=zs[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Ws(e){var t={};e=qn(e);for(var r=0;r<zs.length;++r){var n=zs[r],a=e.match(Hs[r]);null!=a&&a.length>0&&(t[n[1]]=Ln(a[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=tn(t[n[1]]))}return t}var Gs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Ks(e,t,r,n){var a=[];if("string"==typeof e)a=ea(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?ea(t,n).map(function(e){return e.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l)}o+=l}}var qs=/<[^>]+>[^<]*/g;var Xs,$s={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ys(e,t,r){Xs||(Xs=Gr($s)),e[t=Xs[t]||t]=r}function Qs(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Js(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Zs(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function ei(e,t,r){return 31===t?Zs(e):Js(e,0,r)}function ti(e,t,r){return ei(e,t,!1===r?0:4)}function ri(e){var t=e.l,r=si(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,si(e,3)]}function ni(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace($t,"").replace(Yt,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function ai(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function si(e,t,r){var n,a=e.read_shift(2),s=r||{};if(e.l+=2,12!==t&&a!==t&&-1===Cs.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return Js(e,0,4).replace($t,"");case 31:return Zs(e);case 64:return Qs(e);case 65:return ai(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return ti(e,a,!s.raw).replace($t,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ei(e,t,0)}(e,a).replace($t,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(ri(e));return r}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace($t,""),e.l-a&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace($t,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function ii(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),d=e.read_shift(4);s[i]=[u,d+r]}s.sort(function(e,t){return e[1]-t[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var f=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],f=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(f=!1,e.l=s[i][1]),f)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){if(0==s[i][0]&&s.length>i+1&&s[i][1]==s[i+1][1])continue;var m=t[s[i][0]];if(h[m.n]=si(e,m.t,{raw:!0}),"version"===m.p&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(65535&h[m.n])).slice(-4)),"CodePage"==m.n)switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ct(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(1===s[i][0]){if(o=h.CodePage=si(e,2),Ct(o),-1!==l){var p=e.l;e.l=s[l][1],c=ni(e,o),e.l=p}}else if(0===s[i][0]){if(0===o){l=i,e.l=s[i+1][1];continue}c=ni(e,o)}else{var g,v=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=ai(e);break;case 30:case 31:e.l+=4,g=ti(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=ci(e,4);break;case 64:e.l+=4,g=tn(Qs(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=g}}return e.l=r+n,h}function oi(e,t,r){var n=e.content;if(!n)return{};za(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Hr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=n.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),1===a&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===a&&(i=n.read_shift(16),l=n.read_shift(4));var d,h=ii(n,t),f={SystemIdentifier:c};for(var m in h)f[m]=h[m];if(f.FMTID=s,1===a)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{d=ii(n,null)}catch(p){}for(m in d)f[m]=d[m];return f.FMTID=[s,i],f}function li(e,t){return e.read_shift(t),null}function ci(e,t){return 1===e.read_shift(t)}function ui(e){return e.read_shift(2,"u")}function di(e,t){return function(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}(e,t,ui)}function hi(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}function fi(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=Tt;(r&&r.biff>=8&&(Tt=1200),r&&8!=r.biff)?12==r.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return Tt=s,i}function mi(e){var t=Tt;Tt=1200;var r,n=e.read_shift(2),a=e.read_shift(1),s=4&a,i=8&a,o=1+(1&a),l=0,c={};i&&(l=e.read_shift(2)),s&&(r=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",d=0===n?"":e.read_shift(n,u);return i&&(e.l+=4*l),s&&(e.l+=r),c.t=d,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Tt=t,c}function pi(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function gi(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):pi(e,n,r)}function vi(e,t,r){if(r.biff>5)return gi(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function yi(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace($t,"");return n&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(a>>1,"utf16le").replace($t,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function bi(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace($t,""):""}function wi(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function xi(e,t){var r=wi(e);return r[3]=0,r}function Ei(e,t,r){var n={r:e.read_shift(2),c:e.read_shift(2),ixfe:0};if(r&&2==r.biff||7==t){var a=e.read_shift(1);n.ixfe=63&a,e.l+=2}else n.ixfe=e.read_shift(2);return n}function Ti(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function ki(e){return[e.read_shift(2),Es(e)]}function Ni(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function Si(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var _i=Si;function Ci(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Ai(e){e.l+=2,e.l+=e.read_shift(2)}var Ii={0:Ai,4:Ai,5:Ai,6:Ai,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:Ai,9:Ai,10:Ai,11:Ai,12:Ai,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:Ai,15:Ai,16:Ai,17:Ai,18:Ai,19:Ai,20:Ai,21:Ci};function Ri(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Oi(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var a=e.read_shift(2);return r&&2==r.biff&&(n=1-(a>>15),a&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},a]}var Di=vi;function ji(e,t,r){var n=e.l+t,a=8!=r.biff&&r.biff?2:4,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}var Pi=function(e,t,r){return 0===t?"":vi(e,0,r)};function Mi(e,t,r){var n,a=e.read_shift(2),s={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=fi(e,0,r),s=e.read_shift(2);if(s!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}(e,t-2,r)),s.body=n||e.read_shift(t-2),"string"===typeof n&&(s.Name=n),s}function Li(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=pi(e,i,r);32&a&&(c=Ls[c.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var d=n!=e.l&&0!==o&&u>0?function(e,t,r,n){var a,s=e.l+t,i=Il(e,n,r);s!==e.l&&(a=Al(e,s-e.l,i,r));return[i,a]}(e,u,r,o):[];return{chKey:s,Name:c,itab:l,rgce:d}}function Fi(e,t,r){if(r.biff<8)return Ui(e,t,r);if(!(r.biff>8)&&t==e[e.l]+(3==e[e.l+1]?1:0)+1)return Ui(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);0!==s--;)n.push(Ti(e,r.biff,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Ui(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=fi(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}function Bi(e,t,r){var n=_i(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Ll(e,t,r)]}var Vi={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function zi(e,t,r){if(!r.cellStyles)return Ha(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var Hi=Ei,Wi=di,Gi=gi;var Ki=[2,3,48,49,131,139,140,245],qi=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Gr({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var a=ds(function(t,r){var n=[],a=Ht(1);switch(r.type){case"base64":a=Gt(Ut(t));break;case"binary":a=Gt(t);break;case"buffer":case"array":a=t}za(a,0);var s=a.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,u=521;2==s&&(c=a.read_shift(2)),a.l+=3,2!=s&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(u=a.read_shift(2));var d=a.read_shift(2),h=r.codepage||1252;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],m={},p=Math.min(a.length,2==s?521:u-10-(o?264:0)),g=l?32:11;a.l<p&&13!=a[a.l];)switch((m={}).name=("undefined"!==typeof xt?xt.utils.decode(h,a.slice(a.l,a.l+g)):Kt(a.slice(a.l,a.l+g))).replace(/[\u0000\r\n].*$/g,""),a.l+=g,m.type=String.fromCharCode(a.read_shift(1)),2==s||l||(m.offset=a.read_shift(4)),m.len=a.read_shift(1),2==s&&(m.offset=a.read_shift(2)),m.dec=a.read_shift(1),m.name.length&&f.push(m),2!=s&&(a.l+=l?13:14),m.type){case"B":o&&8==m.len||!r.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(n[0]=[],y=0;y!=f.length;++y)n[0][y]=f[y].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,n[++v]=[],y=0,y=0;y!=f.length;++y){var b=a.slice(a.l,a.l+f[y].len);a.l+=f[y].len,za(b,0);var w="undefined"!==typeof xt?xt.utils.decode(h,b):Kt(b);switch(f[y].type){case"C":w.trim().length&&(n[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?(n[v][y]=new Date(Date.UTC(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8),0,0,0,0)),r&&r.UTC||(n[v][y]=mn(n[v][y]))):n[v][y]=w;break;case"F":n[v][y]=parseFloat(w.trim());break;case"+":case"I":n[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":n[v][y]=!0;break;case"N":case"F":n[v][y]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(n[v][y]=+w||0);break;case"@":n[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":var x=b.read_shift(4),E=b.read_shift(4);if(0==x&&0==E)break;n[v][y]=new Date(864e5*(x-2440588)+E),r&&r.UTC||(n[v][y]=mn(n[v][y]));break;case"Y":n[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==f[y].len){n[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else a.l+=d;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return a["!cols"]=n.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete n.DBF,a}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{var n=cs(r(e,t),t);return n.bookType="dbf",n}catch(a){if(t&&t.WTF)throw a}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(r,a){if(!r["!ref"])throw new Error("Cannot export empty sheet to DBF");var s=a||{},i=Tt;if(+s.codepage>=0&&Ct(+s.codepage),"string"==s.type)throw new Error("Cannot write DBF to JS string");var o=Ka(),l=sd(r,{header:1,raw:!0,cellDates:!0}),c=l[0],u=l.slice(1),d=r["!cols"]||[],h=0,f=0,m=0,p=1;for(h=0;h<c.length;++h)if(((d[h]||{}).DBF||{}).name)c[h]=d[h].DBF.name,++m;else if(null!=c[h]){if(++m,"number"===typeof c[h]&&(c[h]=c[h].toString(10)),"string"!==typeof c[h])throw new Error("DBF Invalid column name "+c[h]+" |"+typeof c[h]+"|");if(c.indexOf(c[h])!==h)for(f=0;f<1024;++f)if(-1==c.indexOf(c[h]+"_"+f)){c[h]+="_"+f;break}}var g=is(r["!ref"]),v=[],y=[],b=[];for(h=0;h<=g.e.c-g.s.c;++h){var w="",x="",E=0,T=[];for(f=0;f<u.length;++f)null!=u[f][h]&&T.push(u[f][h]);if(0!=T.length&&null!=c[h]){for(f=0;f<T.length;++f){switch(typeof T[f]){case"number":x="B";break;case"string":default:x="C";break;case"boolean":x="L";break;case"object":x=T[f]instanceof Date?"D":"C"}E=Math.max(E,("undefined"!==typeof xt&&"string"==typeof T[f]?xt.utils.encode(kt,T[f]):String(T[f])).length),w=w&&w!=x?"C":x}E>250&&(E=250),"C"==(x=((d[h]||{}).DBF||{}).type)&&d[h].DBF.len>E&&(E=d[h].DBF.len),"B"==w&&"N"==x&&(w="N",b[h]=d[h].DBF.dec,E=d[h].DBF.len),y[h]="C"==w||"N"==x?E:n[w]||0,p+=y[h],v[h]=w}else v[h]="?"}var k=o.next(32);for(k.write_shift(4,318902576),k.write_shift(4,u.length),k.write_shift(2,296+32*m),k.write_shift(2,p),h=0;h<4;++h)k.write_shift(4,0);var N=+t[Tt]||3;for(k.write_shift(4,N<<8),e[N]!=+s.codepage&&(s.codepage&&console.error("DBF Unsupported codepage "+Tt+", using 1252"),Tt=1252),h=0,f=0;h<c.length;++h)if(null!=c[h]){var S=o.next(32),_=(c[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,_,"sbcs"),S.write_shift(1,"?"==v[h]?"C":v[h],"sbcs"),S.write_shift(4,f),S.write_shift(1,y[h]||n[v[h]]||0),S.write_shift(1,b[h]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),f+=y[h]||n[v[h]]||0}var C=o.next(264);for(C.write_shift(4,13),h=0;h<65;++h)C.write_shift(4,0);for(h=0;h<u.length;++h){var A=o.next(p);for(A.write_shift(1,0),f=0;f<c.length;++f)if(null!=c[f])switch(v[f]){case"L":A.write_shift(1,null==u[h][f]?63:u[h][f]?84:70);break;case"B":A.write_shift(8,u[h][f]||0,"f");break;case"N":var I="0";for("number"==typeof u[h][f]&&(I=u[h][f].toFixed(b[f]||0)),I.length>y[f]&&(I=I.slice(0,y[f])),m=0;m<y[f]-I.length;++m)A.write_shift(1,32);A.write_shift(1,I,"sbcs");break;case"D":u[h][f]?(A.write_shift(4,("0000"+u[h][f].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(u[h][f].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+u[h][f].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var R=A.l,O=String(null!=u[h][f]?u[h][f]:"").slice(0,y[f]);for(A.write_shift(1,O,"cpstr"),R+=y[f]-A.l,m=0;m<R;++m)A.write_shift(1,32)}}return Tt=i,o.next(1).write_shift(1,26),o.end()}}}(),Xi=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Wr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1bN("+Wr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch(o){}var r=function(t,r){var n=e[r];return"number"==typeof n?Pt(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:Pt(n)};e["|"]=254;function a(e,a){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,d=[],h=[],f=null,m={},p=[],g=[],v=[],y=0,b={Workbook:{WBProps:{},Names:[]}};for(+a.codepage>=0&&Ct(+a.codepage);c!==i.length;++c){y=0;var w,x=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),E=x.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),T=E[0];if(x.length>0)switch(T){case"ID":case"E":case"B":case"W":break;case"O":for(u=1;u<E.length;++u)if("V"===E[u].charAt(0)){var k=parseInt(E[u].slice(1),10);k>=1&&k<=4&&(b.Workbook.WBProps.date1904=!0)}break;case"P":if("P"===E[1].charAt(0))h.push(x.slice(3).replace(/;;/g,";"));break;case"NN":var N={Sheet:0};for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"N":N.Name=E[u].slice(1);break;case"E":N.Ref=(a&&a.sheet||"Sheet1")+"!"+al(E[u].slice(1))}b.Workbook.Names.push(N);break;case"C":var S=!1,_=!1,C=!1,A=!1,I=-1,R=-1,O="",D="z",j="";for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"A":j=E[u].slice(1);break;case"X":l=parseInt(E[u].slice(1),10)-1,_=!0;break;case"Y":for(o=parseInt(E[u].slice(1),10)-1,_||(l=0),s=d.length;s<=o;++s)d[s]=[];break;case"K":'"'===(w=E[u].slice(1)).charAt(0)?(w=w.slice(1,w.length-1),D="s"):"TRUE"===w||"FALSE"===w?(w="TRUE"===w,D="b"):isNaN(sn(w))||(w=sn(w),D="n",null!==f&&Ir(f)&&a.cellDates&&(D="number"==typeof(w=Yr(b.Workbook.WBProps.date1904?w+1462:w))?"n":"d")),"undefined"!==typeof xt&&"string"==typeof w&&"string"!=(a||{}).type&&(a||{}).codepage&&(w=xt.utils.decode(a.codepage,w)),S=!0;break;case"E":A=!0,O=al(E[u].slice(1),{r:o,c:l});break;case"S":C=!0;break;case"G":break;case"R":I=parseInt(E[u].slice(1),10)-1;break;case"C":R=parseInt(E[u].slice(1),10)-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}if(S&&(d[o][l]?(d[o][l].t=D,d[o][l].v=w):d[o][l]={t:D,v:w},f&&(d[o][l].z=f),!1!==a.cellText&&f&&(d[o][l].w=jr(d[o][l].z,d[o][l].v,{date1904:b.Workbook.WBProps.date1904})),f=null),C){if(A)throw new Error("SYLK shared formula cannot have own formula");var P=I>-1&&d[I][R];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");O=ol(P[1],{r:o-I,c:l-R})}O&&(d[o][l]?d[o][l].f=O:d[o][l]={t:"n",f:O}),j&&(d[o][l]||(d[o][l]={t:"z"}),d[o][l].c=[{a:"SheetJSYLK",t:j}]);break;case"F":var M=0;for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"X":l=parseInt(E[u].slice(1),10)-1,++M;break;case"Y":for(o=parseInt(E[u].slice(1),10)-1,s=d.length;s<=o;++s)d[s]=[];break;case"M":y=parseInt(E[u].slice(1),10)/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(E[u].slice(1),10)];break;case"W":for(v=E[u].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)y=parseInt(v[2],10),g[s-1]=0===y?{hidden:!0}:{wch:y};break;case"C":g[l=parseInt(E[u].slice(1),10)-1]||(g[l]={});break;case"R":p[o=parseInt(E[u].slice(1),10)-1]||(p[o]={}),y>0?(p[o].hpt=y,p[o].hpx=Po(y)):0===y&&(p[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}M<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),g.forEach(function(e){Oo(e)}),a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),[d,m,b]}function s(e,t,r,n,a,s){var i="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+il(e.f,{r:r,c:n}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+=$r(tn(e.v,s),s);break;case"s":i+='"'+(null==e.v?"":String(e.v)).replace(/"/g,"").replace(/;/g,";;")+'"'}return i}function i(e,t,r){var n="C;Y"+(t+1)+";X"+(r+1)+";A";return n+=e.map(function(e){return e.t}).join("").replace(/\n/g,"\x1b :").replace(/\r/g,"\x1b =")}return{to_workbook:function(e,t){var r=function(e,t){switch(t.type){case"base64":return a(Ut(e),t);case"binary":return a(e,t);case"buffer":return a(Bt&&Buffer.isBuffer(e)?e.toString("binary"):Kt(e),t);case"array":return a(rn(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],s=r[1],i=r[2],o=nn(t);o.date1904=(((i||{}).Workbook||{}).WBProps||{}).date1904;var l=ds(n,o);Wr(s).forEach(function(e){l[e]=s[e]});var c=cs(l,t);return Wr(i).forEach(function(e){c[e]=i[e]}),c.bookType="sylk",c},from_sheet:function(e,t,r){t||(t={}),t._formats=["General"];var n,a=["ID;PSheetJS;N;E"],o=[],l=is(e["!ref"]||"A1"),c=null!=e["!data"],u="\r\n",d=(((r||{}).Workbook||{}).WBProps||{}).date1904;a.push("P;PGeneral");var h,f=l.s.r,m=l.s.c,p=[];if(e["!ref"])for(f=l.s.r;f<=l.e.r;++f)if(!c||e["!data"][f]){for(p=[],m=l.s.c;m<=l.e.c;++m)(n=c?e["!data"][f][m]:e[es(m)+Ja(f)])&&n.c&&p.push(i(n.c,f,m));p.length&&o.push(p.join(u))}if(e["!ref"])for(f=l.s.r;f<=l.e.r;++f)if(!c||e["!data"][f]){for(p=[],m=l.s.c;m<=l.e.c;++m)if((n=c?e["!data"][f][m]:e[es(m)+Ja(f)])&&(null!=n.v||n.f&&!n.F)){if("General"!=(n.z||("d"==n.t?ir[14]:"General"))){var g=t._formats.indexOf(n.z);-1==g&&(t._formats.push(n.z),g=t._formats.length-1,a.push("P;P"+n.z.replace(/;/g,";;"))),p.push("F;P"+g+";Y"+(f+1)+";X"+(m+1))}p.push(s(n,0,f,m,0,d))}o.push(p.join(u))}return a.push("F;P0;DG0G8;M255"),e["!cols"]&&(h=a,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=_o(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Co(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&h.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*jo(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))})}(a,e["!rows"]),e["!ref"]&&a.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" ")),a.push("O;L;D;B"+(d?";V4":"")+";K47;G100 0.001"),delete t._formats,a.join(u)+u+o.join(u)+u+"E"+u}}}(),$i=function(){function e(e,t){for(var r=e.split("\n"),n=-1,a=-1,s=0,i=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(n<0)){for(var o=r[s].trim().split(","),l=o[0],c=o[1],u=r[++s]||"";1&(u.match(/["]/g)||[]).length&&s<r.length-1;)u+="\n"+r[++s];switch(u=u.trim(),+l){case-1:if("BOT"===u){i[++n]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?i[n][a]=!0:"FALSE"===u?i[n][a]=!1:isNaN(sn(c))?isNaN(hn(c).getDate())?i[n][a]=c:(i[n][a]=tn(c),t&&t.UTC||(i[n][a]=mn(i[n][a]))):i[n][a]=sn(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),i[n][a++]=""!==u?u:null}if("EOD"===u)break}}else i[++n]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return ds(function(t,r){switch(r.type){case"base64":return e(Ut(t),r);case"binary":return e(t,r);case"buffer":return e(Bt&&Buffer.isBuffer(t)?t.toString("binary"):Kt(t),r);case"array":return e(rn(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}function r(e,t){return"0,"+String(e)+"\r\n"+t}function n(e){return'1,0\r\n"'+e.replace(/"/g,'""')+'"'}return{to_workbook:function(e,r){var n=cs(t(e,r),r);return n.bookType="dif",n},to_sheet:t,from_sheet:function(e){if(!e["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var t=is(e["!ref"]),a=null!=e["!data"],s=['TABLE\r\n0,1\r\n"sheetjs"\r\n',"VECTORS\r\n0,"+(t.e.r-t.s.r+1)+'\r\n""\r\n',"TUPLES\r\n0,"+(t.e.c-t.s.c+1)+'\r\n""\r\n','DATA\r\n0,0\r\n""\r\n'],i=t.s.r;i<=t.e.r;++i){for(var o=a?e["!data"][i]:[],l="-1,0\r\nBOT\r\n",c=t.s.c;c<=t.e.c;++c){var u=a?o&&o[c]:e[rs({r:i,c:c})];if(null!=u){switch(u.t){case"n":null!=u.w?l+="0,"+u.w+"\r\nV":null!=u.v?l+=r(u.v,"V"):null==u.f||u.F?l+='1,0\r\n""':l+=n("="+u.f);break;case"b":l+=u.v?r(1,"TRUE"):r(0,"FALSE");break;case"s":l+=n(isNaN(+u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=jr(u.z||ir[14],$r(tn(u.v)))),l+=r(u.w,"V");break;default:l+='1,0\r\n""'}l+="\r\n"}else l+='1,0\r\n""\r\n'}s.push(l)}return s.join("")+"-1,0\r\nEOD"}}}(),Yi=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return ds(function(t,r){for(var n=t.split("\n"),a=-1,s=-1,i=0,o=[];i!==n.length;++i){var l=n[i].trim().split(":");if("cell"===l[0]){var c=ts(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,s=c.c,l[2]){case"t":o[a][s]=e(l[3]);break;case"v":o[a][s]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?o[a][s]=!!+l[4]:o[a][s]=+l[4],"vtf"==l[2]&&(o[a][s]=[o[a][s],u])}}}return r&&r.sheetRows&&(o=o.slice(0,r.sheetRows)),o}(t,r),r)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var r,n=[],a=[],s="",i=ns(e["!ref"]),o=null!=e["!data"],l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=rs({r:l,c:c}),(r=o?(e["!data"][l]||[])[c]:e[s])&&null!=r.v&&"z"!==r.t){switch(a=["cell",s,"t"],r.t){case"s":case"str":a.push(t(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=t(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=$r(tn(r.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=r.w||jr(r.z||ir[14],u);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,t){return cs(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[n,a,s,a,o(e),i].join("\n")}}}(),Qi=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(sn(e))?isNaN(hn(e).getDate())?t[r][n]=e:t[r][n]=tn(e):t[r][n]=sn(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},a=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?a=!a:!a&&i in t&&(n[i]=(n[i]||0)+1);for(s in i=[],n)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);if(!i.length)for(s in n=r)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function a(e,t){var r=t||{},a="";var s={};r.dense&&(s["!data"]=[]);var i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024)):a=r&&r.FS?r.FS:n(e.slice(0,1024));var o=0,l=0,c=0,u=0,d=0,h=a.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0),g=null!=r.dateNF?function(e){var t="number"==typeof e?ir[e]:e;return t=t.replace(Fr,"(\\d+)"),Fr.lastIndex=0,new RegExp("^"+t+"$")}(r.dateNF):null;function v(){var t=e.slice(u,d);"\r"==t.slice(-1)&&(t=t.slice(0,-1));var n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),!1!==r.cellText&&(n.w=t),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="s",n.f=t.slice(1),n.v=t):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=sn(t)))if(!isNaN((c=hn(t)).getDate())||g&&t.match(g)){if(n.z=r.dateNF||ir[14],g&&t.match(g)){var a=function(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(Fr)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":s=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:a=c}}),Fr.lastIndex=0,l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==n&&-1==a&&-1==s?u:c+"T"+u}(0,r.dateNF,t.match(g)||[]);c=tn(a),r&&!1===r.UTC&&(c=mn(c))}else r&&!1===r.UTC?c=mn(c):!1!==r.cellText&&r.dateNF&&(n.w=jr(n.z,c));r.cellDates?(n.t="d",n.v=c):(n.t="n",n.v=$r(c)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",n.v=c;if("z"==n.t||(r.dense?(s["!data"][o]||(s["!data"][o]=[]),s["!data"][o][l]=n):s[rs({c:l,r:o})]=n),u=d+1,p=e.charCodeAt(u),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),m==h)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(m=e.charCodeAt(d)){case 34:34===p&&(f=!f);break;case 13:if(f)break;10==e.charCodeAt(d+1)&&++d;case h:case 10:if(!f&&v())break e}return d-u>0&&v(),s["!ref"]=as(i),s}function s(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,r):ds(function(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){a[c]=[];var u=0;for(e(s[c].slice(0,o).trim(),a,c,u,n),u=1;u<=(s[c].length-o)/10+1;++u)e(s[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,r),r):a(t,r)}function i(e,t){var r="",n="string"==t.type?[0,0,0,0]:Zu(e,t);switch(t.type){case"base64":r=Ut(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof xt?xt.utils.decode(t.codepage,e):Bt&&Buffer.isBuffer(e)?e.toString("binary"):Kt(e);break;case"array":r=rn(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=qn(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=qn(r):"binary"==t.type&&"undefined"!==typeof xt&&t.codepage&&(r=xt.utils.decode(t.codepage,xt.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Yi.to_sheet("string"==t.type?r:qn(r),t):s(r,t)}return{to_workbook:function(e,t){return cs(i(e,t),t)},to_sheet:i,from_sheet:function(e){var t=[];if(!e["!ref"])return"";for(var r,n=is(e["!ref"]),a=null!=e["!data"],s=n.s.r;s<=n.e.r;++s){for(var i=[],o=n.s.c;o<=n.e.c;++o){var l=rs({r:s,c:o});if((r=a?(e["!data"][s]||[])[o]:e[l])&&null!=r.v){for(var c=(r.w||(ls(r),r.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}t.push(i.join(""))}return t.join("\n")}}}();var Ji=function(){function e(e,t,r){if(e){za(e,e.l||0);for(var n=r.Enum||y;e.l<e.length;){var a=e.read_shift(2),s=n[a]||n[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,r);if(e.l=o,t(l,s,a))return}}}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function r(r,n){if(!r)return r;var a=n||{};var s={},i="Sheet1",o="",l=0,c={},u=[],d=[],h=[];a.dense&&(h=s["!data"]=[]);var f={s:{r:0,c:0},e:{r:0,c:0}},m=a.sheetRows||0,p={};if(81==r[4]&&80==r[5]&&87==r[6])return function(e,t){za(e,0);var r=t||{};0;var n={};r.dense&&(n["!data"]=[]);var a=[],s="",i={s:{r:-1,c:-1},e:{r:-1,c:-1}},o=0,l=0,c=0,u=0,d={SheetNames:[],Sheets:{}},h=[];e:for(;e.l<e.length;){var f=e.read_shift(2),m=e.read_shift(2),p=e.slice(e.l,e.l+m);switch(za(p,0),f){case 1:if(962023505!=p.read_shift(4))throw"Bad QPW9 BOF!";break;case 2:break e;case 8:case 1025:case 1026:case 1032:default:break;case 10:for(var g=p.read_shift(4),v=(p.length-p.l)/g|0,y=0;y<g;++y){var b=p.l+v,E={};p.l+=2,E.numFmtId=p.read_shift(2),w[E.numFmtId]&&(E.z=w[E.numFmtId]),p.l=b,h.push(E)}break;case 1031:for(p.l+=12;p.l<p.length;)o=p.read_shift(2),l=p.read_shift(1),a.push(p.read_shift(o,"cstr"));break;case 1537:var T=p.read_shift(2);n={},r.dense&&(n["!data"]=[]),i.s.c=p.read_shift(2),i.e.c=p.read_shift(2),i.s.r=p.read_shift(4),i.e.r=p.read_shift(4),p.l+=4,p.l+2<p.length&&(o=p.read_shift(2),l=p.read_shift(1),s=0==o?"":p.read_shift(o,"cstr")),s||(s=es(T));break;case 1538:if(i.s.c>255||i.s.r>999999)break;i.e.c<i.s.c&&(i.e.c=i.s.c),i.e.r<i.s.r&&(i.e.r=i.s.r),n["!ref"]=as(i),fd(d,n,s);break;case 2561:c=p.read_shift(2),i.e.c<c&&(i.e.c=c),i.s.c>c&&(i.s.c=c),u=p.read_shift(4),i.s.r>u&&(i.s.r=u),u=p.read_shift(4),i.e.r<u&&(i.e.r=u);break;case 3073:u=p.read_shift(4),o=p.read_shift(4),i.s.r>u&&(i.s.r=u),i.e.r<u+o-1&&(i.e.r=u+o-1);for(var k=es(c);p.l<p.length;){var N={t:"z"},S=p.read_shift(1),_=-1;128&S&&(_=p.read_shift(2));var C=64&S?p.read_shift(2)-1:0;switch(31&S){case 0:case 1:break;case 2:N={t:"n",v:p.read_shift(2)};break;case 3:N={t:"n",v:p.read_shift(2,"i")};break;case 4:N={t:"n",v:Es(p)};break;case 5:N={t:"n",v:p.read_shift(8,"f")};break;case 7:N={t:"s",v:a[l=p.read_shift(4)-1]};break;case 8:N={t:"n",v:p.read_shift(8,"f")},p.l+=2,p.l+=4,isNaN(N.v)&&(N={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(31&S)}-1!=_&&(h[_-1]||{}).z&&(N.z=h[_-1].z);var A=0;if(32&S)switch(31&S){case 2:case 7:A=p.read_shift(2);break;case 3:A=p.read_shift(2,"i");break;default:throw"Unsupported delta for QPW cell type "+(31&S)}if(r.sheetStubs||"z"!=N.t){var I=nn(N);"n"==N.t&&N.z&&Ir(N.z)&&r.cellDates&&(I.v=Yr(N.v),I.t="number"==typeof I.v?"n":"d"),null!=n["!data"]?(n["!data"][u]||(n["!data"][u]=[]),n["!data"][u][c]=I):n[k+Ja(u)]=I}for(++u,--o;C-- >0&&o>=0;){if(32&S)switch(31&S){case 2:N={t:"n",v:N.v+A&65535};break;case 3:(N={t:"n",v:N.v+A&65535}).v>32767&&(N.v-=65536);break;case 7:N={t:"s",v:a[l=l+A>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(31&S)}else switch(31&S){case 1:N={t:"z"};break;case 2:N={t:"n",v:p.read_shift(2)};break;case 7:N={t:"s",v:a[l=p.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(31&S)}(r.sheetStubs||"z"!=N.t)&&(null!=n["!data"]?(n["!data"][u]||(n["!data"][u]=[]),n["!data"][u][c]=N):n[k+Ja(u)]=N),++u,--o}}break;case 3074:c=p.read_shift(2),u=p.read_shift(4);var R=x(p);null!=n["!data"]?(n["!data"][u]||(n["!data"][u]=[]),n["!data"][u][c]={t:"s",v:R}):n[es(c)+Ja(u)]={t:"s",v:R}}e.l+=m}return d}(r,n);if(0==r[2]&&(8==r[3]||9==r[3])&&r.length>=16&&5==r[14]&&108===r[15])throw new Error("Unsupported Works 3 for Mac file");if(2==r[2])a.Enum=y,e(r,function(e,r,n){switch(n){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 255:a.vers=e,a.works=!0;break;case 6:f=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:(!a.qpro&&!a.works||51==n)&&e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),(a.works||a.works2)&&(e[1].v=e[1].v.replace(/\r\n/g,"\n"));case 13:case 14:case 16:112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||t[(15&e[2])-1]||ir[14],a.cellDates&&(e[1].v=Yr(e[1].v),e[1].t="number"==typeof e[1].v?"n":"d")),a.qpro&&e[3]>l&&(s["!ref"]=as(f),c[i]=s,u.push(i),s={},a.dense&&(h=s["!data"]=[]),f={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],i=o||"Sheet"+(l+1),o="");var d=a.dense?(h[e[0].r]||[])[e[0].c]:s[rs(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f),p=d;break}a.dense?(h[e[0].r]||(h[e[0].r]=[]),h[e[0].r][e[0].c]=e[1]):s[rs(e[0])]=e[1],p=e[1];break;case 21509:a.works2=!0;break;case 21506:5281==e&&(p.z="hh:mm:ss",a.cellDates&&"n"==p.t&&(p.v=Yr(p.v),p.t="number"==typeof p.v?"n":"d"))}},a);else{if(26!=r[2]&&14!=r[2])throw new Error("Unrecognized LOTUS BOF "+r[2]);a.Enum=b,14==r[2]&&(a.qpro=!0,r.l=0),e(r,function(e,t,r){switch(r){case 204:i=e;break;case 22:e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),e[1].v=e[1].v.replace(/\x0F./g,function(e){return String.fromCharCode(e.charCodeAt(1)-32)}).replace(/\r\n/g,"\n");case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(s["!ref"]=as(f),c[i]=s,u.push(i),s={},a.dense&&(h=s["!data"]=[]),f={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],i="Sheet"+(l+1)),m>0&&e[0].r>=m)break;a.dense?(h[e[0].r]||(h[e[0].r]=[]),h[e[0].r][e[0].c]=e[1]):s[rs(e[0])]=e[1],f.e.c<e[0].c&&(f.e.c=e[0].c),f.e.r<e[0].r&&(f.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==l&&(i=e[1])}},a)}if(s["!ref"]=as(f),c[o||i]=s,u.push(o||i),!d.length)return{SheetNames:u,Sheets:c};for(var g={},v=[],E=0;E<d.length;++E)c[u[E]]?(v.push(d[E]||u[E]),g[d[E]]=c[d[E]]||c[u[E]]):(v.push(d[E]),g[d[E]]={"!ref":"A1"});return{SheetNames:v,Sheets:g}}function n(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):r.works?(n[0].c=e.read_shift(2),n[0].r=e.read_shift(2),n[2]=e.read_shift(2)):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function a(e){return e.z&&Ir(e.z)?240|(t.indexOf(e.z)+1||2):255}function s(e,t,r){var n=Wa(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var s=r.charCodeAt(a);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function i(e,t,r){var n=Wa(7);return n.write_shift(1,a(r)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r.v,"i"),n}function o(e,t,r){var n=Wa(13);return n.write_shift(1,a(r)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r.v,"f"),n}function l(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?es(t):Ja(t))}var c={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},u=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,r,n){var a=Wa(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<n.length;++s){var i=n.charCodeAt(s);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function f(e,t){var r=d(e),n=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(a*Math.pow(2,s+32)+n*Math.pow(2,s)),r}function m(e,t,r,n){var a=Wa(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s,i=0,o=0,l=0;return n<0&&(i=1,n=-n),o=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,o-31))>>>0))&&(++o,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,s=(n*=Math.pow(2,32))>>>0,a.write_shift(4,s),a.write_shift(4,l),o+=16383+(i?32768:0),a.write_shift(2,o),a}function p(e,t){var r=d(e),n=e.read_shift(8,"f");return r[1].v=n,r}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function v(e,t){var r=Wa(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var y={0:{n:"BOF",f:ui},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:function(e,t,r){var a=e.l+t,s=n(e,0,r);if(s[1].t="s",20768==(65534&r.vers)){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return r.qpro&&e.l++,s[1].v=e.read_shift(a-e.l,"cstr"),s}},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,s=n(e,0,r);if(s[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var i=e.read_shift(2);!function(e,t){za(e,0);var r=[],n=0,a="",s="",i="",o="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=l(t[0].c,e.read_shift(2),!0),a=l(t[0].r,e.read_shift(2),!1),r.push(s+a);break;case 2:var h=l(t[0].c,e.read_shift(2),!0),f=l(t[0].r,e.read_shift(2),!1);s=l(t[0].c,e.read_shift(2),!0),a=l(t[0].r,e.read_shift(2),!1),r.push(h+f+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var m="";d=e[e.l++];)m+=String.fromCharCode(d);r.push('"'+m.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:o=r.pop(),i=r.pop(),r.push(["AND","OR"][d-20]+"("+i+","+o+")");break;default:if(d<32&&u[d])o=r.pop(),i=r.pop(),r.push(i+u[d]+o);else{if(!c[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(n=c[d][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-n);r.length-=n,r.push(c[d][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:function(e,t,r){var a=e.l+t,s=n(e,0,r);if(s[1].t="s",20768==r.vers){var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return s[1].v=e.read_shift(a-e.l,"cstr"),s}},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},255:{n:"BOF",f:ui},21506:{n:"WKSNF",f:ui},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=d(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:f},24:{n:"NUMBER18",f:function(e,t){var r=d(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=f(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var a=e.read_shift(2);if(14e3==a){for(r[a]=[0,""],r[a][0]=e.read_shift(2);e[e.l];)r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=d(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var r=p(e);return e.l+=t-12,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},w={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function x(e){var t=e.read_shift(2),r=e.read_shift(1);if(0!=r)throw"unsupported QPW string type "+r.toString(16);return e.read_shift(t,"sbcs-cont")}return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&Ct(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=Ka();if(!e["!ref"])throw new Error("Cannot export empty sheet to WK1");var a=is(e["!ref"]),l=null!=e["!data"],c=[];cu(n,0,function(e){var t=Wa(2);return t.write_shift(2,e),t}(1030)),cu(n,6,function(e){var t=Wa(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(a));for(var u=Math.min(a.e.r,8191),d=a.s.c;d<=a.e.c;++d)c[d]=es(d);for(var h=a.s.r;h<=u;++h){var f=Ja(h);for(d=a.s.c;d<=a.e.c;++d){var m=l?(e["!data"][h]||[])[d]:e[c[d]+f];if(m&&"z"!=m.t)switch(m.t){case"n":(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?cu(n,13,i(h,d,m)):cu(n,14,o(h,d,m));break;case"d":var p=$r(m.v);(0|p)==p&&p>=-32768&&p<=32767?cu(n,13,i(h,d,{t:"n",v:p,z:m.z||ir[14]})):cu(n,14,o(h,d,{t:"n",v:p,z:m.z||ir[14]}));break;default:cu(n,15,s(h,d,ls(m).slice(0,239)))}}}return cu(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&Ct(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=Ka();cu(n,0,function(e){var t=Wa(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++a;var l=ns(o["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&cu(n,27,v(e.SheetNames[a],s++));var i=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=is(o["!ref"]),c=null!=o["!data"],u=[],d=Math.min(l.e.r,8191),f=l.s.r;f<=d;++f)for(var p=Ja(f),g=l.s.c;g<=l.e.c;++g){f===l.s.r&&(u[g]=es(g));var y=u[g]+p,b=c?(o["!data"][f]||[])[g]:o[y];if(b&&"z"!=b.t)if("n"==b.t)cu(n,23,m(f,g,i,b.v));else cu(n,22,h(f,g,i,ls(b).slice(0,239)))}++i}}return cu(n,1),n.end()},to_workbook:function(e,t){switch(t.type){case"base64":return r(Gt(Ut(e)),t);case"binary":return r(Gt(e),t);case"buffer":case"array":return r(e,t)}throw"Unsupported type "+t.type}}}();var Zi=function(){var e=$n("t"),t=$n("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var a={t:"s",v:Ln(n[1])},s=r.match(t);return s&&(a.s=function(e){var t={},r=e.match(In),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Dn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=St[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==s[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),a}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(a).map(r).filter(function(e){return e.v})}}(),eo=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),to=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ro=/<(?:\w+:)?r\b[^>]*>/,no=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ao(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ln(qn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=qn(e),r&&(n.h=Bn(n.t))):e.match(ro)&&(n.r=qn(e),n.t=Ln(qn((e.replace(no,"").match(to)||[]).join("").replace(In,"")),!0),r&&(n.h=eo(Zi(n.r)))),n):{t:""}}var so=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,io=/<(?:\w+:)?(?:si|sstItem)>/g,oo=/<\/(?:\w+:)?(?:si|sstItem)>/;function lo(e){if("undefined"!==typeof xt)return xt.utils.encode(kt,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function co(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function uo(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function ho(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=co(e,4),t.U=co(e,4),t.W=co(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function fo(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=36==n.Flags;break;case 26625:a=4==n.Flags;break;case 0:a=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function mo(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function po(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:fo(e,t),v:mo(e,e.length-e.l)}}function go(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vo(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(In,function(e){var r=Dn(e);switch(jn(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){n[e]=r[e]});break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}}),n}function yo(e){var t,r,n=0,a=lo(e),s=a.length+1;for((t=Ht(s))[0]=a.length,r=1;r!=s;++r)t[r]=a[r-1];for(r=s-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var bo=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(a){for(var s,i,o,l=lo(a),c=function(e){for(var n=t[e.length-1],a=104,s=e.length-1;s>=0;--s)for(var i=e[s],o=0;7!=o;++o)64&i&&(n^=r[a]),i*=2,--a;return n}(l),u=l.length,d=Ht(16),h=0;16!=h;++h)d[h]=0;for(1===(1&u)&&(s=c>>8,d[u]=n(e[0],s),--u,s=255&c,i=l[l.length-1],d[u]=n(i,s));u>0;)s=c>>8,d[--u]=n(l[u],s),s=255&c,d[--u]=n(l[u],s);for(u=15,o=15-l.length;o>0;)s=c>>8,d[u]=n(e[o],s),--o,s=255&c,d[--u]=n(l[u],s),--u,--o;return d}}(),wo=function(e){var t=0,r=bo(e);return function(e){var n=function(e,t,r,n,a){var s,i;for(a||(a=t),n||(n=bo(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=n[r])>>5|i<<3),a[s]=i,++r;return[a,r,n]}("",e,t,r);return t=n[1],n[0]}};function xo(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=co(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=co(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=fo(e,a),t-=a,r.EncryptionVerifier=mo(e,t),r}(e,t),n}function Eo(e,t){var r=t||{},n={},a=r.dense;a&&(n["!data"]=[]);var s=e.match(/\\trowd[\s\S]*?\\row\b/g);if(!s)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:s.length-1}},o=[];return s.forEach(function(e,t){a&&(o=n["!data"][t]=[]);for(var s,l=/\\[\w\-]+\b/g,c=0,u=-1,d=[];null!=(s=l.exec(e));){var h=e.slice(c,l.lastIndex-s[0].length);switch(32==h.charCodeAt(0)&&(h=h.slice(1)),h.length&&d.push(h),s[0]){case"\\cell":if(++u,d.length){var f={v:d.join(""),t:"s"};"TRUE"==f.v||"FALSE"==f.v?(f.v="TRUE"==f.v,f.t="b"):isNaN(sn(f.v))||(f.t="n",!1!==r.cellText&&(f.w=f.v),f.v=sn(f.v)),a?o[u]=f:n[rs({r:t,c:u})]=f}d=[];break;case"\\par":d.push("\n")}c=l.lastIndex}u>i.e.c&&(i.e.c=u)}),n["!ref"]=as(i),n}function To(e,t){var r=cs(function(e,t){switch(t.type){case"base64":return Eo(Ut(e),t);case"binary":return Eo(e,t);case"buffer":return Eo(Bt&&Buffer.isBuffer(e)?e.toString("binary"):Kt(e),t);case"array":return Eo(rn(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),t);return r.bookType="rtf",r}function ko(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function No(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(0===i)return[0,0,t];var o,l=0,c=a+s;switch(o=i/(c>1?2-c:c),a){case t:l=((r-n)/i+6)%6;break;case r:l=(n-t)/i+2;break;case n:l=(t-r)/i+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),ko(function(e){var t,r=e[0],n=e[1],a=e[2],s=2*n*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(r))}var So=6;function _o(e){return Math.floor((e+Math.round(128/So)/256)*So)}function Co(e){return Math.floor((e-5)/So*100+.5)/100}function Ao(e){return Math.round((e*So+5)/So*256)/256}function Io(e){return Ao(Co(_o(e)))}function Ro(e){var t=Math.abs(e-Io(e)),r=So;if(t>.005)for(So=1;So<15;++So)Math.abs(e-Io(e))<=t&&(t=Math.abs(e-Io(e)),r=So);So=r}function Oo(e){e.width?(e.wpx=_o(e.width),e.wch=Co(e.wpx),e.MDW=So):e.wpx?(e.wch=Co(e.wpx),e.width=Ao(e.wch),e.MDW=So):"number"==typeof e.wch&&(e.width=Ao(e.wch),e.wpx=_o(e.width),e.MDW=So),e.customWidth&&delete e.customWidth}var Do=96;function jo(e){return 96*e/Do}function Po(e){return e*Do/96}var Mo={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Lo=["numFmtId","fillId","fontId","borderId","xfId"],Fo=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Uo=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var l,c={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=Wr(ir),a=0;a<n.length;++a)t.NumberFmt[n[a]]=ir[n[a]];var s=e[0].match(In);if(s)for(a=0;a<s.length;++a){var i=Dn(s[a]);switch(jn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=Ln(qn(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}Br(o,l)}break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=s.match(n))&&function(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(In)||[]).forEach(function(e){var i=Dn(e);switch(jn(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":i.val&&(a.name=qn(i.val));break;case"<b":a.bold=i.val?zn(i.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=i.val?zn(i.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(i.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=i.val?zn(i.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=i.val?zn(i.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=i.val?zn(i.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=i.val?zn(i.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=i.val?zn(i.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":i.val&&(a.sz=+i.val);break;case"<vertAlign":i.val&&(a.vertAlign=i.val);break;case"<family":i.val&&(a.family=parseInt(i.val,10));break;case"<scheme":i.val&&(a.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=St[parseInt(i.val,10)];break;case"<color":if(a.color||(a.color={}),i.auto&&(a.color.auto=zn(i.auto)),i.rgb)a.color.rgb=i.rgb.slice(-6);else if(i.indexed){a.color.index=parseInt(i.indexed,10);var o=js[a.color.index];81==a.color.index&&(o=js[1]),o||(o=js[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(a.color.theme=parseInt(i.theme,10),i.tint&&(a.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=No(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}(l,c,i,o),(l=s.match(r))&&function(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(In)||[]).forEach(function(e){var r=Dn(e);switch(jn(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":r.patternType&&(a.patternType=r.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),r.indexed&&(a.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(a.bgColor.theme=parseInt(r.theme,10)),r.tint&&(a.bgColor.tint=parseFloat(r.tint)),r.rgb&&(a.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),r.theme&&(a.fgColor.theme=parseInt(r.theme,10)),r.tint&&(a.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(a.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}})}(l,c,0,o),(l=s.match(a))&&function(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(In)||[]).forEach(function(e){var r=Dn(e);switch(jn(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},r.diagonalUp&&(a.diagonalUp=zn(r.diagonalUp)),r.diagonalDown&&(a.diagonalDown=zn(r.diagonalDown)),t.Borders.push(a);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}})}(l,c,0,o),(l=s.match(t))&&function(e,t,r){var n;t.CellXf=[];var a=!1;(e[0].match(In)||[]).forEach(function(e){var s=Dn(e),i=0;switch(jn(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"<protection>":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":case"<xf>":for(delete(n=s)[0],i=0;i<Lo.length;++i)n[Lo[i]]&&(n[Lo[i]]=parseInt(n[Lo[i]],10));for(i=0;i<Fo.length;++i)n[Fo[i]]&&(n[Fo[i]]=zn(n[Fo[i]]));if(t.NumberFmt&&n.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[i]){n.numFmtId=i;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":case"<alignment>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=zn(s.wrapText)),n.alignment=o;break;case"<AlternateContent":case"<AlternateContent>":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(l,c,o),c):c}}();var Bo=Ha;var Vo=Ha;var zo=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Ho(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(In)||[]).forEach(function(e){var a=Dn(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[zo.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Wo(){}function Go(){}var Ko=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,qo=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Xo=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var $o=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Yo(e,t){var r;e&&0!==e.length||(e=Qo());var n={};if(!(r=e.match($o)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",Ko,Ho],["fontScheme",qo,Wo],["fmtScheme",Xo,Go]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}(r[0],n,t),n.raw=e,n}function Qo(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[_n];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Jo(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Ha(e,t)}(e,4);break;case 2:t.xclrValue=wi(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function Zo(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Jo(e);break;case 6:n[1]=function(e,t){return Ha(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function el(e,t){t.forEach(function(e){e[0]})}var tl=/<(?:\w+:)?shape(?:[^\w][^>]*)?>([\s\S]*?)<\/(?:\w+:)?shape>/g;function rl(e,t,r,n){var a,s=null!=e["!data"];t.forEach(function(t){var i=ts(t.ref);if(!(i.r<0||i.c<0)){if(s?(e["!data"][i.r]||(e["!data"][i.r]=[]),a=e["!data"][i.r][i.c]):a=e[t.ref],!a){a={t:"z"},s?e["!data"][i.r][i.c]=a:e[t.ref]=a;var o=is(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=as(o);e["!ref"]=l}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!r&&a.c[u].T)return;r&&!a.c[u].T&&a.c.splice(u,1)}if(r&&n)for(u=0;u<n.length;++u)if(c.a==n[u].id){c.a=n[u].name||c.a;break}a.c.push(c)}})}var nl=hs;var al=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var s=!1,i=!1;0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,l=a.length>0?0|parseInt(a,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,r+(s?"":"$")+es(l)+(i?"":"$")+Ja(o)}return function(n,a){return t=a,n.replace(e,r)}}(),sl=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{sl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch(Iv){}var il=function(){return function(e,t){return e.replace(sl,function(e,r,n,a,s,i){var o=Za(a)-(n?0:t.c),l=Qa(i)-(s?0:t.r);return r+"R"+("$"==s?l+1:0==l?"":"["+l+"]")+"C"+("$"==n?o+1:0==o?"":"["+o+"]")})}}();function ol(e,t){return e.replace(sl,function(e,r,n,a,s,i){return r+("$"==n?n+a:es(Za(a)+t.c))+("$"==s?s+i:Ja(Qa(i)+t.r))})}function ll(e,t,r){var n=ns(t).s,a=ts(r);return ol(e,{r:a.r-n.r,c:a.c-n.c})}function cl(e){return e.replace(/_xlfn\./g,"")}function ul(e){e.l+=1}function dl(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function hl(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return fl(e);12==r.biff&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=dl(e,2),o=dl(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function fl(e){var t=dl(e,2),r=dl(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function ml(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=dl(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),a=dl(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function pl(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function gl(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function vl(e){return[e.read_shift(1),e.read_shift(1)]}function yl(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=ci(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Ps[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ns(e);break;case 2:r[1]=vi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function bl(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],s=0;s!=n;++s)a.push((12==r.biff?ks:Ni)(e,8));return a}function wl(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=yl(e,r.biff);return i}function xl(e,t,r){return e.l+=2,[pl(e)]}function El(e){return e.l+=6,[]}function Tl(e){return e.l+=2,[ui(e),1&e.read_shift(2)]}var kl=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Nl={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Ha},3:{n:"PtgAdd",f:ul},4:{n:"PtgSub",f:ul},5:{n:"PtgMul",f:ul},6:{n:"PtgDiv",f:ul},7:{n:"PtgPower",f:ul},8:{n:"PtgConcat",f:ul},9:{n:"PtgLt",f:ul},10:{n:"PtgLe",f:ul},11:{n:"PtgEq",f:ul},12:{n:"PtgGe",f:ul},13:{n:"PtgGt",f:ul},14:{n:"PtgNe",f:ul},15:{n:"PtgIsect",f:ul},16:{n:"PtgUnion",f:ul},17:{n:"PtgRange",f:ul},18:{n:"PtgUplus",f:ul},19:{n:"PtgUminus",f:ul},20:{n:"PtgPercent",f:ul},21:{n:"PtgParen",f:ul},22:{n:"PtgMissArg",f:ul},23:{n:"PtgStr",f:function(e,t,r){return e.l++,fi(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Ps[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Ns(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[ql[a],Kl[a],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===s[0]?Kl:Gl)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,ml(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,hl(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Ha},40:{n:"PtgMemNoMem",f:Ha},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;a>524287;)a-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:a,c:s,cRel:i,rRel:o}}(e,0,r);return[n,a]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=function(e,t,r){if(r.biff<8)return fl(e);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),s=dl(e,2),i=dl(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[n,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,a,ml(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,a,hl(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[n,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[n,a]}},255:{}},Sl={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_l={1:{n:"PtgElfLel",f:Tl},2:{n:"PtgElfRw",f:xl},3:{n:"PtgElfCol",f:xl},6:{n:"PtgElfRwV",f:xl},7:{n:"PtgElfColV",f:xl},10:{n:"PtgElfRadical",f:xl},11:{n:"PtgElfRadicalS",f:El},13:{n:"PtgElfColS",f:El},15:{n:"PtgElfColSV",f:El},16:{n:"PtgElfRadicalLel",f:Tl},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:kl[r>>2&31],idx:n,c:a,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Cl={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&2==r.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:gl},33:{n:"PtgAttrBaxcel",f:gl},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),vl(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),vl(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Al(e,t,r,n){if(n.biff<8)return Ha(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=wl(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=bl(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&12==n.biff&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=a-e.l)&&s.push(Ha(e,t)),s}function Il(e,t,r){for(var n,a,s=e.l+t,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=Nl[a]||Nl[Sl[a]],24!==a&&25!==a||(n=(24===a?_l:Cl)[e[e.l+1]]),n&&n.f?i.push([n.n,n.f(e,t,r)]):Ha(e,t);return i}function Rl(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)if(2===i[0])a.push('"'+i[1].replace(/"/g,'""')+'"');else a.push(i[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var Ol={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Dl(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return-1==r&&-1==n?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function jl(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Pl(e,t,r){var n=jl(e,t,r);return"#REF"==n?n:ss(n,r)}function Ml(e,t,r,n,a){var s,i,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=d.pop(),i=d.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=an(" ",e[0][p][1][1]);break;case 1:g=an("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}d.push(i+Ol[b[0]]+s);break;case"PtgIsect":s=d.pop(),i=d.pop(),d.push(i+" "+s);break;case"PtgUnion":s=d.pop(),i=d.pop(),d.push(i+","+s);break;case"PtgRange":s=d.pop(),i=d.pop(),d.push(Dl(i,s));break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=qa(b[1][1],u,a),d.push($a(o,c));break;case"PtgRefN":o=r?qa(b[1][1],r,a):b[1][1],d.push($a(o,c));break;case"PtgRef3d":h=b[1][1],o=qa(b[1][2],u,a);m=Pl(n,h,a);d.push(m+"!"+$a(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],x=b[1][1];w||(w=0);var E=0==(w&=127)?[]:d.slice(-w);d.length-=w,"User"===x&&(x=E.shift()),d.push(x+"("+E.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Xa(b[1][1],r?{s:r}:u,a),d.push(Ya(l,a));break;case"PtgArea":l=Xa(b[1][1],u,a),d.push(Ya(l,a));break;case"PtgArea3d":h=b[1][1],l=b[1][2],m=Pl(n,h,a),d.push(m+"!"+Ya(l,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=b[1][2];var T=(n.names||[])[f-1]||(n[0]||[])[f],k=T?T.Name:"SH33TJSNAME"+String(f);k&&"_xlfn."==k.slice(0,6)&&!a.xlfn&&(k=k.slice(6)),d.push(k);break;case"PtgNameX":var N,S=b[1][1];if(f=b[1][2],!(a.biff<=5)){var _="";if(14849==((n[S]||[])[0]||[])[0]||(1025==((n[S]||[])[0]||[])[0]?n[S][f]&&n[S][f].itab>0&&(_=n.SheetNames[n[S][f].itab-1]+"!"):_=n.SheetNames[f-1]+"!"),n[S]&&n[S][f])_+=n[S][f].Name;else if(n[0]&&n[0][f])_+=n[0][f].Name;else{var C=(jl(n,S,a)||"").split(";;");C[f-1]?_=C[f-1]:_+="SH33TJSERRX"}d.push(_);break}S<0&&(S=-S),n[S]&&(N=n[S][f]),N||(N={Name:"SH33TJSERRY"}),d.push(N.Name);break;case"PtgParen":var A="(",I=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:A=an(" ",e[0][p][1][1])+A;break;case 3:A=an("\r",e[0][p][1][1])+A;break;case 4:I=an(" ",e[0][p][1][1])+I;break;case 5:I=an("\r",e[0][p][1][1])+I;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}d.push(A+d.pop()+I);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var R={c:r.c,r:r.r};if(n.sharedf[rs(o)]){var O=n.sharedf[rs(o)];d.push(Ml(O,u,R,n,a))}else{var D=!1;for(s=0;s!=n.arrayf.length;++s)if(i=n.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){d.push(Ml(i[1],u,R,n,a)),D=!0;break}D||d.push(b[1])}break;case"PtgArray":d.push("{"+Rl(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var j=!0;switch((b=e[0][p])[1][0]){case 4:j=!1;case 0:g=an(" ",b[1][1]);break;case 5:j=!1;case 1:g=an("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((j?g:"")+d.pop()+(j?"":g)),p=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return"TRUE"==d[0]||"FALSE"!=d[0]&&d[0]}function Ll(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Ha(e,t-2)];var o=Il(e,i,r);return t!==i+s&&(n=Al(e,t-i-s,o,r)),e.l=a,[o,n]}function Fl(e,t,r){var n,a=e.l+t,s=e.read_shift(2),i=Il(e,s,r);return 65535==s?[[],Ha(e,t-2)]:(t!==s+2&&(n=Al(e,a-s-2,i,r)),[i,n])}function Ul(e,t,r){var n=e.l+t,a=Ei(e,6,r),s=function(e){var t;if(65535!==Ra(e,e.l+6))return[Ns(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=function(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Ha(e,t-2)];var o=Il(e,i,r);return t!==i+s&&(n=Al(e,t-i-s,o,r)),e.l=a,[o,n]}(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Bl(e,t,r){var n=e.read_shift(4),a=Il(e,n,r),s=e.read_shift(4);return[a,s>0?Al(e,s,a,r):null]}var Vl=Bl,zl=Bl,Hl=Bl,Wl=Bl;var Gl={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Kl={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ql={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Xl(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\$'([^']|'')+'/g,function(e){return e.slice(1)})).replace(/\$([^\]\. #$]+)/g,function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function $l(e){var t=(e=(e=e.replace(/\$'([^']|'')+'/g,function(e){return e.slice(1)})).replace(/\$([^\]\. #$]+)/g,function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t})).split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Yl={},Ql={};function Jl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function Zl(e,t,r,n,a,s,i){try{n.cellNF&&(e.z=ir[t])}catch(Iv){if(n.WTF)throw Iv}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=tn(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==ir[t]&&Br(Lr[t]||"General",t),"e"===e.t)e.w=e.w||Ps[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=hr(e.v);else if("d"===e.t){var o=$r(e.v,!!i);e.w=(0|o)===o?o.toString(10):hr(o)}else{if(void 0===e.v)return"";e.w=fr(e.v,Ql)}else"d"===e.t?e.w=jr(t,$r(e.v,!!i),Ql):e.w=jr(t,e.v,Ql)}catch(Iv){if(n.WTF)throw Iv}if(n.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=No(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=No(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(Iv){if(n.WTF&&s.Fills)throw Iv}}}var ec=/<(?:\w:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,tc=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,rc=/<(?:\w:)?hyperlink [^>]*>/gm,nc=/"(\w*:\w*)"/,ac=/<(?:\w:)?col\b[^>]*[\/]?>/g,sc=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ic=/<(?:\w:)?pageMargins[^>]*\/>/g,oc=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lc=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,cc=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function uc(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o={};t.dense&&(o["!data"]=[]);var l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(tc);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(oc);h?dc(h[0],o,a,r):(h=c.match(lc))&&function(e,t,r,n,a){dc(e.slice(0,e.indexOf(">")),r,n,a)}(h[0],h[1],o,a,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(nc);!m||t&&t.nodim||function(e,t){var r=is(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=as(r))}(o,m[1])}var p=c.match(cc);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(hc)||[]).forEach(function(e,r){var n=Dn(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),n.rightToLeft&&zn(n.rightToLeft)&&(t.Views[r].RTL=!0)})}(p[1],a);var g=[];if(t.cellStyles){var v=c.match(ac);v&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Dn(t[n],!0);a.hidden&&(a.hidden=zn(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Ro(a.width)),Oo(a);s<=i;)e[s++]=nn(a)}}(g,v)}d&&fc(d[1],o,t,l,s,i,a);var y=u.match(sc);y&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(ec);if(w)for(f=0;f!=w.length;++f)b[f]=is(w[f].slice(w[f].indexOf('"')+1));var x=u.match(rc);x&&function(e,t,r){for(var n=null!=e["!data"],a=0;a!=t.length;++a){var s=Dn(qn(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Ln(s.location))):(s.Target="#"+Ln(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=is(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=es(c)+Ja(l);n?(e["!data"][l]||(e["!data"][l]=[]),e["!data"][l][c]||(e["!data"][l][c]={t:"z",v:void 0}),e["!data"][l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}(o,x,n);var E,T=u.match(ic);if(T&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}(Dn(T[0]))),(E=u.match(/legacyDrawing r:id="(.*?)"/))&&(o["!legrel"]=E[1]),t&&t.nodim&&(l.s.c=l.s.r=0),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=as(l)),t.sheetRows>0&&o["!ref"]){var k=is(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=as(k))}return g.length>0&&(o["!cols"]=g),b.length>0&&(o["!merges"]=b),n["!id"][o["!legrel"]]&&(o["!legdrawel"]=n["!id"][o["!legrel"]]),o}function dc(e,t,r,n){var a=Dn(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ln(qn(a.codeName)))}var hc=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/g;var fc=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=$n("v"),i=$n("f");return function(o,l,c,u,d,h,f){for(var m,p,g,v,y,b=0,w="",x=[],E=[],T=0,k=0,N=0,S="",_=0,C=0,A=0,I=0,R=Array.isArray(h.CellXf),O=[],D=[],j=null!=l["!data"],P=[],M={},L=!1,F=!!c.sheetStubs,U=!!((f||{}).WBProps||{}).date1904,B=o.split(t),V=0,z=B.length;V!=z;++V){var H=(w=B[V].trim()).length;if(0!==H){var W=0;e:for(b=0;b<H;++b)switch(w[b]){case">":if("/"!=w[b-1]){++b;break e}if(c&&c.cellStyles){if(_=null!=(p=Dn(w.slice(W,b),!0)).r?parseInt(p.r,10):_+1,C=-1,c.sheetRows&&c.sheetRows<_)continue;M={},L=!1,p.ht&&(L=!0,M.hpt=parseFloat(p.ht),M.hpx=Po(M.hpt)),p.hidden&&zn(p.hidden)&&(L=!0,M.hidden=!0),null!=p.outlineLevel&&(L=!0,M.level=+p.outlineLevel),L&&(P[_-1]=M)}break;case"<":W=b}if(W>=b)break;if(_=null!=(p=Dn(w.slice(W,b),!0)).r?parseInt(p.r,10):_+1,C=-1,!(c.sheetRows&&c.sheetRows<_)){c.nodim||(u.s.r>_-1&&(u.s.r=_-1),u.e.r<_-1&&(u.e.r=_-1)),c&&c.cellStyles&&(M={},L=!1,p.ht&&(L=!0,M.hpt=parseFloat(p.ht),M.hpx=Po(M.hpt)),p.hidden&&zn(p.hidden)&&(L=!0,M.hidden=!0),null!=p.outlineLevel&&(L=!0,M.level=+p.outlineLevel),L&&(P[_-1]=M)),x=w.slice(b).split(e);for(var G=0;G!=x.length&&"<"==x[G].trim().charAt(0);++G);for(x=x.slice(G),b=0;b!=x.length;++b)if(0!==(w=x[b].trim()).length){if(E=w.match(r),T=b,k=0,N=0,w="<c "+("<"==w.slice(0,1)?">":"")+w,null!=E&&2===E.length){for(T=0,S=E[1],k=0;k!=S.length&&!((N=S.charCodeAt(k)-64)<1||N>26);++k)T=26*T+N;C=--T}else++C;for(k=0;k!=w.length&&62!==w.charCodeAt(k);++k);if(++k,(p=Dn(w.slice(0,k),!0)).r||(p.r=rs({r:_-1,c:C})),m={t:""},null!=(E=(S=w.slice(k)).match(s))&&""!==E[1]&&(m.v=Ln(E[1])),c.cellFormula){if(null!=(E=S.match(i))){if(""==E[1])E[0].indexOf('t="shared"')>-1&&D[(v=Dn(E[0])).si]&&(m.f=ll(D[v.si][1],D[v.si][2],p.r));else if(m.f=Ln(qn(E[1]),!0),c.xlfn||(m.f=cl(m.f)),E[0].indexOf('t="array"')>-1)m.F=(S.match(a)||[])[1],m.F.indexOf(":")>-1&&O.push([is(m.F),m.F]);else if(E[0].indexOf('t="shared"')>-1){v=Dn(E[0]);var K=Ln(qn(E[1]));c.xlfn||(K=cl(K)),D[parseInt(v.si,10)]=[v,K,p.r]}}else(E=S.match(/<f[^>]*\/>/))&&D[(v=Dn(E[0])).si]&&(m.f=ll(D[v.si][1],D[v.si][2],p.r));var q=ts(p.r);for(k=0;k<O.length;++k)q.r>=O[k][0].s.r&&q.r<=O[k][0].e.r&&q.c>=O[k][0].s.c&&q.c<=O[k][0].e.c&&(m.F=O[k][1])}if(null==p.t&&void 0===m.v)if(m.f||m.F)m.v=0,m.t="n";else{if(!F)continue;m.t="z"}else m.t=p.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),m.t){case"n":if(""==m.v||null==m.v){if(!F)continue;m.t="z"}else m.v=parseFloat(m.v);break;case"s":if("undefined"==typeof m.v){if(!F)continue;m.t="z"}else g=Yl[parseInt(m.v,10)],m.v=g.t,m.r=g.r,c.cellHTML&&(m.h=g.h);break;case"str":m.t="s",m.v=null!=m.v?Ln(qn(m.v),!0):"",c.cellHTML&&(m.h=Bn(m.v));break;case"inlineStr":E=S.match(n),m.t="s",null!=E&&(g=ao(E[1]))?(m.v=g.t,c.cellHTML&&(m.h=g.h)):m.v="";break;case"b":m.v=zn(m.v);break;case"d":c.cellDates?m.v=tn(m.v,U):(m.v=$r(tn(m.v,U),U),m.t="n");break;case"e":c&&!1===c.cellText||(m.w=m.v),m.v=Ms[m.v]}if(A=I=0,y=null,R&&void 0!==p.s&&null!=(y=h.CellXf[p.s])&&(null!=y.numFmtId&&(A=y.numFmtId),c.cellStyles&&null!=y.fillId&&(I=y.fillId)),Zl(m,A,I,c,d,h,U),c.cellDates&&R&&"n"==m.t&&Ir(ir[A])&&(m.v=Yr(m.v+(U?1462:0)),m.t="number"==typeof m.v?"n":"d"),p.cm&&c.xlmeta){var X=(c.xlmeta.Cell||[])[+p.cm-1];X&&"XLDAPR"==X.type&&(m.D=!0)}var $;c.nodim&&($=ts(p.r),u.s.r>$.r&&(u.s.r=$.r),u.e.r<$.r&&(u.e.r=$.r)),j?($=ts(p.r),l["!data"][$.r]||(l["!data"][$.r]=[]),l["!data"][$.r][$.c]=m):l[p.r]=m}}}}P.length>0&&(l["!rows"]=P)}}();var mc=ks;function pc(e){return[vs(e),Ns(e),"n"]}var gc=ks;var vc=["left","right","top","bottom","header","footer"];function yc(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])});var a=Ln((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[r,a,t]}(e);u.s.r=u.s.c=0,u.e.c=o,c=es(o),t[0].forEach(function(e,r){i["!data"]?(i["!data"][r]||(i["!data"][r]=[]),i["!data"][r][o]={t:"n",v:e,z:t[1]}):i[c+Ja(r)]={t:"n",v:e,z:t[1]},l=r}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=as(u)),i}var bc=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],wc=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xc=[],Ec=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Tc(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=zn(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10))}}}function kc(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=zn(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function Nc(e){kc(e.WBProps,bc),kc(e.CalcPr,Ec),Tc(e.WBView,wc),Tc(e.Sheets,xc),Ql.date1904=zn(e.WBProps.date1904)}var Sc=":][*?/\\".split("");function _c(e,t){try{if(""==e)throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(39==e.charCodeAt(0)||39==e.charCodeAt(e.length-1))throw new Error("Sheet name cannot start or end with apostrophe (')");if("history"==e.toLowerCase())throw new Error("Sheet name cannot be 'History'");Sc.forEach(function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(Iv){if(t)return!1;throw Iv}return!0}var Cc=/<\w+:workbook/;function Ac(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Ic(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],ou[16]={n:"BrtFRTArchID$",f:Ac},Ga(e,function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=Ml(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:n.push(l),a=!0;break;case 36:case 38:n.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),Nc(r),r.Names=s,r.supbooks=i,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(In,function(o,l){var c=Dn(o);switch(jn(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(Cc)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[a];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":bc.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=zn(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(r.WBProps.CodeName=qn(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Ln(qn(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(s={}).Name=qn(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),zn(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=Ln(qn(e.slice(i,l))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===oa.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return Nc(r),r}(e,r)}function Rc(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l,c={};o.dense&&(c["!data"]=[]);var u,d,h,f,m,p,g,v,y,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],x=!1,E=!1,T=[];o.biff=12,o["!row"]=0;var k=0,N=!1,S=[],_={},C=o.supbooks||a.supbooks||[[]];if(C.sharedf=_,C.arrayf=S,C.SheetNames=a.SheetNames||a.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=C,a.Names))for(var A=0;A<a.Names.length;++A)C[0][A+1]=a.Names[A];var I,R,O=[],D=[],j=!1;ou[16]={n:"BrtShortReal",f:pc};var P=1462*+!!((a||{}).WBProps||{}).date1904;if(Ga(e,function(e,t,A){if(!E)switch(A){case 148:l=e;break;case 0:u=e,o.sheetRows&&o.sheetRows<=u.r&&(E=!0),v=Ja(f=u.r),o["!row"]=u.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Po(e.hpt)),D[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":g=Yl[e[1]],d.v=g.t,d.r=g.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==o.cellText&&(d.w=Ps[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((h=i.CellXf[e[0].iStyleRef])&&Zl(d,h.numFmtId,null,o,s,i,P>0),m=-1==e[0].c?m+1:e[0].c,o.dense?(c["!data"][f]||(c["!data"][f]=[]),c["!data"][f][m]=d):c[es(m)+v]=d,o.cellFormula){for(N=!1,k=0;k<S.length;++k){var M=S[k];u.r>=M[0].s.r&&u.r<=M[0].e.r&&m>=M[0].s.c&&m<=M[0].e.c&&(d.F=as(M[0]),N=!0)}!N&&e.length>3&&(d.f=e[3])}if(b.s.r>u.r&&(b.s.r=u.r),b.s.c>m&&(b.s.c=m),b.e.r<u.r&&(b.e.r=u.r),b.e.c<m&&(b.e.c=m),o.cellDates&&h&&"n"==d.t&&Ir(ir[h.numFmtId])){var L=ur(d.v+P);L&&(d.t="d",d.v=new Date(Date.UTC(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u)))}I&&("XLDAPR"==I.type&&(d.D=!0),I=void 0),R&&(R=void 0);break;case 1:case 12:if(!o.sheetStubs||x)break;d={t:"z",v:void 0},m=-1==e[0].c?m+1:e[0].c,o.dense?(c["!data"][f]||(c["!data"][f]=[]),c["!data"][f][m]=d):c[es(m)+v]=d,b.s.r>u.r&&(b.s.r=u.r),b.s.c>m&&(b.s.c=m),b.e.r<u.r&&(b.e.r=u.r),b.e.c<m&&(b.e.c=m),I&&("XLDAPR"==I.type&&(d.D=!0),I=void 0),R&&(R=void 0);break;case 176:T.push(e);break;case 49:I=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=n["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),f=e.rfx.s.r;f<=e.rfx.e.r;++f)for(m=e.rfx.s.c;m<=e.rfx.e.c;++m)o.dense?(c["!data"][f]||(c["!data"][f]=[]),c["!data"][f][m]||(c["!data"][f][m]={t:"z",v:void 0}),c["!data"][f][m].l=e):(p=es(m)+Ja(f),c[p]||(c[p]={t:"z",v:void 0}),c[p].l=e);break;case 426:if(!o.cellFormula)break;S.push(e),(y=o.dense?c["!data"][f][m]:c[es(m)+v]).f=Ml(e[1],0,{r:u.r,c:m},C,o),y.F=as(e[0]);break;case 427:if(!o.cellFormula)break;_[rs(e[0].s)]=e[1],(y=o.dense?c["!data"][f][m]:c[es(m)+v]).f=Ml(e[1],0,{r:u.r,c:m},C,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)O[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},j||(j=!0,Ro(e.w/256)),Oo(O[e.e+1]);break;case 551:e&&(c["!legrel"]=e);break;case 161:c["!autofilter"]={ref:as(e)};break;case 476:c["!margins"]=e;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name),(e.above||e.left)&&(c["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:w.push(A),x=!0;break;case 38:w.pop(),x=!1;break;default:if(t.T);else if(!x||o.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=as(l||b)),o.sheetRows&&c["!ref"]){var M=is(c["!ref"]);o.sheetRows<=+M.e.r&&(M.e.r=o.sheetRows-1,M.e.r>b.e.r&&(M.e.r=b.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>b.e.c&&(M.e.c=b.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),c["!fullref"]=c["!ref"],c["!ref"]=as(M))}return T.length>0&&(c["!merges"]=T),O.length>0&&(c["!cols"]=O),D.length>0&&(c["!rows"]=D),n["!id"][c["!legrel"]]&&(c["!legdrawel"]=n["!id"][c["!legrel"]]),c}(e,n,r,a,s,i,o):uc(e,n,r,a,s,i,o)}function Oc(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return Ga(e,function(e,n,l){switch(l){case 550:s["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(l);break;case 38:i.pop();break;default:if(n.T>0)i.push(l);else if(n.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,n,r,a,s):function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(oc);return o&&dc(o[0],0,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}(e,0,r,a,s)}function Dc(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var a in ir)n.NumberFmt[a]=ir[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ga(e,function(e,a,o){switch(o){case 44:n.NumberFmt[e[0]]=e[1],Br(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=No(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&n.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(o),i=!0;break;case 38:s.pop(),i=!1;break;default:if(a.T>0)s.push(o);else if(a.T<0)s.pop();else if(!i||r.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),n}(e,r,n):Uo(e,r,n)}function jc(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return Ga(e,function(e,a,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var a=e.match(so);if(a){n=a[2].replace(io,"").split(oo);for(var s=0;s!=n.length;++s){var i=ao(n[s].trim(),t);null!=i&&(r[r.length]=i)}a=Dn(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}(e,r)}function Pc(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],a={},s=!1;return Ga(e,function(e,i,o){switch(o){case 632:n.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var s=Dn(a[0]),i={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=ts(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&ao(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),n.push(i)}}}}),n}(e,r)}function Mc(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return Ga(e,function(e,r,n){if(63===n)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+n.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(In)||[]).forEach(function(e){var n=Dn(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}}),t}(e)}function Lc(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Ga(e,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||a.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}},a)}(e,0,0,n)}function Fc(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return Ga(e,function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==o&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(r),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||a.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}}),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a,s=!1,i=2;return e.replace(In,function(e){var t=Dn(e);switch(jn(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==t.name&&(a=n.Types[o]);break;case"<rc":1==i?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==i&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!s&&(null==r?void 0:r.WTF))throw new Error("unrecognized "+t[0]+" in metadata")}return e}),n}(e,0,r)}var Uc,Bc=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Vc=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function zc(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var a,s,i,o=e.match(Bc);if(o)for(i=0;i!=o.length;++i)-1===(s=(a=o[i].match(Vc))[1].indexOf(":"))?n[a[1]]=a[2].slice(1,a[2].length-1):n["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return n}function Hc(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,a,s=e.match(Bc);if(s)for(a=0;a!=s.length;++a)-1===(n=(r=s[a].match(Vc))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function Wc(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=zn(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=tn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ln(t)]=a}function Gc(e,t,r,n){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Ps[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=hr(e.v):e.w=fr(e.v):e.w=function(e,t,r){var n=Uc[e]||Ln(e);return"General"===n?fr(t):jr(n,t,{date1904:!!r})}(t||"General",e.v,n)}catch(Iv){if(r.WTF)throw Iv}try{var a=Uc[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&"n"==e.t&&Ir(a)){var s=ur(e.v+(n?1462:0));s&&(e.t="d",e.v=new Date(Date.UTC(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u)))}}catch(Iv){if(r.WTF)throw Iv}}}function Kc(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Mo[n.Pattern]||n.Pattern)}e[t.ID]=t}function qc(e,t,r,n,a,s,i,o,l,c,u){var d="General",h=n.StyleID,f={};c=c||{};var m=[],p=0;for(void 0===h&&o&&(h=o.StyleID),void 0===h&&i&&(h=i.StyleID);void 0!==s[h]&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&m.push(s[h].Interior),s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=zn(e);break;case"String":n.t="s",n.r=Vn(Ln(e)),n.v=e.indexOf("<")>-1?Ln(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=$r(tn(e,u),u),n.v!==n.v&&(n.v=Ln(e)),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Ms[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=Vn(t||e))}if(Gc(n,d,c,u),!1!==c.cellFormula)if(n.Formula){var g=Ln(n.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),n.f=al(g,a),delete n.Formula,"RC"==n.ArrayRange?n.F=al("RC:RC",a):n.ArrayRange&&(n.F=al(n.ArrayRange,a),l.push([is(n.F),n.F]))}else for(p=0;p<l.length;++p)a.r>=l[p][0].s.r&&a.r<=l[p][0].e.r&&a.c>=l[p][0].s.c&&a.c<=l[p][0].e.c&&(n.F=l[p][1]);c.cellStyles&&(m.forEach(function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)}),n.s=f),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function Xc(e){return Ls.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function $c(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Yc(e,t){var r=t||{};Mr();var n=Dt(aa(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof xt?xt.utils.decode(65001,It(n)):qn(n));var a,s=n.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=nn(r);return o.type="string",Qi.to_workbook(n,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){s.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length){var n=cs(uu(r[0],t),t);return n.bookType="html",n}var a=hd();return r.forEach(function(e,r){fd(a,uu(e,t),"Sheet"+(r+1))}),a.bookType="html",a}(n,r);Uc={"General Number":"General","General Date":ir[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ir[15],"Short Date":ir[14],"Long Time":ir[19],"Medium Time":ir[18],"Short Time":ir[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ir[2],Standard:ir[4],Percent:ir[10],Scientific:ir[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u={},d=[],h={},f="";r.dense&&(h["!data"]=[]);var m,p={},g={},v=zc('<Data ss:Type="String">'),y=0,b=0,w=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},T={},k="",N=0,S=[],_={},C={},A=0,I=[],R=[],O={},D=[],j=!1,P=[],M=[],L={},F=0,U=0,B={Sheets:[],WBProps:{date1904:!1}},V={};sa.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var z="";a=sa.exec(n);)switch(a[3]=(z=a[3]).toLowerCase()){case"data":if("data"==z){if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;"/"===a[1]?qc(n.slice(y,a.index),k,v,"comment"==c[c.length-1][0]?O:p,{c:b,r:w},E,D[b],g,P,r,B.WBProps.date1904):(k="",v=zc(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(R.length>0&&(p.c=R),(!r.sheetRows||r.sheetRows>w)&&void 0!==p.v&&(r.dense?(h["!data"][w]||(h["!data"][w]=[]),h["!data"][w][b]=p):h[es(b)+Ja(w)]=p),p.HRef&&(p.l={Target:Ln(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=b+(0|parseInt(p.MergeAcross,10)),U=w+(0|parseInt(p.MergeDown,10)),(F>b||U>w)&&S.push({s:{c:b,r:w},e:{c:F,r:U}})),r.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var H=b;H<=F;++H)for(var W=w;W<=U;++W)(H>b||W>w)&&(r.dense?(h["!data"][W]||(h["!data"][W]=[]),h["!data"][W][H]={t:"z"}):h[es(H)+Ja(W)]={t:"z"});b=F+1}else++b;else p.MergeAcross?b=F+1:++b;else(p=Hc(a[0])).Index&&(b=+p.Index-1),b<x.s.c&&(x.s.c=b),b>x.e.c&&(x.e.c=b),"/>"===a[0].slice(-2)&&++b,R=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(w<x.s.r&&(x.s.r=w),w>x.e.r&&(x.e.r=w),"/>"===a[0].slice(-2)&&(g=zc(a[0])).Index&&(w=+g.Index-1),b=0,++w):((g=zc(a[0])).Index&&(w=+g.Index-1),L={},("0"==g.AutoFitHeight||g.Height)&&(L.hpx=parseInt(g.Height,10),L.hpt=jo(L.hpx),M[w]=L),"1"==g.Hidden&&(L.hidden=!0,M[w]=L));break;case"worksheet":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));d.push(f),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(h["!ref"]=as(x),r.sheetRows&&r.sheetRows<=x.e.r&&(h["!fullref"]=h["!ref"],x.e.r=r.sheetRows-1,h["!ref"]=as(x))),S.length&&(h["!merges"]=S),D.length>0&&(h["!cols"]=D),M.length>0&&(h["!rows"]=M),u[f]=h}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([a[3],!1]),l=zc(a[0]),f=Ln(l.Name),h={},r.dense&&(h["!data"]=[]),S=[],P=[],M=[],V={name:f,Hidden:0},B.Sheets.push(V);break;case"table":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;c.push([a[3],!1]),D=[],j=!1}break;case"style":"/"===a[1]?Kc(E,T,r):T=zc(a[0]);break;case"numberformat":T.nf=Ln(zc(a[0]).Format||"General"),Uc[T.nf]&&(T.nf=Uc[T.nf]);for(var G=0;392!=G&&ir[G]!=T.nf;++G);if(392==G)for(G=57;392!=G;++G)if(null==ir[G]){Br(T.nf,G);break}break;case"column":if("table"!==c[c.length-1][0])break;if("/"===a[1])break;if((m=zc(a[0])).Hidden&&(m.hidden=!0,delete m.Hidden),m.Width&&(m.wpx=parseInt(m.Width,10)),!j&&m.wpx>10){j=!0,So=6;for(var K=0;K<D.length;++K)D[K]&&Oo(D[K])}j&&Oo(m),D[m.Index-1||D.length]=m;for(var q=0;q<+m.Span;++q)D[D.length]=nn(m);break;case"namedrange":if("/"===a[1])break;B.Names||(B.Names=[]);var X=Dn(a[0]),$={Name:Xc(X.Name),Ref:al(X.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&($.Sheet=B.Sheets.length-1),B.Names.push($);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?k+=n.slice(N,a.index):N=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=zc(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Ys(_,z,n.slice(A,a.index)):A=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));$c(O),R.push(O)}else c.push([a[3],!1]),zn((l=zc(a[0])).ShowAlways||"0")||(R.hidden=!0),O={a:l.Author};break;case"autofilter":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var Y=zc(a[0]);h["!autofilter"]={ref:al(Y.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;default:if(0==c.length&&"document"==a[3])return Tu(n,r);if(0==c.length&&"uof"==a[3])return Tu(n,r);var Q=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Q=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Q=!1}break;case"excelworkbook":switch(a[3]){case"date1904":B.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":case"hideverticalscrollbar":case"hideworkbooktabs":case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Q=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:Q=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(n.slice(A,a.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2}else A=a.index+a[0].length;break;case"header":h["!margins"]||Jl(h["!margins"]={},"xlml"),isNaN(+Dn(a[0]).Margin)||(h["!margins"].header=+Dn(a[0]).Margin);break;case"footer":h["!margins"]||Jl(h["!margins"]={},"xlml"),isNaN(+Dn(a[0]).Margin)||(h["!margins"].footer=+Dn(a[0]).Margin);break;case"pagemargins":var J=Dn(a[0]);h["!margins"]||Jl(h["!margins"]={},"xlml"),isNaN(+J.Top)||(h["!margins"].top=+J.Top),isNaN(+J.Left)||(h["!margins"].left=+J.Left),isNaN(+J.Right)||(h["!margins"].right=+J.Right),isNaN(+J.Bottom)||(h["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;default:Q=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Q=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Q=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Q=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Q=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Q=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Q=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Q=!1}break;case"smarttags":break;default:Q=!1}if(Q)break;if(a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?Wc(C,z,I,n.slice(A,a.index)):(I=a,A=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=u),Z.SheetNames=d,Z.Workbook=B,Z.SSF=nn(ir),Z.Props=_,Z.Custprops=C,Z.bookType="xlml",Z}function Qc(e,t){switch(qu(t=t||{}),t.type||"base64"){case"base64":return Yc(Ut(e),t);case"binary":case"buffer":case"file":return Yc(e,t);case"array":return Yc(Kt(e),t)}}function Jc(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Ss(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return Ss(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var Zc=[60,1084,2066,2165,2175];function eu(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Ra(r,r.l),c=lu[l],u=0;null!=c&&Zc.indexOf(l)>-1;)s=Ra(r,r.l+2),u=r.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),o=r.slice(u,r.l+4+s),i.push(o),r.l+=4+s,c=lu[l=Ra(r,r.l)];var d=Xt(i);za(d,0);var h=0;d.lens=[];for(var f=0;f<i.length;++f)d.lens.push(h),h+=i[f].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function tu(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&null==e.z&&(e.z=ir[n])}catch(Iv){if(t.WTF)throw Iv}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Ps[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=hr(e.v):e.w=fr(e.v):e.w=jr(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(Iv){if(t.WTF)throw Iv}if(t.cellDates&&n&&"n"==e.t&&Ir(ir[n]||String(n))){var a=ur(e.v+(r?1462:0));a&&(e.t="d",e.v=new Date(Date.UTC(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)))}}}function ru(e,t,r){return{v:e,ixfe:t,t:r}}function nu(e,t){var r={opts:{}},n={};var a={};t.dense&&(a["!data"]=[]);var s,i,o,l,c,u,d,h,f={},m={},p=null,g=[],v="",y={},b="",w={},x=[],E=[],T=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},S=!1,_=function(e){return e<8?js[e]:e<64&&T[e-8]||js[e]},C=function(e,t,r){if((S||!(F>1))&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,a=t.XF.data;a&&a.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=a.patternType,(n=ko(_(a.icvFore)))&&(t.s.fgColor={rgb:n}),(n=ko(_(a.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,r),delete t.ixfe,delete t.XF,s=e,b=rs(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<x.length;++n)if(!(x[n][0].s.c>e.c||x[n][0].s.r>e.r)&&!(x[n][0].e.c<e.c||x[n][0].e.r<e.r)){t.F=as(x[n][0]),x[n][0].s.c==e.c&&x[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+Ml(x[n][1],0,e,P,A));break}r.dense?(a["!data"][e.r]||(a["!data"][e.r]=[]),a["!data"][e.r][e.c]=t):a[b]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var I=[],R=[],O=[],D=[],j=!1,P=[];P.SheetNames=A.snames,P.sharedf=A.sharedf,P.arrayf=A.arrayf,P.names=[],P.XTI=[];var M,L=0,F=0,U=0,B=[],V=[];A.codepage=1200,Ct(1200);for(var z=!1;e.l<e.length-1;){var H=e.l,W=e.read_shift(2);if(0===W&&10===L)break;var G=e.l===e.length?0:e.read_shift(2),K=lu[W];if(0==F&&-1==[9,521,1033,2057].indexOf(W))break;if(K&&K.f){if(t.bookSheets&&133===L&&133!==W)break;if(L=W,2===K.r||12==K.r){var q=e.read_shift(2);if(G-=2,!A.enc&&q!==W&&((255&q)<<8|q>>8)!==W)throw new Error("rt mismatch: "+q+"!="+W);12==K.r&&(e.l+=10,G-=10)}var X={};if(X=10===W?K.f(e,G,A):eu(W,K,e,G,A),0==F&&-1===[9,521,1033,2057].indexOf(L))continue;switch(W){case 34:r.opts.Date1904=k.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=X,!t.password)throw new Error("File is password-protected");if(null==X.valid)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=X;break;case 66:var $=Number(X);switch($){case 21010:$=1200;break;case 32768:$=1e4;break;case 32769:$=1252}Ct(A.codepage=$),z=!0;break;case 317:A.rrtabid=X;break;case 25:A.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:A.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(a["!type"]="dialog"),X.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),X.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:E.push(X);break;case 430:P.push([X]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(X);break;case 24:case 536:M={Name:X.Name,Ref:Ml(X.rgce,0,null,P,A)},X.itab>0&&(M.Sheet=X.itab-1),P.names.push(M),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(X),"_xlnm._FilterDatabase"==X.Name&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&"PtgArea3d"==X.rgce[0][0][0]&&(V[X.itab-1]={ref:as(X.rgce[0][0][1][2])});break;case 22:A.ExternCount=X;break;case 23:0==P.length&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(X),P.XTI=P.XTI.concat(X);break;case 2196:if(A.biff<8)break;null!=M&&(M.Comment=X[1]);break;case 18:a["!protect"]=X;break;case 19:0!==X&&A.WTF&&console.error("Password verifier: "+X);break;case 133:f[4==A.biff?A.snames.length:X.pos]=X,A.snames.push(X.name);break;case 10:if(--F?!S:S)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,a["!ref"]=as(m),t.sheetRows&&t.sheetRows<=m.e.r){var Y=m.e.r;m.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=as(m),m.e.r=Y}m.e.r++,m.e.c++}I.length>0&&(a["!merges"]=I),R.length>0&&(a["!objects"]=R),O.length>0&&(a["!cols"]=O),D.length>0&&(a["!rows"]=D),k.Sheets.push(N)}""===v?y=a:n[v]=a,a={},t.dense&&(a["!data"]=[]);break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),A.biffguess=0==X.BIFFVer,0==X.BIFFVer&&4096==X.dt&&(A.biff=5,z=!0,Ct(A.codepage=28591)),4==A.biff&&256&X.dt&&(S=!0),8==A.biff&&0==X.BIFFVer&&16==X.dt&&(A.biff=2),F++&&!S)break;if(a={},t.dense&&(a["!data"]=[]),A.biff<8&&!z&&(z=!0,Ct(A.codepage=t.codepage||1252)),4==A.biff&&S)v=(f[A.snames.indexOf(v)+1]||{name:""}).name;else if(A.biff<5||0==X.BIFFVer&&4096==X.dt){""===v&&(v="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var Q={pos:e.l-G,name:v};f[Q.pos]=Q,A.snames.push(v)}else v=(f[H]||{name:""}).name;32==X.dt&&(a["!type"]="chart"),64==X.dt&&(a["!type"]="macro"),I=[],R=[],A.arrayf=x=[],O=[],D=[],j=!1,N={Hidden:(f[H]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==a["!type"]&&(t.dense?(a["!data"][X.r]||[])[X.c]:a[es(X.c)+Ja(X.r)])&&++X.c,u={ixfe:X.ixfe,XF:E[X.ixfe]||{},v:X.val,t:"n"},U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:X.c,r:X.r},u,t);break;case 5:case 517:u={ixfe:X.ixfe,XF:E[X.ixfe],v:X.val,t:X.t},U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:X.c,r:X.r},u,t);break;case 638:u={ixfe:X.ixfe,XF:E[X.ixfe],v:X.rknum,t:"n"},U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:X.c,r:X.r},u,t);break;case 189:for(var J=X.c;J<=X.C;++J){var Z=X.rkrec[J-X.c][0];u={ixfe:Z,XF:E[Z],v:X.rkrec[J-X.c][1],t:"n"},U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:J,r:X.r},u,t)}break;case 6:case 518:case 1030:if("String"==X.val){p=X;break}if((u=ru(X.val,X.cell.ixfe,X.tt)).XF=E[u.ixfe],t.cellFormula){var ee=X.formula;if(ee&&ee[0]&&ee[0][0]&&"PtgExp"==ee[0][0][0]){var te=ee[0][0][1][0],re=ee[0][0][1][1],ne=rs({r:te,c:re});w[ne]?u.f=""+Ml(X.formula,0,X.cell,P,A):u.F=((t.dense?(a["!data"][te]||[])[re]:a[ne])||{}).F}else u.f=""+Ml(X.formula,0,X.cell,P,A)}U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C(X.cell,u,t),p=X;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=X,(u=ru(X,p.cell.ixfe,"s")).XF=E[u.ixfe],t.cellFormula&&(u.f=""+Ml(p.formula,0,p.cell,P,A)),U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C(p.cell,u,t),p=null;break;case 33:case 545:x.push(X);var ae=rs(X[0].s);if(i=t.dense?(a["!data"][X[0].s.r]||[])[X[0].s.c]:a[ae],t.cellFormula&&i){if(!p)break;if(!ae||!i)break;i.f=""+Ml(X[1],0,X[0],P,A),i.F=as(X[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!p)break;w[rs(p.cell)]=X[0],((i=t.dense?(a["!data"][p.cell.r]||[])[p.cell.c]:a[rs(p.cell)])||{}).f=""+Ml(X[0],0,s,P,A)}break;case 253:u=ru(g[X.isst].t,X.ixfe,"s"),g[X.isst].h&&(u.h=g[X.isst].h),u.XF=E[u.ixfe],U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:X.c,r:X.r},u,t);break;case 513:t.sheetStubs&&(u={ixfe:X.ixfe,XF:E[X.ixfe],t:"z"},U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:X.c,r:X.r},u,t));break;case 190:if(t.sheetStubs)for(var se=X.c;se<=X.C;++se){var ie=X.ixfe[se-X.c];u={ixfe:ie,XF:E[ie],t:"z"},U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:se,r:X.r},u,t)}break;case 214:case 516:case 4:(u=ru(X.val,X.ixfe,"s")).XF=E[u.ixfe],U>0&&(u.z=u.XF&&u.XF.numFmtId&&B[u.XF.numFmtId]||B[u.ixfe>>8&63]),tu(u,t,r.opts.Date1904),C({c:X.c,r:X.r},u,t);break;case 0:case 512:1===F&&(m=X);break;case 252:g=X;break;case 1054:if(A.biff>=3&&A.biff<=4){B[U++]=X[1];for(var oe=0;oe<U+163&&ir[oe]!=X[1];++oe);oe>=163&&Br(X[1],U+163)}else Br(X[1],X[0]);break;case 30:B[U++]=X;for(var le=0;le<U+163&&ir[le]!=X;++le);le>=163&&Br(X,U+163);break;case 229:I=I.concat(X);break;case 93:R[X.cmo[0]]=A.lastobj=X;break;case 438:A.lastobj.TxO=X;break;case 127:A.lastobj.ImData=X;break;case 440:for(c=X[0].s.r;c<=X[0].e.r;++c)for(l=X[0].s.c;l<=X[0].e.c;++l)(i=t.dense?(a["!data"][c]||[])[l]:a[rs({c:l,r:c})])&&(i.l=X[1]);break;case 2048:for(c=X[0].s.r;c<=X[0].e.r;++c)for(l=X[0].s.c;l<=X[0].e.c;++l)(i=t.dense?(a["!data"][c]||[])[l]:a[rs({c:l,r:c})])&&i.l&&(i.l.Tooltip=X[1]);break;case 28:if((i=t.dense?(a["!data"][X[0].r]||[])[X[0].c]:a[rs(X[0])])||(t.dense?(a["!data"][X[0].r]||(a["!data"][X[0].r]=[]),i=a["!data"][X[0].r][X[0].c]={t:"z"}):i=a[rs(X[0])]={t:"z"},m.e.r=Math.max(m.e.r,X[0].r),m.s.r=Math.min(m.s.r,X[0].r),m.e.c=Math.max(m.e.c,X[0].c),m.s.c=Math.min(m.s.c,X[0].c)),i.c||(i.c=[]),A.biff<=5&&A.biff>=2)o={a:"SheetJ5",t:X[1]};else{var ce=R[X[2]];o={a:X[1],t:ce.TxO.t},null==X[3]||2&X[3]||(i.c.hidden=!0)}i.c.push(o);break;case 2173:el(E[X.ixfe],X.ext);break;case 125:if(!A.cellStyles)break;for(;X.e>=X.s;)O[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(1&X.flags)},j||(j=!0,Ro(X.w/256)),Oo(O[X.e+1]);break;case 520:var ue={};null!=X.level&&(D[X.r]=ue,ue.level=X.level),X.hidden&&(D[X.r]=ue,ue.hidden=!0),X.hpt&&(D[X.r]=ue,ue.hpt=X.hpt,ue.hpx=Po(X.hpt));break;case 38:case 39:case 40:case 41:a["!margins"]||Jl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=X;break;case 161:a["!margins"]||Jl(a["!margins"]={}),a["!margins"].header=X.header,a["!margins"].footer=X.footer;break;case 574:X.RTL&&(k.Views[0].RTL=!0);break;case 146:T=X;break;case 2198:h=X;break;case 140:d=X;break;case 442:v?N.CodeName=X||N.name:k.WBProps.CodeName=X||"ThisWorkbook"}}else K||console.error("Missing Info for XLS Record 0x"+W.toString(16)),e.l+=G}return r.SheetNames=Wr(f).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return f[e].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&y["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=y)):r.Preamble=y,r.Sheets&&V.forEach(function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e}),r.Strings=g,r.SSF=nn(ir),A.enc&&(r.Encryption=A.enc),h&&(r.Themes=h),r.Metadata={},void 0!==d&&(r.Metadata.Country=d),P.names.length>0&&(k.Names=P.names),r.Workbook=k,r}var au="e0859ff2f94f6810ab9108002b27b3d9",su="02d5cdd59c2e1b10939708002b2cf9ae";function iu(e,t){var r,n,a,s;if(t||(t={}),qu(t),At(),t.codepage&&_t(t.codepage),e.FullPaths){if(Hr.find(e,"/encryption"))throw new Error("File is password-protected");r=Hr.find(e,"!CompObj"),n=Hr.find(e,"/Workbook")||Hr.find(e,"/Book")}else{switch(t.type){case"base64":e=Gt(Ut(e));break;case"binary":e=Gt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}za(e,0),n={content:e}}if(r&&Jc(r),t.bookProps&&!t.bookSheets)a={};else{var i=Bt?"buffer":"array";if(n&&n.content)a=nu(n.content,t);else if((s=Hr.find(e,"PerfectOffice_MAIN"))&&s.content)a=Ji.to_workbook(s.content,(t.type=i,t));else{if(!(s=Hr.find(e,"NativeContent_MAIN"))||!s.content)throw(s=Hr.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Ji.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&Hr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=Hr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Hr.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Hr.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,r){var n=Hr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=oi(n,As,su);for(var s in a)t[s]=a[s]}catch(Iv){if(r.WTF)throw Iv}var i=Hr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=oi(i,Is,au);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(Iv){if(r.WTF)throw Iv}t.HeadingPairs&&t.TitlesOfParts&&(Ks(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var ou={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=a/20),r}},1:{f:function(e){return[gs(e)]}},2:{f:function(e){return[gs(e),Es(e),"n"]}},3:{f:function(e){return[gs(e),e.read_shift(1),"e"]}},4:{f:function(e){return[gs(e),e.read_shift(1),"b"]}},5:{f:function(e){return[gs(e),Ns(e),"n"]}},6:{f:function(e){return[gs(e),hs(e),"str"]}},7:{f:function(e){return[gs(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,a=gs(e);a.r=r["!row"];var s=[a,hs(e),"str"];if(r.cellFormula){e.l+=2;var i=zl(e,n-e.l,r);s[3]=Ml(i,0,a,r.supbooks,r)}else e.l=n;return s}},9:{f:function(e,t,r){var n=e.l+t,a=gs(e);a.r=r["!row"];var s=[a,Ns(e),"n"];if(r.cellFormula){e.l+=2;var i=zl(e,n-e.l,r);s[3]=Ml(i,0,a,r.supbooks,r)}else e.l=n;return s}},10:{f:function(e,t,r){var n=e.l+t,a=gs(e);a.r=r["!row"];var s=[a,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=zl(e,n-e.l,r);s[3]=Ml(i,0,a,r.supbooks,r)}else e.l=n;return s}},11:{f:function(e,t,r){var n=e.l+t,a=gs(e);a.r=r["!row"];var s=[a,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=zl(e,n-e.l,r);s[3]=Ml(i,0,a,r.supbooks,r)}else e.l=n;return s}},12:{f:function(e){return[vs(e)]}},13:{f:function(e){return[vs(e),Es(e),"n"]}},14:{f:function(e){return[vs(e),e.read_shift(1),"e"]}},15:{f:function(e){return[vs(e),e.read_shift(1),"b"]}},16:{f:pc},17:{f:function(e){return[vs(e),hs(e),"str"]}},18:{f:function(e){return[vs(e),e.read_shift(4),"s"]}},19:{f:ms},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var s=e.read_shift(4),i=ws(e),o=Hl(e,0,r),l=bs(e);32&a&&(i="_xlnm."+i),e.l=n;var c={Name:i,Ptg:o,Flags:a};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(n.underline=s);var i=e.read_shift(1);i>0&&(n.family=i);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=js[n];l&&(t.rgb=ko(l));break;case 2:t.rgb=ko([s,i,o]);break;case 3:t.theme=n}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=hs(e),n}},44:{f:function(e,t){return[e.read_shift(2),hs(e)]}},45:{f:Bo},46:{f:Vo},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zi},62:{f:function(e){return[gs(e),ms(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=rs(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ha,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=ys(e,t-19),r}},148:{f:mc,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?hs(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=xs(e,t-8),r.name=hs(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:ks},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gc},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:hs(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:xs},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Fi},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,a=Ts(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=Vl(e,n-e.l,r);i[1]=o}else e.l=n;return i}},427:{f:function(e,t,r){var n=e.l+t,a=[ks(e,16)];if(r.cellFormula){var s=Wl(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return vc.forEach(function(r){t[r]=Ns(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=ks(e,16),a=bs(e),s=hs(e),i=hs(e),o=hs(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:xs},551:{f:bs},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nl},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=ks(e,16);return t.rfx=r.s,t.ref=rs(r.s),e.l+=16,t}},636:{T:-1},637:{f:ps},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:hs(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},lu={6:{f:Ul},10:{f:li},12:{f:ui},13:{f:ui},14:{f:ci},15:{f:ci},16:{f:Ns},17:{f:ci},18:{f:ci},19:{f:ui},20:{f:Pi},21:{f:Pi},23:{f:Fi},24:{f:Li},25:{f:ci},26:{},27:{},28:{f:function(e,t,r){if(r&&r.biff<8){var n=e.read_shift(2),a=e.read_shift(2);if(65535==n||-1==n)return;var s=e.read_shift(2);return[{r:n,c:a},e.read_shift(Math.min(s,2048),"cpstr")]}return function(e,t,r){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return[{r:n,c:a},vi(e,0,r),i,s]}(e,0,r)}},29:{},34:{f:ci},35:{f:Mi},38:{f:Ns},39:{f:Ns},40:{f:Ns},41:{f:Ns},42:{f:ci},43:{f:ci},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?xo(e,t-2,n):function(e,t,r,n){var a={key:ui(e),verificationBytes:ui(e)};r.password&&(a.verifier=yo(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=wo(r.password))}(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=fi(e,0,r),n}},51:{f:ui},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:ci},65:{f:function(){}},66:{f:ui},77:{},80:{},81:{},82:{},85:{f:ui},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=vi(e,0,r);return e.read_shift(t+n-e.l),a}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Vi[n]||Ha)(e,t,r)),{cmo:[a,n,s],ft:i}}(e,t,r);var n=Ci(e),a=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n[a]=Ii[a](e,r-e.l)}catch(Iv){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:a}}},94:{},95:{f:ci},96:{},97:{},99:{f:ci},125:{f:zi},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:ui},131:{f:ci},132:{f:ci},133:{f:function(e,t,r){var n="";if(4==r.biff)return 0===(n=fi(e,0,r)).length&&(n="Sheet1"),{name:n};var a=e.read_shift(4),s=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}return 0===(n=fi(e,0,r)).length&&(n="Sheet1"),{pos:a,hs:s,dt:i,name:n}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Rs[t]||t,t=e.read_shift(2),r[1]=Rs[t]||t,r}},141:{f:ui},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xi(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:ui},157:{},158:{},160:{f:Wi},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Ns(e),r.footer=Ns(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(ki(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}},193:{f:li},197:{},198:{},199:{},200:{},201:{},202:{f:ci},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ui},220:{},221:{f:ci},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Os[o>>26],n.cellStyles?(a.alc=7&s,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=15&i,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:li},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Ni(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(mi(e));return s.Count=n,s.Unique=a,s}},253:{f:function(e,t,r){var n=Ei(e,t,r);return n.isst=e.read_shift(4),n}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:di},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ci},353:{f:li},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=pi(e,s),o=[];n>e.l;)o.push(gi(e));return[s,a,i,o]}},431:{f:ci},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var i=e.read_shift(2);e.read_shift(2),ui(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=pi(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(a.length!==i&&a.length!==2*i)throw new Error("cchText: "+i+" != "+a.length);return e.l=n+t,{t:a}}catch(Iv){return e.l=n+t,{t:a}}}},439:{f:ci},440:{f:function(e,t){var r=Ni(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c,u,d="";16&a&&(s=bi(e,e.l)),128&a&&(i=bi(e,e.l)),257===(257&a)&&(o=bi(e,e.l)),1===(257&a)&&(l=yi(e,e.l)),8&a&&(d=bi(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(u=Qs(e)),e.l=r;var h=i||o||l||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&a&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),u&&(f.time=u),s&&(f.Tooltip=s),f}(e,t-24);return[r,n]}},441:{},442:{f:gi},443:{},444:{f:ui},445:{},446:{},448:{f:li},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:li},512:{f:ji},513:{f:Hi},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=Ei(e,6,r),a=Ns(e);return n.val=a,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=Ei(e,t,r),a=gi(e,e.l,r);return n.val=a,n}},517:{f:function(e,t,r){var n=Ei(e,6,r),a=hi(e);return n.val=a,n.t=!0===a||!1===a?"b":"e",n}},519:{f:Gi},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:Bi},549:{f:Oi},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=ki(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),vi(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=Si(e);e.l++;var a=e.read_shift(1);return[Fl(e,t-=8,r),a,n]}},2048:{f:function(e,t){e.read_shift(2);var r=Ni(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace($t,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ri},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:li},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Zo(e,e.l));return{ixfe:r,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ci,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2);return[pi(e,n,r),pi(e,a,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var a,s=e.slice(e.l);e.l=n;try{a=Nn(s,{type:"array"})}catch(Iv){return}var i=xn(a,"theme/theme/theme1.xml",!0);if(i)return Yo(i,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:li},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ui},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,16&a&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xi(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ji},1:{},2:{f:function(e,t,r){var n=Ei(e,7,r),a=e.read_shift(2);return n.t="n",n.val=a,n}},3:{f:function(e,t,r){var n=Ei(e,7,r),a=Ns(e);return n.t="n",n.val=a,n}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=Ei(e,7,r),a=vi(e,0,r);return n.t="str",n.val=a,n}},5:{f:function(e,t,r){var n=e.l+7,a=Ei(e,6,r);e.l=n;var s=hi(e);return a.val=s,a.t=!0===s||!1===s?"b":"e",a}},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:Ri},11:{},22:{f:ui},30:{f:Di},31:{},32:{},33:{f:Bi},36:{},37:{f:Oi},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{f:function(e){var t={};return t.ifnt=e.read_shift(1),e.l++,t.flags=e.read_shift(1),t.numFmtId=63&t.flags,t.flags>>=6,t.fStyle=0,t.data={},t}},68:{f:ui},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}},135:{},136:{},137:{},143:{f:function(e){var t=e.read_shift(4),r=e.read_shift(1),n=e.read_shift(r,"sbcs");return 0===n.length&&(n="Sheet1"),{flags:t,name:n}}},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,a=Ei(e,6,r),s=e.read_shift(2),i=pi(e,s,r);return e.l=n,a.t="str",a.val=i,a}},223:{},234:{},354:{},421:{},518:{f:Ul},521:{f:Ri},536:{f:Li},547:{f:Mi},561:{},579:{f:function(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}},1030:{f:Ul},1033:{f:Ri},1091:{f:function(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function cu(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Ca(r)&&e.push(r)}}function uu(e,t){var r=t||{},n=null!=r.dense?r.dense:Mt,a={};n&&(a["!data"]=[]);var s=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=fn(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,f=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var g=c[o].trim(),v=g.slice(0,3).toLowerCase();if("<tr"!=v){if("<td"==v||"<th"==v){var y=g.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var b=y[l].trim();if(b.match(/<t[dh]/i)){for(var w=b,x=0;"<"==w.charAt(0)&&(x=w.indexOf(">"))>-1;)w=w.slice(x+1);for(var E=0;E<p.length;++E){var T=p[E];T.s.c==d&&T.s.r<u&&u<=T.e.r&&(d=T.e.c+1,E=-1)}var k=Dn(b.slice(0,b.indexOf(">")));f=k.colspan?+k.colspan:1,((h=+k.rowspan)>1||f>1)&&p.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+f-1}});var N=k.t||k["data-t"]||"";if(w.length)if(w=Yn(w),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),w.length){var S={t:"s",v:w};r.raw||!w.trim().length||"s"==N||("TRUE"===w?S={t:"b",v:!0}:"FALSE"===w?S={t:"b",v:!1}:isNaN(sn(w))?isNaN(hn(w).getDate())||(S={t:"d",v:tn(w)},!1===r.UTC&&(S.v=mn(S.v)),r.cellDates||(S={t:"n",v:$r(S.v)}),S.z=r.dateNF||ir[14]):S={t:"n",v:sn(w)}),!1!==S.cellText&&(S.w=w),n?(a["!data"][u]||(a["!data"][u]=[]),a["!data"][u][d]=S):a[rs({r:u,c:d})]=S,d+=f}else d+=f;else d+=f}}}}else{if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0}}return a["!ref"]=as(m),p.length&&(a["!merges"]=p),a}function du(e,t,r,n){for(var a=e["!merges"]||[],s=[],i={},o=null!=e["!data"],l=t.s.c;l<=t.e.c;++l){for(var c=0,u=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){c=-1;break}c=a[d].e.r-a[d].s.r+1,u=a[d].e.c-a[d].s.c+1;break}if(!(c<0)){var h=es(l)+Ja(r),f=o?(e["!data"][r]||[])[l]:e[h],m=f&&null!=f.v&&(f.h||Bn(f.w||(ls(f),f.w)||""))||"";i={},c>1&&(i.rowspan=c),u>1&&(i.colspan=u),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(i["data-t"]=f&&f.t||"z",null!=f.v&&(i["data-v"]=f.v instanceof Date?f.v.toISOString():f.v),null!=f.z&&(i["data-z"]=f.z),f.l&&"#"!=(f.l.Target||"#").charAt(0)&&(m='<a href="'+Bn(f.l.Target)+'">'+m+"</a>")),i.id=(n.id||"sjs")+"-"+h,s.push(na("td",m,i))}}return"<tr>"+s.join("")+"</tr>"}var hu='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fu="</body></html>";function mu(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pu(e,t){var r=t||{},n=null!=r.header?r.header:hu,a=null!=r.footer?r.footer:fu,s=[n],i=ns(e["!ref"]||"A1");if(s.push(mu(0,0,r)),e["!ref"])for(var o=i.s.r;o<=i.e.r;++o)s.push(du(e,i,o,r));return s.push("</table>"+a),s.join("")}function gu(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},s=null!=e["!data"],i=0,o=0;if(null!=a.origin)if("number"==typeof a.origin)i=a.origin;else{var l="string"==typeof a.origin?ts(a.origin):a.origin;i=l.r,o=l.c}var c=Math.min(a.sheetRows||1e7,n.length),u={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var d=ns(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),-1==i&&(u.e.r=i=d.e.r+1)}var h=[],f=0,m=e["!rows"]||(e["!rows"]=[]),p=0,g=0,v=0,y=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<n.length&&g<c;++p){var x=n[p];if(yu(x)){if(a.display)continue;m[g]={hidden:!0}}var E=x.cells;for(v=y=0;v<E.length;++v){var T=E[v];if(!a.display||!yu(T)){var k=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):Yn(T.innerHTML),N=T.getAttribute("data-z")||T.getAttribute("z");for(f=0;f<h.length;++f){var S=h[f];S.s.c==y+o&&S.s.r<g+i&&g+i<=S.e.r&&(y=S.e.c+1-o,f=-1)}w=+T.getAttribute("colspan")||1,((b=+T.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:g+i,c:y+o},e:{r:g+i+(b||1)-1,c:y+o+(w||1)-1}});var _={t:"s",v:k},C=T.getAttribute("data-t")||T.getAttribute("t")||"";null!=k&&(0==k.length?_.t=C||"z":a.raw||0==k.trim().length||"s"==C||("TRUE"===k?_={t:"b",v:!0}:"FALSE"===k?_={t:"b",v:!1}:isNaN(sn(k))?isNaN(hn(k).getDate())||(_={t:"d",v:tn(k)},a.UTC&&(_.v=pn(_.v)),a.cellDates||(_={t:"n",v:$r(_.v)}),_.z=a.dateNF||ir[14]):_={t:"n",v:sn(k)})),void 0===_.z&&null!=N&&(_.z=N);var A="",I=T.getElementsByTagName("A");if(I&&I.length)for(var R=0;R<I.length&&(!I[R].hasAttribute("href")||"#"==(A=I[R].getAttribute("href")).charAt(0));++R);A&&"#"!=A.charAt(0)&&"javascript:"!=A.slice(0,11).toLowerCase()&&(_.l={Target:A}),s?(e["!data"][g+i]||(e["!data"][g+i]=[]),e["!data"][g+i][y+o]=_):e[rs({c:y+o,r:g+i})]=_,u.e.c<y+o&&(u.e.c=y+o),y+=w}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=as(u),g>=c&&(e["!fullref"]=as((u.e.r=n.length-p+g-1+i,u))),e}function vu(e,t){var r={};return(t||{}).dense&&(r["!data"]=[]),gu(r,e,t)}function yu(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function bu(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Ln(t.replace(/<[^>]*>/g,""))]}function wu(e,t,r){var n=r||{},a=aa(e);sa.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");for(var s,i,o,l="",c="",u=0,d=-1,h="";s=sa.exec(a);)switch(s[3]=s[3].replace(/_.*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":"/"===s[1]?("false"==i["truncate-on-overflow"]&&(l.match(/h/)?l=l.replace(/h+/,"[$&]"):l.match(/m/)?l=l.replace(/m+/,"[$&]"):l.match(/s/)&&(l=l.replace(/s+/,"[$&]"))),n[i.name]=l,l=""):"/"!==s[0].charAt(s[0].length-2)&&(l="",i=Dn(s[0],!1));break;case"boolean-style":"/"===s[1]?(n[i.name]="General",l=""):"/"!==s[0].charAt(s[0].length-2)&&(l="",i=Dn(s[0],!1));break;case"boolean":l+="General";break;case"text":"/"===s[1]?"%"==(h=a.slice(d,sa.lastIndex-s[0].length))&&"<number:percentage-style"==i[0]?l+="%":l+='"'+h.replace(/"/g,'""')+'"':"/"!==s[0].charAt(s[0].length-2)&&(d=sa.lastIndex);break;case"day":if("short"===(o=Dn(s[0],!1)).style)l+="d";else l+="dd";break;case"day-of-week":switch((o=Dn(s[0],!1)).style){case"short":default:l+="ddd";break;case"long":l+="dddd"}break;case"era":if("short"===(o=Dn(s[0],!1)).style)l+="ee";else l+="eeee";break;case"hours":if("short"===(o=Dn(s[0],!1)).style)l+="h";else l+="hh";break;case"minutes":if("short"===(o=Dn(s[0],!1)).style)l+="m";else l+="mm";break;case"month":switch((o=Dn(s[0],!1)).textual&&(l+="mm"),o.style){case"short":default:l+="m";break;case"long":l+="mm"}break;case"seconds":if("short"===(o=Dn(s[0],!1)).style)l+="s";else l+="ss";o["decimal-places"]&&(l+="."+an("0",+o["decimal-places"]));break;case"year":switch((o=Dn(s[0],!1)).style){case"short":default:l+="yy";break;case"long":l+="yyyy"}break;case"am-pm":l+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+s[3]);break;case"fill-character":"/"===s[1]?l+='"'+(h=a.slice(d,sa.lastIndex-s[0].length)).replace(/"/g,'""')+'"*':"/"!==s[0].charAt(s[0].length-2)&&(d=sa.lastIndex);break;case"scientific-number":l+="0."+an("0",+(o=Dn(s[0],!1))["min-decimal-places"]||+o["decimal-places"]||2)+an("?",+o["decimal-places"]-+o["min-decimal-places"]||0)+"E"+(zn(o["forced-exponent-sign"])?"+":"")+an("0",+o["min-exponent-digits"]||2);break;case"fraction":+(o=Dn(s[0],!1))["min-integer-digits"]?l+=an("0",+o["min-integer-digits"]):l+="#",l+=" ",l+=an("?",+o["min-numerator-digits"]||1),l+="/",+o["denominator-value"]?l+=o["denominator-value"]:l+=an("?",+o["min-denominator-digits"]||1);break;case"currency-symbol":"/"===s[1]?l+='"'+a.slice(d,sa.lastIndex-s[0].length).replace(/"/g,'""')+'"':"/"!==s[0].charAt(s[0].length-2)?d=sa.lastIndex:l+="$";break;case"text-properties":switch(((o=Dn(s[0],!1)).color||"").toLowerCase().replace("#","")){case"ff0000":case"red":l="[Red]"+l}break;case"text-content":l+="@";break;case"map":o=Dn(s[0],!1),"value()>=0"==Ln(o.condition)?l=n[o["apply-style-name"]]+";"+l:console.error("ODS number format may be incorrect: "+o.condition);break;case"number":if("/"===s[1])break;c="",c+=an("0",+(o=Dn(s[0],!1))["min-integer-digits"]||1),zn(o.grouping)&&(c=pr(an("#",Math.max(0,4-c.length))+c)),(+o["min-decimal-places"]||+o["decimal-places"])&&(c+="."),+o["min-decimal-places"]&&(c+=an("0",+o["min-decimal-places"]||1)),+o["decimal-places"]-(+o["min-decimal-places"]||0)&&(c+=an("0",+o["decimal-places"]-(+o["min-decimal-places"]||0))),l+=c;break;case"embedded-text":"/"===s[1]?0==u?l+='"'+a.slice(d,sa.lastIndex-s[0].length).replace(/"/g,'""')+'"':l=l.slice(0,u)+'"'+a.slice(d,sa.lastIndex-s[0].length).replace(/"/g,'""')+'"'+l.slice(u):"/"!==s[0].charAt(s[0].length-2)&&(d=sa.lastIndex,u=-+Dn(s[0],!1).position||0)}return n}function xu(e,t,r){var n=t||{};var a,s,i,o,l,c,u,d=aa(e),h=[],f=0,m={},p=[],g={};n.dense&&(g["!data"]=[]);var v={value:""},y="",b=0,w="",x=0,E=[],T=[],k=-1,N=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},_=0,C=r||{},A={},I=[],R={},O=[],D=1,j=1,P=[],M={Names:[],WBProps:{}},L={},F=["",""],U=[],B={},V="",z=0,H=!1,W=!1,G=0;for(sa.lastIndex=0,d=d.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");c=sa.exec(d);)switch(c[3]=c[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===c[1]?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=as(S):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=n.sheetRows-1,g["!ref"]=as(S)),I.length&&(g["!merges"]=I),O.length&&(g["!rows"]=O),o.name=o["\u540d\u79f0"]||o.name,"undefined"!==typeof JSON&&JSON.stringify(o),p.push(o.name),m[o.name]=g,W=!1):"/"!==c[0].charAt(c[0].length-2)&&(o=Dn(c[0],!1),k=N=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g={},n.dense&&(g["!data"]=[]),I=[],O=[],W=!0);break;case"table-row-group":"/"===c[1]?--_:++_;break;case"table-row":case"\u884c":if("/"===c[1]){k+=D,D=1;break}if((l=Dn(c[0],!1))["\u884c\u53f7"]?k=l["\u884c\u53f7"]-1:-1==k&&(k=0),(D=+l["number-rows-repeated"]||1)<10)for(G=0;G<D;++G)_>0&&(O[k+G]={level:_});N=-1;break;case"covered-table-cell":"/"!==c[1]&&++N,n.sheetStubs&&(n.dense?(g["!data"][k]||(g["!data"][k]=[]),g["!data"][k][N]={t:"z"}):g[rs({r:k,c:N})]={t:"z"}),y="",E=[];break;case"table-cell":case"\u6570\u636e":if("/"===c[0].charAt(c[0].length-2))++N,v=Dn(c[0],!1),j=parseInt(v["number-columns-repeated"]||"1",10),u={t:"z",v:null},v.formula&&0!=n.cellFormula&&(u.f=Xl(Ln(v.formula))),v["style-name"]&&A[v["style-name"]]&&(u.z=A[v["style-name"]]),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(u.t="s",u.v=Ln(v["string-value"]||""),n.dense?(g["!data"][k]||(g["!data"][k]=[]),g["!data"][k][N]=u):g[es(N)+Ja(k)]=u),N+=j-1;else if("/"!==c[1]){y=w="",b=x=0,E=[],T=[],j=1;var K=D?k+D-1:k;if(++N>S.e.c&&(S.e.c=N),N<S.s.c&&(S.s.c=N),k<S.s.r&&(S.s.r=k),K>S.e.r&&(S.e.r=K),U=[],B={},u={t:(v=Dn(c[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},v["style-name"]&&A[v["style-name"]]&&(u.z=A[v["style-name"]]),n.cellFormula)if(v.formula&&(v.formula=Ln(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(R={s:{r:k,c:N},e:{r:k+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:N+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},u.F=as(R),P.push([R,u.F])),v.formula)u.f=Xl(v.formula);else for(G=0;G<P.length;++G)k>=P[G][0].s.r&&k<=P[G][0].e.r&&N>=P[G][0].s.c&&N<=P[G][0].e.c&&(u.F=P[G][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(R={s:{r:k,c:N},e:{r:k+(parseInt(v["number-rows-spanned"],10)||0)-1,c:N+(parseInt(v["number-columns-spanned"],10)||0)-1}},I.push(R)),v["number-columns-repeated"]&&(j=parseInt(v["number-columns-repeated"],10)),u.t){case"boolean":u.t="b",u.v=zn(v["boolean-value"])||+v["boolean-value"]>=1;break;case"float":u.t="n",u.v=parseFloat(v.value),n.cellDates&&u.z&&Ir(u.z)&&(u.v=Yr(u.v+(M.WBProps.date1904?1462:0)),u.t="number"==typeof u.v?"n":"d");break;case"percentage":case"currency":u.t="n",u.v=parseFloat(v.value);break;case"date":u.t="d",u.v=tn(v["date-value"],M.WBProps.date1904),n.cellDates||(u.t="n",u.v=$r(u.v,M.WBProps.date1904)),u.z||(u.z="m/d/yy");break;case"time":u.t="n",u.v=Qr(v["time-value"])/86400,n.cellDates&&(u.v=Yr(u.v),u.t="number"==typeof u.v?"n":"d"),u.z||(u.z="HH:MM:SS");break;case"number":u.t="n",u.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==u.t&&"text"!==u.t&&u.t)throw new Error("Unsupported value type "+u.t);u.t="s",null!=v["string-value"]&&(y=Ln(v["string-value"]),E=[])}}else{if(H=!1,"s"===u.t&&(u.v=y||"",E.length&&(u.R=E),H=0==b),L.Target&&(u.l=L),U.length>0&&(u.c=U,U=[]),y&&!1!==n.cellText&&(u.w=y),H&&(u.t="z",delete u.v),(!H||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=k))for(var q=0;q<D;++q){if(j=parseInt(v["number-columns-repeated"]||"1",10),n.dense)for(g["!data"][k+q]||(g["!data"][k+q]=[]),g["!data"][k+q][N]=0==q?u:nn(u);--j>0;)g["!data"][k+q][N+j]=nn(u);else for(g[rs({r:k+q,c:N})]=u;--j>0;)g[rs({r:k+q,c:N+j})]=nn(u);S.e.c<=N&&(S.e.c=N)}N+=(j=parseInt(v["number-columns-repeated"]||"1",10))-1,j=0,u={},y="",E=[]}L={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===c[1]){if((a=h.pop())[0]!==c[3])throw"Bad state: "+a}else"/"!==c[0].charAt(c[0].length-2)&&h.push([c[3],!0]);break;case"annotation":if("/"===c[1]){if((a=h.pop())[0]!==c[3])throw"Bad state: "+a;B.t=y,E.length&&(B.R=E),B.a=V,U.push(B),y=w,b=x,E=T}else if("/"!==c[0].charAt(c[0].length-2)){h.push([c[3],!1]);var X=Dn(c[0],!0);X.display&&zn(X.display)||(U.hidden=!0),w=y,x=b,T=E,y="",b=0,E=[]}V="",z=0;break;case"creator":"/"===c[1]?V=d.slice(z,c.index):z=c.index+c[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===c[1]){if((a=h.pop())[0]!==c[3])throw"Bad state: "+a}else"/"!==c[0].charAt(c[0].length-2)&&h.push([c[3],!1]);y="",b=0,E=[];break;case"scientific-number":case"currency-symbol":case"fill-character":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"number":case"fraction":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":case"boolean":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"filter-set-item":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if("/"===c[1]){var $=sa.lastIndex;wu(d.slice(i,sa.lastIndex),0,C),sa.lastIndex=$}else"/"!==c[0].charAt(c[0].length-2)&&(i=sa.lastIndex-c[0].length);break;case"style":var Y=Dn(c[0],!1);"table-cell"==Y.family&&C[Y["data-style-name"]]&&(A[Y.name]=C[Y["data-style-name"]]);break;case"text":if("/>"===c[0].slice(-2))break;if("/"===c[1])switch(h[h.length-1][0]){case"number-style":case"date-style":case"time-style":d.slice(f,c.index)}else f=c.index+c[0].length;break;case"named-range":F=$l((s=Dn(c[0],!1))["cell-range-address"]);var Q={Name:s.name,Ref:F[0]+"!"+F[1]};W&&(Q.Sheet=p.length),M.Names.push(Q);break;case"null-date":if("1904-01-01"===(s=Dn(c[0],!1))["date-value"])M.WBProps.date1904=!0;break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(h[h.length-1][0])>-1)break;if("/"!==c[1]||v&&v["string-value"])"/>"==c[0].slice(-2)?y+="\n":(Dn(c[0],!1),b=c.index+c[0].length);else{var J=bu(d.slice(b,c.index));y=(y.length>0?y+"\n":"")+J[0]}break;case"database-range":if("/"===c[1])break;try{m[(F=$l(Dn(c[0])["target-range-address"]))[0]]["!autofilter"]={ref:F[1]}}catch(Iv){}break;case"a":if("/"!==c[1]){if(!(L=Dn(c[0],!1)).href)break;L.Target=Ln(L.href),delete L.href,"#"==L.Target.charAt(0)&&L.Target.indexOf(".")>-1?(F=$l(L.Target.slice(1)),L.Target="#"+F[0]+"!"+F[1]):L.Target.match(/^\.\.[\\\/]/)&&(L.Target=L.Target.slice(3))}break;default:switch(c[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(c)}}var Z={Sheets:m,SheetNames:p,Workbook:M};return n.bookSheets&&delete Z.Sheets,Z}function Eu(e,t){t=t||{},yn(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,a=aa(e);r=sa.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=Dn(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(wn(e,"META-INF/manifest.xml"),t);var r=xn(e,"styles.xml"),n=r&&wu(qn(r)),a=xn(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=xu(qn(a),t,n);return yn(e,"meta.xml")&&(s.Props=Ws(wn(e,"meta.xml"))),s.bookType="ods",s}function Tu(e,t){var r=xu(e,t);return r.bookType="fods",r}var ku=function(){try{return"undefined"==typeof Uint8Array||"undefined"==typeof Uint8Array.prototype.subarray?"slice":"undefined"!==typeof Buffer?"undefined"==typeof Buffer.prototype.subarray?"slice":("function"==typeof Buffer.from?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch(Iv){return"slice"}}();function Nu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Su(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):qn(Kt(e))}function _u(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var s=e[r],i=s.length;if(i<250)for(var o=0;o<i;++o)n[a++]=s[o];else n.set(s,a),a+=i}return n}function Cu(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Au(e,t){var r=t.l,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t.l=r,n}function Iu(e){var t=0,r=127&e[t];return e[t++]<128?r:(r|=(127&e[t])<<7,e[t++]<128?r:(r|=(127&e[t])<<14,e[t++]<128?r:(r|=(127&e[t])<<21,e[t++]<128?r:r|=(15&e[t])<<28)))}function Ru(e){for(var t=[],r={l:0};r.l<e.length;){var n,a=r.l,s=Au(e,r),i=7&s;s=s/8|0;var o=r.l;switch(i){case 0:for(;e[o++]>=128;);n=e[ku](r.l,o),r.l=o;break;case 1:n=e[ku](o,o+8),r.l=o+8;break;case 2:var l=Au(e,r);n=e[ku](r.l,r.l+l),r.l+=l;break;case 5:n=e[ku](o,o+4),r.l=o+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var c={data:n,type:i};null==t[s]&&(t[s]=[]),t[s].push(c)}return t}function Ou(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function Du(e){for(var t,r=[],n={l:0};n.l<e.length;){var a=Au(e,n),s=Ru(e[ku](n.l,n.l+a));n.l+=a;var i={id:Iu(s[1][0].data),messages:[]};s[2].forEach(function(t){var r=Ru(t.data),a=Iu(r[3][0].data);i.messages.push({meta:r,data:e[ku](n.l,n.l+a)}),n.l+=a}),(null==(t=s[3])?void 0:t[0])&&(i.merge=Iu(s[3][0].data)>>>0>0),r.push(i)}return r}function ju(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=Au(t,r),a=[],s=r.l;s<t.length;){var i=3&t[s];if(0!=i){var o=0,l=0;if(1==i?(l=4+(t[s]>>2&7),o=(224&t[s++])<<3,o|=t[s++]):(l=1+(t[s++]>>2),2==i?(o=t[s]|t[s+1]<<8,s+=2):(o=(t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24)>>>0,s+=4)),0==o)throw new Error("Invalid offset 0");for(var c=a.length-1,u=o;c>=0&&u>=a[c].length;)u-=a[c].length,--c;if(c<0){if(0!=u)throw new Error("Invalid offset beyond length");u=a[c=0].length}if(l<u)a.push(a[c][ku](a[c].length-u,a[c].length-u+l));else{for(u>0&&(a.push(a[c][ku](a[c].length-u)),l-=u),++c;l>=a[c].length;)a.push(a[c]),l-=a[c].length,++c;l&&a.push(a[c][ku](0,l))}a.length>25&&(a=[_u(a)])}else{var d=t[s++]>>2;if(d<60)++d;else{var h=d-59;d=t[s],h>1&&(d|=t[s+1]<<8),h>2&&(d|=t[s+2]<<16),h>3&&(d|=t[s+3]<<24),d>>>=0,d++,s+=h}a.push(t[ku](s,s+d)),s+=d}}for(var f=0,m=0;m<a.length;++m)f+=a[m].length;if(f!=n)throw new Error("Unexpected length: ".concat(f," != ").concat(n));return a}function Pu(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,ju(n,e[ku](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return 1==t.length?t[0]:_u(t)}function Mu(e,t,r,n,a){var s,i,o,l,c=255&t,u=t>>8,d=u>=5?a:n;e:if(r&(u>4?8:4)&&"n"==e.t&&7==c){var h=(null==(s=d[7])?void 0:s[0])?Iu(d[7][0].data):-1;if(-1==h)break e;var f=(null==(i=d[15])?void 0:i[0])?Iu(d[15][0].data):-1,m=(null==(o=d[16])?void 0:o[0])?Iu(d[16][0].data):-1,p=(null==(l=d[40])?void 0:l[0])?Iu(d[40][0].data):-1,g=e.v,v=g;t:if(p){if(0==g){f=m=2;break t}f=g>=604800?1:g>=86400?2:g>=3600?4:g>=60?8:g>=1?16:32,Math.floor(g)!=g?m=32:g%60?m=16:g%3600?m=8:g%86400?m=4:g%604800&&(m=2),m<f&&(m=f)}if(-1==f||-1==m)break e;var y=[],b=[];1==f&&(v=g/604800,1==m?b.push('d"d"'):g-=604800*(v|=0),y.push(v+(2==h?" week"+(1==v?"":"s"):1==h?"w":""))),f<=2&&m>=2&&(v=g/86400,m>2&&(g-=86400*(v|=0)),b.push('d"d"'),y.push(v+(2==h?" day"+(1==v?"":"s"):1==h?"d":""))),f<=4&&m>=4&&(v=g/3600,m>4&&(g-=3600*(v|=0)),b.push((f>=4?"[h]":"h")+'"h"'),y.push(v+(2==h?" hour"+(1==v?"":"s"):1==h?"h":""))),f<=8&&m>=8&&(v=g/60,m>8&&(g-=60*(v|=0)),b.push((f>=8?"[m]":"m")+'"m"'),0==h?y.push((8==f&&8==m||v>=10?"":"0")+v):y.push(v+(2==h?" minute"+(1==v?"":"s"):1==h?"m":""))),f<=16&&m>=16&&(v=g,m>16&&(g-=v|=0),b.push((f>=16?"[s]":"s")+'"s"'),0==h?y.push((16==m&&16==f||v>=10?"":"0")+v):y.push(v+(2==h?" second"+(1==v?"":"s"):1==h?"s":""))),m>=32&&(v=Math.round(1e3*g),f<32&&b.push('.000"ms"'),0==h?y.push((v>=100?"":v>=10?"0":"00")+v):y.push(v+(2==h?" millisecond"+(1==v?"":"s"):1==h?"ms":""))),e.w=y.join(0==h?":":" "),e.z=b.join(0==h?'":"':" "),0==h&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function Lu(e,t,r){var n,a=Nu(e),s=(a.getUint32(4,!0),a.getUint32(8,!0)),i=12,o=-1,l=-1,c=-1,u=NaN,d=NaN,h=0,f=new Date(Date.UTC(2001,0,1));1&s&&(u=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],a=t+13;a>=t;--a)n=256*n+e[a];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,i),i+=16),2&s&&(d=a.getFloat64(i,!0),i+=8),4&s&&(f.setTime(f.getTime()+1e3*(h=a.getFloat64(i,!0))),i+=8),8&s&&(l=a.getUint32(i,!0),i+=4),16&s&&(o=a.getUint32(i,!0),i+=4),i+=4*Cu(480&s),512&s&&(a.getUint32(i,!0),i+=4),i+=4*Cu(1024&s),2048&s&&(a.getUint32(i,!0),i+=4);var m=e[1];switch(m){case 0:n={t:"z"};break;case 2:case 10:n={t:"n",v:u};break;case 3:n={t:"s",v:t.sst[l]};break;case 5:n=(null==r?void 0:r.cellDates)?{t:"d",v:f}:{t:"n",v:h/86400+35430,z:ir[14]};break;case 6:n={t:"b",v:d>0};break;case 7:n={t:"n",v:d};break;case 8:n={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e[ku](0,4)));var p=t.rsst[o];n={t:"s",v:p.v},p.l&&(n.l={Target:p.l});break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e[ku](0,4)))}if(i+=4*Cu(4096&s),516096&s&&(-1==c&&(c=a.getUint32(i,!0)),i+=4),524288&s){var g=a.getUint32(i,!0);i+=4,t.cmnt[g]&&(n.c=function(e){var t=[];t.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach(function(e){t.push({t:e.t||"",a:e.a,T:!0})});return t}(t.cmnt[g]))}return c>-1&&Mu(n,1280|m,s>>13,t.ofmt[c],t.nfmt[c]),7==m&&(n.v/=86400),n}function Fu(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return function(e,t,r,n){var a,s=Nu(e),i=s.getUint32(4,!0),o=-1,l=-1,c=-1,u=NaN,d=0,h=new Date(Date.UTC(2001,0,1)),f=r>1?12:8;2&i&&(c=s.getUint32(f,!0),f+=4),f+=4*Cu(i&(r>1?3468:396)),512&i&&(o=s.getUint32(f,!0),f+=4),f+=4*Cu(i&(r>1?12288:4096)),16&i&&(l=s.getUint32(f,!0),f+=4),32&i&&(u=s.getFloat64(f,!0),f+=8),64&i&&(h.setTime(h.getTime()+1e3*(d=s.getFloat64(f,!0))),f+=8),r>1&&255&(i=s.getUint32(8,!0)>>>16)&&(-1==c&&(c=s.getUint32(f,!0)),f+=4);var m=e[r>=4?1:2];switch(m){case 0:return;case 2:case 7:a={t:"n",v:u};break;case 3:a={t:"s",v:t.sst[l]};break;case 5:a=(null==n?void 0:n.cellDates)?{t:"d",v:h}:{t:"n",v:d/86400+35430,z:ir[14]};break;case 6:a={t:"b",v:u>0};break;case 8:a={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[ku](0,4)));var p=t.rsst[o];a={t:"s",v:p.v},p.l&&(a.l={Target:p.l});break;default:throw new Error("Unsupported cell type ".concat(e[ku](0,4)))}return c>-1&&Mu(a,m|r<<8,i,t.ofmt[c],t.nfmt[c]),7==m&&(a.v/=86400),a}(e,t,e[0],r);case 5:return Lu(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Uu(e){return Iu(Ru(e)[1][0].data)}function Bu(e,t){var r=Ru(t.data),n=Iu(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(t){var r,a,i=Ru(t.data);if(i[1]){var o=Iu(i[1][0].data)>>>0;switch(n){case 1:s[o]=Su(i[3][0].data);break;case 8:var l=Ru(e[Uu(i[9][0].data)][0].data),c=e[Uu(l[1][0].data)][0],u=Iu(c.meta[1][0].data);if(2001!=u)throw new Error("2000 unexpected reference to ".concat(u));var d=Ru(c.data),h={v:d[3].map(function(e){return Su(e.data)}).join("")};s[o]=h;e:if(null==(r=null==d?void 0:d[11])?void 0:r[0]){var f=null==(a=Ru(d[11][0].data))?void 0:a[1];if(!f)break e;f.forEach(function(t){var r,n,a,s=Ru(t.data);if(null==(r=s[2])?void 0:r[0]){var i=e[Uu(null==(n=s[2])?void 0:n[0].data)][0],o=Iu(i.meta[1][0].data);switch(o){case 2032:var l=Ru(i.data);(null==(a=null==l?void 0:l[2])?void 0:a[0])&&!h.l&&(h.l=Su(l[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(o))}}})}break;case 2:s[o]=Ru(i[6][0].data);break;case 3:s[o]=Ru(i[5][0].data);break;case 10:var m=e[Uu(i[10][0].data)][0];s[o]=zu(e,m.data);break;default:throw n}}}),s}function Vu(e,t){var r,n=Ru(t.data),a=-1;(null==(r=null==n?void 0:n[7])?void 0:r[0])&&(a=Iu(n[7][0].data)>>>0?1:0);var s=Ou(n[5],function(e){return function(e,t){var r,n,a,s,i,o,l,c,u,d,h,f,m,p,g,v,y=Ru(e),b=Iu(y[1][0].data)>>>0,w=Iu(y[2][0].data)>>>0,x=(null==(n=null==(r=y[8])?void 0:r[0])?void 0:n.data)&&Iu(y[8][0].data)>0||!1;if((null==(s=null==(a=y[7])?void 0:a[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=y[7])?void 0:i[0])?void 0:o.data,v=null==(c=null==(l=y[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(d=null==(u=y[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(f=null==(h=y[4])?void 0:h[0])?void 0:f.data,v=null==(p=null==(m=y[3])?void 0:m[0])?void 0:p.data}for(var E=x?4:1,T=Nu(g),k=[],N=0;N<g.length/2;++N){var S=T.getUint16(2*N,!0);S<65535&&k.push([N,S])}if(k.length!=w)throw"Expected ".concat(w," cells, found ").concat(k.length);var _=[];for(N=0;N<k.length-1;++N)_[k[N][0]]=v[ku](k[N][1]*E,k[N+1][1]*E);return k.length>=1&&(_[k[k.length-1][0]]=v[ku](k[k.length-1][1]*E)),{R:b,cells:_}}(e,a)});return{nrows:Iu(n[4][0].data)>>>0,data:s.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r}),e},[])}}function zu(e,t){var r,n,a,s,i,o,l,c,u,d,h={t:"",a:""},f=Ru(t);if((null==(n=null==(r=null==f?void 0:f[1])?void 0:r[0])?void 0:n.data)&&(h.t=Su(null==(s=null==(a=null==f?void 0:f[1])?void 0:a[0])?void 0:s.data)||""),null==(o=null==(i=null==f?void 0:f[3])?void 0:i[0])?void 0:o.data){var m=Ru(e[Uu(null==(c=null==(l=null==f?void 0:f[3])?void 0:l[0])?void 0:c.data)][0].data);(null==(d=null==(u=m[1])?void 0:u[0])?void 0:d.data)&&(h.a=Su(m[1][0].data))}return(null==f?void 0:f[4])&&(h.replies=[],f[4].forEach(function(t){var r=e[Uu(t.data)][0];h.replies.push(zu(e,r.data))})),h}function Hu(e,t,r){var n=Ru(t.data),a={"!ref":"A1"};(null==r?void 0:r.dense)&&(a["!data"]=[]);var s=e[Uu(n[2][0].data)],i=Iu(s[0].meta[1][0].data);if(6001!=i)throw new Error("6000 unexpected reference to ".concat(i));return function(e,t,r,n){var a,s,i,o,l,c,u,d,h,f,m=Ru(t.data),p={s:{r:0,c:0},e:{r:0,c:0}};if(p.e.r=(Iu(m[6][0].data)>>>0)-1,p.e.r<0)throw new Error("Invalid row varint ".concat(m[6][0].data));if(p.e.c=(Iu(m[7][0].data)>>>0)-1,p.e.c<0)throw new Error("Invalid col varint ".concat(m[7][0].data));r["!ref"]=as(p);var g=null!=r["!data"],v=r,y=Ru(m[4][0].data),b={sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]};(null==(a=y[4])?void 0:a[0])&&(b.sst=Bu(e,e[Uu(y[4][0].data)][0])),(null==(s=y[6])?void 0:s[0])&&(b.fmla=Bu(e,e[Uu(y[6][0].data)][0])),(null==(i=y[11])?void 0:i[0])&&(b.ofmt=Bu(e,e[Uu(y[11][0].data)][0])),(null==(o=y[12])?void 0:o[0])&&(b.ferr=Bu(e,e[Uu(y[12][0].data)][0])),(null==(l=y[17])?void 0:l[0])&&(b.rsst=Bu(e,e[Uu(y[17][0].data)][0])),(null==(c=y[19])?void 0:c[0])&&(b.cmnt=Bu(e,e[Uu(y[19][0].data)][0])),(null==(u=y[22])?void 0:u[0])&&(b.nfmt=Bu(e,e[Uu(y[22][0].data)][0]));var w=Ru(y[3][0].data),x=0;if(!(null==(d=y[9])?void 0:d[0]))throw"NUMBERS file missing row tree";if(Ru(y[9][0].data)[1].map(function(e){return Ru(e.data)}).forEach(function(t){x=Iu(t[1][0].data);var a=Iu(t[2][0].data),s=w[1][a];if(!s)throw"NUMBERS missing tile "+a;var i=Ru(s.data),o=e[Uu(i[2][0].data)][0],l=Iu(o.meta[1][0].data);if(6002!=l)throw new Error("6001 unexpected reference to ".concat(l));var c=Vu(0,o);c.data.forEach(function(e,t){e.forEach(function(e,a){var s=Fu(e,b,n);s&&(g?(v["!data"][x+t]||(v["!data"][x+t]=[]),v["!data"][x+t][a]=s):r[es(a)+Ja(x+t)]=s)})}),x+=c.nrows}),null==(h=y[13])?void 0:h[0]){var E=e[Uu(y[13][0].data)][0],T=Iu(E.meta[1][0].data);if(6144!=T)throw new Error("Expected merge type 6144, found ".concat(T));r["!merges"]=null==(f=Ru(E.data))?void 0:f[1].map(function(e){var t=Ru(e.data),r=Nu(Ru(t[1][0].data)[1][0].data),n=Nu(Ru(t[2][0].data)[1][0].data);return{s:{r:r.getUint16(0,!0),c:r.getUint16(2,!0)},e:{r:r.getUint16(0,!0)+n.getUint16(0,!0)-1,c:r.getUint16(2,!0)+n.getUint16(2,!0)-1}}})}}(e,s[0],a,r),a}function Wu(e,t,r){var n,a=hd();a.Workbook={WBProps:{date1904:!0}};var s=Ru(t.data);if(null==(n=s[2])?void 0:n[0])throw new Error("Keynote presentations are not supported");if(Ou(s[1],Uu).forEach(function(t){e[t].forEach(function(t){if(2==Iu(t.meta[1][0].data)){var n=function(e,t,r){var n,a=Ru(t.data),s={name:(null==(n=a[1])?void 0:n[0])?Su(a[1][0].data):"",sheets:[]};return Ou(a[2],Uu).forEach(function(t){e[t].forEach(function(t){6e3==Iu(t.meta[1][0].data)&&s.sheets.push(Hu(e,t,r))})}),s}(e,t,r);n.sheets.forEach(function(e,t){fd(a,e,0==t?n.name:n.name+"_"+t,!0)})}})}),0==a.SheetNames.length)throw new Error("Empty NUMBERS file");return a.bookType="numbers",a}function Gu(e,t){var r,n,a,s,i,o,l,c={},u=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)&&0==e.content[0]){var t,r;try{t=Pu(e.content)}catch(Iv){return console.log("?? "+e.content.length+" "+(Iv.message||Iv))}try{r=Du(t)}catch(Iv){return console.log("## "+(Iv.message||Iv))}r.forEach(function(e){c[e.id]=e.messages,u.push(e.id)})}}),!u.length)throw new Error("File has no messages");if((null==(a=null==(n=null==(r=null==c?void 0:c[1])?void 0:r[0].meta)?void 0:n[1])?void 0:a[0].data)&&1e4==Iu(c[1][0].meta[1][0].data))throw new Error("Pages documents are not supported");var d=(null==(l=null==(o=null==(i=null==(s=null==c?void 0:c[1])?void 0:s[0])?void 0:i.meta)?void 0:o[1])?void 0:l[0].data)&&1==Iu(c[1][0].meta[1][0].data)&&c[1][0];if(d||u.forEach(function(e){c[e].forEach(function(e){if(1==Iu(e.meta[1][0].data)>>>0){if(d)throw new Error("Document has multiple roots");d=e}})}),!d)throw new Error("Cannot find Document root");return Wu(c,d,t)}function Ku(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function qu(e){Ku([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Xu(e,t,r,n,a,s,i,o){if(e&&e["!legdrawel"]){var l=xn(r,Sn(e["!legdrawel"].Target,n),!0);l&&function(e,t,r){var n=0;(e.match(tl)||[]).forEach(function(e){var a="",s=!0,i=-1,o=-1,l=-1;if(e.replace(In,function(t,r){var n=Dn(t);switch(jn(n[0])){case"<ClientData":n.ObjectType&&(a=n.ObjectType);break;case"<Visible":case"<Visible/>":s=!1;break;case"<Row":case"<Row>":case"<Column":case"<Column>":i=r+t.length;break;case"</Row>":o=+e.slice(i,r).trim();break;case"</Column>":l=+e.slice(i,r).trim()}return""}),"Note"===a){var c=dd(t,o>=0&&l>=0?rs({r:o,c:l}):r[n].ref);c.c&&(c.c.hidden=s),++n}})}(qn(l),e,o||[])}}function $u(e,t,r,n,a,s,i,o,l,c,u,d){try{s[n]=Vs(xn(e,r,!0),t);var h,f=wn(e,t);switch(o){case"sheet":h=Rc(f,t,a,l,s[n],c,u,d);break;case"chart":if(!(h=Oc(f,t,a,l,s[n],c))||!h["!drawel"])break;var m=Sn(h["!drawel"].Target,t),p=Bs(m),g=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(xn(e,m,!0),Vs(xn(e,p,!0),m)),v=Sn(g,m),y=Bs(v);h=yc(xn(e,v,!0),0,0,Vs(xn(e,y,!0),v),0,h);break;case"macro":x=t,s[n],x.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[n]);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var b=[],w=[];s&&s[n]&&Wr(s[n]).forEach(function(r){var a="";if(s[n][r].Type==Us.CMNT){if(a=Sn(s[n][r].Target,t),!(b=Pc(wn(e,a,!0),a,l))||!b.length)return;rl(h,b,!1)}s[n][r].Type==Us.TCMNT&&(a=Sn(s[n][r].Target,t),w=w.concat(function(e,t){var r=[],n=!1,a={},s=0;return e.replace(In,function(i,o){var l=Dn(i);switch(jn(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&r.push(a);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}(wn(e,a,!0),l)))}),w&&w.length&&rl(h,w,!0,l.people||[]),Xu(h,0,e,t,0,0,0,b)}catch(Iv){if(l.WTF)throw Iv}var x}function Yu(e){return"/"==e.charAt(0)?e.slice(1):e}function Qu(e,t){if(Mr(),qu(t=t||{}),yn(e,"META-INF/manifest.xml"))return Eu(e,t);if(yn(e,"objectdata.xml"))return Eu(e,t);if(yn(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return Gu(e,t);var r=Hr.utils.cfb_new();return Tn(e).forEach(function(t){kn(r,t,En(e,t))}),Gu(r,t)}if(!yn(e,"[Content_Types].xml")){if(yn(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(yn(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=Hr.find(e,"Index.zip");if(n)return delete(t=nn(t)).type,"string"==typeof n.content&&(t.type="binary"),"undefined"!==typeof Bun&&Buffer.isBuffer(n.content)?nd(new Uint8Array(n.content),t):nd(n.content,t);throw new Error("Unsupported ZIP file")}var a,s,i=Tn(e),o=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(In)||[]).forEach(function(e){var n=Dn(e);switch(n[0].replace(Rn,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension.toLowerCase()]=n.ContentType;break;case"<Override":void 0!==t[Fs[n.ContentType]]&&t[Fs[n.ContentType]].push(n.PartName)}}),t.xmlns!==ia)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(xn(e,"[Content_Types].xml")),l=!1;if(0===o.workbooks.length&&wn(e,s="xl/workbook.xml",!0)&&o.workbooks.push(s),0===o.workbooks.length){if(!wn(e,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(s),l=!0}"bin"==o.workbooks[0].slice(-3)&&(l=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Yl=[],o.sst)try{Yl=jc(wn(e,Yu(o.sst)),o.sst,t)}catch(Iv){if(t.WTF)throw Iv}t.cellStyles&&o.themes.length&&(c=Yo(xn(e,o.themes[0].replace(/^\//,""),!0)||"",t)),o.style&&(u=Dc(wn(e,Yu(o.style)),o.style,c,t))}o.links.map(function(r){try{Vs(xn(e,Bs(Yu(r))),r);return Lc(wn(e,Yu(r)),0,r,t)}catch(Iv){}});var d=Ic(wn(e,Yu(o.workbooks[0])),o.workbooks[0],t),h={},f="";o.coreprops.length&&((f=wn(e,Yu(o.coreprops[0]),!0))&&(h=Ws(f)),0!==o.extprops.length&&(f=wn(e,Yu(o.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=qn(e),Gs.forEach(function(r){var a=(e.match($n(r[0]))||[])[1];switch(r[2]){case"string":a&&(t[r[1]]=Ln(a));break;case"bool":t[r[1]]="true"===a;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(n[r[1]]=s[1])}}),n.HeadingPairs&&n.TitlesOfParts&&Ks(n.HeadingPairs,n.TitlesOfParts,t,r)}(f,h,t));var m={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(f=xn(e,Yu(o.custprops[0]),!0))&&(m=function(e,t){var r={},n="",a=e.match(qs);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Dn(i);switch(jn(o[0])){case"<?xml":case"<Properties":break;case"<property":n=Ln(o.name);break;case"</property>":n=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=Ln(u);break;case"bool":r[n]=zn(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=tn(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return r}(f,t));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?a=d.Sheets.map(function(e){return e.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=m),t.bookSheets&&"undefined"!==typeof a&&(p.SheetNames=a),t.bookSheets?p.SheetNames:t.bookProps))return p;a={};var g={};t.bookDeps&&o.calcchain&&(g=Mc(wn(e,Yu(o.calcchain)),o.calcchain));var v,y,b=0,w={},x=d.Sheets;h.Worksheets=x.length,h.SheetNames=[];for(var E=0;E!=x.length;++E)h.SheetNames[E]=x[E].name;var T=l?"bin":"xml",k=o.workbooks[0].lastIndexOf("/"),N=(o.workbooks[0].slice(0,k+1)+"_rels/"+o.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");yn(e,N)||(N="xl/_rels/workbook."+T+".rels");var S=Vs(xn(e,N,!0),N.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=Fc(wn(e,Yu(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(In,function(e){var a=Dn(e);switch(jn(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e}),r}(wn(e,Yu(o.people[0])),t)),S&&(S=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,Us.WS.indexOf(r)>-1?"sheet":Us.CS&&r==Us.CS?"chart":Us.DS&&r==Us.DS?"dialog":Us.MS&&r==Us.MS?"macro":r&&r.length?r:"sheet")];var r})}catch(Iv){return null}return e&&0!==e.length?e:null}(S,d.Sheets));var _=wn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=h.Worksheets;++b){var C="sheet";if(S&&S[b]?(v="xl/"+S[b][1].replace(/[\/]?xl\//,""),yn(e,v)||(v=S[b][1]),yn(e,v)||(v=N.replace(/_rels\/.*$/,"")+S[b][1]),C=S[b][2]):v=(v="xl/worksheets/sheet"+(b+1-_)+"."+T).replace(/sheet0\./,"sheet."),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(h.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,I=0;I!=t.sheets.length;++I)"number"==typeof t.sheets[I]&&t.sheets[I]==b&&(A=1),"string"==typeof t.sheets[I]&&t.sheets[I].toLowerCase()==h.SheetNames[b].toLowerCase()&&(A=1);if(!A)continue e}}$u(e,v,y,h.SheetNames[b],b,w,a,C,t,d,c,u)}return p={Directory:o,Workbook:d,Props:h,Custprops:m,Deps:g,Sheets:a,SheetNames:h.SheetNames,Strings:Yl,Styles:u,Themes:c,SSF:nn(ir)},t&&t.bookFiles&&(e.files?(p.keys=i,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(t,r){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[r]}))),t&&t.bookVBA&&(o.vba.length>0?p.vbaraw=wn(e,Yu(o.vba[0]),!0):o.defaults&&"application/vnd.ms-office.vbaProject"===o.defaults.bin&&(p.vbaraw=wn(e,"xl/vbaProject.bin",!0))),p.bookType=l?"xlsb":"xlsx",p}function Ju(e,t){var r=t||{},n="Workbook",a=Hr.find(e,n);try{if(n="/!DataSpaces/Version",!(a=Hr.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=co(e,4),t.U=co(e,4),t.W=co(e,4)}(a.content),n="/!DataSpaces/DataSpaceMap",!(a=Hr.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(uo(e));return t}(a.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Hr.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Hr.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);ho(a.content)}catch(Iv){}if(n="/EncryptionInfo",!(a=Hr.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=co(e);switch(t.Minor){case 2:return[t.Minor,po(e)];case 3:return[t.Minor,go()];case 4:return[t.Minor,vo(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(n="/EncryptedPackage",!(a=Hr.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,r.password||"",r);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Zu(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ut(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ed(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Qc(e.slice(r),t);default:break e}return Qi.to_workbook(e,t)}function td(e,t){var r=e;return"base64"==t.type&&(r=Ut(r)),"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer&&(r=new Uint8Array(e)),r="undefined"!==typeof xt?xt.utils.decode(1200,r.slice(2),"str"):Bt&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):"undefined"!==typeof Uint8Array&&r instanceof Uint8Array?"undefined"!==typeof TextDecoder?new TextDecoder("utf-16le").decode(r.slice(2)):function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e[2*r]+(e[2*r+1]<<8));return t.join("")}(r.slice(2)):Rt(r.slice(2)),t.type="binary",ed(r,t)}function rd(e,t,r,n){return n?(r.type="string",Qi.to_workbook(e,r)):Qi.to_workbook(t,r)}function nd(e,t){At();var r=t||{};if(r.codepage&&"undefined"===typeof xt&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return nd(new Uint8Array(e),((r=nn(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n,a=e,s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ql={},r.dateNF&&(Ql.dateNF=r.dateNF),r.type||(r.type=Bt&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=Bt?"buffer":"binary",a=function(e){if("undefined"!==typeof Vr)return Vr.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(Iv){if(!Iv.message||!Iv.message.match(/onstruct/))throw Iv}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||Bt||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Xn(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(r=nn(r)).type="array",nd(qt(a),r)}switch((n=Zu(a,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return Hr.find(e,"EncryptedPackage")?Ju(e,t):iu(e,t)}(Hr.read(a,r),r);break;case 9:if(n[1]<=8)return iu(a,r);break;case 60:return Qc(a,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Xi.to_workbook(e,r);return r.WTF=n,a}catch(Iv){if(r.WTF=n,!Iv.message.match(/SYLK bad record ID/)&&n)throw Iv;return Qi.to_workbook(e,t)}}(a,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return $i.to_workbook(a,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=Bt&&Buffer.isBuffer(e)?"buffer":"base64"),Qu(Nn(r,n),n)}(a,r):rd(e,a,r,s);case 239:return 60===n[3]?Qc(a,r):rd(e,a,r,s);case 255:if(254===n[1])return td(a,r);if(0===n[1]&&2===n[2]&&0===n[3])return Ji.to_workbook(a,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return Ji.to_workbook(a,r);if(0===n[2]&&(8===n[3]||9===n[3]))return Ji.to_workbook(a,r)}break;case 3:case 131:case 139:case 140:return qi.to_workbook(a,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return To(a,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=Zu(e,t);switch(t.type){case"base64":r=Ut(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=rn(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=qn(r)),t.type="binary",ed(r,t)}(a,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(231===n[1])throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(236===n[1])throw new Error("Unsupported Multiplan 2.x file!");if(237===n[1])throw new Error("Unsupported Multiplan 3.x file!")}return Ki.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?qi.to_workbook(a,r):rd(e,a,r,s)}function ad(e,t,r,n,a,s,i){var o=Ja(r),l=i.defval,c=i.raw||!Object.prototype.hasOwnProperty.call(i,"raw"),u=!0,d=null!=e["!data"],h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(Iv){h.__rowNum__=r}else h.__rowNum__=r;if(!d||e["!data"][r])for(var f=t.s.c;f<=t.e.c;++f){var m=d?(e["!data"][r]||[])[f]:e[n[f]+o];if(null!=m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"b":case"n":if(!m.z||!Ir(m.z))break;if("number"==typeof(p=Yr(p)))break;case"d":i&&(i.UTC||!1===i.raw)||(p=mn(new Date(p)));break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[f]){if(null==p)if("e"==m.t&&null===p)h[s[f]]=null;else if(void 0!==l)h[s[f]]=l;else{if(!c||null!==p)continue;h[s[f]]=null}else h[s[f]]=("n"===m.t&&"boolean"===typeof i.rawNumbers?i.rawNumbers:c)?p:ls(m,p,i);null!=p&&(u=!1)}}else{if(void 0===l)continue;null!=s[f]&&(h[s[f]]=l)}}return{row:h,isempty:u}}function sd(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof u){case"string":l=is(u);break;case"number":(l=is(e["!ref"])).s.r=u;break;default:l=u}n>0&&(a=0);var d=Ja(l.s.r),h=[],f=[],m=0,p=0,g=null!=e["!data"],v=l.s.r,y=0,b={};g&&!e["!data"][v]&&(e["!data"][v]=[]);var w=c.skipHidden&&e["!cols"]||[],x=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=es(y),r=g?e["!data"][v][y]:e[h[y]+d],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=ls(r,null,c),p=b[i]||0){do{o=i+"_"+p++}while(b[o]);b[i]=p,b[o]=1}else b[i]=1;s[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(x[v]||{}).hidden){var E=ad(e,l,v,h,n,s,c);(!1===E.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(f[m++]=E.row)}return f.length=m,f}var id=/"/g;function od(e,t,r,n,a,s,i,o){for(var l=!0,c=[],u="",d=Ja(r),h=null!=e["!data"],f=h&&e["!data"][r]||[],m=t.s.c;m<=t.e.c;++m)if(n[m]){var p=h?f[m]:e[n[m]+d];if(null==p)u="";else if(null!=p.v){l=!1,u=""+(o.rawNumbers&&"n"==p.t?p.v:ls(p,null,o));for(var g=0,v=0;g!==u.length;++g)if((v=u.charCodeAt(g))===a||v===s||34===v||o.forceQuotes){u='"'+u.replace(id,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==p.f||p.F?u="":(l=!1,(u="="+p.f).indexOf(",")>=0&&(u='"'+u.replace(id,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(i)}function ld(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var a=is(e["!ref"]),s=void 0!==n.FS?n.FS:",",i=s.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),u="",d=[],h=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(d[m]=es(m));for(var p=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||null!=(u=od(e,a,g,d,i,l,s,n))&&(n.strip&&(u=u.replace(c,"")),(u||!1!==n.blankrows)&&r.push((p++?o:"")+u));return r.join("")}function cd(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=ld(e,t);if("undefined"==typeof xt||"string"==t.type)return r;var n=xt.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function ud(e,t,r){var n=r||{},a=e?null!=e["!data"]:n.dense;var s=+!n.skipHeader,i=e||{};!e&&a&&(i["!data"]=[]);var o=0,l=0;if(i&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var c="string"==typeof n.origin?ts(n.origin):n.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var d=is(i["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==o&&(o=d.e.r+1,u.e.r=o+t.length-1+s)}else-1==o&&(o=0,u.e.r=t.length-1+s);var h=n.header||[],f=0,m=[];t.forEach(function(e,t){a&&!i["!data"][o+t+s]&&(i["!data"][o+t+s]=[]),a&&(m=i["!data"][o+t+s]),Wr(e).forEach(function(r){-1==(f=h.indexOf(r))&&(h[f=h.length]=r);var c=e[r],u="z",d="",p=a?"":es(l+f)+Ja(o+t+s),g=a?m[l+f]:i[p];!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",n.UTC||(c=pn(c)),n.cellDates||(u="n",c=$r(c)),d=null!=g&&g.z&&Ir(g.z)?g.z:n.dateNF||ir[14]):null===c&&n.nullError&&(u="e",c=0),g?(g.t=u,g.v=c,delete g.w,delete g.R,d&&(g.z=d)):a?m[l+f]=g={t:u,v:c}:i[p]=g={t:u,v:c},d&&(g.z=d)):a?m[l+f]=c:i[p]=c})}),u.e.c=Math.max(u.e.c,l+h.length-1);var p=Ja(o);if(a&&!i["!data"][o]&&(i["!data"][o]=[]),s)for(f=0;f<h.length;++f)a?i["!data"][o][f+l]={t:"s",v:h[f]}:i[es(f+l)+p]={t:"s",v:h[f]};return i["!ref"]=as(u),i}function dd(e,t,r){if("string"==typeof t){if(null!=e["!data"]){var n=ts(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return dd(e,"number"!=typeof t?rs(t):es(r||0)+Ja(t))}function hd(e,t){var r={SheetNames:[],Sheets:{}};return e&&fd(r,e,t||"Sheet1"),r}function fd(e,t,r,n){var a=1;if(!r)for(;a<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+a);++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(r=i+a);++a);}if(_c(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function md(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var pd={encode_col:es,encode_row:Ja,encode_cell:rs,encode_range:as,decode_col:Za,decode_row:Qa,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ts,decode_range:ns,format_cell:ls,sheet_new:function(e){var t={};return(e||{}).dense&&(t["!data"]=[]),t},sheet_add_aoa:us,sheet_add_json:ud,sheet_add_dom:gu,aoa_to_sheet:ds,json_to_sheet:function(e,t){return ud(null,e,t)},table_to_sheet:vu,table_to_book:function(e,t){return cs(vu(e,t),t)},sheet_to_csv:ld,sheet_to_txt:cd,sheet_to_json:sd,sheet_to_html:pu,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,s=is(e["!ref"]),i="",o=[],l=[],c=null!=e["!data"];for(a=s.s.c;a<=s.e.c;++a)o[a]=es(a);for(var u=s.s.r;u<=s.e.r;++u)for(i=Ja(u),a=s.s.c;a<=s.e.c;++a)if(r=o[a]+i,n="",void 0!==(t=c?(e["!data"][u]||[])[a]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:sd,sheet_get_cell:dd,book_new:hd,book_append_sheet:fd,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:md,cell_set_internal_link:function(e,t,r){return md(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var a="string"!=typeof t?t:is(t),s="string"==typeof t?t:as(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=dd(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}var c=ns(e["!ref"]);return c.s.r>a.s.r&&(c.s.r=a.s.r),c.s.c>a.s.c&&(c.s.c=a.s.c),c.e.r<a.e.r&&(c.e.r=a.e.r),c.e.c<a.e.c&&(c.e.c=a.e.c),e["!ref"]=as(c),e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Et.version;var gd=r(950);const vd="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;function yd(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function bd(e){return"nodeType"in e}function wd(e){var t,r;return e?yd(e)?e:bd(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function xd(e){const{Document:t}=wd(e);return e instanceof t}function Ed(e){return!yd(e)&&e instanceof wd(e).HTMLElement}function Td(e){return e instanceof wd(e).SVGElement}function kd(e){return e?yd(e)?e.document:bd(e)?xd(e)?e:Ed(e)||Td(e)?e.ownerDocument:document:document:document}const Nd=vd?n.useLayoutEffect:n.useEffect;function Sd(e){const t=(0,n.useRef)(e);return Nd(()=>{t.current=e}),(0,n.useCallback)(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return null==t.current?void 0:t.current(...r)},[])}function _d(e,t){void 0===t&&(t=[e]);const r=(0,n.useRef)(e);return Nd(()=>{r.current!==e&&(r.current=e)},t),r}function Cd(e,t){const r=(0,n.useRef)();return(0,n.useMemo)(()=>{const t=e(r.current);return r.current=t,t},[...t])}function Ad(e){const t=Sd(e),r=(0,n.useRef)(null),a=(0,n.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,a]}function Id(e){const t=(0,n.useRef)();return(0,n.useEffect)(()=>{t.current=e},[e]),t.current}let Rd={};function Od(e,t){return(0,n.useMemo)(()=>{if(t)return t;const r=null==Rd[e]?0:Rd[e]+1;return Rd[e]=r,e+"-"+r},[e,t])}function Dd(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((t,r)=>{const n=Object.entries(r);for(const[a,s]of n){const r=t[a];null!=r&&(t[a]=r+e*s)}return t},(0,s.A)({},t))}}const jd=Dd(1),Pd=Dd(-1);function Md(e){if(!e)return!1;const{KeyboardEvent:t}=wd(e.target);return t&&e instanceof t}function Ld(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=wd(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const Fd=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Fd.Translate.toString(e),Fd.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),Ud="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Bd(e){return e.matches(Ud)?e:e.querySelector(Ud)}const Vd={display:"none"};function zd(e){let{id:t,value:r}=e;return n.createElement("div",{id:t,style:Vd},r)}function Hd(e){let{id:t,announcement:r,ariaLiveType:a="assertive"}=e;return n.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":a,"aria-atomic":!0},r)}const Wd=["transform"],Gd=["id","accessibility","autoScroll","children","sensors","collisionDetection","measuring","modifiers"],Kd=["active","dragOverlay","transform"],qd=(0,n.createContext)(null);const Xd={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},$d={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Yd(e){let{announcements:t=$d,container:r,hiddenTextDescribedById:a,screenReaderInstructions:s=Xd}=e;const{announce:i,announcement:o}=function(){const[e,t]=(0,n.useState)("");return{announce:(0,n.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),l=Od("DndLiveRegion"),[c,u]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{u(!0)},[]),function(e){const t=(0,n.useContext)(qd);(0,n.useEffect)(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}((0,n.useMemo)(()=>({onDragStart(e){let{active:r}=e;i(t.onDragStart({active:r}))},onDragMove(e){let{active:r,over:n}=e;t.onDragMove&&i(t.onDragMove({active:r,over:n}))},onDragOver(e){let{active:r,over:n}=e;i(t.onDragOver({active:r,over:n}))},onDragEnd(e){let{active:r,over:n}=e;i(t.onDragEnd({active:r,over:n}))},onDragCancel(e){let{active:r,over:n}=e;i(t.onDragCancel({active:r,over:n}))}}),[i,t])),!c)return null;const d=n.createElement(n.Fragment,null,n.createElement(zd,{id:a,value:s.draggable}),n.createElement(Hd,{id:l,announcement:o}));return r?(0,gd.createPortal)(d,r):d}var Qd;function Jd(){}function Zd(e,t){return(0,n.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(Qd||(Qd={}));const eh=Object.freeze({x:0,y:0});function th(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function rh(e,t){const r=Ld(e);if(!r)return"0 0";return(r.x-t.left)/t.width*100+"% "+(r.y-t.top)/t.height*100+"%"}function nh(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function ah(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function sh(e){let{left:t,top:r,height:n,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+n},{x:t+a,y:r+n}]}function ih(e,t){if(!e||0===e.length)return null;const[r]=e;return t?r[t]:r}function oh(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}const lh=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=oh(t,t.left,t.top),s=[];for(const i of n){const{id:e}=i,t=r.get(e);if(t){const r=th(oh(t),a);s.push({id:e,data:{droppableContainer:i,value:r}})}}return s.sort(nh)};function ch(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),i=a-n,o=s-r;if(n<a&&r<s){const r=t.width*t.height,n=e.width*e.height,a=i*o;return Number((a/(r+n-a)).toFixed(4))}return 0}const uh=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=[];for(const s of n){const{id:e}=s,n=r.get(e);if(n){const r=ch(n,t);r>0&&a.push({id:e,data:{droppableContainer:s,value:r}})}}return a.sort(ah)};function dh(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:eh}function hh(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((t,r)=>(0,s.A)((0,s.A)({},t),{},{top:t.top+e*r.y,bottom:t.bottom+e*r.y,left:t.left+e*r.x,right:t.right+e*r.x}),(0,s.A)({},t))}}const fh=hh(1);function mh(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const ph={ignoreTransform:!1};function gh(e,t){void 0===t&&(t=ph);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:n}=wd(e).getComputedStyle(e);t&&(r=function(e,t,r){const n=mh(t);if(!n)return e;const{scaleX:a,scaleY:s,x:i,y:o}=n,l=e.left-i-(1-a)*parseFloat(r),c=e.top-o-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),u=a?e.width/a:e.width,d=s?e.height/s:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(r,t,n))}const{top:n,left:a,width:s,height:i,bottom:o,right:l}=r;return{top:n,left:a,width:s,height:i,bottom:o,right:l}}function vh(e){return gh(e,{ignoreTransform:!0})}function yh(e,t){const r=[];return e?function n(a){if(null!=t&&r.length>=t)return r;if(!a)return r;if(xd(a)&&null!=a.scrollingElement&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!Ed(a)||Td(a))return r;if(r.includes(a))return r;const s=wd(e).getComputedStyle(a);return a!==e&&function(e,t){void 0===t&&(t=wd(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const n=t[e];return"string"===typeof n&&r.test(n)})}(a,s)&&r.push(a),function(e,t){return void 0===t&&(t=wd(e).getComputedStyle(e)),"fixed"===t.position}(a,s)?r:n(a.parentNode)}(e):r}function bh(e){const[t]=yh(e,1);return null!=t?t:null}function wh(e){return vd&&e?yd(e)?e:bd(e)?xd(e)||e===kd(e).scrollingElement?window:Ed(e)?e:null:null:null}function xh(e){return yd(e)?e.scrollX:e.scrollLeft}function Eh(e){return yd(e)?e.scrollY:e.scrollTop}function Th(e){return{x:xh(e),y:Eh(e)}}var kh;function Nh(e){return!(!vd||!e)&&e===document.scrollingElement}function Sh(e){const t={x:0,y:0},r=Nh(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(kh||(kh={}));const _h={x:.2,y:.2};function Ch(e,t,r,n,a){let{top:s,left:i,right:o,bottom:l}=r;void 0===n&&(n=10),void 0===a&&(a=_h);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=Sh(e),f={x:0,y:0},m={x:0,y:0},p=t.height*a.y,g=t.width*a.x;return!c&&s<=t.top+p?(f.y=kh.Backward,m.y=n*Math.abs((t.top+p-s)/p)):!u&&l>=t.bottom-p&&(f.y=kh.Forward,m.y=n*Math.abs((t.bottom-p-l)/p)),!h&&o>=t.right-g?(f.x=kh.Forward,m.x=n*Math.abs((t.right-g-o)/g)):!d&&i<=t.left+g&&(f.x=kh.Backward,m.x=n*Math.abs((t.left+g-i)/g)),{direction:f,speed:m}}function Ah(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Ih(e){return e.reduce((e,t)=>jd(e,Th(t)),eh)}function Rh(e,t){if(void 0===t&&(t=gh),!e)return;const{top:r,left:n,bottom:a,right:s}=t(e);bh(e)&&(a<=0||s<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Oh=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+xh(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+Eh(t),0)}]];class Dh{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=yh(t),n=Ih(r);this.rect=(0,s.A)({},e),this.width=e.width,this.height=e.height;for(const[a,s,i]of Oh)for(const e of s)Object.defineProperty(this,e,{get:()=>{const t=i(r),s=n[a]-t;return this.rect[e]+s},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class jh{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function Ph(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return"number"===typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}var Mh,Lh;function Fh(e){e.preventDefault()}function Uh(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(Mh||(Mh={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"}(Lh||(Lh={}));const Bh={start:[Lh.Space,Lh.Enter],cancel:[Lh.Esc],end:[Lh.Space,Lh.Enter,Lh.Tab]},Vh=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Lh.Right:return(0,s.A)((0,s.A)({},r),{},{x:r.x+25});case Lh.Left:return(0,s.A)((0,s.A)({},r),{},{x:r.x-25});case Lh.Down:return(0,s.A)((0,s.A)({},r),{},{y:r.y+25});case Lh.Up:return(0,s.A)((0,s.A)({},r),{},{y:r.y-25})}};class zh{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new jh(kd(t)),this.windowListeners=new jh(wd(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Mh.Resize,this.handleCancel),this.windowListeners.add(Mh.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Mh.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&Rh(r),t(eh)}handleKeyDown(e){if(Md(e)){const{active:t,context:r,options:n}=this.props,{keyboardCodes:a=Bh,coordinateGetter:s=Vh,scrollBehavior:i="smooth"}=n,{code:o}=e;if(a.end.includes(o))return void this.handleEnd(e);if(a.cancel.includes(o))return void this.handleCancel(e);const{collisionRect:l}=r.current,c=l?{x:l.left,y:l.top}:eh;this.referenceCoordinates||(this.referenceCoordinates=c);const u=s(e,{active:t,context:r.current,currentCoordinates:c});if(u){const t=Pd(u,c),n={x:0,y:0},{scrollableAncestors:a}=r.current;for(const r of a){const a=e.code,{isTop:s,isRight:o,isLeft:l,isBottom:c,maxScroll:d,minScroll:h}=Sh(r),f=Ah(r),m={x:Math.min(a===Lh.Right?f.right-f.width/2:f.right,Math.max(a===Lh.Right?f.left:f.left+f.width/2,u.x)),y:Math.min(a===Lh.Down?f.bottom-f.height/2:f.bottom,Math.max(a===Lh.Down?f.top:f.top+f.height/2,u.y))},p=a===Lh.Right&&!o||a===Lh.Left&&!l,g=a===Lh.Down&&!c||a===Lh.Up&&!s;if(p&&m.x!==u.x){const e=r.scrollLeft+t.x,s=a===Lh.Right&&e<=d.x||a===Lh.Left&&e>=h.x;if(s&&!t.y)return void r.scrollTo({left:e,behavior:i});n.x=s?r.scrollLeft-e:a===Lh.Right?r.scrollLeft-d.x:r.scrollLeft-h.x,n.x&&r.scrollBy({left:-n.x,behavior:i});break}if(g&&m.y!==u.y){const e=r.scrollTop+t.y,s=a===Lh.Down&&e<=d.y||a===Lh.Up&&e>=h.y;if(s&&!t.x)return void r.scrollTo({top:e,behavior:i});n.y=s?r.scrollTop-e:a===Lh.Down?r.scrollTop-d.y:r.scrollTop-h.y,n.y&&r.scrollBy({top:-n.y,behavior:i});break}}this.handleMove(e,jd(Pd(u,this.referenceCoordinates),n))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function Hh(e){return Boolean(e&&"distance"in e)}function Wh(e){return Boolean(e&&"delay"in e)}zh.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=Bh,onActivation:a}=t,{active:s}=r;const{code:i}=e.nativeEvent;if(n.start.includes(i)){const t=s.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==a||a({event:e.nativeEvent}),!0)}return!1}}];class Gh{constructor(e,t,r){var n;void 0===r&&(r=function(e){const{EventTarget:t}=wd(e);return e instanceof t?e:kd(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:a}=e,{target:s}=a;this.props=e,this.events=t,this.document=kd(s),this.documentListeners=new jh(this.document),this.listeners=new jh(r),this.windowListeners=new jh(wd(s)),this.initialCoordinates=null!=(n=Ld(a))?n:eh,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Mh.Resize,this.handleCancel),this.windowListeners.add(Mh.DragStart,Fh),this.windowListeners.add(Mh.VisibilityChange,this.handleCancel),this.windowListeners.add(Mh.ContextMenu,Fh),this.documentListeners.add(Mh.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Wh(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(Hh(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:n}=this.props;n(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Mh.Click,Uh,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Mh.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:n,props:a}=this,{onMove:s,options:{activationConstraint:i}}=a;if(!n)return;const o=null!=(t=Ld(e))?t:eh,l=Pd(n,o);if(!r&&i){if(Hh(i)){if(null!=i.tolerance&&Ph(l,i.tolerance))return this.handleCancel();if(Ph(l,i.distance))return this.handleStart()}return Wh(i)&&Ph(l,i.tolerance)?this.handleCancel():void this.handlePending(i,l)}e.cancelable&&e.preventDefault(),s(o)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Lh.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const Kh={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class qh extends Gh{constructor(e){const{event:t}=e,r=kd(t.target);super(e,Kh,r)}}qh.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!(!r.isPrimary||0!==r.button)&&(null==n||n({event:r}),!0)}}];const Xh={move:{name:"mousemove"},end:{name:"mouseup"}};var $h;!function(e){e[e.RightClick=2]="RightClick"}($h||($h={}));(class extends Gh{constructor(e){super(e,Xh,kd(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button!==$h.RightClick&&(null==n||n({event:r}),!0)}}];const Yh={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var Qh,Jh;function Zh(e){let{acceleration:t,activator:r=Qh.Pointer,canScroll:a,draggingRect:s,enabled:i,interval:o=5,order:l=Jh.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=e;const m=function(e){let{delta:t,disabled:r}=e;const n=Id(t);return Cd(e=>{if(r||!n||!e)return ef;const a={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[kh.Backward]:e.x[kh.Backward]||-1===a.x,[kh.Forward]:e.x[kh.Forward]||1===a.x},y:{[kh.Backward]:e.y[kh.Backward]||-1===a.y,[kh.Forward]:e.y[kh.Forward]||1===a.y}}},[r,t,n])}({delta:h,disabled:!i}),[p,g]=function(){const e=(0,n.useRef)(null);return[(0,n.useCallback)((t,r)=>{e.current=setInterval(t,r)},[]),(0,n.useCallback)(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}(),v=(0,n.useRef)({x:0,y:0}),y=(0,n.useRef)({x:0,y:0}),b=(0,n.useMemo)(()=>{switch(r){case Qh.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Qh.DraggableRect:return s}},[r,s,c]),w=(0,n.useRef)(null),x=(0,n.useCallback)(()=>{const e=w.current;if(!e)return;const t=v.current.x*y.current.x,r=v.current.y*y.current.y;e.scrollBy(t,r)},[]),E=(0,n.useMemo)(()=>l===Jh.TreeOrder?[...u].reverse():u,[l,u]);(0,n.useEffect)(()=>{if(i&&u.length&&b){for(const e of E){if(!1===(null==a?void 0:a(e)))continue;const r=u.indexOf(e),n=d[r];if(!n)continue;const{direction:s,speed:i}=Ch(e,n,b,t,f);for(const e of["x","y"])m[e][s[e]]||(i[e]=0,s[e]=0);if(i.x>0||i.y>0)return g(),w.current=e,p(x,o),v.current=i,void(y.current=s)}v.current={x:0,y:0},y.current={x:0,y:0},g()}else g()},[t,x,a,g,i,o,JSON.stringify(b),JSON.stringify(m),p,u,E,d,JSON.stringify(f)])}(class extends Gh{constructor(e){super(e,Yh)}static setup(){return window.addEventListener(Yh.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Yh.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:a}=r;return!(a.length>1)&&(null==n||n({event:r}),!0)}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(Qh||(Qh={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(Jh||(Jh={}));const ef={x:{[kh.Backward]:!1,[kh.Forward]:!1},y:{[kh.Backward]:!1,[kh.Forward]:!1}};var tf,rf;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(tf||(tf={})),function(e){e.Optimized="optimized"}(rf||(rf={}));const nf=new Map;function af(e,t){return Cd(r=>e?r||("function"===typeof t?t(e):e):null,[t,e])}function sf(e){let{callback:t,disabled:r}=e;const a=Sd(t),s=(0,n.useMemo)(()=>{if(r||"undefined"===typeof window||"undefined"===typeof window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(a)},[r]);return(0,n.useEffect)(()=>()=>null==s?void 0:s.disconnect(),[s]),s}function of(e){return new Dh(gh(e),e)}function lf(e,t,r){void 0===t&&(t=of);const[a,s]=(0,n.useState)(null);function i(){s(n=>{if(!e)return null;var a;if(!1===e.isConnected)return null!=(a=null!=n?n:r)?a:null;const s=t(e);return JSON.stringify(n)===JSON.stringify(s)?n:s})}const o=function(e){let{callback:t,disabled:r}=e;const a=Sd(t),s=(0,n.useMemo)(()=>{if(r||"undefined"===typeof window||"undefined"===typeof window.MutationObserver)return;const{MutationObserver:e}=window;return new e(a)},[a,r]);return(0,n.useEffect)(()=>()=>null==s?void 0:s.disconnect(),[s]),s}({callback(t){if(e)for(const r of t){const{type:t,target:n}=r;if("childList"===t&&n instanceof HTMLElement&&n.contains(e)){i();break}}}}),l=sf({callback:i});return Nd(()=>{i(),e?(null==l||l.observe(e),null==o||o.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==o||o.disconnect())},[e]),a}const cf=[];function uf(e,t){void 0===t&&(t=[]);const r=(0,n.useRef)(null);return(0,n.useEffect)(()=>{r.current=null},t),(0,n.useEffect)(()=>{const t=e!==eh;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?Pd(e,r.current):eh}function df(e){return(0,n.useMemo)(()=>e?function(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}(e):null,[e])}const hf=[];function ff(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ed(t)?t:e}const mf=[{sensor:qh,options:{}},{sensor:zh,options:{}}],pf={current:{}},gf={draggable:{measure:vh},droppable:{measure:vh,strategy:tf.WhileDragging,frequency:rf.Optimized},dragOverlay:{measure:gh}};class vf extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}const yf={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new vf,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Jd},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:gf,measureDroppableContainers:Jd,windowRect:null,measuringScheduled:!1},bf={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Jd,draggableNodes:new Map,over:null,measureDroppableContainers:Jd},wf=(0,n.createContext)(bf),xf=(0,n.createContext)(yf);function Ef(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new vf}}}function Tf(e,t){switch(t.type){case Qd.DragStart:return(0,s.A)((0,s.A)({},e),{},{draggable:(0,s.A)((0,s.A)({},e.draggable),{},{initialCoordinates:t.initialCoordinates,active:t.active})});case Qd.DragMove:return null==e.draggable.active?e:(0,s.A)((0,s.A)({},e),{},{draggable:(0,s.A)((0,s.A)({},e.draggable),{},{translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}})});case Qd.DragEnd:case Qd.DragCancel:return(0,s.A)((0,s.A)({},e),{},{draggable:(0,s.A)((0,s.A)({},e.draggable),{},{active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}})});case Qd.RegisterDroppable:{const{element:r}=t,{id:n}=r,a=new vf(e.droppable.containers);return a.set(n,r),(0,s.A)((0,s.A)({},e),{},{droppable:(0,s.A)((0,s.A)({},e.droppable),{},{containers:a})})}case Qd.SetDroppableDisabled:{const{id:r,key:n,disabled:a}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const o=new vf(e.droppable.containers);return o.set(r,(0,s.A)((0,s.A)({},i),{},{disabled:a})),(0,s.A)((0,s.A)({},e),{},{droppable:(0,s.A)((0,s.A)({},e.droppable),{},{containers:o})})}case Qd.UnregisterDroppable:{const{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;const i=new vf(e.droppable.containers);return i.delete(r),(0,s.A)((0,s.A)({},e),{},{droppable:(0,s.A)((0,s.A)({},e.droppable),{},{containers:i})})}default:return e}}function kf(e){let{disabled:t}=e;const{active:r,activatorEvent:a,draggableNodes:s}=(0,n.useContext)(wf),i=Id(a),o=Id(null==r?void 0:r.id);return(0,n.useEffect)(()=>{if(!t&&!a&&i&&null!=o){if(!Md(i))return;if(document.activeElement===i.target)return;const e=s.get(o);if(!e)return;const{activatorNode:t,node:r}=e;if(!t.current&&!r.current)return;requestAnimationFrame(()=>{for(const e of[t.current,r.current]){if(!e)continue;const t=Bd(e);if(t){t.focus();break}}})}},[a,t,s,o,i]),null}function Nf(e,t){let{transform:r}=t,n=Xe(t,Wd);return null!=e&&e.length?e.reduce((e,t)=>t((0,s.A)({transform:e},n)),r):r}const Sf=(0,n.createContext)((0,s.A)((0,s.A)({},eh),{},{scaleX:1,scaleY:1}));var _f;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(_f||(_f={}));const Cf=(0,n.memo)(function(e){var t,r,a,i;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:d=mf,collisionDetection:h=uh,measuring:f,modifiers:m}=e,p=Xe(e,Gd);const g=(0,n.useReducer)(Tf,void 0,Ef),[v,y]=g,[b,w]=function(){const[e]=(0,n.useState)(()=>new Set),t=(0,n.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,n.useCallback)(t=>{let{type:r,event:n}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)})},[e]),t]}(),[x,E]=(0,n.useState)(_f.Uninitialized),T=x===_f.Initialized,{draggable:{active:k,nodes:N,translate:S},droppable:{containers:_}}=v,C=null!=k?N.get(k):null,A=(0,n.useRef)({initial:null,translated:null}),I=(0,n.useMemo)(()=>{var e;return null!=k?{id:k,data:null!=(e=null==C?void 0:C.data)?e:pf,rect:A}:null},[k,C]),R=(0,n.useRef)(null),[O,D]=(0,n.useState)(null),[j,P]=(0,n.useState)(null),M=_d(p,Object.values(p)),L=Od("DndDescribedBy",o),F=(0,n.useMemo)(()=>_.getEnabled(),[_]),U=(B=f,(0,n.useMemo)(()=>({draggable:(0,s.A)((0,s.A)({},gf.draggable),null==B?void 0:B.draggable),droppable:(0,s.A)((0,s.A)({},gf.droppable),null==B?void 0:B.droppable),dragOverlay:(0,s.A)((0,s.A)({},gf.dragOverlay),null==B?void 0:B.dragOverlay)}),[null==B?void 0:B.draggable,null==B?void 0:B.droppable,null==B?void 0:B.dragOverlay]));var B;const{droppableRects:V,measureDroppableContainers:z,measuringScheduled:H}=function(e,t){let{dragging:r,dependencies:a,config:s}=t;const[i,o]=(0,n.useState)(null),{frequency:l,measure:c,strategy:u}=s,d=(0,n.useRef)(e),h=function(){switch(u){case tf.Always:return!1;case tf.BeforeDragging:return r;default:return!r}}(),f=_d(h),m=(0,n.useCallback)(function(e){void 0===e&&(e=[]),f.current||o(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[f]),p=(0,n.useRef)(null),g=Cd(t=>{if(h&&!r)return nf;if(!t||t===nf||d.current!==e||null!=i){const t=new Map;for(let r of e){if(!r)continue;if(i&&i.length>0&&!i.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}const e=r.node.current,n=e?new Dh(c(e),e):null;r.rect.current=n,n&&t.set(r.id,n)}return t}return t},[e,i,r,h,c]);return(0,n.useEffect)(()=>{d.current=e},[e]),(0,n.useEffect)(()=>{h||m()},[r,h]),(0,n.useEffect)(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),(0,n.useEffect)(()=>{h||"number"!==typeof l||null!==p.current||(p.current=setTimeout(()=>{m(),p.current=null},l))},[l,h,m,...a]),{droppableRects:g,measureDroppableContainers:m,measuringScheduled:null!=i}}(F,{dragging:T,dependencies:[S.x,S.y],config:U.droppable}),W=function(e,t){const r=null!=t?e.get(t):void 0,n=r?r.node.current:null;return Cd(e=>{var r;return null==t?null:null!=(r=null!=n?n:e)?r:null},[n,t])}(N,k),G=(0,n.useMemo)(()=>j?Ld(j):null,[j]),K=function(){const e=!1===(null==O?void 0:O.autoScrollEnabled),t="object"===typeof c?!1===c.enabled:!1===c,r=T&&!e&&!t;if("object"===typeof c)return(0,s.A)((0,s.A)({},c),{},{enabled:r});return{enabled:r}}(),q=function(e,t){return af(e,t)}(W,U.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:a,config:s=!0}=e;const i=(0,n.useRef)(!1),{x:o,y:l}="boolean"===typeof s?{x:s,y:s}:s;Nd(()=>{if(!o&&!l||!t)return void(i.current=!1);if(i.current||!a)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const n=dh(r(e),a);if(o||(n.x=0),l||(n.y=0),i.current=!0,Math.abs(n.x)>0||Math.abs(n.y)>0){const t=bh(e);t&&t.scrollBy({top:n.y,left:n.x})}},[t,o,l,a,r])}({activeNode:null!=k?N.get(k):null,config:K.layoutShiftCompensation,initialRect:q,measure:U.draggable.measure});const X=lf(W,U.draggable.measure,q),$=lf(W?W.parentElement:null),Y=(0,n.useRef)({activatorEvent:null,active:null,activeNode:W,collisionRect:null,collisions:null,droppableRects:V,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:_,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Q=_.getNodeFor(null==(t=Y.current.over)?void 0:t.id),J=function(e){let{measure:t}=e;const[r,a]=(0,n.useState)(null),i=sf({callback:(0,n.useCallback)(e=>{for(const{target:r}of e)if(Ed(r)){a(e=>{const n=t(r);return e?(0,s.A)((0,s.A)({},e),{},{width:n.width,height:n.height}):n});break}},[t])}),o=(0,n.useCallback)(e=>{const r=ff(e);null==i||i.disconnect(),r&&(null==i||i.observe(r)),a(r?t(r):null)},[t,i]),[l,c]=Ad(o);return(0,n.useMemo)(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}({measure:U.dragOverlay.measure}),Z=null!=(r=J.nodeRef.current)?r:W,ee=T?null!=(a=J.rect)?a:X:null,te=Boolean(J.nodeRef.current&&J.rect),re=dh(ne=te?null:X,af(ne));var ne;const ae=df(Z?wd(Z):null),se=function(e){const t=(0,n.useRef)(e),r=Cd(r=>e?r&&r!==cf&&e&&t.current&&e.parentNode===t.current.parentNode?r:yh(e):cf,[e]);return(0,n.useEffect)(()=>{t.current=e},[e]),r}(T?null!=Q?Q:W:null),ie=function(e,t){void 0===t&&(t=gh);const[r]=e,a=df(r?wd(r):null),[s,i]=(0,n.useState)(hf);function o(){i(()=>e.length?e.map(e=>Nh(e)?a:new Dh(t(e),e)):hf)}const l=sf({callback:o});return Nd(()=>{null==l||l.disconnect(),o(),e.forEach(e=>null==l?void 0:l.observe(e))},[e]),s}(se),oe=Nf(m,{transform:{x:S.x-re.x,y:S.y-re.y,scaleX:1,scaleY:1},activatorEvent:j,active:I,activeNodeRect:X,containerNodeRect:$,draggingNodeRect:ee,over:Y.current.over,overlayNodeRect:J.rect,scrollableAncestors:se,scrollableAncestorRects:ie,windowRect:ae}),le=G?jd(G,S):null,ce=function(e){const[t,r]=(0,n.useState)(null),a=(0,n.useRef)(e),s=(0,n.useCallback)(e=>{const t=wh(e.target);t&&r(e=>e?(e.set(t,Th(t)),new Map(e)):null)},[]);return(0,n.useEffect)(()=>{const t=a.current;if(e!==t){n(t);const i=e.map(e=>{const t=wh(e);return t?(t.addEventListener("scroll",s,{passive:!0}),[t,Th(t)]):null}).filter(e=>null!=e);r(i.length?new Map(i):null),a.current=e}return()=>{n(e),n(t)};function n(e){e.forEach(e=>{const t=wh(e);null==t||t.removeEventListener("scroll",s)})}},[s,e]),(0,n.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>jd(e,t),eh):Ih(e):eh,[e,t])}(se),ue=uf(ce),de=uf(ce,[X]),he=jd(oe,ue),fe=ee?fh(ee,oe):null,me=I&&fe?h({active:I,collisionRect:fe,droppableRects:V,droppableContainers:F,pointerCoordinates:le}):null,pe=ih(me,"id"),[ge,ve]=(0,n.useState)(null),ye=function(e,t,r){return(0,s.A)((0,s.A)({},e),{},{scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1})}(te?oe:jd(oe,de),null!=(i=null==ge?void 0:ge.rect)?i:null,X),be=(0,n.useRef)(null),we=(0,n.useCallback)((e,t)=>{let{sensor:r,options:n}=t;if(null==R.current)return;const a=N.get(R.current);if(!a)return;const s=e.nativeEvent,i=new r({active:R.current,activeNode:a,event:s,options:n,context:Y,onAbort(e){if(!N.get(e))return;const{onDragAbort:t}=M.current,r={id:e};null==t||t(r),b({type:"onDragAbort",event:r})},onPending(e,t,r,n){if(!N.get(e))return;const{onDragPending:a}=M.current,s={id:e,constraint:t,initialCoordinates:r,offset:n};null==a||a(s),b({type:"onDragPending",event:s})},onStart(e){const t=R.current;if(null==t)return;const r=N.get(t);if(!r)return;const{onDragStart:n}=M.current,a={activatorEvent:s,active:{id:t,data:r.data,rect:A}};(0,gd.unstable_batchedUpdates)(()=>{null==n||n(a),E(_f.Initializing),y({type:Qd.DragStart,initialCoordinates:e,active:t}),b({type:"onDragStart",event:a}),D(be.current),P(s)})},onMove(e){y({type:Qd.DragMove,coordinates:e})},onEnd:o(Qd.DragEnd),onCancel:o(Qd.DragCancel)});function o(e){return async function(){const{active:t,collisions:r,over:n,scrollAdjustedTranslate:a}=Y.current;let i=null;if(t&&a){const{cancelDrop:o}=M.current;if(i={activatorEvent:s,active:t,collisions:r,delta:a,over:n},e===Qd.DragEnd&&"function"===typeof o){await Promise.resolve(o(i))&&(e=Qd.DragCancel)}}R.current=null,(0,gd.unstable_batchedUpdates)(()=>{y({type:e}),E(_f.Uninitialized),ve(null),D(null),P(null),be.current=null;const t=e===Qd.DragEnd?"onDragEnd":"onDragCancel";if(i){const e=M.current[t];null==e||e(i),b({type:t,event:i})}})}}be.current=i},[N]),xe=(0,n.useCallback)((e,t)=>(r,n)=>{const a=r.nativeEvent,s=N.get(n);if(null!==R.current||!s||a.dndKit||a.defaultPrevented)return;const i={active:s};!0===e(r,t.options,i)&&(a.dndKit={capturedBy:t.sensor},R.current=n,we(r,t))},[N,we]),Ee=function(e,t){return(0,n.useMemo)(()=>e.reduce((e,r)=>{const{sensor:n}=r;return[...e,...n.activators.map(e=>({eventName:e.eventName,handler:t(e.handler,r)}))]},[]),[e,t])}(d,xe);!function(e){(0,n.useEffect)(()=>{if(!vd)return;const t=e.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const e of t)null==e||e()}},e.map(e=>{let{sensor:t}=e;return t}))}(d),Nd(()=>{X&&x===_f.Initializing&&E(_f.Initialized)},[X,x]),(0,n.useEffect)(()=>{const{onDragMove:e}=M.current,{active:t,activatorEvent:r,collisions:n,over:a}=Y.current;if(!t||!r)return;const s={active:t,activatorEvent:r,collisions:n,delta:{x:he.x,y:he.y},over:a};(0,gd.unstable_batchedUpdates)(()=>{null==e||e(s),b({type:"onDragMove",event:s})})},[he.x,he.y]),(0,n.useEffect)(()=>{const{active:e,activatorEvent:t,collisions:r,droppableContainers:n,scrollAdjustedTranslate:a}=Y.current;if(!e||null==R.current||!t||!a)return;const{onDragOver:s}=M.current,i=n.get(pe),o=i&&i.rect.current?{id:i.id,rect:i.rect.current,data:i.data,disabled:i.disabled}:null,l={active:e,activatorEvent:t,collisions:r,delta:{x:a.x,y:a.y},over:o};(0,gd.unstable_batchedUpdates)(()=>{ve(o),null==s||s(l),b({type:"onDragOver",event:l})})},[pe]),Nd(()=>{Y.current={activatorEvent:j,active:I,activeNode:W,collisionRect:fe,collisions:me,droppableRects:V,draggableNodes:N,draggingNode:Z,draggingNodeRect:ee,droppableContainers:_,over:ge,scrollableAncestors:se,scrollAdjustedTranslate:he},A.current={initial:ee,translated:fe}},[I,W,me,fe,N,Z,ee,V,_,ge,se,he]),Zh((0,s.A)((0,s.A)({},K),{},{delta:S,draggingRect:fe,pointerCoordinates:le,scrollableAncestors:se,scrollableAncestorRects:ie}));const Te=(0,n.useMemo)(()=>({active:I,activeNode:W,activeNodeRect:X,activatorEvent:j,collisions:me,containerNodeRect:$,dragOverlay:J,draggableNodes:N,droppableContainers:_,droppableRects:V,over:ge,measureDroppableContainers:z,scrollableAncestors:se,scrollableAncestorRects:ie,measuringConfiguration:U,measuringScheduled:H,windowRect:ae}),[I,W,X,j,me,$,J,N,_,V,ge,z,se,ie,U,H,ae]),ke=(0,n.useMemo)(()=>({activatorEvent:j,activators:Ee,active:I,activeNodeRect:X,ariaDescribedById:{draggable:L},dispatch:y,draggableNodes:N,over:ge,measureDroppableContainers:z}),[j,Ee,I,X,y,L,N,ge,z]);return n.createElement(qd.Provider,{value:w},n.createElement(wf.Provider,{value:ke},n.createElement(xf.Provider,{value:Te},n.createElement(Sf.Provider,{value:ye},u)),n.createElement(kf,{disabled:!1===(null==l?void 0:l.restoreFocus)})),n.createElement(Yd,(0,s.A)((0,s.A)({},l),{},{hiddenTextDescribedById:L})))}),Af=(0,n.createContext)(null),If="button";function Rf(e){let{id:t,data:r,disabled:a=!1,attributes:s}=e;const i=Od("Draggable"),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:f}=(0,n.useContext)(wf),{role:m=If,roleDescription:p="draggable",tabIndex:g=0}=null!=s?s:{},v=(null==c?void 0:c.id)===t,y=(0,n.useContext)(v?Sf:Af),[b,w]=Ad(),[x,E]=Ad(),T=function(e,t){return(0,n.useMemo)(()=>e.reduce((e,r)=>{let{eventName:n,handler:a}=r;return e[n]=e=>{a(e,t)},e},{}),[e,t])}(o,t),k=_d(r);Nd(()=>(h.set(t,{id:t,key:i,node:b,activatorNode:x,data:k}),()=>{const e=h.get(t);e&&e.key===i&&h.delete(t)}),[h,t]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:(0,n.useMemo)(()=>({role:m,tabIndex:g,"aria-disabled":a,"aria-pressed":!(!v||m!==If)||void 0,"aria-roledescription":p,"aria-describedby":d.draggable}),[a,m,g,v,p,d.draggable]),isDragging:v,listeners:a?void 0:T,node:b,over:f,setNodeRef:w,setActivatorNodeRef:E,transform:y}}function Of(){return(0,n.useContext)(xf)}const Df={timeout:25};function jf(e){let{data:t,disabled:r=!1,id:a,resizeObserverConfig:i}=e;const o=Od("Droppable"),{active:l,dispatch:c,over:u,measureDroppableContainers:d}=(0,n.useContext)(wf),h=(0,n.useRef)({disabled:r}),f=(0,n.useRef)(!1),m=(0,n.useRef)(null),p=(0,n.useRef)(null),{disabled:g,updateMeasurementsFor:v,timeout:y}=(0,s.A)((0,s.A)({},Df),i),b=_d(null!=v?v:a),w=sf({callback:(0,n.useCallback)(()=>{f.current?(null!=p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),p.current=null},y)):f.current=!0},[y]),disabled:g||!l}),x=(0,n.useCallback)((e,t)=>{w&&(t&&(w.unobserve(t),f.current=!1),e&&w.observe(e))},[w]),[E,T]=Ad(x),k=_d(t);return(0,n.useEffect)(()=>{w&&E.current&&(w.disconnect(),f.current=!1,w.observe(E.current))},[E,w]),(0,n.useEffect)(()=>(c({type:Qd.RegisterDroppable,element:{id:a,key:o,disabled:r,node:E,rect:m,data:k}}),()=>c({type:Qd.UnregisterDroppable,key:o,id:a})),[a]),(0,n.useEffect)(()=>{r!==h.current.disabled&&(c({type:Qd.SetDroppableDisabled,id:a,key:o,disabled:r}),h.current.disabled=r)},[a,o,r,c]),{active:l,rect:m,isOver:(null==u?void 0:u.id)===a,node:E,over:u,setNodeRef:T}}function Pf(e){let{animation:t,children:r}=e;const[a,s]=(0,n.useState)(null),[i,o]=(0,n.useState)(null),l=Id(r);return r||a||!l||s(l),Nd(()=>{if(!i)return;const e=null==a?void 0:a.key,r=null==a?void 0:a.props.id;null!=e&&null!=r?Promise.resolve(t(r,i)).then(()=>{s(null)}):s(null)},[t,a,i]),n.createElement(n.Fragment,null,r,a?(0,n.cloneElement)(a,{ref:o}):null)}const Mf={x:0,y:0,scaleX:1,scaleY:1};function Lf(e){let{children:t}=e;return n.createElement(wf.Provider,{value:bf},n.createElement(Sf.Provider,{value:Mf},t))}const Ff={position:"fixed",touchAction:"none"},Uf=e=>Md(e)?"transform 250ms ease":void 0,Bf=(0,n.forwardRef)((e,t)=>{let{as:r,activatorEvent:a,adjustScale:i,children:o,className:l,rect:c,style:u,transform:d,transition:h=Uf}=e;if(!c)return null;const f=i?d:(0,s.A)((0,s.A)({},d),{},{scaleX:1,scaleY:1}),m=(0,s.A)((0,s.A)({},Ff),{},{width:c.width,height:c.height,top:c.top,left:c.left,transform:Fd.Transform.toString(f),transformOrigin:i&&a?rh(a,c):void 0,transition:"function"===typeof h?h(a):h},u);return n.createElement(r,{className:l,style:m,ref:t},o)}),Vf=e=>t=>{let{active:r,dragOverlay:n}=t;const a={},{styles:s,className:i}=e;if(null!=s&&s.active)for(const[e,o]of Object.entries(s.active))void 0!==o&&(a[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,o));if(null!=s&&s.dragOverlay)for(const[e,o]of Object.entries(s.dragOverlay))void 0!==o&&n.node.style.setProperty(e,o);return null!=i&&i.active&&r.node.classList.add(i.active),null!=i&&i.dragOverlay&&n.node.classList.add(i.dragOverlay),function(){for(const[e,t]of Object.entries(a))r.node.style.setProperty(e,t);null!=i&&i.active&&r.node.classList.remove(i.active)}},zf={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:Fd.Transform.toString(t)},{transform:Fd.Transform.toString(r)}]},sideEffects:Vf({styles:{active:{opacity:"0"}}})};function Hf(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:a}=e;return Sd((e,i)=>{if(null===t)return;const o=r.get(e);if(!o)return;const l=o.node.current;if(!l)return;const c=ff(i);if(!c)return;const{transform:u}=wd(i).getComputedStyle(i),d=mh(u);if(!d)return;const h="function"===typeof t?t:function(e){const{duration:t,easing:r,sideEffects:n,keyframes:a}=(0,s.A)((0,s.A)({},zf),e);return e=>{let{active:i,dragOverlay:o,transform:l}=e,c=Xe(e,Kd);if(!t)return;const u={x:o.rect.left-i.rect.left,y:o.rect.top-i.rect.top},d={scaleX:1!==l.scaleX?i.rect.width*l.scaleX/o.rect.width:1,scaleY:1!==l.scaleY?i.rect.height*l.scaleY/o.rect.height:1},h=(0,s.A)({x:l.x-u.x,y:l.y-u.y},d),f=a((0,s.A)((0,s.A)({},c),{},{active:i,dragOverlay:o,transform:{initial:l,final:h}})),[m]=f,p=f[f.length-1];if(JSON.stringify(m)===JSON.stringify(p))return;const g=null==n?void 0:n((0,s.A)({active:i,dragOverlay:o},c)),v=o.node.animate(f,{duration:t,easing:r,fill:"forwards"});return new Promise(e=>{v.onfinish=()=>{null==g||g(),e()}})}}(t);return Rh(l,a.draggable.measure),h({active:{id:e,data:o.data,node:l,rect:a.draggable.measure(l)},draggableNodes:r,dragOverlay:{node:i,rect:a.dragOverlay.measure(c)},droppableContainers:n,measuringConfiguration:a,transform:d})})}let Wf=0;function Gf(e){return(0,n.useMemo)(()=>{if(null!=e)return Wf++,Wf},[e])}const Kf=n.memo(e=>{let{adjustScale:t=!1,children:r,dropAnimation:a,style:i,transition:o,modifiers:l,wrapperElement:c="div",className:u,zIndex:d=999}=e;const{activatorEvent:h,active:f,activeNodeRect:m,containerNodeRect:p,draggableNodes:g,droppableContainers:v,dragOverlay:y,over:b,measuringConfiguration:w,scrollableAncestors:x,scrollableAncestorRects:E,windowRect:T}=Of(),k=(0,n.useContext)(Sf),N=Gf(null==f?void 0:f.id),S=Nf(l,{activatorEvent:h,active:f,activeNodeRect:m,containerNodeRect:p,draggingNodeRect:y.rect,over:b,overlayNodeRect:y.rect,scrollableAncestors:x,scrollableAncestorRects:E,transform:k,windowRect:T}),_=af(m),C=Hf({config:a,draggableNodes:g,droppableContainers:v,measuringConfiguration:w}),A=_?y.setRef:void 0;return n.createElement(Lf,null,n.createElement(Pf,{animation:C},f&&N?n.createElement(Bf,{key:N,id:f.id,ref:A,as:c,activatorEvent:h,adjustScale:t,className:u,transition:o,rect:_,style:(0,s.A)({zIndex:d},i),transform:S},r):null))});function qf(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function Xf(e,t){return e.reduce((e,r,n)=>{const a=t.get(r);return a&&(e[n]=a),e},Array(e.length))}function $f(e){return null!==e&&e>=0}const Yf=e=>{let{rects:t,activeIndex:r,overIndex:n,index:a}=e;const s=qf(t,n,r),i=t[a],o=s[a];return o&&i?{x:o.left-i.left,y:o.top-i.top,scaleX:o.width/i.width,scaleY:o.height/i.height}:null},Qf={scaleX:1,scaleY:1},Jf=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:a,rects:i,overIndex:o}=e;const l=null!=(t=i[r])?t:n;if(!l)return null;if(a===r){const e=i[o];return e?(0,s.A)({x:0,y:r<o?e.top+e.height-(l.top+l.height):e.top-l.top},Qf):null}const c=function(e,t,r){const n=e[t],a=e[t-1],s=e[t+1];if(!n)return 0;if(r<t)return a?n.top-(a.top+a.height):s?s.top-(n.top+n.height):0;return s?s.top-(n.top+n.height):a?n.top-(a.top+a.height):0}(i,a,r);return a>r&&a<=o?(0,s.A)({x:0,y:-l.height-c},Qf):a<r&&a>=o?(0,s.A)({x:0,y:l.height+c},Qf):(0,s.A)({x:0,y:0},Qf)};const Zf="Sortable",em=n.createContext({activeIndex:-1,containerId:Zf,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Yf,disabled:{draggable:!1,droppable:!1}});function tm(e){let{children:t,id:r,items:a,strategy:s=Yf,disabled:i=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=Of(),h=Od(Zf,r),f=Boolean(null!==l.rect),m=(0,n.useMemo)(()=>a.map(e=>"object"===typeof e&&"id"in e?e.id:e),[a]),p=null!=o,g=o?m.indexOf(o.id):-1,v=u?m.indexOf(u.id):-1,y=(0,n.useRef)(m),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(m,y.current),w=-1!==v&&-1===g||b,x=function(e){return"boolean"===typeof e?{draggable:e,droppable:e}:e}(i);Nd(()=>{b&&p&&d(m)},[b,m,p,d]),(0,n.useEffect)(()=>{y.current=m},[m]);const E=(0,n.useMemo)(()=>({activeIndex:g,containerId:h,disabled:x,disableTransforms:w,items:m,overIndex:v,useDragOverlay:f,sortedRects:Xf(m,c),strategy:s}),[g,h,x.draggable,x.droppable,w,m,v,c,f,s]);return n.createElement(em.Provider,{value:E},t)}const rm=e=>{let{id:t,items:r,activeIndex:n,overIndex:a}=e;return qf(r,n,a).indexOf(t)},nm=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:a,items:s,newIndex:i,previousItems:o,previousContainerId:l,transition:c}=e;return!(!c||!n)&&((o===s||a!==i)&&(!!r||i!==a&&t===l))},am={duration:200,easing:"ease"},sm="transform",im=Fd.Transition.toString({property:sm,duration:0,easing:"linear"}),om={roleDescription:"sortable"};function lm(e){let{animateLayoutChanges:t=nm,attributes:r,disabled:a,data:i,getNewIndex:o=rm,id:l,strategy:c,resizeObserverConfig:u,transition:d=am}=e;const{items:h,containerId:f,activeIndex:m,disabled:p,disableTransforms:g,sortedRects:v,overIndex:y,useDragOverlay:b,strategy:w}=(0,n.useContext)(em),x=function(e,t){var r,n;if("boolean"===typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(r=null==e?void 0:e.draggable)?r:t.draggable,droppable:null!=(n=null==e?void 0:e.droppable)?n:t.droppable}}(a,p),E=h.indexOf(l),T=(0,n.useMemo)(()=>(0,s.A)({sortable:{containerId:f,index:E,items:h}},i),[f,i,E,h]),k=(0,n.useMemo)(()=>h.slice(h.indexOf(l)),[h,l]),{rect:N,node:S,isOver:_,setNodeRef:C}=jf({id:l,data:T,disabled:x.droppable,resizeObserverConfig:(0,s.A)({updateMeasurementsFor:k},u)}),{active:A,activatorEvent:I,activeNodeRect:R,attributes:O,setNodeRef:D,listeners:j,isDragging:P,over:M,setActivatorNodeRef:L,transform:F}=Rf({id:l,data:T,attributes:(0,s.A)((0,s.A)({},om),r),disabled:x.draggable}),U=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(C,D),B=Boolean(A),V=B&&!g&&$f(m)&&$f(y),z=!b&&P,H=z&&V?F:null,W=V?null!=H?H:(null!=c?c:w)({rects:v,activeNodeRect:R,activeIndex:m,overIndex:y,index:E}):null,G=$f(m)&&$f(y)?o({id:l,items:h,activeIndex:m,overIndex:y}):E,K=null==A?void 0:A.id,q=(0,n.useRef)({activeId:K,items:h,newIndex:G,containerId:f}),X=h!==q.current.items,$=t({active:A,containerId:f,isDragging:P,isSorting:B,id:l,index:E,items:h,newIndex:q.current.newIndex,previousItems:q.current.items,previousContainerId:q.current.containerId,transition:d,wasDragging:null!=q.current.activeId}),Y=function(e){let{disabled:t,index:r,node:a,rect:s}=e;const[i,o]=(0,n.useState)(null),l=(0,n.useRef)(r);return Nd(()=>{if(!t&&r!==l.current&&a.current){const e=s.current;if(e){const t=gh(a.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&o(r)}}r!==l.current&&(l.current=r)},[t,r,a,s]),(0,n.useEffect)(()=>{i&&o(null)},[i]),i}({disabled:!$,index:E,node:S,rect:N});return(0,n.useEffect)(()=>{B&&q.current.newIndex!==G&&(q.current.newIndex=G),f!==q.current.containerId&&(q.current.containerId=f),h!==q.current.items&&(q.current.items=h)},[B,G,f,h]),(0,n.useEffect)(()=>{if(K===q.current.activeId)return;if(null!=K&&null==q.current.activeId)return void(q.current.activeId=K);const e=setTimeout(()=>{q.current.activeId=K},50);return()=>clearTimeout(e)},[K]),{active:A,activeIndex:m,attributes:O,data:T,rect:N,index:E,newIndex:G,items:h,isOver:_,isSorting:B,isDragging:P,listeners:j,node:S,overIndex:y,over:M,setNodeRef:U,setActivatorNodeRef:L,setDroppableNodeRef:C,setDraggableNodeRef:D,transform:null!=Y?Y:W,transition:function(){if(Y||X&&q.current.newIndex===E)return im;if(z&&!Md(I)||!d)return;if(B||$)return Fd.Transition.toString((0,s.A)((0,s.A)({},d),{},{property:sm}));return}()}}function cm(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"===typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const um=[Lh.Down,Lh.Right,Lh.Up,Lh.Left],dm=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:a,droppableContainers:s,over:i,scrollableAncestors:o}}=t;if(um.includes(e.code)){if(e.preventDefault(),!r||!n)return;const t=[];s.getEnabled().forEach(r=>{if(!r||null!=r&&r.disabled)return;const s=a.get(r.id);if(s)switch(e.code){case Lh.Down:n.top<s.top&&t.push(r);break;case Lh.Up:n.top>s.top&&t.push(r);break;case Lh.Left:n.left>s.left&&t.push(r);break;case Lh.Right:n.left<s.left&&t.push(r)}});const l=(e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=sh(t),s=[];for(const i of n){const{id:e}=i,t=r.get(e);if(t){const r=sh(t),n=a.reduce((e,t,n)=>e+th(r[n],t),0),o=Number((n/4).toFixed(4));s.push({id:e,data:{droppableContainer:i,value:o}})}}return s.sort(nh)})({active:r,collisionRect:n,droppableRects:a,droppableContainers:t,pointerCoordinates:null});let c=ih(l,"id");if(c===(null==i?void 0:i.id)&&l.length>1&&(c=l[1].id),null!=c){const e=s.get(r.id),t=s.get(c),i=t?a.get(t.id):null,l=null==t?void 0:t.node.current;if(l&&i&&e&&t){const r=yh(l).some((e,t)=>o[t]!==e),a=hm(e,t),s=function(e,t){if(!cm(e)||!cm(t))return!1;if(!hm(e,t))return!1;return e.data.current.sortable.index<t.data.current.sortable.index}(e,t),c=r||!a?{x:0,y:0}:{x:s?n.width-i.width:0,y:s?n.height-i.height:0},u={x:i.left,y:i.top};return c.x&&c.y?u:Pd(u,c)}}}};function hm(e,t){return!(!cm(e)||!cm(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}const fm=Qe("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),mm=Qe("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);function pm(e){let{member:t,isCaptain:r=!1,onSetCaptain:n,showAge:a=!1}=e;const{attributes:i,listeners:o,setNodeRef:l,transform:c,transition:u,isDragging:d}=lm({id:"member-".concat(t.id)}),h={transform:Fd.Transform.toString(c),transition:u,opacity:d?.5:1},f=(e=>{if(!e)return null;let t;if(e.includes("/")){const[r,n,a]=e.split("/");t=new Date(a,r-1,n)}else{if(!e.includes("-"))return null;t=new Date(e)}const r=new Date;let n=r.getFullYear()-t.getFullYear();const a=r.getMonth()-t.getMonth();return(a<0||0===a&&r.getDate()<t.getDate())&&n--,n})(t.dob);return(0,bt.jsx)("div",{ref:l,style:h,className:"bg-white border rounded-lg p-3 shadow-sm transition-all ".concat(d?"shadow-2xl scale-105 rotate-3 border-rose-400 bg-rose-50 z-50":"hover:shadow-md"," ").concat(r?"border-amber-300 bg-amber-50":"border-gray-200"),children:(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)("div",(0,s.A)((0,s.A)((0,s.A)({},i),o),{},{className:"cursor-move pt-1 transition-colors ".concat(d?"text-rose-500":"text-gray-400 hover:text-gray-600"),children:(0,bt.jsx)(mm,{className:"w-4 h-4"})})),(0,bt.jsxs)("div",{className:"flex flex-col gap-2 flex-1 min-w-0",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bt.jsx)("div",{className:"flex-shrink-0",children:t.profilePicUrl?(0,bt.jsx)("img",{src:t.profilePicUrl,alt:t.fullName,className:"w-10 h-10 rounded-full object-cover border-2 border-rose-200"}):(0,bt.jsx)("div",{className:"w-10 h-10 rounded-full bg-rose-100 flex items-center justify-center border-2 border-rose-200",children:(0,bt.jsx)(lt,{className:"w-5 h-5 text-rose-400"})})}),(0,bt.jsx)("p",{className:"text-sm font-medium text-gray-900 flex-1",children:t.fullName})]}),(0,bt.jsxs)("div",{className:"space-y-0.5 pl-0",children:[t.email&&(0,bt.jsxs)("div",{className:"flex items-start gap-1.5 text-xs text-gray-600",children:[(0,bt.jsx)(dt,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),(0,bt.jsx)("span",{className:"break-all",children:t.email})]}),t.phone&&(0,bt.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[(0,bt.jsx)(ht,{className:"w-3 h-3 flex-shrink-0"}),(0,bt.jsx)("span",{children:t.phone}),(0,bt.jsxs)("div",{className:"flex items-center gap-1 ml-2",children:["married"===t.maritalStatus&&(0,bt.jsx)(Je,{className:"w-3 h-3 text-rose-500 fill-current",title:"Married"}),"widowed"===t.maritalStatus&&(0,bt.jsx)(Je,{className:"w-3 h-3 text-gray-400",title:"Widowed"}),"divorced"===t.maritalStatus&&(0,bt.jsx)(Je,{className:"w-3 h-3 text-gray-400",title:"Divorced",style:{opacity:.5}}),t.numChildren&&parseInt(t.numChildren)>0&&(0,bt.jsx)("span",{className:"flex items-center gap-0.5 text-rose-500",title:"".concat(t.numChildren," ").concat(1===parseInt(t.numChildren)?"child":"children"),children:(0,bt.jsx)(ft,{className:"w-3 h-3"})})]})]}),a&&(0,bt.jsx)("div",{className:"text-xs text-gray-500",children:f?"Age: ".concat(f):(0,bt.jsx)("span",{className:"text-amber-600 italic",children:"DOB missing"})})]})]}),(0,bt.jsx)("div",{className:"flex flex-col items-end gap-1",children:n&&!d&&(0,bt.jsx)("button",{onClick:n,className:"p-1.5 rounded transition-colors ".concat(r?"text-amber-500 hover:text-gray-400 hover:bg-gray-50":"text-gray-400 hover:text-amber-500 hover:bg-amber-50"),title:r?"Remove as captain":"Set as captain",children:(0,bt.jsx)(fm,{className:"w-4 h-4 ".concat(r?"fill-current":"")})})})]})})}function gm(e){let{circle:t,members:r,onUpdateName:a,onDelete:s,onSetCaptain:i,onEmail:o,onAddMembers:l}=e;const[c,u]=(0,n.useState)(!1),[d,h]=(0,n.useState)(t.name),{setNodeRef:f}=jf({id:t.id}),m=r.find(e=>e.id===t.captainId),p=r.filter(e=>e.id!==t.captainId),g=()=>{d.trim()&&d!==t.name&&a(d.trim()),u(!1)},v=r.map(e=>"member-".concat(e.id));return(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden flex flex-col",children:[(0,bt.jsxs)("div",{className:"p-4 bg-gradient-to-r from-rose-50 to-amber-50 border-b border-gray-200 flex-shrink-0",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[c?(0,bt.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),onBlur:g,onKeyPress:e=>"Enter"===e.key&&g(),className:"flex-1 px-2 py-1 border border-rose-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",autoFocus:!0}):(0,bt.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,bt.jsx)(rt,{className:"w-5 h-5 text-rose-500"}),t.name]}),(0,bt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,bt.jsx)("button",{onClick:l,className:"p-1.5 text-green-600 hover:bg-white rounded transition-colors",title:"Add members",children:(0,bt.jsx)(tt,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:()=>u(!c),className:"p-1.5 text-gray-600 hover:bg-white rounded transition-colors",title:"Rename circle",children:(0,bt.jsx)(ct,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:o,className:"p-1.5 text-blue-600 hover:bg-white rounded transition-colors",title:"Email circle members",disabled:0===r.length,children:(0,bt.jsx)(dt,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:s,className:"p-1.5 text-red-600 hover:bg-white rounded transition-colors",title:"Delete circle",children:(0,bt.jsx)(et,{className:"w-4 h-4"})})]})]}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:[r.length," member",1!==r.length?"s":"",m&&(0,bt.jsxs)("span",{className:"ml-2 text-rose-600",children:["\u2022 Captain: ",m.fullName]})]})]}),(0,bt.jsx)("div",{ref:f,className:"flex-1 p-4",children:(0,bt.jsx)(tm,{items:v,strategy:Jf,children:0===r.length?(0,bt.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[(0,bt.jsx)(rt,{className:"w-12 h-12 mb-2"}),(0,bt.jsx)("p",{className:"text-sm",children:"Drag members here"}),(0,bt.jsx)("p",{className:"text-xs mt-1",children:"or click + to add"})]}):(0,bt.jsxs)("div",{className:"space-y-2",children:[m&&(0,bt.jsxs)("div",{className:"mb-4",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,bt.jsx)(fm,{className:"w-4 h-4 text-amber-500"}),(0,bt.jsx)("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Captain"})]}),(0,bt.jsx)(pm,{member:m,isCaptain:!0,onSetCaptain:()=>i(null)})]}),p.length>0&&(0,bt.jsxs)("div",{children:[m&&(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,bt.jsx)(rt,{className:"w-4 h-4 text-gray-400"}),(0,bt.jsx)("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Members"})]}),p.map(e=>(0,bt.jsx)(pm,{member:e,isCaptain:!1,onSetCaptain:()=>i(e.id)},e.id))]})]})})})]})}const vm=Qe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function ym(e){let{filters:t,onFilterChange:r}=e;const n=(e,t)=>{r(r=>(0,s.A)((0,s.A)({},r),{},{[e]:t}))},a=0!==t.ageMin||120!==t.ageMax||"all"!==t.hasChildren||"all"!==t.maritalStatus||"all"!==t.hasEmail||"all"!==t.hasLoggedIn||"all"!==t.ethnicity;return(0,bt.jsxs)("div",{className:"border-b border-gray-200 p-4 space-y-4",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bt.jsx)(vm,{className:"w-4 h-4 text-gray-500"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Filters"})]}),a&&(0,bt.jsxs)("button",{onClick:()=>{r({ageMin:0,ageMax:120,hasChildren:"all",maritalStatus:"all",hasEmail:"all",hasLoggedIn:"all",ethnicity:"all",sortBy:"name"})},className:"text-xs text-rose-600 hover:text-rose-700 flex items-center gap-1",children:[(0,bt.jsx)(gt,{className:"w-3 h-3"}),"Reset"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sort By"}),(0,bt.jsxs)("select",{value:t.sortBy,onChange:e=>n("sortBy",e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"name",children:"Name"}),(0,bt.jsx)("option",{value:"age",children:"Age"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Age Between"}),(0,bt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bt.jsx)("input",{type:"number",value:t.ageMin,onChange:e=>n("ageMin",parseInt(e.target.value)||0),className:"w-20 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",min:"0",max:"120"}),(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"to"}),(0,bt.jsx)("input",{type:"number",value:t.ageMax,onChange:e=>n("ageMax",parseInt(e.target.value)||120),className:"w-20 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",min:"0",max:"120"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Marital Status"}),(0,bt.jsxs)("select",{value:t.maritalStatus,onChange:e=>n("maritalStatus",e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"All"}),(0,bt.jsx)("option",{value:"single",children:"Single"}),(0,bt.jsx)("option",{value:"married",children:"Married"}),(0,bt.jsx)("option",{value:"widowed",children:"Widowed"}),(0,bt.jsx)("option",{value:"divorced",children:"Divorced"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Cultural Background"}),(0,bt.jsxs)("select",{value:t.ethnicity,onChange:e=>n("ethnicity",e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"All"}),(0,bt.jsx)("option",{value:"asian",children:"Asian"}),(0,bt.jsx)("option",{value:"black",children:"Black/African American"}),(0,bt.jsx)("option",{value:"hispanic",children:"Hispanic/Latino"}),(0,bt.jsx)("option",{value:"white",children:"White/Caucasian"}),(0,bt.jsx)("option",{value:"pacific islander",children:"Pacific Islander"}),(0,bt.jsx)("option",{value:"native american",children:"Native American"}),(0,bt.jsx)("option",{value:"middle eastern",children:"Middle Eastern"}),(0,bt.jsx)("option",{value:"other",children:"Other"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Has Children"}),(0,bt.jsxs)("select",{value:t.hasChildren,onChange:e=>n("hasChildren",e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"All"}),(0,bt.jsx)("option",{value:"yes",children:"Yes"}),(0,bt.jsx)("option",{value:"no",children:"No"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Has Email"}),(0,bt.jsxs)("select",{value:t.hasEmail,onChange:e=>n("hasEmail",e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"All"}),(0,bt.jsx)("option",{value:"yes",children:"Yes"}),(0,bt.jsx)("option",{value:"no",children:"No"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Account Status"}),(0,bt.jsxs)("select",{value:t.hasLoggedIn,onChange:e=>n("hasLoggedIn",e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"All"}),(0,bt.jsx)("option",{value:"yes",children:"Active"}),(0,bt.jsx)("option",{value:"no",children:"Pending"})]})]})]})}const bm=Qe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);function wm(e){let{circle:t,members:r,onClose:a}=e;const i=(0,o.getAuth)().currentUser,[l,c]=(0,n.useState)({from:(null===i||void 0===i?void 0:i.email)||"",subject:"Message from ".concat(t.name),message:""}),[u,d]=(0,n.useState)(!1),[h,f]=(0,n.useState)([]),m=r.filter(e=>e.email&&""!==e.email.trim()),p=m.map(e=>e.email).join(", ");return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,bt.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Email Circle Members"}),(0,bt.jsx)("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:(0,bt.jsx)(gt,{className:"w-5 h-5"})})]}),(0,bt.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["To: ",t.name]}),(0,bt.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,bt.jsx)("div",{className:"flex flex-wrap gap-2",children:0===m.length?(0,bt.jsx)("span",{className:"text-sm text-gray-500 italic",children:"No members with email addresses"}):m.map((e,t)=>(0,bt.jsxs)("span",{className:"inline-flex items-center px-2 py-1 bg-rose-100 text-rose-700 text-sm rounded",children:[e.fullName,(0,bt.jsxs)("span",{className:"ml-1 text-xs text-rose-500",children:["(",e.email,")"]})]},e.id))}),r.length!==m.length&&(0,bt.jsxs)("p",{className:"text-xs text-amber-600 mt-2",children:["Note: ",r.length-m.length," member(s) without email will not receive this message"]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From"}),(0,bt.jsx)("input",{type:"email",value:l.from,onChange:e=>c(t=>(0,s.A)((0,s.A)({},t),{},{from:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"your@email.com"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,bt.jsx)("input",{type:"text",value:l.subject,onChange:e=>c(t=>(0,s.A)((0,s.A)({},t),{},{subject:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,bt.jsx)("textarea",{value:l.message,onChange:e=>c(t=>(0,s.A)((0,s.A)({},t),{},{message:e.target.value})),rows:8,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"Type your message here..."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attachments"}),(0,bt.jsxs)("div",{className:"space-y-2",children:[h.map((e,t)=>(0,bt.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bt.jsx)(bm,{className:"w-4 h-4 text-gray-400"}),(0,bt.jsx)("span",{className:"text-sm text-gray-700",children:e.name}),(0,bt.jsxs)("span",{className:"text-xs text-gray-500",children:["(",(e.size/1024).toFixed(1)," KB)"]})]}),(0,bt.jsx)("button",{onClick:()=>(e=>{f(t=>t.filter((t,r)=>r!==e))})(t),className:"text-red-600 hover:text-red-700",children:(0,bt.jsx)(gt,{className:"w-4 h-4"})})]},t)),(0,bt.jsxs)("label",{className:"flex items-center justify-center gap-2 p-3 border-2 border-dashed border-gray-300 rounded-lg hover:border-rose-400 cursor-pointer transition-colors",children:[(0,bt.jsx)(bm,{className:"w-4 h-4 text-gray-400"}),(0,bt.jsx)("span",{className:"text-sm text-gray-600",children:"Add Attachment"}),(0,bt.jsx)("input",{type:"file",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);f(e=>[...e,...t])},className:"hidden"})]})]})]})]}),(0,bt.jsxs)("div",{className:"p-6 border-t border-gray-200 flex justify-end gap-3",children:[(0,bt.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsxs)("button",{onClick:async()=>{if(!l.message.trim())return void alert("Please enter a message");if(0===m.length)return void alert("No members in this circle have email addresses");const e="mailto:".concat(p,"?subject=").concat(encodeURIComponent(l.subject),"&body=").concat(encodeURIComponent(l.message));window.location.href=e,a()},disabled:u||0===m.length,className:"flex items-center gap-2 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,bt.jsx)(Ze,{className:"w-4 h-4"}),u?"Sending...":"Send Email"]})]})]})})}const xm=Qe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function Em(e){let{circle:t,availableMembers:r,onClose:a,onAddMembers:s}=e;const[i,o]=(0,n.useState)([]),[l,c]=(0,n.useState)(""),u=r.filter(e=>{var t,r;return(null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(l.toLowerCase()))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(l.toLowerCase()))});return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] flex flex-col",children:[(0,bt.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("h2",{className:"text-xl font-bold text-gray-800",children:["Add Members to ",t.name]}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[i.length," selected \u2022 ",r.length," available"]})]}),(0,bt.jsx)("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:(0,bt.jsx)(gt,{className:"w-5 h-5"})})]}),(0,bt.jsx)("div",{className:"p-4 border-b border-gray-200 flex-shrink-0",children:(0,bt.jsxs)("div",{className:"relative",children:[(0,bt.jsx)(xm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,bt.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Search members...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]})}),(0,bt.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:0===u.length?(0,bt.jsx)("div",{className:"text-center py-12 text-gray-500",children:l?"No members match your search":"No available members"}):(0,bt.jsx)("div",{className:"space-y-2",children:u.map(e=>(0,bt.jsxs)("label",{className:"flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-all ".concat(i.includes(e.id)?"bg-rose-50 border-rose-300":"bg-white border-gray-200 hover:border-rose-200"),children:[(0,bt.jsx)("input",{type:"checkbox",checked:i.includes(e.id),onChange:()=>{return t=e.id,void o(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-4 h-4 text-rose-500 border-gray-300 rounded focus:ring-rose-500"}),(0,bt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,bt.jsx)("p",{className:"font-medium text-gray-900",children:e.fullName}),e.email&&(0,bt.jsx)("p",{className:"text-sm text-gray-600 truncate",children:e.email})]})]},e.id))})}),(0,bt.jsxs)("div",{className:"p-6 border-t border-gray-200 flex justify-end gap-3 flex-shrink-0",children:[(0,bt.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsxs)("button",{onClick:()=>{i.length>0&&(s(i),a())},disabled:0===i.length,className:"flex items-center gap-2 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,bt.jsx)(tt,{className:"w-4 h-4"}),"Add ",i.length>0&&"(".concat(i.length,")")]})]})]})})}function Tm(e){let{db:t,stakeId:r,wardId:a,wardName:i}=e;const[o,c]=(0,n.useState)([]),[u,d]=(0,n.useState)([]),[h,f]=(0,n.useState)([]),[m,p]=(0,n.useState)([]),[g,v]=(0,n.useState)(!0),[y,b]=(0,n.useState)(""),[w,x]=(0,n.useState)(""),[E,T]=(0,n.useState)({ageMin:0,ageMax:120,hasChildren:"all",maritalStatus:"all",hasEmail:"all",hasLoggedIn:"all",ethnicity:"all",sortBy:"name"}),[k,N]=(0,n.useState)(!1),[S,_]=(0,n.useState)(!1),[C,A]=(0,n.useState)(null),[I,R]=(0,n.useState)(null),O=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(Zd(qh),Zd(zh,{coordinateGetter:dm}));(0,n.useEffect)(()=>{D()},[r,a]),(0,n.useEffect)(()=>{j()},[h,E]);const D=async()=>{try{v(!0);const e=(0,l.query)((0,l.collection)(t,"stakes",r,"wards",a,"members")),n=(await(0,l.getDocs)(e)).docs.map(e=>(0,s.A)({id:e.id},e.data()));d(n);const i=(0,l.query)((0,l.collection)(t,"stakes",r,"wards",a,"circles")),o=(await(0,l.getDocs)(i)).docs.map(e=>(0,s.A)({id:e.id},e.data()));c(o);const u=new Set;o.forEach(e=>{(e.memberIds||[]).forEach(e=>u.add(e))});const h=n.filter(e=>!u.has(e.id));f(h),v(!1)}catch(e){console.error("Error loading data:",e),b("Failed to load circles and members"),v(!1)}},j=()=>{let e=[...h];e=e.filter(e=>{if(!e.dob)return 0===E.ageMin&&120===E.ageMax;const t=P(e.dob);return t>=E.ageMin&&t<=E.ageMax}),"all"!==E.hasChildren&&(e=e.filter(e=>{const t=e.numChildren&&parseInt(e.numChildren)>0;return"yes"===E.hasChildren?t:!t})),"all"!==E.ethnicity&&(e=e.filter(e=>e.ethnicity&&e.ethnicity.toLowerCase()===E.ethnicity.toLowerCase())),"all"!==E.maritalStatus&&(e=e.filter(e=>e.maritalStatus===E.maritalStatus)),"all"!==E.hasEmail&&(e=e.filter(e=>{const t=e.email&&""!==e.email.trim();return"yes"===E.hasEmail?t:!t})),"all"!==E.hasLoggedIn&&(e=e.filter(e=>"yes"===E.hasLoggedIn?e.hasLoggedIn:!e.hasLoggedIn)),e.sort((e,t)=>{if("name"===E.sortBy)return(e.fullName||"").localeCompare(t.fullName||"");if("age"===E.sortBy){return P(e.dob)-P(t.dob)}return 0}),p(e)},P=e=>{if(!e)return 0;const t=new Date(e),r=new Date;let n=r.getFullYear()-t.getFullYear();const a=r.getMonth()-t.getMonth();return(a<0||0===a&&r.getDate()<t.getDate())&&n--,n},M=async()=>{try{const e=o.length+1,n={name:"Circle ".concat(e),captainId:null,memberIds:[],stakeId:r,wardId:a,createdAt:(0,l.O5)()},i=await(0,l.gS)((0,l.collection)(t,"stakes",r,"wards",a,"circles"),n);c(e=>[...e,(0,s.A)({id:i.id},n)]),x("Circle created successfully")}catch(e){console.error("Error creating circle:",e),b("Failed to create circle")}},L=[...m.map(e=>"member-".concat(e.id)),...o.flatMap(e=>(e.memberIds||[]).map(e=>"member-".concat(e)))];if(g)return(0,bt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,bt.jsx)("div",{className:"text-gray-500",children:"Loading circles..."})});function F(e){let{member:t}=e;return(0,bt.jsx)("div",{className:"bg-white border-2 border-rose-400 rounded-lg p-3 shadow-2xl opacity-90",children:(0,bt.jsxs)("div",{className:"flex items-center gap-2",children:[t.profilePicUrl?(0,bt.jsx)("img",{src:t.profilePicUrl,alt:t.fullName,className:"w-10 h-10 rounded-full object-cover border-2 border-rose-200"}):(0,bt.jsx)("div",{className:"w-10 h-10 rounded-full bg-rose-100 flex items-center justify-center border-2 border-rose-200",children:(0,bt.jsx)(lt,{className:"w-5 h-5 text-rose-400"})}),(0,bt.jsx)("p",{className:"text-sm font-medium text-gray-900",children:t.fullName})]})})}return(0,bt.jsxs)("div",{className:"h-full flex flex-col",children:[y&&(0,bt.jsxs)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:[y,(0,bt.jsx)("button",{onClick:()=>b(""),className:"float-right",children:"\xd7"})]}),w&&(0,bt.jsxs)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:[w,(0,bt.jsx)("button",{onClick:()=>x(""),className:"float-right",children:"\xd7"})]}),(0,bt.jsxs)(Cf,{sensors:O,collisionDetection:lh,onDragEnd:async e=>{const{active:n,over:i}=e;if(!i||n.id===i.id)return;const d=n.id.replace("member-",""),m=u.find(e=>e.id===d);if(!m)return;let p=null,g=i.id;for(const t of o)if((t.memberIds||[]).includes(d)){p=t.id;break}if(i.id.startsWith("member-")){const e=i.id.replace("member-","");if(h.some(t=>t.id===e))g="available";else for(const t of o)if((t.memberIds||[]).includes(e)){g=t.id;break}}if((null!==p||"available"!==g)&&p!==g)try{if(p){const e=o.find(e=>e.id===p),n=(e.memberIds||[]).filter(e=>e!==d),i=e.captainId===d?null:e.captainId;await(0,l.mZ)((0,l.H9)(t,"stakes",r,"wards",a,"circles",p),{memberIds:n,captainId:i}),c(e=>e.map(e=>e.id===p?(0,s.A)((0,s.A)({},e),{},{memberIds:n,captainId:i}):e))}if("available"===g)f(e=>[...e,m]);else{const e=[...o.find(e=>e.id===g).memberIds||[],d];await(0,l.mZ)((0,l.H9)(t,"stakes",r,"wards",a,"circles",g),{memberIds:e}),c(t=>t.map(t=>t.id===g?(0,s.A)((0,s.A)({},t),{},{memberIds:e}):t)),f(e=>e.filter(e=>e.id!==d))}x("Member moved successfully"),R(null)}catch(v){console.error("Error moving member:",v),b("Failed to move member"),D()}},onDragStart:e=>{const t=e.active.id.replace("member-",""),r=u.find(e=>e.id===t);R(r)},children:[(0,bt.jsx)(tm,{items:L,strategy:Jf,children:(0,bt.jsxs)("div",{className:"flex-1 flex gap-6 overflow-y-auto",children:[(0,bt.jsxs)("div",{className:"w-80 flex flex-col bg-white rounded-lg shadow-md border border-gray-200 flex-shrink-0",children:[(0,bt.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-rose-50 flex-shrink-0",children:[(0,bt.jsxs)("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[(0,bt.jsx)(st,{className:"w-5 h-5 text-rose-500"}),"Available Members"]}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[m.length," of ",h.length," shown"]}),h.length!==m.length&&(0,bt.jsxs)("p",{className:"text-xs text-amber-600 mt-1",children:[h.length-m.length," members hidden by filters"]})]}),(0,bt.jsx)("div",{className:"flex-shrink-0",children:(0,bt.jsx)(ym,{filters:E,onFilterChange:T})}),(0,bt.jsx)("div",{className:"p-4 space-y-2",children:0===m.length?(0,bt.jsx)("div",{className:"text-center py-8 text-gray-500 text-sm",children:0===h.length?"All members are in circles":"No members match filters"}):m.map(e=>(0,bt.jsx)(pm,{member:e,showAge:!0},e.id))})]}),(0,bt.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,bt.jsxs)("div",{className:"mb-4 flex items-center justify-between flex-shrink-0",children:[(0,bt.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:["Friendship Circles (",o.length,")"]}),(0,bt.jsxs)("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors",children:[(0,bt.jsx)(tt,{className:"w-4 h-4"}),"Create Circle"]})]}),0===o.length?(0,bt.jsxs)("div",{className:"flex flex-col items-center justify-center flex-1 bg-white rounded-lg shadow-md border-2 border-dashed border-gray-300 p-12",children:[(0,bt.jsx)(st,{className:"w-16 h-16 text-gray-300 mb-4"}),(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Circles Yet"}),(0,bt.jsx)("p",{className:"text-gray-600 text-center mb-6",children:"Create your first friendship circle to get started"}),(0,bt.jsxs)("button",{onClick:M,className:"flex items-center gap-2 px-6 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors",children:[(0,bt.jsx)(tt,{className:"w-5 h-5"}),"Create First Circle"]})]}):(0,bt.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 pb-4",children:o.map(e=>(0,bt.jsx)(gm,{circle:e,members:u.filter(t=>(e.memberIds||[]).includes(t.id)),onUpdateName:n=>(async(e,n)=>{try{await(0,l.mZ)((0,l.H9)(t,"stakes",r,"wards",a,"circles",e),{name:n}),c(t=>t.map(t=>t.id===e?(0,s.A)((0,s.A)({},t),{},{name:n}):t)),x("Circle name updated")}catch(i){console.error("Error updating circle name:",i),b("Failed to update circle name")}})(e.id,n),onDelete:()=>(async e=>{if(confirm("Are you sure you want to delete this circle? All members will be moved back to available members."))try{const n=o.find(t=>t.id===e);await(0,l.kd)((0,l.H9)(t,"stakes",r,"wards",a,"circles",e));const s=u.filter(e=>(n.memberIds||[]).includes(e.id));f(e=>[...e,...s]),c(t=>t.filter(t=>t.id!==e)),x("Circle deleted successfully")}catch(n){console.error("Error deleting circle:",n),b("Failed to delete circle")}})(e.id),onSetCaptain:n=>(async(e,n)=>{try{await(0,l.mZ)((0,l.H9)(t,"stakes",r,"wards",a,"circles",e),{captainId:n}),c(t=>t.map(t=>t.id===e?(0,s.A)((0,s.A)({},t),{},{captainId:n}):t)),x("Captain assigned successfully")}catch(i){console.error("Error setting captain:",i),b("Failed to set captain")}})(e.id,n),onEmail:()=>{A(e),N(!0)},onAddMembers:()=>{A(e),_(!0)}},e.id))})]})]})}),(0,bt.jsx)(Kf,{children:I&&(0,bt.jsx)(F,{member:I})})]}),k&&C&&(0,bt.jsx)(wm,{circle:C,members:u.filter(e=>(C.memberIds||[]).includes(e.id)),onClose:()=>{N(!1),A(null)}}),S&&C&&(0,bt.jsx)(Em,{circle:C,availableMembers:m.length>0?m:h,onClose:()=>{_(!1),A(null)},onAddMembers:e=>(async(e,n)=>{try{const i=[...o.find(t=>t.id===e).memberIds||[],...n];await(0,l.mZ)((0,l.H9)(t,"stakes",r,"wards",a,"circles",e),{memberIds:i}),c(t=>t.map(t=>t.id===e?(0,s.A)((0,s.A)({},t),{},{memberIds:i}):t)),f(e=>e.filter(e=>!n.includes(e.id))),x("".concat(n.length," member").concat(n.length>1?"s":""," added successfully"))}catch(i){console.error("Error adding members:",i),b("Failed to add members")}})(C.id,e)})]})}const km=Qe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Nm=Qe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Sm=Qe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),_m=Qe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),Cm=Qe("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Am=Qe("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),Im=Qe("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]),Rm=Qe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Om=Qe("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Dm=Qe("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]),jm=Qe("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),Pm=Qe("Church",[["path",{d:"m18 7 4 2v11a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9l4-2",key:"gy5gyo"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 22V5l-6-3-6 3v17",key:"1hsnhq"}],["path",{d:"M12 7v5",key:"ma6bk"}],["path",{d:"M10 9h4",key:"u4k05v"}]]);function Mm(e){var t;let{member:r,onClose:n}=e;const a=(e=>{if(!e)return null;const t=new Date(e),r=new Date;let n=r.getFullYear()-t.getFullYear();const a=r.getMonth()-t.getMonth();return(a<0||0===a&&r.getDate()<t.getDate())&&n--,n})(r.dob);return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full my-8 max-h-[90vh] overflow-y-auto",children:[(0,bt.jsx)("div",{className:"relative h-32 z-0",style:{background:"linear-gradient(to bottom, #f472b6 0%, #fbbf24 60%, rgba(255,255,255,1) 100%)"},children:(0,bt.jsx)("button",{onClick:n,className:"absolute top-4 right-4 p-2 bg-white rounded-lg hover:bg-gray-100 transition-colors z-20",children:(0,bt.jsx)(gt,{className:"w-5 h-5 text-gray-700"})})}),(0,bt.jsxs)("div",{className:"px-8 pb-8",children:[(0,bt.jsxs)("div",{className:"flex items-end gap-6 -mt-16 mb-6 relative z-10",children:[r.profilePicUrl?(0,bt.jsx)("img",{src:r.profilePicUrl,alt:r.fullName,className:"w-32 h-32 rounded-full object-cover border-4 border-white shadow-lg"}):(0,bt.jsx)("div",{className:"w-32 h-32 rounded-full bg-rose-100 flex items-center justify-center border-4 border-white shadow-lg",children:(0,bt.jsx)("span",{className:"text-4xl text-rose-400",children:(null===(t=r.fullName)||void 0===t?void 0:t[0])||"?"})}),(0,bt.jsxs)("div",{className:"flex-1 pb-4",children:[(0,bt.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:r.fullName}),r.preferredName&&r.preferredName!==r.fullName&&(0,bt.jsxs)("p",{className:"text-lg text-gray-600 italic",children:['"',r.preferredName,'"']})]})]}),r.aboutMe&&(0,bt.jsxs)("div",{className:"mb-6 p-4 bg-rose-50 rounded-lg",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"About Me"}),(0,bt.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:r.aboutMe})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Contact Information"}),r.email&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(dt,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.email})]})]}),r.phone&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(ht,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Phone"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.phone})]})]}),r.address&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Sm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Address"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.address})]})]})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Personal Details"}),r.dob&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Nm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Birthday"}),(0,bt.jsxs)("p",{className:"text-gray-800",children:[r.dob," ",a&&"(".concat(a," years old)")]})]})]}),r.maritalStatus&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Je,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Marital Status"}),(0,bt.jsx)("p",{className:"text-gray-800 capitalize",children:r.maritalStatus})]})]}),r.anniversary&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Je,{className:"w-5 h-5 text-rose-500 mt-0.5 fill-current"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Anniversary"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.anniversary})]})]}),r.ethnicity&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(_m,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Cultural Background"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.ethnicity})]})]})]}),(r.numChildren||r.childrenNames||r.spouseName)&&(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Family"}),r.spouseName&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Je,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Spouse"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.spouseName})]})]}),r.numChildren&&parseInt(r.numChildren)>0&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(ft,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Children"}),(0,bt.jsxs)("p",{className:"text-gray-800",children:[r.numChildren," ",1===parseInt(r.numChildren)?"child":"children"]}),r.childrenNames&&(0,bt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:r.childrenNames})]})]})]}),(r.occupation||r.education||r.employer)&&(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Professional & Education"}),r.occupation&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Cm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Occupation"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.occupation})]})]}),r.employer&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Cm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Employer"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.employer})]})]}),r.education&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Am,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Education"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.education})]})]})]}),(r.hobbies||r.interests||r.talents||r.favoriteBooks||r.favoriteMusic)&&(0,bt.jsxs)("div",{className:"space-y-4 md:col-span-2",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Hobbies & Interests"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.hobbies&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Im,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Hobbies"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.hobbies})]})]}),r.interests&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Rm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Interests"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.interests})]})]}),r.talents&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Om,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Talents"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.talents})]})]}),r.favoriteBooks&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Dm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Favorite Books"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.favoriteBooks})]})]}),r.favoriteMusic&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(jm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Favorite Music"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.favoriteMusic})]})]})]})]}),(r.spiritualJourney||r.favoriteScripture||r.testimony||r.callings)&&(0,bt.jsxs)("div",{className:"space-y-4 md:col-span-2",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Spiritual Journey"}),r.spiritualJourney&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Pm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"My Spiritual Journey"}),(0,bt.jsx)("p",{className:"text-gray-800 whitespace-pre-wrap",children:r.spiritualJourney})]})]}),r.favoriteScripture&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Dm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Favorite Scripture"}),(0,bt.jsx)("p",{className:"text-gray-800 italic whitespace-pre-wrap",children:r.favoriteScripture})]})]}),r.testimony&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Je,{className:"w-5 h-5 text-rose-500 mt-0.5 fill-current"}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Testimony"}),(0,bt.jsx)("p",{className:"text-gray-800 whitespace-pre-wrap",children:r.testimony})]})]}),r.callings&&(0,bt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,bt.jsx)(Pm,{className:"w-5 h-5 text-rose-500 mt-0.5"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Current Callings"}),(0,bt.jsx)("p",{className:"text-gray-800",children:r.callings})]})]})]}),(r.personalGoals||r.familyGoals||r.spiritualGoals)&&(0,bt.jsxs)("div",{className:"space-y-4 md:col-span-2",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Goals & Aspirations"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.personalGoals&&(0,bt.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Personal Goals"}),(0,bt.jsx)("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:r.personalGoals})]}),r.familyGoals&&(0,bt.jsxs)("div",{className:"p-4 bg-amber-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm font-medium text-amber-800 mb-2",children:"Family Goals"}),(0,bt.jsx)("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:r.familyGoals})]}),r.spiritualGoals&&(0,bt.jsxs)("div",{className:"p-4 bg-rose-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm font-medium text-rose-800 mb-2",children:"Spiritual Goals"}),(0,bt.jsx)("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:r.spiritualGoals})]})]})]})]})]})]})})}const Lm=Qe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);function Fm(e){var t;let{member:r,stakeId:a,wardId:i,db:o,storage:c,onClose:u,onSave:d}=e;const[h,f]=(0,n.useState)({preferredName:r.preferredName||"",aboutMe:r.aboutMe||"",phone:r.phone||"",address:r.address||"",dob:r.dob||"",maritalStatus:r.maritalStatus||"",anniversary:r.anniversary||"",ethnicity:r.ethnicity||"",spouseName:r.spouseName||"",numChildren:r.numChildren||"",childrenNames:r.childrenNames||"",occupation:r.occupation||"",employer:r.employer||"",education:r.education||"",hobbies:r.hobbies||"",interests:r.interests||"",talents:r.talents||"",favoriteBooks:r.favoriteBooks||"",favoriteMusic:r.favoriteMusic||"",spiritualJourney:r.spiritualJourney||"",favoriteScripture:r.favoriteScripture||"",testimony:r.testimony||"",callings:r.callings||"",personalGoals:r.personalGoals||"",familyGoals:r.familyGoals||"",spiritualGoals:r.spiritualGoals||"",profilePicUrl:r.profilePicUrl||""}),[m,p]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(r.profilePicUrl||""),w=(e,t)=>{if("dob"===e&&t&&t.includes("-")&&t.match(/^\d{4}-\d{2}-\d{2}$/)){const[e,r,n]=t.split("-");t="".concat(r,"/").concat(n,"/").concat(e)}if("anniversary"===e&&t&&t.includes("-")&&t.match(/^\d{4}-\d{2}-\d{2}$/)){const[e,r,n]=t.split("-");t="".concat(r,"/").concat(n,"/").concat(e)}f(r=>(0,s.A)((0,s.A)({},r),{},{[e]:t}))};return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full my-8 max-h-[90vh] overflow-y-auto",children:[(0,bt.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between z-10",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Edit My Profile"}),(0,bt.jsx)("button",{onClick:u,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:(0,bt.jsx)(gt,{className:"w-6 h-6"})})]}),(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex flex-col items-center mb-8 pb-8 border-b",children:[(0,bt.jsxs)("div",{className:"relative",children:[y?(0,bt.jsx)("img",{src:y,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-4 border-rose-200"}):(0,bt.jsx)("div",{className:"w-32 h-32 rounded-full bg-rose-100 flex items-center justify-center border-4 border-rose-200",children:(0,bt.jsx)("span",{className:"text-4xl text-rose-400",children:(null===(t=r.fullName)||void 0===t?void 0:t[0])||"?"})}),(0,bt.jsxs)("label",{className:"absolute bottom-0 right-0 bg-rose-500 text-white p-3 rounded-full cursor-pointer hover:bg-rose-600 transition-colors",children:[(0,bt.jsx)(mt,{className:"w-5 h-5"}),(0,bt.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files[0];if(t)if(t.type.startsWith("image/"))if(t.size>5242880)alert("Image must be less than 5MB");else{p(!0);try{const e=Ae(c,"profilePics/".concat(r.id));await _e(e,t);const n=await Ce(e);f(e=>(0,s.A)((0,s.A)({},e),{},{profilePicUrl:n})),b(n),alert("Profile picture uploaded successfully!")}catch(n){console.error("Error uploading profile picture:",n),alert("Error uploading picture. Please try again.")}finally{p(!1)}}else alert("Please upload an image file")},className:"hidden",disabled:m})]})]}),m&&(0,bt.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Uploading..."}),(0,bt.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Click camera icon to upload"}),(0,bt.jsxs)("div",{className:"mt-4 text-center",children:[(0,bt.jsx)("p",{className:"text-lg font-semibold text-gray-800",children:r.fullName}),(0,bt.jsx)("p",{className:"text-sm text-gray-500",children:r.email}),(0,bt.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"Name and email cannot be changed"})]})]}),(0,bt.jsxs)("div",{className:"space-y-8",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 pb-2 border-b",children:"Basic Information"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Name/Nickname"}),(0,bt.jsx)("input",{type:"text",value:h.preferredName,onChange:e=>w("preferredName",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"What you like to be called"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,bt.jsx)("input",{type:"tel",value:h.phone,onChange:e=>w("phone",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,bt.jsx)("input",{type:"text",value:h.address,onChange:e=>w("address",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),(0,bt.jsx)("input",{type:"date",value:h.dob&&h.dob.includes("/")?(()=>{const[e,t,r]=h.dob.split("/");return"".concat(r,"-").concat(e,"-").concat(t)})():h.dob,onChange:e=>w("dob",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),(0,bt.jsxs)("select",{value:h.maritalStatus,onChange:e=>w("maritalStatus",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"",children:"Select..."}),(0,bt.jsx)("option",{value:"single",children:"Single"}),(0,bt.jsx)("option",{value:"married",children:"Married"}),(0,bt.jsx)("option",{value:"widowed",children:"Widowed"}),(0,bt.jsx)("option",{value:"divorced",children:"Divorced"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cultural Background"}),(0,bt.jsx)("input",{type:"text",value:h.ethnicity,onChange:e=>w("ethnicity",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Optional"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"About Me"}),(0,bt.jsx)("textarea",{value:h.aboutMe,onChange:e=>w("aboutMe",e.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"Tell others a little about yourself..."})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 pb-2 border-b",children:"Family Information"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Spouse Name"}),(0,bt.jsx)("input",{type:"text",value:h.spouseName,onChange:e=>w("spouseName",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Anniversary"}),(0,bt.jsx)("input",{type:"date",value:h.anniversary&&h.anniversary.includes("/")?(()=>{const[e,t,r]=h.anniversary.split("/");return"".concat(r,"-").concat(e,"-").concat(t)})():h.anniversary,onChange:e=>w("anniversary",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Children"}),(0,bt.jsx)("input",{type:"number",value:h.numChildren,onChange:e=>w("numChildren",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",min:"0"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Children's Names"}),(0,bt.jsx)("input",{type:"text",value:h.childrenNames,onChange:e=>w("childrenNames",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"e.g., John, Mary, David"})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 pb-2 border-b",children:"Professional & Education"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Occupation"}),(0,bt.jsx)("input",{type:"text",value:h.occupation,onChange:e=>w("occupation",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employer"}),(0,bt.jsx)("input",{type:"text",value:h.employer,onChange:e=>w("employer",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Education"}),(0,bt.jsx)("input",{type:"text",value:h.education,onChange:e=>w("education",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"e.g., Bachelor's in Computer Science, University of Nevada"})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 pb-2 border-b",children:"Hobbies & Interests"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hobbies"}),(0,bt.jsx)("input",{type:"text",value:h.hobbies,onChange:e=>w("hobbies",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"e.g., Hiking, Photography, Cooking"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interests"}),(0,bt.jsx)("input",{type:"text",value:h.interests,onChange:e=>w("interests",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"e.g., Travel, History, Technology"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Talents"}),(0,bt.jsx)("input",{type:"text",value:h.talents,onChange:e=>w("talents",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"e.g., Piano, Public Speaking, Gardening"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Favorite Books"}),(0,bt.jsx)("input",{type:"text",value:h.favoriteBooks,onChange:e=>w("favoriteBooks",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Favorite Music"}),(0,bt.jsx)("input",{type:"text",value:h.favoriteMusic,onChange:e=>w("favoriteMusic",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 pb-2 border-b",children:"Spiritual Journey"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"My Spiritual Journey"}),(0,bt.jsx)("textarea",{value:h.spiritualJourney,onChange:e=>w("spiritualJourney",e.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"Share your conversion story or spiritual experiences..."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Favorite Scripture"}),(0,bt.jsx)("textarea",{value:h.favoriteScripture,onChange:e=>w("favoriteScripture",e.target.value),rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"e.g., Alma 32:21"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Testimony"}),(0,bt.jsx)("textarea",{value:h.testimony,onChange:e=>w("testimony",e.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"Share your testimony..."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Callings"}),(0,bt.jsx)("input",{type:"text",value:h.callings,onChange:e=>w("callings",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"e.g., Relief Society Teacher"})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 pb-2 border-b",children:"Goals & Aspirations"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Personal Goals"}),(0,bt.jsx)("textarea",{value:h.personalGoals,onChange:e=>w("personalGoals",e.target.value),rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"What are you working towards personally?"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Family Goals"}),(0,bt.jsx)("textarea",{value:h.familyGoals,onChange:e=>w("familyGoals",e.target.value),rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"Goals for your family..."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Spiritual Goals"}),(0,bt.jsx)("textarea",{value:h.spiritualGoals,onChange:e=>w("spiritualGoals",e.target.value),rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none",placeholder:"Your spiritual aspirations..."})]})]})]})]})]}),(0,bt.jsxs)("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-6 flex justify-end gap-3",children:[(0,bt.jsx)("button",{onClick:u,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsxs)("button",{onClick:async()=>{v(!0);try{await(0,l.mZ)((0,l.H9)(o,"stakes",a,"wards",i,"members",r.id),(0,s.A)((0,s.A)({},h),{},{updatedAt:(new Date).toISOString()})),d()}catch(e){console.error("Error saving profile:",e),alert("Error saving profile. Please try again.")}finally{v(!1)}},disabled:g||m,className:"flex items-center gap-2 px-6 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50",children:[(0,bt.jsx)(Lm,{className:"w-4 h-4"}),g?"Saving...":"Save Profile"]})]})]})})}const Um=Qe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);function Bm(e){let{db:t,storage:r,stakeId:a,wardId:i,circleId:o,currentMemberId:c,currentMemberName:u,circleMembers:d}=e;const[h,f]=(0,n.useState)([]),[m,p]=(0,n.useState)(""),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),w=(0,n.useRef)(null),x=(0,n.useRef)(null);(0,n.useEffect)(()=>{const e=(0,l.query)((0,l.collection)(t,"stakes",a,"wards",i,"circles",o,"chats"),(0,l.My)("createdAt","asc")),r=(0,l.aQ)(e,e=>{const t=e.docs.map(e=>(0,s.A)({id:e.id},e.data()));f(t)});return()=>r()},[t,a,i,o]),(0,n.useEffect)(()=>{E()},[h]);const E=()=>{var e;null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},T=async()=>{if(m.trim()&&!y){b(!0);try{await(0,l.gS)((0,l.collection)(t,"stakes",a,"wards",i,"circles",o,"chats"),{memberId:c,memberName:u,type:"text",message:m.trim(),createdAt:(0,l.O5)()}),p("")}catch(e){console.error("Error sending message:",e),alert("Error sending message. Please try again.")}finally{b(!1)}}},k=e=>{if(!e)return"";const t=e.toDate?e.toDate():new Date(e),r=new Date-t,n=Math.floor(r/6e4),a=Math.floor(r/36e5),s=Math.floor(r/864e5);return n<1?"Just now":n<60?"".concat(n,"m ago"):a<24?"".concat(a,"h ago"):s<7?"".concat(s,"d ago"):t.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md border border-blue-100 flex flex-col h-[600px]",children:[(0,bt.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Circle Chat"}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:[d.length," members"]})]}),(0,bt.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===h.length?(0,bt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,bt.jsx)("p",{className:"mb-2",children:"No messages yet"}),(0,bt.jsx)("p",{className:"text-sm",children:"Start the conversation!"})]}):h.map(e=>{const t=e.memberId===c,r=(n=e.memberId,d.find(e=>e.id===n));var n;return(0,bt.jsxs)("div",{className:"flex gap-3 ".concat(t?"flex-row-reverse":"flex-row"),children:[(0,bt.jsx)("div",{className:"flex-shrink-0",children:null!==r&&void 0!==r&&r.profilePicUrl?(0,bt.jsx)("img",{src:r.profilePicUrl,alt:e.memberName,className:"w-10 h-10 rounded-full object-cover border-2 border-blue-200"}):(0,bt.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center border-2 border-blue-200",children:(0,bt.jsx)(lt,{className:"w-5 h-5 text-blue-400"})})}),(0,bt.jsxs)("div",{className:"flex-1 max-w-[70%] ".concat(t?"items-end":"items-start"," flex flex-col"),children:[(0,bt.jsxs)("div",{className:"flex items-baseline gap-2 mb-1 ".concat(t?"flex-row-reverse":"flex-row"),children:[(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.memberName}),(0,bt.jsx)("span",{className:"text-xs text-gray-500",children:k(e.createdAt)})]}),"text"===e.type&&(0,bt.jsx)("div",{className:"px-4 py-2 rounded-lg ".concat(t?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"),children:(0,bt.jsx)("p",{className:"whitespace-pre-wrap break-words",children:e.message})}),"image"===e.type&&(0,bt.jsxs)("div",{className:"rounded-lg overflow-hidden border-2 ".concat(t?"border-blue-500":"border-gray-200"),children:[(0,bt.jsx)("img",{src:e.fileUrl,alt:e.fileName,className:"max-w-full max-h-64 object-contain cursor-pointer",onClick:()=>window.open(e.fileUrl,"_blank")}),(0,bt.jsx)("div",{className:"px-3 py-2 text-xs ".concat(t?"bg-blue-50":"bg-gray-50"),children:(0,bt.jsx)("p",{className:"font-medium truncate",children:e.fileName})})]}),"document"===e.type&&(0,bt.jsx)("div",{className:"px-4 py-3 rounded-lg border-2 ".concat(t?"bg-blue-50 border-blue-500":"bg-gray-50 border-gray-200"),children:(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(it,{className:"w-8 h-8 text-blue-500"}),(0,bt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,bt.jsx)("p",{className:"font-medium text-sm truncate",children:e.fileName}),(0,bt.jsxs)("p",{className:"text-xs text-gray-500",children:[(e.fileSize/1024).toFixed(1)," KB"]})]}),(0,bt.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-blue-100 rounded-lg transition-colors",children:(0,bt.jsx)(Um,{className:"w-5 h-5 text-blue-600"})})]})})]})]},e.id)}),(0,bt.jsx)("div",{ref:w})]}),(0,bt.jsxs)("div",{className:"p-4 border-t border-gray-200",children:[g&&(0,bt.jsx)("div",{className:"mb-2 text-sm text-blue-600",children:"Uploading file..."}),(0,bt.jsxs)("div",{className:"flex gap-2",children:[(0,bt.jsx)("input",{type:"file",ref:x,onChange:async e=>{const n=Array.from(e.target.files);if(0!==n.length){v(!0);try{for(const e of n){const n=Date.now(),s="".concat(n,"_").concat(e.name),d=Ae(r,"circles/".concat(o,"/chat/").concat(s));await _e(d,e);const h=await Ce(d),f=e.type.startsWith("image/")?"image":"document";await(0,l.gS)((0,l.collection)(t,"stakes",a,"wards",i,"circles",o,"chats"),{memberId:c,memberName:u,type:f,fileUrl:h,fileName:e.name,fileSize:e.size,createdAt:(0,l.O5)()})}}catch(s){console.error("Error uploading file:",s),alert("Error uploading file. Please try again.")}finally{v(!1),x.current&&(x.current.value="")}}},multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt",className:"hidden"}),(0,bt.jsx)("button",{onClick:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.click()},disabled:g,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",title:"Attach file",children:(0,bt.jsx)(bm,{className:"w-5 h-5"})}),(0,bt.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),onKeyPress:e=>"Enter"===e.key&&!e.shiftKey&&T(),placeholder:"Type a message...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:g||y}),(0,bt.jsx)("button",{onClick:T,disabled:!m.trim()||g||y,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,bt.jsx)(Ze,{className:"w-5 h-5"})})]})]})]})}const Vm=Qe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),zm=Qe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);function Hm(e){let{db:t,storage:r,stakeId:a,wardId:i,circleId:o,currentMemberId:c,currentMemberName:u,circleMembers:d}=e;const[h,f]=(0,n.useState)([]),[m,p]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null);(0,n.useEffect)(()=>{const e=(new Date).toISOString(),r=(0,l.query)((0,l.collection)(t,"stakes",a,"wards",i,"circles",o,"events"),(0,l.where)("eventDate",">=",e),(0,l.My)("eventDate","asc")),n=(0,l.aQ)(r,e=>{const t=e.docs.map(e=>(0,s.A)({id:e.id},e.data()));f(t)});return()=>n()},[t,a,i,o]);const w=e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},x=e=>{if(!e)return"";const[t,r]=e.split(":"),n=parseInt(t),a=n>=12?"PM":"AM";return"".concat(0===n?12:n>12?n-12:n,":").concat(r," ").concat(a)};return(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md border border-green-100 p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Upcoming Events"}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:[h.length," scheduled"]})]}),(0,bt.jsxs)("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[(0,bt.jsx)(tt,{className:"w-4 h-4"}),"Create Event"]})]}),0===h.length?(0,bt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,bt.jsx)(Nm,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,bt.jsx)("p",{className:"mb-2",children:"No upcoming events"}),(0,bt.jsx)("p",{className:"text-sm",children:"Create an event to get started!"})]}):(0,bt.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,bt.jsx)(Wm,{event:e,circleMembers:d,currentMemberId:c,onEdit:()=>{b(e),v(!0)},onDelete:()=>(async e=>{if(confirm("Are you sure you want to delete this event?"))try{await(0,l.kd)((0,l.H9)(t,"stakes",a,"wards",i,"circles",o,"events",e))}catch(r){console.error("Error deleting event:",r),alert("Error deleting event. Please try again.")}})(e.id),formatEventDate:w,formatEventTime:x},e.id))}),m&&(0,bt.jsx)(Gm,{db:t,storage:r,stakeId:a,wardId:i,circleId:o,currentMemberId:c,currentMemberName:u,onClose:()=>p(!1)}),g&&y&&(0,bt.jsx)(Km,{db:t,storage:r,stakeId:a,wardId:i,circleId:o,event:y,onClose:()=>{v(!1),b(null)}})]})}function Wm(e){let{event:t,circleMembers:r,currentMemberId:n,onEdit:a,onDelete:s,formatEventDate:i,formatEventTime:o}=e;const l=r.find(e=>e.id===t.organizerId),c=t.organizerId===n;return(0,bt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[t.imageUrl&&(0,bt.jsx)("img",{src:t.imageUrl,alt:t.title,className:"w-full h-48 object-cover rounded-lg mb-4"}),(0,bt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:t.title}),t.description&&(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:t.description})]}),c&&(0,bt.jsxs)("div",{className:"flex gap-1",children:[(0,bt.jsx)("button",{onClick:a,className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",children:(0,bt.jsx)(ct,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:s,className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",children:(0,bt.jsx)(et,{className:"w-4 h-4"})})]})]}),(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,bt.jsx)(Nm,{className:"w-4 h-4 text-green-500"}),(0,bt.jsx)("span",{children:i(t.eventDate)})]}),t.eventTime&&(0,bt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,bt.jsx)(Vm,{className:"w-4 h-4 text-green-500"}),(0,bt.jsx)("span",{children:o(t.eventTime)})]}),t.location&&(0,bt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,bt.jsx)(Sm,{className:"w-4 h-4 text-green-500"}),(0,bt.jsx)("span",{children:t.location})]}),l&&(0,bt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 mt-3 pt-3 border-t",children:[(0,bt.jsx)(rt,{className:"w-4 h-4"}),(0,bt.jsxs)("span",{children:["Organized by ",l.fullName]})]})]})]})}function Gm(e){let{db:t,storage:r,stakeId:a,wardId:i,circleId:o,currentMemberId:c,currentMemberName:u,onClose:d}=e;const[h,f]=(0,n.useState)({title:"",description:"",eventDate:"",eventTime:"",location:"",imageUrl:""}),[m,p]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1);return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,bt.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Create Event"}),(0,bt.jsx)("button",{onClick:d,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:(0,bt.jsx)(gt,{className:"w-5 h-5"})})]}),(0,bt.jsxs)("div",{className:"p-6 space-y-4",children:[h.imageUrl&&(0,bt.jsxs)("div",{className:"relative",children:[(0,bt.jsx)("img",{src:h.imageUrl,alt:"Event",className:"w-full h-48 object-cover rounded-lg"}),(0,bt.jsx)("button",{onClick:()=>f(e=>(0,s.A)((0,s.A)({},e),{},{imageUrl:""})),className:"absolute top-2 right-2 p-2 bg-white rounded-lg hover:bg-gray-100",children:(0,bt.jsx)(gt,{className:"w-4 h-4"})})]}),!h.imageUrl&&(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Image (Optional)"}),(0,bt.jsxs)("label",{className:"flex flex-col items-center justify-center gap-2 p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-green-400 cursor-pointer transition-colors",children:[(0,bt.jsx)(zm,{className:"w-8 h-8 text-gray-400"}),(0,bt.jsx)("span",{className:"text-sm text-gray-600",children:"Click to upload image"}),(0,bt.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files[0];if(t)if(t.type.startsWith("image/"))if(t.size>5242880)alert("Image must be less than 5MB");else{p(!0);try{const e=Date.now(),n="".concat(e,"_").concat(t.name),a=Ae(r,"circles/".concat(o,"/events/").concat(n));await _e(a,t);const i=await Ce(a);f(e=>(0,s.A)((0,s.A)({},e),{},{imageUrl:i}))}catch(n){console.error("Error uploading image:",n),alert("Error uploading image. Please try again.")}finally{p(!1)}}else alert("Please upload an image file")},className:"hidden",disabled:m})]}),m&&(0,bt.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Uploading..."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Title *"}),(0,bt.jsx)("input",{type:"text",value:h.title,onChange:e=>f(t=>(0,s.A)((0,s.A)({},t),{},{title:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Game Night"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,bt.jsx)("textarea",{value:h.description,onChange:e=>f(t=>(0,s.A)((0,s.A)({},t),{},{description:e.target.value})),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",placeholder:"Tell us about the event..."})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),(0,bt.jsx)("input",{type:"date",value:h.eventDate,onChange:e=>f(t=>(0,s.A)((0,s.A)({},t),{},{eventDate:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:(new Date).toISOString().split("T")[0]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time"}),(0,bt.jsx)("input",{type:"time",value:h.eventTime,onChange:e=>f(t=>(0,s.A)((0,s.A)({},t),{},{eventTime:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,bt.jsx)("input",{type:"text",value:h.location,onChange:e=>f(t=>(0,s.A)((0,s.A)({},t),{},{location:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Smith's Home or 123 Main St"})]})]}),(0,bt.jsxs)("div",{className:"p-6 border-t border-gray-200 flex justify-end gap-3",children:[(0,bt.jsx)("button",{onClick:d,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsx)("button",{onClick:async()=>{if(h.title.trim()&&h.eventDate){v(!0);try{const e=h.eventTime?"".concat(h.eventDate,"T").concat(h.eventTime,":00"):"".concat(h.eventDate,"T00:00:00");await(0,l.gS)((0,l.collection)(t,"stakes",a,"wards",i,"circles",o,"events"),(0,s.A)((0,s.A)({},h),{},{eventDate:e,organizerId:c,organizerName:u,createdAt:(0,l.O5)()})),d()}catch(e){console.error("Error creating event:",e),alert("Error creating event. Please try again.")}finally{v(!1)}}else alert("Please fill in title and date")},disabled:g||m||!h.title.trim()||!h.eventDate,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50",children:g?"Creating...":"Create Event"})]})]})})}function Km(e){let{db:t,stakeId:r,wardId:a,circleId:i,event:o,onClose:c}=e;const[u,d]=(0,n.useState)({title:o.title||"",description:o.description||"",eventDate:o.eventDate?o.eventDate.split("T")[0]:"",eventTime:o.eventTime||"",location:o.location||""}),[h,f]=(0,n.useState)(!1);return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,bt.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Edit Event"}),(0,bt.jsx)("button",{onClick:c,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:(0,bt.jsx)(gt,{className:"w-5 h-5"})})]}),(0,bt.jsxs)("div",{className:"p-6 space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Title *"}),(0,bt.jsx)("input",{type:"text",value:u.title,onChange:e=>d(t=>(0,s.A)((0,s.A)({},t),{},{title:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,bt.jsx)("textarea",{value:u.description,onChange:e=>d(t=>(0,s.A)((0,s.A)({},t),{},{description:e.target.value})),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),(0,bt.jsx)("input",{type:"date",value:u.eventDate,onChange:e=>d(t=>(0,s.A)((0,s.A)({},t),{},{eventDate:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:(new Date).toISOString().split("T")[0]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time"}),(0,bt.jsx)("input",{type:"time",value:u.eventTime,onChange:e=>d(t=>(0,s.A)((0,s.A)({},t),{},{eventTime:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,bt.jsx)("input",{type:"text",value:u.location,onChange:e=>d(t=>(0,s.A)((0,s.A)({},t),{},{location:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),(0,bt.jsxs)("div",{className:"p-6 border-t border-gray-200 flex justify-end gap-3",children:[(0,bt.jsx)("button",{onClick:c,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsx)("button",{onClick:async()=>{if(u.title.trim()&&u.eventDate){f(!0);try{const e=u.eventTime?"".concat(u.eventDate,"T").concat(u.eventTime,":00"):"".concat(u.eventDate,"T00:00:00");await(0,l.mZ)((0,l.H9)(t,"stakes",r,"wards",a,"circles",i,"events",o.id),(0,s.A)((0,s.A)({},u),{},{eventDate:e,updatedAt:(0,l.O5)()})),c()}catch(e){console.error("Error updating event:",e),alert("Error updating event. Please try again.")}finally{f(!1)}}else alert("Please fill in title and date")},disabled:h||!u.title.trim()||!u.eventDate,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50",children:h?"Updating...":"Update Event"})]})]})})}function qm(e){let{user:t,userData:r,auth:a,db:i,storage:c,isAdmin:u=!1,onSwitchToAdmin:d}=e;const[h,f]=(0,n.useState)("circle"),[m,p]=(0,n.useState)(null),[g,v]=(0,n.useState)([]),[y,b]=(0,n.useState)([]),[w,x]=(0,n.useState)([]),[E,T]=(0,n.useState)(!0),[k,N]=(0,n.useState)(null),[S,_]=(0,n.useState)(!1),[C,A]=(0,n.useState)(!1),[I,R]=(0,n.useState)(null);console.log("MemberDashboard - isAdmin:",u),console.log("MemberDashboard - onSwitchToAdmin:",d),console.log("MemberDashboard - userRole:",null===r||void 0===r?void 0:r.role),(0,n.useEffect)(()=>{O()},[]);const O=async()=>{try{if(T(!0),console.log("=== MEMBER DASHBOARD DEBUG START ==="),console.log("User email:",t.email),console.log("User UID:",t.uid),console.log("userData:",r),console.log("userData.stakeId:",r.stakeId),console.log("userData.wardId:",r.wardId),!r.wardId){console.log("No wardId found for user. Searching all wards for member profile...");const n=await(0,l.getDocs)((0,l.collection)(i,"stakes",r.stakeId,"wards"));console.log("Total wards found:",n.size);for(const a of n.docs){console.log("Searching ward: ".concat(a.id," (").concat(a.data().name,")"));const n=(0,l.query)((0,l.collection)(i,"stakes",r.stakeId,"wards",a.id,"members"),(0,l.where)("email","==",t.email)),s=await(0,l.getDocs)(n);if(console.log("  Members found with email ".concat(t.email,":"),s.size),!s.empty){const n=s.docs[0];console.log("  FOUND MEMBER!",n.id,n.data()),r.wardId=a.id,console.log("Found member profile in ward: ".concat(a.id,", updating user document..."));try{const e=(0,l.H9)(i,"users",t.uid);await(0,l.mZ)(e,{wardId:a.id,memberWardId:a.id,updatedAt:(new Date).toISOString()}),console.log("User document updated successfully")}catch(e){console.error("Error updating user document:",e)}break}}if(!r.wardId)return console.log("Member profile not found in any ward."),console.log("=== MEMBER DASHBOARD DEBUG END (NO WARD) ==="),void T(!1)}console.log("Using wardId:",r.wardId);const n=(0,l.query)((0,l.collection)(i,"stakes",r.stakeId,"wards",r.wardId,"members"),(0,l.where)("email","==",t.email)),a=await(0,l.getDocs)(n);if(console.log("Member profile search results:",a.size),a.empty)return console.error("Member profile not found in ward:",r.wardId),console.log("=== MEMBER DASHBOARD DEBUG END (NO MEMBER) ==="),void T(!1);const o=a.docs[0],c=(0,s.A)({id:o.id},o.data());console.log("Member profile loaded:",o.id,c),R(c);const u=(0,l.query)((0,l.collection)(i,"stakes",r.stakeId,"wards",r.wardId,"circles")),d=await(0,l.getDocs)(u);console.log("Total circles in ward:",d.size);let h=null;if(d.docs.forEach(e=>{const t=e.data();console.log('Circle "'.concat(t.name,'" (').concat(e.id,"):"),t.memberIds),console.log("  Does it include member ".concat(o.id,"?"),(t.memberIds||[]).includes(o.id)),(t.memberIds||[]).includes(o.id)&&(h=(0,s.A)({id:e.id},t),console.log("  \u2713 FOUND MY CIRCLE!"))}),!h)return console.log("\u274c Member not assigned to any circle yet"),console.log("Member ID:",o.id),console.log("All circles checked, none contain this member ID"),console.log("=== MEMBER DASHBOARD DEBUG END (NO CIRCLE) ==="),void T(!1);console.log("\u2713 Circle found:",h.name),console.log("=== MEMBER DASHBOARD DEBUG END (SUCCESS) ==="),p(h);const f=(0,l.query)((0,l.collection)(i,"stakes",r.stakeId,"wards",r.wardId,"members")),m=await(0,l.getDocs)(f),g=m.docs.map(e=>(0,s.A)({id:e.id},e.data())).filter(e=>(h.memberIds||[]).includes(e.id));v(g);const y=(0,l.query)((0,l.collection)(i,"stakes",r.stakeId,"wards",r.wardId,"circles",h.id,"chats"),(0,l.My)("createdAt","desc"),(0,l.AB)(5)),w=await(0,l.getDocs)(y);b(w.docs.map(e=>(0,s.A)({id:e.id},e.data())));const E=(new Date).toISOString(),k=(0,l.query)((0,l.collection)(i,"stakes",r.stakeId,"wards",r.wardId,"circles",h.id,"events"),(0,l.where)("eventDate",">=",E),(0,l.My)("eventDate","asc"),(0,l.AB)(5)),N=await(0,l.getDocs)(k);x(N.docs.map(e=>(0,s.A)({id:e.id},e.data())))}catch(n){console.error("Error loading dashboard:",n)}finally{T(!1)}},D=async()=>{await(0,o.CI)(a)};return E?(0,bt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50 flex items-center justify-center",children:(0,bt.jsxs)("div",{className:"text-rose-600 flex items-center gap-2",children:[(0,bt.jsx)(Je,{className:"animate-pulse"}),(0,bt.jsx)("span",{className:"text-lg",children:"Loading your circle..."})]})}):r.wardId?m?(0,bt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50",children:[(0,bt.jsx)("header",{className:"bg-white shadow-sm border-b border-rose-100",children:(0,bt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(Je,{className:"w-8 h-8 text-rose-500"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"My Stake Friends"}),(0,bt.jsx)("p",{className:"text-sm text-gray-500",children:m.name})]})]}),(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[u&&d&&(0,bt.jsxs)("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border border-purple-200",children:[(0,bt.jsx)(rt,{className:"w-4 h-4"}),"Back to Admin"]}),(0,bt.jsxs)("button",{onClick:()=>A(!0),className:"flex items-center gap-2 px-4 py-2 text-rose-600 hover:bg-rose-50 rounded-lg transition-colors border border-rose-200",children:[(0,bt.jsx)(ct,{className:"w-4 h-4"}),"My Profile"]}),(0,bt.jsxs)("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,bt.jsx)(at,{className:"w-4 h-4"}),"Sign Out"]})]})]})})}),(0,bt.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,bt.jsxs)("button",{onClick:()=>f("circle"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("circle"===h?"bg-rose-500 border-rose-600 text-white":"bg-white border-rose-100 text-gray-800 hover:border-rose-300"),children:[(0,bt.jsx)(rt,{className:"w-12 h-12 mx-auto mb-3 ".concat("circle"===h?"text-white":"text-rose-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"My Circle"}),(0,bt.jsxs)("p",{className:"text-sm ".concat("circle"===h?"text-rose-100":"text-gray-600"),children:[g.length," members"]})]}),(0,bt.jsxs)("button",{onClick:()=>f("chat"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("chat"===h?"bg-blue-500 border-blue-600 text-white":"bg-white border-blue-100 text-gray-800 hover:border-blue-300"),children:[(0,bt.jsx)(km,{className:"w-12 h-12 mx-auto mb-3 ".concat("chat"===h?"text-white":"text-blue-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Chat"}),(0,bt.jsxs)("p",{className:"text-sm ".concat("chat"===h?"text-blue-100":"text-gray-600"),children:[y.length," recent"]})]}),(0,bt.jsxs)("button",{onClick:()=>f("events"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("events"===h?"bg-green-500 border-green-600 text-white":"bg-white border-green-100 text-gray-800 hover:border-green-300"),children:[(0,bt.jsx)(Nm,{className:"w-12 h-12 mx-auto mb-3 ".concat("events"===h?"text-white":"text-green-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Events"}),(0,bt.jsxs)("p",{className:"text-sm ".concat("events"===h?"text-green-100":"text-gray-600"),children:[w.length," upcoming"]})]})]}),"circle"===h&&(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md border border-rose-100 p-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Circle Members"}),(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(e=>(0,bt.jsxs)("button",{onClick:()=>{N(e),_(!0)},className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all text-left hover:border-rose-300",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[e.profilePicUrl?(0,bt.jsx)("img",{src:e.profilePicUrl,alt:e.fullName,className:"w-16 h-16 rounded-full object-cover border-2 border-rose-200"}):(0,bt.jsx)("div",{className:"w-16 h-16 rounded-full bg-rose-100 flex items-center justify-center border-2 border-rose-200",children:(0,bt.jsx)(lt,{className:"w-8 h-8 text-rose-400"})}),(0,bt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,bt.jsx)("h3",{className:"font-semibold text-gray-800 truncate",children:e.fullName}),e.preferredName&&e.preferredName!==e.fullName&&(0,bt.jsxs)("p",{className:"text-sm text-gray-500 italic truncate",children:['"',e.preferredName,'"']})]})]}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.aboutMe||"Click to view profile"})]},e.id))})]}),"chat"===h&&(0,bt.jsx)(Bm,{db:i,storage:c,stakeId:r.stakeId,wardId:r.wardId,circleId:m.id,currentMemberId:I.id,currentMemberName:I.fullName,circleMembers:g}),"events"===h&&(0,bt.jsx)(Hm,{db:i,storage:c,stakeId:r.stakeId,wardId:r.wardId,circleId:m.id,currentMemberId:I.id,currentMemberName:I.fullName,circleMembers:g})]}),S&&k&&(0,bt.jsx)(Mm,{member:k,onClose:()=>{_(!1),N(null)}}),C&&I&&(0,bt.jsx)(Fm,{member:I,stakeId:r.stakeId,wardId:r.wardId,db:i,storage:c,onClose:()=>A(!1),onSave:()=>{A(!1),O()}})]}):(0,bt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50",children:[(0,bt.jsx)("header",{className:"bg-white shadow-sm border-b border-rose-100",children:(0,bt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(Je,{className:"w-8 h-8 text-rose-500"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"My Stake Friends"}),(0,bt.jsxs)("p",{className:"text-sm text-gray-500",children:["Welcome, ",(null===I||void 0===I?void 0:I.fullName)||t.email]})]})]}),(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[u&&d&&(0,bt.jsxs)("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border border-purple-200",children:[(0,bt.jsx)(rt,{className:"w-4 h-4"}),"Back to Admin"]}),(0,bt.jsxs)("button",{onClick:()=>A(!0),className:"flex items-center gap-2 px-4 py-2 text-rose-600 hover:bg-rose-50 rounded-lg transition-colors border border-rose-200",children:[(0,bt.jsx)(ct,{className:"w-4 h-4"}),"My Profile"]}),(0,bt.jsxs)("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,bt.jsx)(at,{className:"w-4 h-4"}),"Sign Out"]})]})]})})}),(0,bt.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8 text-center",children:[(0,bt.jsx)(rt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Not in a Circle Yet"}),(0,bt.jsx)("p",{className:"text-gray-600 mb-6",children:"You haven't been assigned to a friendship circle yet. Please contact your ward administrator."}),(0,bt.jsxs)("button",{onClick:()=>A(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors",children:[(0,bt.jsx)(ct,{className:"w-5 h-5"}),"Complete Your Profile"]}),(0,bt.jsx)("p",{className:"text-sm text-gray-500 mt-4",children:"Get your profile ready so your circle members can get to know you!"})]})}),C&&I&&(0,bt.jsx)(Fm,{member:I,stakeId:r.stakeId,wardId:r.wardId,db:i,storage:c,onClose:()=>A(!1),onSave:()=>{A(!1),O()}})]}):(0,bt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50",children:[(0,bt.jsx)("header",{className:"bg-white shadow-sm border-b border-rose-100",children:(0,bt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(Je,{className:"w-8 h-8 text-rose-500"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"My Stake Friends"}),(0,bt.jsxs)("p",{className:"text-sm text-gray-500",children:["Welcome, ",t.email]})]})]}),(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[u&&d&&(0,bt.jsxs)("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border border-purple-200",children:[(0,bt.jsx)(rt,{className:"w-4 h-4"}),"Back to Admin"]}),(0,bt.jsxs)("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,bt.jsx)(at,{className:"w-4 h-4"}),"Sign Out"]})]})]})})}),(0,bt.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8 text-center",children:[(0,bt.jsx)(rt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Not Set Up as a Member Yet"}),(0,bt.jsx)("p",{className:"text-gray-600 mb-4",children:"To view your member dashboard, you need to be added as a member to a specific ward first."}),(0,bt.jsxs)("p",{className:"text-sm text-gray-500",children:["As a ","stakeAdmin"===r.role?"Stake":"Ward"," Administrator, you can switch back to your admin view using the button above, or ask another administrator to add you as a member to a ward so you can participate in a circle."]})]})})]})}function Xm(e){let{stakeId:t,wardId:a,wards:i,db:o,onClose:c,onSave:u}=e;const[d,h]=(0,n.useState)({fullName:"",email:"",phone:"",selectedWardId:a||""}),[f,m]=(0,n.useState)(!1),[p,g]=(0,n.useState)(""),v=(e,t)=>{h(r=>(0,s.A)((0,s.A)({},r),{},{[e]:t})),g("")};return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Quick Add Member"}),(0,bt.jsx)("button",{onClick:c,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:(0,bt.jsx)(gt,{className:"w-5 h-5"})})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Full Name ",(0,bt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,bt.jsx)("input",{type:"text",value:d.fullName,onChange:e=>v("fullName",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"John Doe",autoFocus:!0})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",(0,bt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,bt.jsx)("input",{type:"email",value:d.email,onChange:e=>v("email",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"john.doe@example.com"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,bt.jsx)("input",{type:"tel",value:d.phone,onChange:e=>v("phone",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"(555) 123-4567"})]}),i&&i.length>0&&(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ward ",(0,bt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,bt.jsxs)("select",{value:d.selectedWardId,onChange:e=>v("selectedWardId",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"",children:"Select a ward..."}),i.map(e=>(0,bt.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),p&&(0,bt.jsx)("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm",children:p}),(0,bt.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,bt.jsx)("p",{className:"text-sm text-blue-800",children:"\ud83d\udcdd The member can complete their profile after accepting their invitation and logging in."})})]}),(0,bt.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,bt.jsx)("button",{onClick:c,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsxs)("button",{onClick:async()=>{if(!d.fullName.trim())return void g("Full name is required");if(!d.email.trim())return void g("Email is required");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email))if(i&&i.length>0&&!d.selectedWardId)g("Please select a ward");else{m(!0),g("");try{const e=d.selectedWardId||a,n=d.email.trim().toLowerCase(),{getAuth:s}=await Promise.resolve().then(r.bind(r,786)),{collection:i,query:c,where:h,getDocs:f}=await Promise.resolve().then(r.bind(r,472)),m=(s(),c(i(o,"users"),h("email","==",n))),p=await f(m);let g=null,v=null;if(!p.empty){const e=p.docs[0];g=e.id,v=e.data()}const y={fullName:d.fullName.trim(),email:n,phone:d.phone.trim(),hasLoggedIn:v&&v.hasLoggedIn||!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};g&&(y.userId=g),await(0,l.gS)((0,l.collection)(o,"stakes",t,"wards",e,"members"),y),u()}catch(e){console.error("Error adding member:",e),g("Failed to add member. Please try again."),m(!1)}}else g("Please enter a valid email address")},disabled:f,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50",children:[(0,bt.jsx)(nt,{className:"w-4 h-4"}),f?"Adding...":"Add Member"]})]})]})})}const $m=["sri"],Ym=["page"],Qm=["page","matches"],Jm=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Zm=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],ep=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var tp="popstate";function rp(){return cp(function(e,t){let{pathname:r,search:n,hash:a}=e.location;return ip("",{pathname:r,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:op(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function np(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function ap(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Iv){}}}function sp(e,t){return{usr:e.state,key:e.key,idx:t}}function ip(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return(0,s.A)((0,s.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?lp(t):t),{},{state:r,key:t&&t.key||n||Math.random().toString(36).substring(2,10)})}function op(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function lp(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function cp(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,l="POP",c=null,u=d();function d(){return(o.state||{idx:null}).idx}function h(){l="POP";let e=d(),t=null==e?null:e-u;u=e,c&&c({action:l,location:m.location,delta:t})}function f(e){return up(e)}null==u&&(u=0,o.replaceState((0,s.A)((0,s.A)({},o.state),{},{idx:u}),""));let m={get action(){return l},get location(){return e(a,o)},listen(e){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(tp,h),c=e,()=>{a.removeEventListener(tp,h),c=null}},createHref:e=>t(a,e),createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let n=ip(m.location,e,t);r&&r(n,e),u=d()+1;let s=sp(n,u),h=m.createHref(n);try{o.pushState(s,"",h)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;a.location.assign(h)}i&&c&&c({action:l,location:m.location,delta:1})},replace:function(e,t){l="REPLACE";let n=ip(m.location,e,t);r&&r(n,e),u=d();let a=sp(n,u),s=m.createHref(n);o.replaceState(a,"",s),i&&c&&c({action:l,location:m.location,delta:0})},go:e=>o.go(e)};return m}function up(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="http://localhost";"undefined"!==typeof window&&(r="null"!==window.location.origin?window.location.origin:window.location.href),np(r,"No window.location.(origin|href) available to create URL");let n="string"===typeof e?e:op(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}new WeakMap;function dp(e,t){return hp(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function hp(e,t,r,n){let a=_p(("string"===typeof t?lp(t):t).pathname||"/",r);if(null==a)return null;let s=fp(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=Sp(a);i=Tp(s[o],e,n)}return i}function fp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(n)&&i)return;np(l.relativePath.startsWith(n),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(n,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(n.length)}let c=Op([n,l.relativePath]),u=r.concat(l);e.children&&e.children.length>0&&(np(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),fp(e.children,t,u,c,i)),(null!=e.path||e.index)&&t.push({path:c,score:Ep(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!==(r=e.path)&&void 0!==r&&r.includes("?"))for(let n of mp(e.path))s(e,t,!0,n);else s(e,t)}),t}function mp(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===n.length)return a?[s,""]:[s];let i=mp(n.join("/")),o=[];return o.push(...i.map(e=>""===e?s:[s,e].join("/"))),a&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var pp=/^:[\w-]+$/,gp=3,vp=2,yp=1,bp=10,wp=-2,xp=e=>"*"===e;function Ep(e,t){let r=e.split("/"),n=r.length;return r.some(xp)&&(n+=wp),t&&(n+=vp),r.filter(e=>!xp(e)).reduce((e,t)=>e+(pp.test(t)?gp:""===t?yp:bp),n)}function Tp(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let e=n[o],l=o===n.length-1,c="/"===s?t:t.slice(s.length)||"/",u=kp({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&r&&!n[n.length-1].route.index&&(u=kp({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),i.push({params:a,pathname:Op([s,u.pathname]),pathnameBase:Dp(Op([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=Op([s,u.pathnameBase]))}return i}function kp(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Np(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((e,t,r)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=o[r]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[r];return e[n]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:i,pattern:e}}function Np(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ap("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Sp(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return ap(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function _p(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function Cp(e,t,r,n){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(n),"].  Please separate it out to the `to.").concat(r,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function Ap(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function Ip(e){let t=Ap(e);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function Rp(e,t,r){let n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?n=lp(e):(n=(0,s.A)({},e),np(!n.pathname||!n.pathname.includes("?"),Cp("?","pathname","search",n)),np(!n.pathname||!n.pathname.includes("#"),Cp("#","pathname","hash",n)),np(!n.search||!n.search.includes("#"),Cp("#","search","hash",n)));let i,o=""===e||""===n.pathname,l=o?"/":n.pathname;if(null==l)i=r;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:r,search:n="",hash:a=""}="string"===typeof e?lp(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:jp(n),hash:Pp(a)}}(n,i),u=l&&"/"!==l&&l.endsWith("/"),d=(o||"."===l)&&r.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}var Op=e=>e.join("/").replace(/\/\/+/g,"/"),Dp=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),jp=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Pp=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Mp(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Lp=["POST","PUT","PATCH","DELETE"],Fp=(new Set(Lp),["GET",...Lp]);new Set(Fp),Symbol("ResetLoaderData");var Up=n.createContext(null);Up.displayName="DataRouter";var Bp=n.createContext(null);Bp.displayName="DataRouterState";var Vp=n.createContext(!1);var zp=n.createContext({isTransitioning:!1});zp.displayName="ViewTransition";var Hp=n.createContext(new Map);Hp.displayName="Fetchers";var Wp=n.createContext(null);Wp.displayName="Await";var Gp=n.createContext(null);Gp.displayName="Navigation";var Kp=n.createContext(null);Kp.displayName="Location";var qp=n.createContext({outlet:null,matches:[],isDataRoute:!1});qp.displayName="Route";var Xp=n.createContext(null);Xp.displayName="RouteError";function $p(){return null!=n.useContext(Kp)}function Yp(){return np($p(),"useLocation() may be used only in the context of a <Router> component."),n.useContext(Kp).location}var Qp="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Jp(e){n.useContext(Gp).static||n.useLayoutEffect(e)}function Zp(){let{isDataRoute:e}=n.useContext(qp);return e?function(){let{router:e}=lg("useNavigate"),t=ug("useNavigate"),r=n.useRef(!1);Jp(()=>{r.current=!0});let a=n.useCallback(async function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ap(r.current,Qp),r.current&&("number"===typeof n?e.navigate(n):await e.navigate(n,(0,s.A)({fromRouteId:t},a)))},[e,t]);return a}():function(){np($p(),"useNavigate() may be used only in the context of a <Router> component.");let e=n.useContext(Up),{basename:t,navigator:r}=n.useContext(Gp),{matches:a}=n.useContext(qp),{pathname:s}=Yp(),i=JSON.stringify(Ip(a)),o=n.useRef(!1);Jp(()=>{o.current=!0});let l=n.useCallback(function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ap(o.current,Qp),!o.current)return;if("number"===typeof n)return void r.go(n);let l=Rp(n,JSON.parse(i),s,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:Op([t,l.pathname])),(a.replace?r.replace:r.push)(l,a.state,a)},[t,r,i,s,e]);return l}()}n.createContext(null);function eg(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:r}=n.useContext(qp),{pathname:a}=Yp(),s=JSON.stringify(Ip(r));return n.useMemo(()=>Rp(e,JSON.parse(s),a,"path"===t),[e,s,a,t])}function tg(e,t,r,a,i){np($p(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=n.useContext(Gp),{matches:l}=n.useContext(qp),c=l[l.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",f=c&&c.route;{let e=f&&f.path||"";fg(d,!f||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let m,p=Yp();if(t){var g;let e="string"===typeof t?lp(t):t;np("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),m=e}else m=p;let v=m.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=dp(e,{pathname:y});ap(f||null!=b,'No routes matched location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" ')),ap(null==b||void 0!==b[b.length-1].route.element||void 0!==b[b.length-1].route.Component||void 0!==b[b.length-1].route.lazy,'Matched leaf route at location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let w=ig(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:Op([h,o.encodeLocation?o.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:Op([h,o.encodeLocation?o.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),l,r,a,i);return t&&w?n.createElement(Kp.Provider,{value:{location:(0,s.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:"POP"}},w):w}function rg(){let e=dg(),t=Mp(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:a},i={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=n.createElement(n.Fragment,null,n.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),n.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",n.createElement("code",{style:i},"ErrorBoundary")," or"," ",n.createElement("code",{style:i},"errorElement")," prop on your route.")),n.createElement(n.Fragment,null,n.createElement("h2",null,"Unexpected Application Error!"),n.createElement("h3",{style:{fontStyle:"italic"}},t),r?n.createElement("pre",{style:s},r):null,o)}var ng=n.createElement(rg,null),ag=class extends n.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?n.createElement(qp.Provider,{value:this.props.routeContext},n.createElement(Xp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function sg(e){let{routeContext:t,match:r,children:a}=e,s=n.useContext(Up);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),n.createElement(qp.Provider,{value:t},a)}function ig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!r)return null;if(r.errors)e=r.matches;else{if(0!==t.length||r.initialized||!(r.matches.length>0))return null;e=r.matches}}let s=e,i=null===r||void 0===r?void 0:r.errors;if(null!=i){let e=s.findIndex(e=>e.route.id&&void 0!==(null===i||void 0===i?void 0:i[e.route.id]));np(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(i).join(","))),s=s.slice(0,Math.min(s.length,e+1))}let o=!1,l=-1;if(r)for(let n=0;n<s.length;n++){let e=s[n];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=n),e.route.id){let{loaderData:t,errors:n}=r,a=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){o=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}return s.reduceRight((e,c,u)=>{let d,h=!1,f=null,m=null;r&&(d=i&&c.route.id?i[c.route.id]:void 0,f=c.route.errorElement||ng,o&&(l<0&&0===u?(fg("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,m=null):l===u&&(h=!0,m=c.route.hydrateFallbackElement||null)));let p=t.concat(s.slice(0,u+1)),g=()=>{let t;return t=d?f:h?m:c.route.Component?n.createElement(c.route.Component,null):c.route.element?c.route.element:e,n.createElement(sg,{match:c,routeContext:{outlet:e,matches:p,isDataRoute:null!=r},children:t})};return r&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?n.createElement(ag,{location:r.location,revalidation:r.revalidation,component:f,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0},unstable_onError:a}):g()},null)}function og(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function lg(e){let t=n.useContext(Up);return np(t,og(e)),t}function cg(e){let t=n.useContext(Bp);return np(t,og(e)),t}function ug(e){let t=function(e){let t=n.useContext(qp);return np(t,og(e)),t}(e),r=t.matches[t.matches.length-1];return np(r.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),r.route.id}function dg(){var e;let t=n.useContext(Xp),r=cg("useRouteError"),a=ug("useRouteError");return void 0!==t?t:null===(e=r.errors)||void 0===e?void 0:e[a]}var hg={};function fg(e,t,r){t||hg[e]||(hg[e]=!0,ap(!1,r))}var mg={};function pg(e,t){e||mg[t]||(mg[t]=!0,console.warn(t))}n.memo(function(e){let{routes:t,future:r,state:n,unstable_onError:a}=e;return tg(t,void 0,n,a,r)});function gg(e){np(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function vg(e){let{basename:t="/",children:r=null,location:a,navigationType:s="POP",navigator:i,static:o=!1}=e;np(!$p(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=n.useMemo(()=>({basename:l,navigator:i,static:o,future:{}}),[l,i,o]);"string"===typeof a&&(a=lp(a));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:m="default"}=a,p=n.useMemo(()=>{let e=_p(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:f,key:m},navigationType:s}},[l,u,d,h,f,m,s]);return ap(null!=p,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==p?null:n.createElement(Gp.Provider,{value:c},n.createElement(Kp.Provider,{children:r,value:p}))}function yg(e){let{children:t,location:r}=e;return tg(bg(t),r)}n.Component;function bg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return n.Children.forEach(e,(e,a)=>{if(!n.isValidElement(e))return;let s=[...t,a];if(e.type===n.Fragment)return void r.push.apply(r,bg(e.props.children,s));np(e.type===gg,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),np(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=bg(e.props.children,s)),r.push(i)}),r}var wg="get",xg="application/x-www-form-urlencoded";function Eg(e){return null!=e&&"string"===typeof e.tagName}var Tg=null;var kg=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ng(e){return null==e||kg.has(e)?e:(ap(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(xg,'"')),null)}function Sg(e,t){let r,n,a,s,i;if(Eg(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");n=i?_p(i,t):null,r=e.getAttribute("method")||wg,a=Ng(e.getAttribute("enctype"))||xg,s=new FormData(e)}else if(function(e){return Eg(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Eg(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(n=o?_p(o,t):null,r=e.getAttribute("formmethod")||i.getAttribute("method")||wg,a=Ng(e.getAttribute("formenctype"))||Ng(i.getAttribute("enctype"))||xg,s=new FormData(i,e),!function(){if(null===Tg)try{new FormData(document.createElement("form"),0),Tg=!1}catch(Iv){Tg=!0}return Tg}()){let{name:t,type:r,value:n}=e;if("image"===r){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,n)}}else{if(Eg(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=wg,n=null,a=xg,i=e}var o;return s&&"text/plain"===a&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function _g(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Cg(e,t,r){let n="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.".concat(r):t&&"/"===_p(n.pathname,t)?n.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(r):n.pathname="".concat(n.pathname.replace(/\/$/,""),".").concat(r),n}async function Ag(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ig(e){return null!=e&&"string"===typeof e.page}function Rg(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Og(e,t,r,n,a,s){let i=(e,t)=>!r[t]||e.route.id!==r[t].route.id,o=(e,t)=>{var n;return r[t].pathname!==e.pathname||(null===(n=r[t].route.path)||void 0===n?void 0:n.endsWith("*"))&&r[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>i(e,t)||o(e,t)):"data"===s?t.filter((t,s)=>{let l=n.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var c;let n=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=r[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof n)return n}return!0}):[]}function Dg(e,t){let{includeHydrateFallback:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n=e.map(e=>{let n=t.routes[e.route.id];if(!n)return[];let a=[n.module];return n.clientActionModule&&(a=a.concat(n.clientActionModule)),n.clientLoaderModule&&(a=a.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(a=a.concat(n.hydrateFallbackModule)),n.imports&&(a=a.concat(n.imports)),a}).flat(1),[...new Set(n)];var n}function jg(e,t){let r=new Set,n=new Set(t);return e.reduce((e,a)=>{if(t&&!Ig(a)&&"script"===a.as&&a.href&&n.has(a.href))return e;let s=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}(a));return r.has(s)||(r.add(s),e.push({key:s,link:a})),e},[])}function Pg(e,t){return"lazy"===e.mode&&!0===t}function Mg(){let e=n.useContext(Up);return _g(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Lg(){let e=n.useContext(Bp);return _g(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Fg=n.createContext(void 0);function Ug(){let e=n.useContext(Fg);return _g(e,"You must render this element inside a <HydratedRouter> element"),e}function Bg(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Vg(e,t,r){if(r&&!Gg)return[e[0]];if(t){let r=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,r+1)}return e}Fg.displayName="FrameworkContext";function zg(e){let{page:t}=e,r=Xe(e,Ym),{router:a}=Mg(),i=n.useMemo(()=>dp(a.routes,t,a.basename),[a.routes,t,a.basename]);return i?n.createElement(Wg,(0,s.A)({page:t,matches:i},r)):null}function Hg(e){let{manifest:t,routeModules:r}=Ug(),[a,i]=n.useState([]);return n.useEffect(()=>{let n=!1;return async function(e,t,r){return jg((await Promise.all(e.map(async e=>{let n=t.routes[e.route.id];if(n){let e=await Ag(n,r);return e.links?e.links():[]}return[]}))).flat(1).filter(Rg).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?(0,s.A)((0,s.A)({},e),{},{rel:"prefetch",as:"style"}):(0,s.A)((0,s.A)({},e),{},{rel:"prefetch"})))}(e,t,r).then(e=>{n||i(e)}),()=>{n=!0}},[e,t,r]),a}function Wg(e){let{page:t,matches:r}=e,a=Xe(e,Qm),i=Yp(),{manifest:o,routeModules:l}=Ug(),{basename:c}=Mg(),{loaderData:u,matches:d}=Lg(),h=n.useMemo(()=>Og(t,r,d,o,i,"data"),[t,r,d,o,i]),f=n.useMemo(()=>Og(t,r,d,o,i,"assets"),[t,r,d,o,i]),m=n.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let e=new Set,n=!1;if(r.forEach(t=>{var r;let a=o.routes[t.route.id];a&&a.hasLoader&&(!h.some(e=>e.route.id===t.route.id)&&t.route.id in u&&null!==(r=l[t.route.id])&&void 0!==r&&r.shouldRevalidate||a.hasClientLoader?n=!0:e.add(t.route.id))}),0===e.size)return[];let a=Cg(t,c,"data");return n&&e.size>0&&a.searchParams.set("_routes",r.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[a.pathname+a.search]},[c,u,i,o,h,r,t,l]),p=n.useMemo(()=>Dg(f,o),[f,o]),g=Hg(f);return n.createElement(n.Fragment,null,m.map(e=>n.createElement("link",(0,s.A)({key:e,rel:"prefetch",as:"fetch",href:e},a))),p.map(e=>n.createElement("link",(0,s.A)({key:e,rel:"modulepreload",href:e},a))),g.map(e=>{let{key:t,link:r}=e;return n.createElement("link",(0,s.A)({key:t,nonce:a.nonce},r))}))}var Gg=!1;function Kg(e){let{manifest:t,serverHandoffString:r,isSpaMode:a,renderMeta:i,routeDiscovery:o,ssr:l}=Ug(),{router:c,static:u,staticContext:d}=Mg(),{matches:h}=Lg(),f=n.useContext(Vp),m=Pg(o,l);i&&(i.didRenderScripts=!0);let p=Vg(h,null,a);n.useEffect(()=>{Gg=!0},[]);let g=n.useMemo(()=>{var a;if(f)return null;let i=d?"window.__reactRouterContext = ".concat(r,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=u?"".concat(null!==(a=t.hmr)&&void 0!==a&&a.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(m?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(p.map((e,r)=>{let n="route".concat(r),a=t.routes[e.route.id];_g(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:i,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=a,u=[...s?[{module:s,varName:"".concat(n,"_clientAction")}]:[],...i?[{module:i,varName:"".concat(n,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(n,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(n,"_HydrateFallback")}]:[],{module:c,varName:"".concat(n,"_main")}];return 1===u.length?"import * as ".concat(n," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(n," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(m?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:r}=e,n=Xe(e,$m),a=new Set(t.state.matches.map(e=>e.route.id)),i=t.state.location.pathname.split("/").filter(Boolean),o=["/"];for(i.pop();i.length>0;)o.push("/".concat(i.join("/"))),i.pop();o.forEach(e=>{let r=dp(t.routes,e,t.basename);r&&r.forEach(e=>a.add(e.route.id))});let l=[...a].reduce((e,t)=>Object.assign(e,{[t]:n.routes[t]}),{});return(0,s.A)((0,s.A)({},n),{},{routes:l,sri:!!r||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(p.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return n.createElement(n.Fragment,null,n.createElement("script",(0,s.A)((0,s.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:i},type:void 0})),n.createElement("script",(0,s.A)((0,s.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),v=Gg||f?[]:(y=t.entry.imports.concat(Dg(p,t,{includeHydrateFallback:!0})),[...new Set(y)]);var y;let b="object"===typeof t.sri?t.sri:{};return pg(!f,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),Gg||f?null:n.createElement(n.Fragment,null,"object"===typeof t.sri?n.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:b})}}):null,m?null:n.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:b[t.url],suppressHydrationWarning:!0}),n.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:b[t.entry.module],suppressHydrationWarning:!0}),v.map(t=>n.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:b[t],suppressHydrationWarning:!0})),g)}function qg(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}n.Component;function Xg(e){let{error:t,isOutsideRemixApp:r}=e;console.error(t);let a,s=n.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Mp(t))return n.createElement($g,{title:"Unhandled Thrown Response!"},n.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),s);if(t instanceof Error)a=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);a=new Error(e)}return n.createElement($g,{title:"Application Error!",isOutsideRemixApp:r},n.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),n.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},a.stack),s)}function $g(e){var t;let{title:r,renderScripts:a,isOutsideRemixApp:s,children:i}=e,{routeModules:o}=Ug();return null!==(t=o.root)&&void 0!==t&&t.Layout&&!s?i:n.createElement("html",{lang:"en"},n.createElement("head",null,n.createElement("meta",{charSet:"utf-8"}),n.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),n.createElement("title",null,r)),n.createElement("body",null,n.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},i,a?n.createElement(Kg,null):null)))}var Yg="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{Yg&&(window.__reactRouterVersion="7.9.4")}catch(Iv){}function Qg(e){let{basename:t,children:r,window:a}=e,s=n.useRef();null==s.current&&(s.current=rp({window:a,v5Compat:!0}));let i=s.current,[o,l]=n.useState({action:i.action,location:i.location}),c=n.useCallback(e=>{n.startTransition(()=>l(e))},[l]);return n.useLayoutEffect(()=>i.listen(c),[i,c]),n.createElement(vg,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i})}var Jg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zg=n.forwardRef(function(e,t){let r,{onClick:a,discover:i="render",prefetch:o="none",relative:l,reloadDocument:c,replace:u,state:d,target:h,to:f,preventScrollReset:m,viewTransition:p}=e,g=Xe(e,Jm),{basename:v}=n.useContext(Gp),y="string"===typeof f&&Jg.test(f),b=!1;if("string"===typeof f&&y&&(r=f,Yg))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),r=_p(t.pathname,v);t.origin===e.origin&&null!=r?f=r+t.search+t.hash:b=!0}catch(Iv){ap(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let w=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};np($p(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=n.useContext(Gp),{hash:s,pathname:i,search:o}=eg(e,{relative:t}),l=i;return"/"!==r&&(l="/"===i?r:Op([r,i])),a.createHref({pathname:l,search:o,hash:s})}(f,{relative:l}),[x,E,T]=function(e,t){let r=n.useContext(Fg),[a,s]=n.useState(!1),[i,o]=n.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,f=n.useRef(null);n.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}},[e]),n.useEffect(()=>{if(a){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[a]);let m=()=>{s(!0)},p=()=>{s(!1),o(!1)};return r?"intent"!==e?[i,f,{}]:[i,f,{onFocus:Bg(l,m),onBlur:Bg(c,p),onMouseEnter:Bg(u,m),onMouseLeave:Bg(d,p),onTouchStart:Bg(h,m)}]:[!1,f,{}]}(o,g),k=function(e){let{target:t,replace:r,state:a,preventScrollReset:s,relative:i,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Zp(),c=Yp(),u=eg(e,{relative:i});return n.useCallback(n=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(n,t)){n.preventDefault();let t=void 0!==r?r:op(c)===op(u);l(e,{replace:t,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,u,r,a,t,e,s,i,o])}(f,{replace:u,state:d,target:h,preventScrollReset:m,relative:l,viewTransition:p});let N=n.createElement("a",(0,s.A)((0,s.A)((0,s.A)({},g),T),{},{href:r||w,onClick:b||c?a:function(e){a&&a(e),e.defaultPrevented||k(e)},ref:qg(t,E),target:h,"data-discover":y||"render"!==i?void 0:"true"}));return x&&!y?n.createElement(n.Fragment,null,N,n.createElement(zg,{page:w})):N});Zg.displayName="Link";var ev=n.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:a=!1,className:i="",end:o=!1,style:l,to:c,viewTransition:u,children:d}=e,h=Xe(e,Zm),f=eg(c,{relative:h.relative}),m=Yp(),p=n.useContext(Bp),{navigator:g,basename:v}=n.useContext(Gp),y=null!=p&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.useContext(zp);np(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=nv("useViewTransitionState"),s=eg(e,{relative:t});if(!r.isTransitioning)return!1;let i=_p(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=_p(r.nextLocation.pathname,a)||r.nextLocation.pathname;return null!=kp(s.pathname,o)||null!=kp(s.pathname,i)}(f)&&!0===u,b=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,w=m.pathname,x=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;a||(w=w.toLowerCase(),x=x?x.toLowerCase():null,b=b.toLowerCase()),x&&v&&(x=_p(x,v)||x);const E="/"!==b&&b.endsWith("/")?b.length-1:b.length;let T,k=w===b||!o&&w.startsWith(b)&&"/"===w.charAt(E),N=null!=x&&(x===b||!o&&x.startsWith(b)&&"/"===x.charAt(b.length)),S={isActive:k,isPending:N,isTransitioning:y},_=k?r:void 0;T="function"===typeof i?i(S):[i,k?"active":null,N?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let C="function"===typeof l?l(S):l;return n.createElement(Zg,(0,s.A)((0,s.A)({},h),{},{"aria-current":_,className:T,ref:t,style:C,to:c,viewTransition:u}),"function"===typeof d?d(S):d)});ev.displayName="NavLink";var tv=n.forwardRef((e,t)=>{let{discover:r="render",fetcherKey:a,navigate:i,reloadDocument:o,replace:l,state:c,method:u=wg,action:d,onSubmit:h,relative:f,preventScrollReset:m,viewTransition:p}=e,g=Xe(e,ep),v=iv(),y=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:r}=n.useContext(Gp),a=n.useContext(qp);np(a,"useFormAction must be used inside a RouteContext");let[i]=a.matches.slice(-1),o=(0,s.A)({},eg(e||".",{relative:t})),l=Yp();if(null==e){o.search=l.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let r=e.toString();o.search=r?"?".concat(r):""}}e&&"."!==e||!i.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==r&&(o.pathname="/"===o.pathname?r:Op([r,o.pathname]));return op(o)}(d,{relative:f}),b="get"===u.toLowerCase()?"get":"post",w="string"===typeof d&&Jg.test(d);return n.createElement("form",(0,s.A)((0,s.A)({ref:t,method:b,action:y,onSubmit:o?h:e=>{if(h&&h(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,r=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;v(t||e.currentTarget,{fetcherKey:a,method:r,navigate:i,replace:l,state:c,relative:f,preventScrollReset:m,viewTransition:p})}},g),{},{"data-discover":w||"render"!==r?void 0:"true"}))});function rv(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function nv(e){let t=n.useContext(Up);return np(t,rv(e)),t}tv.displayName="Form";var av=0,sv=()=>"__".concat(String(++av),"__");function iv(){let{router:e}=nv("useSubmit"),{basename:t}=n.useContext(Gp),r=ug("useRouteId");return n.useCallback(async function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:i,encType:o,formData:l,body:c}=Sg(n,t);if(!1===a.navigate){let t=a.fetcherKey||sv();await e.fetch(t,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}const ov=Qe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),lv=Qe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),cv=Qe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),uv=Qe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function dv(){return(0,bt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50",children:[(0,bt.jsx)("header",{className:"bg-white shadow-sm border-b border-rose-100",children:(0,bt.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(Je,{className:"w-8 h-8 text-rose-500"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"My Stake Friends"}),(0,bt.jsx)("p",{className:"text-sm text-gray-500",children:"Privacy Policy"})]})]})})}),(0,bt.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md border border-rose-100 p-8",children:[(0,bt.jsxs)("div",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(ov,{className:"w-6 h-6 text-rose-500"}),(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Privacy Policy"})]}),(0,bt.jsxs)("p",{className:"text-gray-600 mb-2",children:[(0,bt.jsx)("strong",{children:"Effective Date:"})," October 19, 2025"]}),(0,bt.jsx)("p",{className:"text-gray-600",children:'My Stake Friends ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our application.'})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(lv,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"1. Information We Collect"})]}),(0,bt.jsxs)("div",{className:"ml-7 space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Personal Information"}),(0,bt.jsx)("p",{className:"text-gray-600 mb-2",children:"We collect information that you voluntarily provide to us, including:"}),(0,bt.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1 ml-4",children:[(0,bt.jsx)("li",{children:"Full name"}),(0,bt.jsx)("li",{children:"Email address"}),(0,bt.jsx)("li",{children:"Phone number"}),(0,bt.jsx)("li",{children:"Physical address"}),(0,bt.jsx)("li",{children:"Date of birth"}),(0,bt.jsx)("li",{children:"Marital status"}),(0,bt.jsx)("li",{children:"Family information (number of children)"}),(0,bt.jsx)("li",{children:"Cultural background"}),(0,bt.jsx)("li",{children:"Profile pictures"}),(0,bt.jsx)("li",{children:"Interests and hobbies"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Account Information"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"When you create an account, we collect your email address and encrypted password. We also track login activity and account status."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Usage Information"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"We automatically collect certain information about your device and how you interact with our application, including access times and feature usage."})]})]})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(cv,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"2. How We Use Your Information"})]}),(0,bt.jsxs)("div",{className:"ml-7",children:[(0,bt.jsx)("p",{className:"text-gray-600 mb-2",children:"We use the collected information to:"}),(0,bt.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1 ml-4",children:[(0,bt.jsx)("li",{children:"Facilitate community connections within your religious organization"}),(0,bt.jsx)("li",{children:"Create and manage friendship circles"}),(0,bt.jsx)("li",{children:"Enable members to find and connect with others who share similar interests"}),(0,bt.jsx)("li",{children:"Send account-related notifications and invitations"}),(0,bt.jsx)("li",{children:"Provide administrative tools for stake and ward leaders"}),(0,bt.jsx)("li",{children:"Maintain and improve our application"}),(0,bt.jsx)("li",{children:"Ensure the security and integrity of our services"}),(0,bt.jsx)("li",{children:"Comply with legal obligations"})]})]})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(uv,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"3. Information Sharing and Disclosure"})]}),(0,bt.jsxs)("div",{className:"ml-7 space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Within Your Organization"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Your profile information is visible to other members within your stake and ward to facilitate meaningful connections. Administrators (stake and ward leaders) have access to member information for organizational purposes."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Service Providers"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"We use Firebase (Google Cloud Platform) to host our application and store data. These service providers are bound by confidentiality obligations and may only use your information to provide services to us."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Legal Requirements"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"We may disclose your information if required by law or in response to valid legal requests from public authorities."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"What We Don't Do"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"We do not sell, rent, or trade your personal information to third parties for marketing purposes."})]})]})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(ov,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"4. Data Security"})]}),(0,bt.jsxs)("div",{className:"ml-7",children:[(0,bt.jsx)("p",{className:"text-gray-600 mb-2",children:"We implement appropriate technical and organizational measures to protect your personal information, including:"}),(0,bt.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1 ml-4",children:[(0,bt.jsx)("li",{children:"Encryption of data in transit and at rest"}),(0,bt.jsx)("li",{children:"Secure authentication using Firebase Authentication"}),(0,bt.jsx)("li",{children:"Regular security assessments"}),(0,bt.jsx)("li",{children:"Access controls limiting who can view your information"})]}),(0,bt.jsx)("p",{className:"text-gray-600 mt-2",children:"However, no method of transmission over the internet or electronic storage is 100% secure. While we strive to protect your information, we cannot guarantee absolute security."})]})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(cv,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"5. Your Rights and Choices"})]}),(0,bt.jsxs)("div",{className:"ml-7",children:[(0,bt.jsx)("p",{className:"text-gray-600 mb-2",children:"You have the right to:"}),(0,bt.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1 ml-4",children:[(0,bt.jsx)("li",{children:"Access and update your personal information through your account settings"}),(0,bt.jsx)("li",{children:"Request deletion of your account and associated data"}),(0,bt.jsx)("li",{children:"Opt out of non-essential communications"}),(0,bt.jsx)("li",{children:"Request a copy of your data"}),(0,bt.jsx)("li",{children:"Withdraw consent where we rely on consent as our legal basis for processing"})]}),(0,bt.jsx)("p",{className:"text-gray-600 mt-2",children:"To exercise these rights, please contact your ward or stake administrator, or reach out to us directly at the contact information below."})]})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(lv,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"6. Data Retention"})]}),(0,bt.jsx)("div",{className:"ml-7",children:(0,bt.jsx)("p",{className:"text-gray-600",children:"We retain your personal information for as long as your account is active or as needed to provide you services. If you request account deletion, we will delete your information within 30 days, except where we are required to retain it for legal or legitimate business purposes."})})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(ov,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"7. Children's Privacy"})]}),(0,bt.jsx)("div",{className:"ml-7",children:(0,bt.jsx)("p",{className:"text-gray-600",children:"Our application is intended for use by adults (18 years and older). We do not knowingly collect personal information from children under 18. If we become aware that we have collected information from a child under 18, we will take steps to delete that information."})})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(cv,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"8. Changes to This Privacy Policy"})]}),(0,bt.jsx)("div",{className:"ml-7",children:(0,bt.jsx)("p",{className:"text-gray-600",children:'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Effective Date" at the top. You are advised to review this Privacy Policy periodically for any changes.'})})]}),(0,bt.jsxs)("section",{className:"mb-8",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,bt.jsx)(dt,{className:"w-5 h-5 text-rose-500"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"9. Contact Us"})]}),(0,bt.jsxs)("div",{className:"ml-7",children:[(0,bt.jsx)("p",{className:"text-gray-600 mb-4",children:"If you have any questions about this Privacy Policy or our data practices, please contact us at:"}),(0,bt.jsxs)("div",{className:"bg-rose-50 p-4 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-gray-800 font-medium",children:"My Stake Friends"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Email: privacy@mystakefriends.com"})]})]})]}),(0,bt.jsx)("div",{className:"border-t pt-6 mt-8",children:(0,bt.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"By using My Stake Friends, you acknowledge that you have read and understood this Privacy Policy and agree to its terms."})})]})}),(0,bt.jsx)("footer",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center text-sm text-gray-500",children:(0,bt.jsx)("p",{children:"\xa9 2025 My Stake Friends. All rights reserved."})})]})}const hv=(0,i.Wp)({apiKey:"AIzaSyBGm_Qvm3DjBSOtTUePB_jKIFtwY_kEHq0",authDomain:"mystakefriends.firebaseapp.com",projectId:"mystakefriends",storageBucket:"mystakefriends.firebasestorage.app",messagingSenderId:"18358580651",appId:"1:18358580651:web:0f8a9fbbe5850a3c880eee"}),fv=(0,o.getAuth)(hv),mv=(0,l.aU)(hv),pv=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)(),t=arguments.length>1?arguments[1]:void 0;e=(0,c.Ku)(e);const r=(0,i.j6)(e,Se).getImmediate({identifier:t}),n=(0,c.yU)("storage");return n&&function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(r),e._protocol="http";const{mockUserToken:a}=n;a&&(e._overrideAuthToken="string"===typeof a?a:(0,c.Fy)(a,e.app.options.projectId))}(e,t,r,n)}(r,...n),r}(hv),gv=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fe;const r=(0,i.j6)((0,c.Ku)(e),je).getImmediate({identifier:t}),n=(0,c.yU)("functions");return n&&function(e,t,r){!function(e,t,r){e.emulatorOrigin="http://".concat(t,":").concat(r)}((0,c.Ku)(e),t,r)}(r,...n),r}(hv);function vv(){const[e,t]=(0,n.useState)(null),[r,a]=(0,n.useState)(null),[s,i]=(0,n.useState)(null),[c,u]=(0,n.useState)(!0),[d,h]=(0,n.useState)("admin");return(0,n.useEffect)(()=>{const e=(0,o.hg)(fv,async e=>{if(e){t(e);const r=await(0,l.x7)((0,l.H9)(mv,"users",e.uid));if(r.exists()){const e=r.data();a(e.role),i(e)}}else t(null),a(null),i(null);u(!1)});return()=>e()},[]),c?(0,bt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50 flex items-center justify-center",children:(0,bt.jsxs)("div",{className:"text-rose-600 flex items-center gap-2",children:[(0,bt.jsx)(Je,{className:"animate-pulse"}),(0,bt.jsx)("span",{className:"text-lg",children:"Loading..."})]})}):(0,bt.jsx)(Qg,{children:(0,bt.jsxs)(yg,{children:[(0,bt.jsx)(gg,{path:"/privacy",element:(0,bt.jsx)(dv,{})}),(0,bt.jsx)(gg,{path:"*",element:(0,bt.jsx)(bt.Fragment,{children:c?(0,bt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50 flex items-center justify-center",children:(0,bt.jsxs)("div",{className:"text-rose-600 flex items-center gap-2",children:[(0,bt.jsx)(Je,{className:"animate-pulse"}),(0,bt.jsx)("span",{className:"text-lg",children:"Loading..."})]})}):e?"superAdmin"===r?(0,bt.jsx)(Sv,{user:e}):"wardAdmin"===r?"member"===d?(0,bt.jsx)(qm,{user:e,userData:s,auth:fv,db:mv,storage:pv,isAdmin:!0,onSwitchToAdmin:()=>h("admin")}):(0,bt.jsx)(xv,{user:e,userData:s,onSwitchToMember:()=>h("member")}):"stakeAdmin"===r?"member"===d?(0,bt.jsx)(qm,{user:e,userData:s,auth:fv,db:mv,storage:pv,isAdmin:!0,onSwitchToAdmin:()=>h("admin")}):(0,bt.jsx)(wv,{user:e,userData:s,onSwitchToMember:()=>h("member")}):"member"===r?(0,bt.jsx)(qm,{user:e,userData:s,auth:fv,db:mv,storage:pv}):(0,bt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50 p-8",children:(0,bt.jsxs)("div",{className:"max-w-2xl mx-auto text-center",children:[(0,bt.jsx)(Je,{className:"w-16 h-16 text-rose-500 mx-auto mb-4"}),(0,bt.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Welcome to My Stake Friends"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Your dashboard will be available soon."})]})}):(0,bt.jsx)(bv,{})})})]})})}function yv(e){let{title:t,admins:r,onClose:a,onSave:s,stakeId:i,wardId:o,stakeName:c,wardName:u,isWardAdmin:d=!1,wards:h=[]}=e;const[f,m]=(0,n.useState)([...r]),[p,g]=(0,n.useState)({}),[v,y]=(0,n.useState)(""),[b,w]=(0,n.useState)(""),[x,E]=(0,n.useState)(!1),[T,k]=(0,n.useState)(""),[N,S]=(0,n.useState)(!0);(0,n.useEffect)(()=>{_()},[f]);const _=async()=>{S(!0);try{const e={};for(const t of f){console.log("Checking status for:",t);const r=(0,l.query)((0,l.collection)(mv,"users"),(0,l.where)("email","==",t)),n=await(0,l.getDocs)(r);if(console.log("Found user docs:",n.size,"for email:",t),n.empty)e[t]="pending";else{const r=n.docs[0].data();console.log("User data:",r),e[t]=!0===r.hasLoggedIn?"active":"pending"}}console.log("Final statuses:",e),g(e)}catch(e){console.error("Error loading admin statuses:",e)}finally{S(!1)}},C=()=>{v&&!f.includes(v)&&(m([...f,v]),y(""),w(""))};return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:t}),T&&(0,bt.jsx)("div",{className:"mb-4 p-3 rounded-lg text-sm ".concat(T.startsWith("\u2713")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:T}),(0,bt.jsxs)("div",{className:"space-y-4 mb-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Admins"}),0===f.length?(0,bt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No admins assigned yet"}):N?(0,bt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Loading admin statuses..."}):(0,bt.jsx)("div",{className:"space-y-2",children:f.map((e,t)=>(0,bt.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,bt.jsx)("span",{className:"text-sm text-gray-700",children:e}),"active"===p[e]?(0,bt.jsx)("span",{className:"inline-block px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:"Active"}):(0,bt.jsx)("span",{className:"inline-block px-2 py-0.5 bg-amber-100 text-amber-700 text-xs rounded-full",children:"Pending"})]}),(0,bt.jsxs)("div",{className:"flex gap-1",children:["active"!==p[e]&&(0,bt.jsx)("button",{onClick:()=>(async e=>{E(!0),k("");try{const t=Ge(gv,"inviteAdmin"),r={email:e,role:d?"wardAdmin":"stakeAdmin",stakeId:i,stakeName:c};if(d)r.wardId=o,r.wardName=u;else if(b){r.memberWardId=b;const e=h.find(e=>e.id===b);r.wardName=null===e||void 0===e?void 0:e.name}await t(r),k("\u2713 Invitation sent to ".concat(e)),setTimeout(()=>k(""),3e3),_()}catch(t){console.error("Error inviting admin:",t),k("\u2717 Error: ".concat(t.message)),setTimeout(()=>k(""),5e3)}finally{E(!1)}})(e),disabled:x,className:"p-1 text-blue-600 hover:text-blue-700 disabled:opacity-50",title:"Send invitation",children:(0,bt.jsx)(Ze,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:()=>(e=>{m(f.filter(t=>t!==e))})(e),className:"p-1 text-red-600 hover:text-red-700",title:"Remove admin",children:(0,bt.jsx)(et,{className:"w-4 h-4"})})]})]},t))})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Add New Admin"}),(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsx)("input",{type:"email",value:v,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&!e.shiftKey&&C(),placeholder:"admin@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),!d&&h&&h.length>0&&(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Which ward are they a member of? (Optional)"}),(0,bt.jsxs)("select",{value:b,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[(0,bt.jsx)("option",{value:"",children:"Select a ward (optional)..."}),h.map(e=>(0,bt.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,bt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Stake admins manage all wards. Ward membership is optional."})]}),(0,bt.jsxs)("button",{onClick:C,disabled:!v,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,bt.jsx)(tt,{className:"w-4 h-4 inline mr-2"}),"Add to List"]})]}),(0,bt.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Add the email first, then click the ",(0,bt.jsx)(Ze,{className:"w-3 h-3 inline"})," icon to send the invitation"]})]})]}),(0,bt.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,bt.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsx)("button",{onClick:()=>s(f),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Save Admins"})]})]})})}function bv(){const[e,t]=(0,n.useState)(""),[r,a]=(0,n.useState)(""),[s,i]=(0,n.useState)(""),[c,u]=(0,n.useState)(!1),d=async()=>{i(""),u(!0);try{const t=await(0,o.x9)(fv,e,r),n=(0,l.H9)(mv,"users",t.user.uid);await(0,l.mZ)(n,{hasLoggedIn:!0,lastLoginAt:(new Date).toISOString()})}catch(t){i("Invalid email or password")}finally{u(!1)}};return(0,bt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-rose-100 via-amber-50 to-green-100 flex items-center justify-center p-4",children:(0,bt.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border border-rose-200",children:[(0,bt.jsxs)("div",{className:"text-center mb-8",children:[(0,bt.jsx)(Je,{className:"w-16 h-16 text-rose-500 mx-auto mb-4"}),(0,bt.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"My Stake Friends"}),(0,bt.jsx)("p",{className:"text-gray-600 italic",children:'"Hearts Knit in Unity"'})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,bt.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,bt.jsx)("input",{type:"password",value:r,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&d(),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),s&&(0,bt.jsx)("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm",children:s}),(0,bt.jsx)("button",{onClick:d,disabled:c,className:"w-full bg-rose-500 text-white py-2 rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50 font-medium",children:c?"Signing in...":"Sign In"})]})]})})}function wv(e){var t;let{user:r,userData:a,onSwitchToMember:i}=e;const[c,u]=(0,n.useState)("friends"),[d,h]=(0,n.useState)("all"),[f,m]=(0,n.useState)([]),[p,g]=(0,n.useState)([]),[v,y]=(0,n.useState)(!0),[b,w]=(0,n.useState)(!1),[x,E]=(0,n.useState)(!1),[T,k]=(0,n.useState)(null),[N,S]=(0,n.useState)(null),[_,C]=(0,n.useState)(!1),[A,I]=(0,n.useState)(!1),[R,O]=(0,n.useState)(null),[D,j]=(0,n.useState)(!1),[P,M]=(0,n.useState)(null);(0,n.useEffect)(()=>{L()},[]);const L=async()=>{try{const e=await(0,l.x7)((0,l.H9)(mv,"stakes",a.stakeId));e.exists()&&S((0,s.A)({id:e.id},e.data()));const t=(0,l.query)((0,l.collection)(mv,"stakes",a.stakeId,"wards")),r=(await(0,l.getDocs)(t)).docs.map(e=>(0,s.A)({id:e.id},e.data()));m(r);const n=[];for(const o of r){const e=(0,l.query)((0,l.collection)(mv,"stakes",a.stakeId,"wards",o.id,"members"));(await(0,l.getDocs)(e)).docs.forEach(e=>{n.push((0,s.A)({id:e.id,wardId:o.id,wardName:o.name},e.data()))})}g(n);let i=0;for(const s of r){const e=(0,l.query)((0,l.collection)(mv,"stakes",a.stakeId,"wards",s.id,"circles"));i+=(await(0,l.getDocs)(e)).size}B(i)}catch(e){console.error("Error loading stake data:",e)}finally{y(!1)}},F=("all"===d?p:p.filter(e=>e.wardId===d)).sort((e,t)=>(e.fullName||"").localeCompare(t.fullName||"")),[U,B]=(0,n.useState)(0);return(0,bt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50",children:[(0,bt.jsx)("header",{className:"bg-white shadow-sm border-b border-rose-100",children:(0,bt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(Je,{className:"w-8 h-8 text-rose-500"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"My Stake Friends"}),(0,bt.jsx)("p",{className:"text-sm text-gray-500",children:(null===N||void 0===N?void 0:N.name)||"Stake Administrator"})]})]}),(0,bt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,bt.jsxs)("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border border-purple-200",children:[(0,bt.jsx)(rt,{className:"w-4 h-4"}),"My Dashboard"]}),(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"View Ward:"}),(0,bt.jsxs)("select",{value:d,onChange:e=>h(e.target.value),className:"text-sm font-medium text-gray-800 border border-gray-300 focus:ring-2 focus:ring-rose-500 rounded px-3 py-2",children:[(0,bt.jsx)("option",{value:"all",children:"All Wards"}),f.map(e=>(0,bt.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,bt.jsxs)("button",{onClick:()=>C(!0),className:"flex items-center gap-2 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-200",children:[(0,bt.jsx)(nt,{className:"w-4 h-4"}),"Stake Admins"]}),"all"!==d&&(0,bt.jsxs)("button",{onClick:()=>{O(f.find(e=>e.id===d)),I(!0)},className:"flex items-center gap-2 px-3 py-2 text-sm text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-200",children:[(0,bt.jsx)(nt,{className:"w-4 h-4"}),"Ward Admins"]}),(0,bt.jsxs)("button",{onClick:async()=>{await(0,o.CI)(fv)},className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,bt.jsx)(at,{className:"w-4 h-4"}),"Sign Out"]})]})]})})}),(0,bt.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,bt.jsxs)("button",{onClick:()=>u("friends"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("friends"===c?"bg-rose-500 border-rose-600 text-white":"bg-white border-rose-100 text-gray-800 hover:border-rose-300"),children:[(0,bt.jsx)(rt,{className:"w-12 h-12 mx-auto mb-3 ".concat("friends"===c?"text-white":"text-rose-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Friends"}),(0,bt.jsxs)("p",{className:"text-sm ".concat("friends"===c?"text-rose-100":"text-gray-600"),children:[F.length," members"]})]}),(0,bt.jsxs)("button",{onClick:()=>u("circles"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("circles"===c?"bg-green-500 border-green-600 text-white":"bg-white border-green-100 text-gray-800 hover:border-green-300"),children:[(0,bt.jsx)(st,{className:"w-12 h-12 mx-auto mb-3 ".concat("circles"===c?"text-white":"text-green-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Circles"}),(0,bt.jsxs)("p",{className:"text-sm ".concat("circles"===c?"text-green-100":"text-gray-600"),children:[U," active circles"]})]}),(0,bt.jsxs)("button",{onClick:()=>u("reports"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("reports"===c?"bg-amber-500 border-amber-600 text-white":"bg-white border-amber-100 text-gray-800 hover:border-amber-300"),children:[(0,bt.jsx)(it,{className:"w-12 h-12 mx-auto mb-3 ".concat("reports"===c?"text-white":"text-amber-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Reports"}),(0,bt.jsx)("p",{className:"text-sm ".concat("reports"===c?"text-amber-100":"text-gray-600"),children:"View analytics"})]})]}),"friends"===c&&(0,bt.jsx)(Tv,{members:F,onAddMember:()=>w(!0),onUploadRoster:"all"!==d?()=>E(!0):void 0,onEditMember:e=>{k(e),w(!0)},onDeleteMember:async e=>{confirm("Are you sure you want to delete this member?")&&(await(0,l.kd)((0,l.H9)(mv,"stakes",a.stakeId,"wards",e.wardId,"members",e.id)),L())},onInviteMember:async e=>{try{var t;const r=Ge(gv,"inviteMember");await r({email:e.email,memberName:e.fullName,memberId:e.id,stakeId:a.stakeId,wardId:e.wardId||a.wardId,stakeName:null===N||void 0===N?void 0:N.name,wardName:e.wardName||(null===(t=wardInfo)||void 0===t?void 0:t.name)});alert("Invitation sent to ".concat(e.email)),loadWardData()}catch(r){console.error("Error inviting member:",r),alert("Failed to send invitation: ".concat(r.message))}},onInviteAll:async()=>{const e=p.filter(e=>e.email&&""!==e.email.trim()&&!e.hasLoggedIn);if(0===e.length)return void alert("No members to invite. All members with emails have already been invited.");if(!confirm("Send invitations to ".concat(e.length," member(s)?")))return;let t=0,r=0;for(const i of e)try{var n;const e=Ge(gv,"inviteMember");await e({email:i.email,memberName:i.fullName,memberId:i.id,stakeId:a.stakeId,wardId:i.wardId||a.wardId,stakeName:null===N||void 0===N?void 0:N.name,wardName:i.wardName||(null===(n=wardInfo)||void 0===n?void 0:n.name)}),t++}catch(s){console.error("Error inviting ".concat(i.email,":"),s),r++}alert("Invitations sent!\nSuccess: ".concat(t,"\nFailed: ").concat(r)),L()},onTransfer:e=>{M(e),j(!0)},showWardColumn:"all"===d}),"circles"===c&&"all"!==d&&(0,bt.jsx)(Tm,{db:mv,stakeId:a.stakeId,wardId:d,wardName:null===(t=f.find(e=>e.id===d))||void 0===t?void 0:t.name}),"circles"===c&&"all"===d&&(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8 text-center",children:[(0,bt.jsx)(st,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Select a Ward"}),(0,bt.jsx)("p",{className:"text-gray-600",children:'Please select a specific ward from the "Viewing" dropdown to manage circles.'})]}),"reports"===c&&(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8",children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Stake Overview"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"p-4 bg-rose-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Members"}),(0,bt.jsx)("p",{className:"text-3xl font-bold text-rose-600",children:p.length})]}),(0,bt.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Wards"}),(0,bt.jsx)("p",{className:"text-3xl font-bold text-green-600",children:f.length})]}),(0,bt.jsxs)("div",{className:"p-4 bg-amber-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Active Users"}),(0,bt.jsx)("p",{className:"text-3xl font-bold text-amber-600",children:p.filter(e=>e.hasLoggedIn).length})]}),(0,bt.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Pending Invites"}),(0,bt.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:p.filter(e=>!e.hasLoggedIn).length})]})]})]})]}),b&&!T&&(0,bt.jsx)(Xm,{stakeId:a.stakeId,wardId:"all"!==d?d:null,wards:"all"===d?f:void 0,db:mv,onClose:()=>w(!1),onSave:()=>{w(!1),L()}}),b&&T&&(0,bt.jsx)(Nv,{member:T,stakeId:a.stakeId,wardId:T.wardId,onClose:()=>{w(!1),k(null)},onSave:()=>{w(!1),k(null),L()}}),x&&"all"!==d&&(0,bt.jsx)(Ev,{stakeId:a.stakeId,wardId:d,onClose:()=>E(!1),onComplete:()=>{E(!1),L()}}),_&&(0,bt.jsx)(yv,{title:"Manage Stake Admins - ".concat(null===N||void 0===N?void 0:N.name),admins:(null===N||void 0===N?void 0:N.stakeAdmins)||[],stakeId:a.stakeId,stakeName:null===N||void 0===N?void 0:N.name,wards:f,onClose:()=>C(!1),onSave:async e=>{await(0,l.mZ)((0,l.H9)(mv,"stakes",a.stakeId),{stakeAdmins:e,updatedAt:(new Date).toISOString()}),C(!1),L()}}),A&&R&&(0,bt.jsx)(yv,{title:"Manage Ward Admins - ".concat(R.name),admins:R.wardAdmins||[],stakeId:a.stakeId,wardId:R.id,stakeName:null===N||void 0===N?void 0:N.name,wardName:R.name,isWardAdmin:!0,onClose:()=>{I(!1),O(null)},onSave:async e=>{await(0,l.mZ)((0,l.H9)(mv,"stakes",a.stakeId,"wards",R.id),{wardAdmins:e,updatedAt:(new Date).toISOString()}),I(!1),O(null),L()}}),D&&P&&(0,bt.jsx)(wt,{member:P,currentWard:f.find(e=>e.id===P.wardId),wards:f,stakeId:a.stakeId,db:mv,onClose:()=>{j(!1),M(null)},onComplete:()=>{j(!1),M(null),L()}})]})}function xv(e){let{user:t,userData:r,onSwitchToMember:a}=e;const[i,c]=(0,n.useState)("friends"),[u,d]=(0,n.useState)([]),[h,f]=(0,n.useState)(!0),[m,p]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),[w,x]=(0,n.useState)(null),[E,T]=(0,n.useState)(0),[k,N]=(0,n.useState)(!1),[S,_]=(0,n.useState)(null);(0,n.useEffect)(()=>{C()},[]);const C=async()=>{try{const e=await(0,l.x7)((0,l.H9)(mv,"stakes",r.stakeId));e.exists()&&_((0,s.A)({id:e.id},e.data()));const t=await(0,l.x7)((0,l.H9)(mv,"stakes",r.stakeId,"wards",r.wardId));t.exists()&&x((0,s.A)({id:t.id},t.data()));const n=(0,l.query)((0,l.collection)(mv,"stakes",r.stakeId,"wards",r.wardId,"members")),a=await(0,l.getDocs)(n);d(a.docs.map(e=>(0,s.A)({id:e.id},e.data())));const i=(0,l.query)((0,l.collection)(mv,"stakes",r.stakeId,"wards",r.wardId,"circles")),o=await(0,l.getDocs)(i);T(o.size)}catch(e){console.error("Error loading ward data:",e)}finally{f(!1)}};return(0,bt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50",children:[(0,bt.jsx)("header",{className:"bg-white shadow-sm border-b border-rose-100",children:(0,bt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(Je,{className:"w-8 h-8 text-rose-500"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"MyStakeFriends"}),(0,bt.jsx)("p",{className:"text-sm text-gray-500",children:(null===w||void 0===w?void 0:w.name)||"Ward Administrator"})]})]}),(0,bt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,bt.jsxs)("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border border-purple-200",children:[(0,bt.jsx)(rt,{className:"w-4 h-4"}),"My Dashboard"]}),(0,bt.jsxs)("button",{onClick:()=>N(!0),className:"flex items-center gap-2 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-200",children:[(0,bt.jsx)(nt,{className:"w-4 h-4"}),"Manage Ward Admins"]}),(0,bt.jsxs)("button",{onClick:async()=>{await(0,o.CI)(fv)},className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,bt.jsx)(at,{className:"w-4 h-4"}),"Sign Out"]})]})]})})}),(0,bt.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,bt.jsxs)("button",{onClick:()=>c("friends"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("friends"===i?"bg-rose-500 border-rose-600 text-white":"bg-white border-rose-100 text-gray-800 hover:border-rose-300"),children:[(0,bt.jsx)(rt,{className:"w-12 h-12 mx-auto mb-3 ".concat("friends"===i?"text-white":"text-rose-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Friends"}),(0,bt.jsxs)("p",{className:"text-sm ".concat("friends"===i?"text-rose-100":"text-gray-600"),children:[u.length," members"]})]}),(0,bt.jsxs)("button",{onClick:()=>c("circles"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("circles"===i?"bg-green-500 border-green-600 text-white":"bg-white border-green-100 text-gray-800 hover:border-green-300"),children:[(0,bt.jsx)(st,{className:"w-12 h-12 mx-auto mb-3 ".concat("circles"===i?"text-white":"text-green-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Circles"}),(0,bt.jsxs)("p",{className:"text-sm ".concat("circles"===i?"text-green-100":"text-gray-600"),children:[E," active circle",1!==E?"s":""]})]}),(0,bt.jsxs)("button",{onClick:()=>c("reports"),className:"p-6 rounded-xl shadow-md border-2 transition-all ".concat("reports"===i?"bg-amber-500 border-amber-600 text-white":"bg-white border-amber-100 text-gray-800 hover:border-amber-300"),children:[(0,bt.jsx)(it,{className:"w-12 h-12 mx-auto mb-3 ".concat("reports"===i?"text-white":"text-amber-500")}),(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-1",children:"Reports"}),(0,bt.jsx)("p",{className:"text-sm ".concat("reports"===i?"text-amber-100":"text-gray-600"),children:"View analytics"})]})]}),"friends"===i&&(0,bt.jsx)(Tv,{members:u.sort((e,t)=>(e.fullName||"").localeCompare(t.fullName||"")),onAddMember:()=>p(!0),onUploadRoster:()=>v(!0),onEditMember:e=>{b(e),p(!0)},onDeleteMember:async e=>{confirm("Are you sure you want to delete this member?")&&(await(0,l.kd)((0,l.H9)(mv,"stakes",r.stakeId,"wards",r.wardId,"members",e)),C())},onInviteMember:async e=>{try{const t=Ge(gv,"inviteMember");await t({email:e.email,memberName:e.fullName,memberId:e.id,stakeId:r.stakeId,wardId:e.wardId||r.wardId,stakeName:null===S||void 0===S?void 0:S.name,wardName:e.wardName||(null===w||void 0===w?void 0:w.name)});alert("Invitation sent to ".concat(e.email)),C()}catch(t){console.error("Error inviting member:",t),alert("Failed to send invitation: ".concat(t.message))}},onInviteAll:async()=>{const e=u.filter(e=>e.email&&""!==e.email.trim()&&!e.hasLoggedIn);if(0===e.length)return void alert("No members to invite. All members with emails have already been invited.");if(!confirm("Send invitations to ".concat(e.length," member(s)?")))return;let t=0,n=0;for(const s of e)try{const e=Ge(gv,"inviteMember");await e({email:s.email,memberName:s.fullName,memberId:s.id,stakeId:r.stakeId,wardId:s.wardId||r.wardId,stakeName:null===S||void 0===S?void 0:S.name,wardName:s.wardName||(null===w||void 0===w?void 0:w.name)}),t++}catch(a){console.error("Error inviting ".concat(s.email,":"),a),n++}alert("Invitations sent!\nSuccess: ".concat(t,"\nFailed: ").concat(n)),C()}}),"circles"===i&&(0,bt.jsx)(Tm,{db:mv,stakeId:r.stakeId,wardId:r.wardId,wardName:null===w||void 0===w?void 0:w.name}),"reports"===i&&(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8 text-center",children:[(0,bt.jsx)(it,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Reports Coming Soon"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"View engagement and activity reports here."})]})]}),m&&!y&&(0,bt.jsx)(Xm,{stakeId:r.stakeId,wardId:r.wardId,db:mv,onClose:()=>p(!1),onSave:()=>{p(!1),C()}}),m&&y&&(0,bt.jsx)(Nv,{member:y,stakeId:r.stakeId,wardId:r.wardId,onClose:()=>{p(!1),b(null)},onSave:()=>{p(!1),b(null),C()}}),g&&(0,bt.jsx)(Ev,{stakeId:r.stakeId,wardId:r.wardId,onClose:()=>v(!1),onComplete:()=>{v(!1),C()}}),k&&(0,bt.jsx)(yv,{title:"Manage Ward Admins - ".concat(null===w||void 0===w?void 0:w.name),admins:(null===w||void 0===w?void 0:w.wardAdmins)||[],stakeId:r.stakeId,wardId:r.wardId,stakeName:null===S||void 0===S?void 0:S.name,wardName:null===w||void 0===w?void 0:w.name,isWardAdmin:!0,onClose:()=>N(!1),onSave:async e=>{await(0,l.mZ)((0,l.H9)(mv,"stakes",r.stakeId,"wards",r.wardId),{wardAdmins:e,updatedAt:(new Date).toISOString()}),N(!1),C()}})]})}function Ev(e){let{stakeId:t,wardId:r,onClose:a,onComplete:i}=e;const[o,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[h,f]=(0,n.useState)({}),[m,p]=(0,n.useState)(1),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),w=[{value:"fullName",label:"Full Name"},{value:"email",label:"Email"},{value:"phone",label:"Phone"},{value:"address",label:"Address"},{value:"dob",label:"Date of Birth"},{value:"maritalStatus",label:"Marital Status"},{value:"numChildren",label:"Has Children"},{value:"ethnicity",label:"Ethnicity"},{value:"ignore",label:"-- Ignore this column --"}],x=async e=>{c(e),v(!0);try{const t=nd(await e.arrayBuffer(),{cellDates:!0}),r=t.Sheets[t.SheetNames[0]],n=pd.decode_range(r["!ref"]),a=[];for(let e=n.s.c;e<=n.e.c;e++){const t=r[pd.encode_col(e)+(n.s.r+1)];t&&t.v&&a.push(t.v)}const s=pd.sheet_to_json(r,{raw:!1,dateNF:"yyyy-mm-dd",defval:""});if(0===s.length)return void alert("The file appears to be empty");const i=a.length>0?a:Object.keys(s[0]);console.log("Headers found:",i),console.log("First row data:",s[0]);const o={};i.forEach(e=>{const t=e.toLowerCase().trim();t.includes("preferred name")?o[e]="fullName":t.includes("individual e-mail")||"email"===t?o[e]="email":t.includes("individual phone")||"phone"===t?o[e]="phone":t.includes("address - street")?o[e]="address":t.includes("birth date")?o[e]="dob":t.includes("email")||t.includes("mail")?o[e]="email":t.includes("phone")||t.includes("cell")||t.includes("mobile")?o[e]="phone":t.includes("name")||t.includes("full")?o[e]="fullName":t.includes("address")||t.includes("street")?o[e]="address":t.includes("birth")||t.includes("dob")||t.includes("birthday")?o[e]="dob":t.includes("ethnic")||t.includes("culture")||t.includes("background")?o[e]="ethnicity":(t.includes("is married")||t.includes("is divorced")||t.includes("is widowed")||t.includes("is single")||t.includes("has children")||t.includes("child")||t.includes("unit")||t.includes("city")||t.includes("postal")||t.includes("state"),o[e]="ignore")}),console.log("Auto-mapping result:",o),f(o),d({headers:i,rows:s.slice(0,5),allRows:s}),p(2)}catch(t){console.error("Error reading file:",t),alert("Error reading file. Please make sure it's a valid CSV or Excel file.")}finally{v(!1)}},E=e=>{if(!e)return"";if("string"===typeof e){const t=e.trim(),r=t.match(/^(\d{1,2})-([A-Za-z]{3})-(\d{2})$/);if(r){const e=r[1],t=r[2],n=parseInt(r[3]),a=n>=50?1900+n:2e3+n,s={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"}[t.toLowerCase()];if(s)return"".concat(s,"/").concat(e.padStart(2,"0"),"/").concat(a)}if(t.includes("-")||t.includes("/"))try{const e=new Date(t);if(!isNaN(e.getTime())){const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return"".concat(r,"/").concat(n,"/").concat(t)}}catch(Iv){console.error("Error parsing date:",t,Iv)}}if("number"===typeof e&&e>1&&e<73050){const t=new Date(1899,11,30),r=new Date(t.getTime()+864e5*e),n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");return"".concat(a,"/").concat(s,"/").concat(n)}return String(e)};return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full p-6 my-8 max-h-[90vh] overflow-y-auto",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Upload Member Roster"}),1===m&&(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(y?"border-rose-500 bg-rose-50":"border-gray-300 hover:border-rose-400"),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),b(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),b(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),b(!1);const t=e.dataTransfer.files[0];t&&x(t)},children:[(0,bt.jsx)(ot,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,bt.jsx)("p",{className:"text-gray-600 mb-4",children:y?"Drop file here":"Drag and drop a file here, or click to browse"}),(0,bt.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:async e=>{const t=e.target.files[0];t&&x(t)},className:"hidden",id:"fileUpload"}),(0,bt.jsx)("label",{htmlFor:"fileUpload",className:"inline-block px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 cursor-pointer transition-colors",children:"Choose File"}),o&&(0,bt.jsxs)("p",{className:"mt-4 text-sm text-gray-600",children:["Selected: ",o.name]})]}),(0,bt.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,bt.jsx)("p",{className:"text-sm text-blue-800 font-medium mb-2",children:"Expected columns:"}),(0,bt.jsx)("p",{className:"text-sm text-blue-700",children:"Full Name, Email, Phone, Address, Date of Birth, Marital Status, Number of Children, Cultural Background"})]})]}),2===m&&u&&(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-gray-600 mb-4",children:"Map your CSV columns to our fields:"}),(0,bt.jsx)("div",{className:"space-y-3 mb-6",children:u.headers.map(e=>(0,bt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,bt.jsx)("div",{className:"w-1/3 font-medium text-gray-700",children:e}),(0,bt.jsx)("div",{className:"w-1/3",children:(0,bt.jsx)("select",{value:h[e]||"ignore",onChange:t=>f(r=>(0,s.A)((0,s.A)({},r),{},{[e]:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500",children:w.map(e=>(0,bt.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,bt.jsx)("div",{className:"w-1/3 text-sm text-gray-600",children:(()=>{const t=e.toLowerCase(),r=t.includes("is married")||t.includes("is divorced")||t.includes("is single")||t.includes("is widowed"),n=t.includes("has children");return r||n?(0,bt.jsx)("span",{className:"italic text-blue-600",children:'Auto-handled - leave as "ignore"'}):(0,bt.jsx)("span",{className:"truncate",children:"dob"===h[e]&&u.rows[0][e]?E(u.rows[0][e]):u.rows[0][e]})})()})]},e))}),(0,bt.jsxs)("div",{className:"border-t pt-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-gray-800 mb-3",children:"Preview (first 5 rows):"}),(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"min-w-full text-sm",children:[(0,bt.jsx)("thead",{className:"bg-gray-50",children:(0,bt.jsx)("tr",{children:u.headers.map(e=>(0,bt.jsx)("th",{className:"px-4 py-2 text-left text-gray-700",children:e},e))})}),(0,bt.jsx)("tbody",{children:u.rows.map((e,t)=>(0,bt.jsx)("tr",{className:"border-t",children:u.headers.map(t=>{const r=h[t];let n=e[t];return"dob"===r&&n&&(n=E(n)),(0,bt.jsx)("td",{className:"px-4 py-2 text-gray-600",children:n},t)})},t))})]})})]}),(0,bt.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>p(1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Back"}),(0,bt.jsx)("button",{onClick:async()=>{v(!0);try{const e=(0,l.query)((0,l.collection)(mv,"stakes",t,"wards",r,"members")),n=await(0,l.getDocs)(e),a={},o={};n.docs.forEach(e=>{const t=e.data();if(t.email&&(a[t.email.toLowerCase()]=e.id),t.fullName&&t.dob){const r="".concat(t.fullName.toLowerCase(),"_").concat(t.dob);o[r]=e.id}});const c=(0,l.wP)(mv);let d=0,f=0;u.allRows.forEach(e=>{const n={};if(Object.keys(h).forEach(t=>{const r=h[t];if("ignore"!==r&&e[t]){let a=String(e[t]).trim();"dob"===r&&(a=E(e[t])),n[r]=a}}),n.maritalStatus||("Yes"===e["Is Married"]?n.maritalStatus="married":"Yes"===e["Is Divorced"]?n.maritalStatus="divorced":"Yes"===e["Is Widowed"]?n.maritalStatus="widowed":"Yes"===e["Is Single"]&&(n.maritalStatus="single")),n.numChildren||"Yes"!==e["Has Children"]||(n.numChildren="1"),n.fullName){var i;const e=null===(i=n.email)||void 0===i?void 0:i.toLowerCase();let u=e?a[e]:null;if(!u&&n.dob){const e="".concat(n.fullName.toLowerCase(),"_").concat(n.dob);u=o[e]}if(u){const e=(0,l.H9)(mv,"stakes",t,"wards",r,"members",u);c.update(e,(0,s.A)((0,s.A)({},n),{},{updatedAt:(new Date).toISOString()})),f++}else{const e=(0,l.H9)((0,l.collection)(mv,"stakes",t,"wards",r,"members"));c.set(e,(0,s.A)((0,s.A)({},n),{},{hasLoggedIn:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()})),d++}}}),await c.commit(),alert("Successfully imported ".concat(d," new members and updated ").concat(f," existing members!")),i()}catch(e){console.error("Error importing:",e),alert("Error importing members. Please try again.")}finally{v(!1)}},disabled:g,className:"flex-1 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50",children:g?"Importing...":"Import ".concat(u.allRows.length," Members")})]})]}),!g&&1===m&&(0,bt.jsx)("div",{className:"flex justify-end mt-6",children:(0,bt.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})})]})})}function Tv(e){let{members:t,onAddMember:r,onUploadRoster:a,onEditMember:s,onDeleteMember:i,onInviteMember:o,onInviteAll:l,onTransfer:c,showWardColumn:u=!1}=e;const[d,h]=(0,n.useState)(""),f=t.filter(e=>{var t,r,n;return(null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(d.toLowerCase()))||(null===(n=e.wardName)||void 0===n?void 0:n.toLowerCase().includes(d.toLowerCase()))}).sort((e,t)=>(e.fullName||"").localeCompare(t.fullName||"")),m=t.filter(e=>e.email&&""!==e.email.trim()&&!e.hasLoggedIn).length;return(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md border border-rose-100",children:[(0,bt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Members"}),(0,bt.jsxs)("div",{className:"flex gap-2",children:[m>0&&(0,bt.jsxs)("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[(0,bt.jsx)(Ze,{className:"w-4 h-4"}),"Invite All (",m,")"]}),a&&(0,bt.jsxs)("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[(0,bt.jsx)(ot,{className:"w-4 h-4"}),"Upload Roster"]}),(0,bt.jsxs)("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors",children:[(0,bt.jsx)(nt,{className:"w-4 h-4"}),"Add Member"]})]})]}),(0,bt.jsx)("input",{type:"text",placeholder:"Search members...",value:d,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsx)("div",{className:"p-6",children:0===f.length?(0,bt.jsxs)("div",{className:"text-center py-12",children:[(0,bt.jsx)(rt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,bt.jsx)("p",{className:"text-gray-500 mb-4",children:0===t.length?"No members added yet":"No members match your search"}),0===t.length&&(0,bt.jsx)("button",{onClick:r,className:"text-rose-500 hover:text-rose-600 font-medium",children:"Add your first member"})]}):(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(e=>(0,bt.jsx)(kv,{member:e,showWard:u,onEdit:()=>s(e),onDelete:()=>i(e),onInvite:o?()=>o(e):void 0,onTransfer:c?()=>c(e):void 0},e.id))})})]})}function kv(e){let{member:t,showWard:r,onEdit:a,onDelete:s,onInvite:i,onTransfer:o}=e;const[l,c]=(0,n.useState)(!1);return(0,bt.jsx)("div",{className:"border rounded-lg p-4 transition-all ".concat(l?"border-gray-300 bg-gray-50":"border-gray-200 hover:shadow-md"),children:l?(0,bt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,bt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,bt.jsx)("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Sending invitation..."})]})}):(0,bt.jsxs)(bt.Fragment,{children:[(0,bt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,bt.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,bt.jsx)("div",{className:"relative",children:t.profilePicUrl?(0,bt.jsx)("img",{src:t.profilePicUrl,alt:t.fullName,className:"w-12 h-12 rounded-full object-cover border-2 border-rose-200"}):(0,bt.jsx)("div",{className:"w-12 h-12 rounded-full bg-rose-100 flex items-center justify-center border-2 border-rose-200",children:(0,bt.jsx)(lt,{className:"w-6 h-6 text-rose-400"})})}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("h3",{className:"font-semibold text-gray-800 mb-1",children:t.fullName||"Unnamed"}),(0,bt.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[t.hasLoggedIn?(0,bt.jsx)("span",{className:"inline-block px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:"Active"}):(0,bt.jsx)("span",{className:"inline-block px-2 py-0.5 bg-amber-100 text-amber-700 text-xs rounded-full",children:"Pending"}),r&&t.wardName&&(0,bt.jsx)("span",{className:"inline-block px-2 py-0.5 bg-blue-100 text-blue-700 text-xs rounded-full",children:t.wardName})]})]})]}),(0,bt.jsxs)("div",{className:"flex flex-col gap-1 items-end",children:[(0,bt.jsxs)("div",{className:"flex gap-1",children:[i&&!t.hasLoggedIn&&t.email&&(0,bt.jsx)("button",{onClick:async()=>{c(!0);try{await i()}finally{c(!1)}},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Send invitation",children:(0,bt.jsx)(Ze,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:a,className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:(0,bt.jsx)(ct,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:s,className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",children:(0,bt.jsx)(et,{className:"w-4 h-4"})})]}),o&&(0,bt.jsx)("button",{onClick:o,className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Transfer to another ward",children:(0,bt.jsx)(ut,{className:"w-4 h-4"})})]})]}),(0,bt.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[t.email&&(0,bt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bt.jsx)(dt,{className:"w-3.5 h-3.5"}),(0,bt.jsx)("span",{className:"truncate",children:t.email})]}),t.phone&&(0,bt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bt.jsx)(ht,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,bt.jsx)("span",{children:t.phone}),(0,bt.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:["married"===t.maritalStatus&&(0,bt.jsx)(Je,{className:"w-3.5 h-3.5 text-rose-500 fill-current",title:"Married"}),"widowed"===t.maritalStatus&&(0,bt.jsx)(Je,{className:"w-3.5 h-3.5 text-gray-400",title:"Widowed"}),"divorced"===t.maritalStatus&&(0,bt.jsx)(Je,{className:"w-3.5 h-3.5 text-gray-400",title:"Divorced",style:{opacity:.5}}),t.numChildren&&parseInt(t.numChildren)>0&&(0,bt.jsx)("span",{className:"flex items-center gap-0.5 text-rose-500",title:"".concat(t.numChildren," ").concat(1===parseInt(t.numChildren)?"child":"children"),children:(0,bt.jsx)(ft,{className:"w-3.5 h-3.5"})})]})]})]})]})})}function Nv(e){let{member:t,stakeId:r,wardId:a,onClose:i,onSave:o}=e;const[c,u]=(0,n.useState)({fullName:(null===t||void 0===t?void 0:t.fullName)||"",email:(null===t||void 0===t?void 0:t.email)||"",phone:(null===t||void 0===t?void 0:t.phone)||"",address:(null===t||void 0===t?void 0:t.address)||"",dob:(null===t||void 0===t?void 0:t.dob)||"",maritalStatus:(null===t||void 0===t?void 0:t.maritalStatus)||"",numChildren:(null===t||void 0===t?void 0:t.numChildren)||"",ethnicity:(null===t||void 0===t?void 0:t.ethnicity)||"",hobbies:(null===t||void 0===t?void 0:t.hobbies)||[],interests:(null===t||void 0===t?void 0:t.interests)||[],hasLoggedIn:(null===t||void 0===t?void 0:t.hasLoggedIn)||!1,profilePicUrl:(null===t||void 0===t?void 0:t.profilePicUrl)||""}),[d,h]=(0,n.useState)(!1),[f,m]=(0,n.useState)(!1),[p,g]=(0,n.useState)((null===t||void 0===t?void 0:t.profilePicUrl)||""),v=(e,t)=>{if("dob"===e&&t&&t.includes("-")&&t.match(/^\d{4}-\d{2}-\d{2}$/)){const[e,r,n]=t.split("-");t="".concat(r,"/").concat(n,"/").concat(e)}u(r=>(0,s.A)((0,s.A)({},r),{},{[e]:t}))};return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full p-6 my-8",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:t?"Edit Member":"Add New Member"}),(0,bt.jsxs)("div",{className:"flex flex-col items-center mb-6 pb-6 border-b",children:[(0,bt.jsxs)("div",{className:"relative",children:[p?(0,bt.jsx)("img",{src:p,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-rose-200"}):(0,bt.jsx)("div",{className:"w-24 h-24 rounded-full bg-rose-100 flex items-center justify-center border-4 border-rose-200",children:(0,bt.jsx)(lt,{className:"w-12 h-12 text-rose-400"})}),(0,bt.jsxs)("label",{className:"absolute bottom-0 right-0 bg-rose-500 text-white p-2 rounded-full cursor-pointer hover:bg-rose-600 transition-colors",onClick:()=>console.log("Label clicked"),children:[(0,bt.jsx)(mt,{className:"w-4 h-4"}),(0,bt.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{console.log("Input onChange fired",e.target.files),(async e=>{const r=e.target.files[0];if(r)if(r.type.startsWith("image/"))if(r.size>5242880)alert("Image must be less than 5MB");else{m(!0);try{const e=(null===t||void 0===t?void 0:t.id)||"temp_"+Date.now(),n=Ae(pv,"profilePics/".concat(e));await _e(n,r);const a=await Ce(n);u(e=>(0,s.A)((0,s.A)({},e),{},{profilePicUrl:a})),g(a),alert("Profile picture uploaded successfully!")}catch(n){console.error("Error uploading profile picture:",n),alert("Error uploading picture. Please try again.")}finally{m(!1)}}else alert("Please upload an image file")})(e)},className:"hidden",disabled:f})]})]}),f&&(0,bt.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Uploading..."}),(0,bt.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Click camera icon to upload"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),(0,bt.jsx)("input",{type:"text",value:c.fullName,onChange:e=>v("fullName",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,bt.jsx)("input",{type:"email",value:c.email,onChange:e=>v("email",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,bt.jsx)("input",{type:"tel",value:c.phone,onChange:e=>v("phone",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,bt.jsx)("input",{type:"text",value:c.address,onChange:e=>v("address",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),(0,bt.jsx)("input",{type:"date",value:c.dob&&c.dob.includes("/")?(()=>{const[e,t,r]=c.dob.split("/");return"".concat(r,"-").concat(e,"-").concat(t)})():c.dob,onChange:e=>v("dob",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"}),(0,bt.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Stored as: ",c.dob||"MM/DD/YYYY"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),(0,bt.jsxs)("select",{value:c.maritalStatus,onChange:e=>v("maritalStatus",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"",children:"Select..."}),(0,bt.jsx)("option",{value:"single",children:"Single"}),(0,bt.jsx)("option",{value:"married",children:"Married"}),(0,bt.jsx)("option",{value:"widowed",children:"Widowed"}),(0,bt.jsx)("option",{value:"divorced",children:"Divorced"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Children"}),(0,bt.jsx)("input",{type:"number",value:c.numChildren,onChange:e=>v("numChildren",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",min:"0"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cultural Background"}),(0,bt.jsx)("input",{type:"text",value:c.ethnicity,onChange:e=>v("ethnicity",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Optional"})]})]}),(0,bt.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,bt.jsx)("button",{onClick:i,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsx)("button",{onClick:async()=>{h(!0);try{if(t)await(0,l.mZ)((0,l.H9)(mv,"stakes",r,"wards",a,"members",t.id),(0,s.A)((0,s.A)({},c),{},{updatedAt:(new Date).toISOString()}));else{const e=await(0,l.gS)((0,l.collection)(mv,"stakes",r,"wards",a,"members"),(0,s.A)((0,s.A)({},c),{},{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}));if(p&&p.includes("temp_")){const t=await fetch(p),n=await t.blob(),s=Ae(pv,"profilePics/".concat(e.id));await _e(s,n);const i=await Ce(s);await(0,l.mZ)((0,l.H9)(mv,"stakes",r,"wards",a,"members",e.id),{profilePicUrl:i})}}o()}catch(e){console.error("Error saving member:",e),alert("Error saving member")}finally{h(!1)}},disabled:d||!c.fullName||f,className:"flex-1 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50",children:d?"Saving...":"Save Member"})]})]})})}function Sv(e){let{user:t}=e;const[r,a]=(0,n.useState)([]),[i,c]=(0,n.useState)(!1),[u,d]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[m,p]=(0,n.useState)(!1),[g,v]=(0,n.useState)(null),[y,b]=(0,n.useState)(null),[w,x]=(0,n.useState)(!0),[E,T]=(0,n.useState)(0);(0,n.useEffect)(()=>{k()},[]);const k=async()=>{try{const e=(0,l.query)((0,l.collection)(mv,"stakes")),t=await(0,l.getDocs)(e),r=await Promise.all(t.docs.map(async e=>{const t=(0,l.query)((0,l.collection)(mv,"stakes",e.id,"wards")),r=await(0,l.getDocs)(t);return(0,s.A)((0,s.A)({id:e.id},e.data()),{},{wards:r.docs.map(e=>(0,s.A)({id:e.id},e.data()))})}));let n=0;for(const a of r)for(const e of a.wards){const t=(0,l.query)((0,l.collection)(mv,"stakes",a.id,"wards",e.id,"circles"));n+=(await(0,l.getDocs)(t)).size}T(n),a(r)}catch(e){console.error("Error loading stakes:",e)}finally{x(!1)}};return(0,bt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-amber-50 to-green-50",children:[(0,bt.jsx)("header",{className:"bg-white shadow-sm border-b border-rose-100",children:(0,bt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bt.jsx)(Je,{className:"w-8 h-8 text-rose-500"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"My Stake Friends"}),(0,bt.jsx)("p",{className:"text-sm text-gray-500",children:"Super Administrator"})]})]}),(0,bt.jsxs)("button",{onClick:async()=>{await(0,o.CI)(fv)},className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,bt.jsx)(at,{className:"w-4 h-4"}),"Sign Out"]})]})})}),(0,bt.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-rose-100",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Stakes"}),(0,bt.jsx)("p",{className:"text-3xl font-bold text-rose-600",children:r.length})]}),(0,bt.jsx)(pt,{className:"w-12 h-12 text-rose-300"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-green-100",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Wards"}),(0,bt.jsx)("p",{className:"text-3xl font-bold text-green-600",children:r.reduce((e,t)=>{var r;return e+((null===(r=t.wards)||void 0===r?void 0:r.length)||0)},0)})]}),(0,bt.jsx)(rt,{className:"w-12 h-12 text-green-300"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-amber-100",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Active Circles"}),(0,bt.jsx)("p",{className:"text-3xl font-bold text-amber-600",children:E})]}),(0,bt.jsx)(Je,{className:"w-12 h-12 text-amber-300"})]})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-md border border-rose-100",children:[(0,bt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Stakes & Wards"}),(0,bt.jsxs)("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors",children:[(0,bt.jsx)(tt,{className:"w-4 h-4"}),"Add Stake"]})]})}),(0,bt.jsx)("div",{className:"p-6",children:w?(0,bt.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading stakes..."}):0===r.length?(0,bt.jsxs)("div",{className:"text-center py-12",children:[(0,bt.jsx)(pt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,bt.jsx)("p",{className:"text-gray-500 mb-4",children:"No stakes created yet"}),(0,bt.jsx)("button",{onClick:()=>c(!0),className:"text-rose-500 hover:text-rose-600 font-medium",children:"Create your first stake"})]}):(0,bt.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,bt.jsx)(_v,{stake:e,onAddWard:()=>{v(e),d(!0)},onEdit:()=>{v(e),c(!0)},onDelete:async()=>{confirm("Are you sure you want to delete this stake?")&&(await(0,l.kd)((0,l.H9)(mv,"stakes",e.id)),k())},onRefresh:k,onManageAdmins:e=>{v(e),f(!0)},onManageWardAdmins:(e,t)=>{v(e),b(t),p(!0)}},e.id))})})]})]}),i&&(0,bt.jsx)(Cv,{stake:g,onClose:()=>{c(!1),v(null)},onSave:()=>{c(!1),v(null),k()}}),u&&(0,bt.jsx)(Av,{stake:g,onClose:()=>{d(!1),v(null)},onSave:()=>{d(!1),v(null),k()}}),h&&g&&(0,bt.jsx)(yv,{title:"Manage Stake Admins - ".concat(g.name),admins:g.stakeAdmins||[],stakeId:g.id,stakeName:g.name,onClose:()=>{f(!1),v(null)},onSave:async e=>{await(0,l.mZ)((0,l.H9)(mv,"stakes",g.id),{stakeAdmins:e,updatedAt:(new Date).toISOString()}),f(!1),v(null),k()}}),m&&g&&y&&(0,bt.jsx)(yv,{title:"Manage Ward Admins - ".concat(y.name),admins:y.wardAdmins||[],stakeId:g.id,wardId:y.id,stakeName:g.name,wardName:y.name,isWardAdmin:!0,onClose:()=>{p(!1),v(null),b(null)},onSave:async e=>{await(0,l.mZ)((0,l.H9)(mv,"stakes",g.id,"wards",y.id),{wardAdmins:e,updatedAt:(new Date).toISOString()}),p(!1),v(null),b(null),k()}})]})}function _v(e){var t;let{stake:r,onAddWard:a,onEdit:s,onDelete:i,onRefresh:o,onManageAdmins:c,onManageWardAdmins:u}=e;const[d,h]=(0,n.useState)(!1);return(0,bt.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,bt.jsxs)("div",{className:"bg-rose-50 p-4 flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,bt.jsx)(pt,{className:"w-6 h-6 text-rose-600"}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("h3",{className:"font-semibold text-gray-800",children:r.name}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:["Code: ",r.stakeCode]}),r.stakeAdmins&&r.stakeAdmins.length>0&&(0,bt.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[r.stakeAdmins.length," admin",r.stakeAdmins.length>1?"s":""]})]}),(0,bt.jsxs)("span",{className:"bg-white px-3 py-1 rounded-full text-sm text-gray-700",children:[(null===(t=r.wards)||void 0===t?void 0:t.length)||0," wards"]})]}),(0,bt.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,bt.jsx)("button",{onClick:()=>c(r),className:"px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors",children:"Admins"}),(0,bt.jsxs)("button",{onClick:()=>h(!d),className:"px-3 py-1 text-sm text-gray-700 hover:bg-rose-100 rounded transition-colors",children:[d?"Hide":"Show"," Wards"]}),(0,bt.jsx)("button",{onClick:s,className:"p-2 text-gray-700 hover:bg-rose-100 rounded transition-colors",children:(0,bt.jsx)(ct,{className:"w-4 h-4"})}),(0,bt.jsx)("button",{onClick:i,className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors",children:(0,bt.jsx)(et,{className:"w-4 h-4"})})]})]}),d&&(0,bt.jsxs)("div",{className:"p-4 bg-white",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("h4",{className:"font-medium text-gray-700",children:"Wards"}),(0,bt.jsxs)("button",{onClick:a,className:"flex items-center gap-1 px-3 py-1 text-sm bg-green-500 text-white rounded hover:bg-green-600 transition-colors",children:[(0,bt.jsx)(tt,{className:"w-3 h-3"}),"Add Ward"]})]}),r.wards&&r.wards.length>0?(0,bt.jsx)("div",{className:"space-y-2",children:r.wards.map(e=>(0,bt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,bt.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,bt.jsx)(rt,{className:"w-4 h-4 text-green-600"}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("span",{className:"text-gray-800",children:e.name}),e.wardAdmins&&e.wardAdmins.length>0&&(0,bt.jsxs)("p",{className:"text-xs text-gray-500",children:[e.wardAdmins.length," admin",e.wardAdmins.length>1?"s":""]})]})]}),(0,bt.jsxs)("div",{className:"flex gap-1",children:[(0,bt.jsx)("button",{onClick:()=>u(r,e),className:"px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 rounded transition-colors",children:"Admins"}),(0,bt.jsx)("button",{onClick:async()=>{if(confirm("Are you sure you want to delete this ward? All members, circles, and ward admins will be permanently deleted."))try{const t=(0,l.collection)(mv,"users"),n=(0,l.query)(t,(0,l.where)("role","==","wardAdmin"),(0,l.where)("wardId","==",e.id)),a=(await(0,l.getDocs)(n)).docs.map(e=>(0,l.kd)(e.ref));await Promise.all(a);const s=(0,l.collection)(mv,"stakes",r.id,"wards",e.id,"members"),i=(await(0,l.getDocs)(s)).docs.map(e=>(0,l.kd)(e.ref));await Promise.all(i);const c=(0,l.collection)(mv,"stakes",r.id,"wards",e.id,"circles"),u=(await(0,l.getDocs)(c)).docs.map(e=>(0,l.kd)(e.ref));await Promise.all(u),await(0,l.kd)((0,l.H9)(mv,"stakes",r.id,"wards",e.id)),o()}catch(t){console.error("Error deleting ward:",t),alert("Failed to delete ward: "+t.message)}},className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",children:(0,bt.jsx)(et,{className:"w-4 h-4"})})]})]},e.id))}):(0,bt.jsx)("p",{className:"text-gray-500 text-sm text-center py-4",children:"No wards yet"})]})]})}function Cv(e){let{stake:t,onClose:r,onSave:a}=e;const[s,i]=(0,n.useState)((null===t||void 0===t?void 0:t.name)||""),[o,c]=(0,n.useState)((null===t||void 0===t?void 0:t.stakeCode)||""),[u,d]=(0,n.useState)(""),[h,f]=(0,n.useState)(!1);return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:t?"Edit Stake":"Add New Stake"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stake Name"}),(0,bt.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stake Code"}),(0,bt.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"e.g., VEGAS-WEST"})]}),!t&&(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stake Admin Email (Optional)"}),(0,bt.jsx)("input",{type:"email",value:u,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"admin@example.com"})]}),(0,bt.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,bt.jsx)("button",{onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsx)("button",{onClick:async()=>{f(!0);try{t?await(0,l.mZ)((0,l.H9)(mv,"stakes",t.id),{name:s,stakeCode:o,updatedAt:(new Date).toISOString()}):await(0,l.gS)((0,l.collection)(mv,"stakes"),{name:s,stakeCode:o,stakeAdmins:u?[u]:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}),a()}catch(e){console.error("Error saving stake:",e),alert("Error saving stake")}finally{f(!1)}},disabled:h,className:"flex-1 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50",children:h?"Saving...":"Save Stake"})]})]})]})})}function Av(e){let{stake:t,onClose:r,onSave:a}=e;const[s,i]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[u,d]=(0,n.useState)(!1);return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Add New Ward"}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Adding ward to: ",t.name]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ward Name"}),(0,bt.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ward Admin Email (Optional)"}),(0,bt.jsx)("input",{type:"email",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"admin@example.com"})]}),(0,bt.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,bt.jsx)("button",{onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,bt.jsx)("button",{onClick:async()=>{d(!0);try{await(0,l.gS)((0,l.collection)(mv,"stakes",t.id,"wards"),{name:s,wardAdmins:o?[o]:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}),a()}catch(e){console.error("Error saving ward:",e),alert("Error saving ward")}finally{d(!1)}},disabled:u,className:"flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50",children:u?"Saving...":"Save Ward"})]})]})]})})}a.createRoot(document.getElementById("root")).render((0,bt.jsx)(vv,{}))})();
//# sourceMappingURL=main.ca607efe.js.map